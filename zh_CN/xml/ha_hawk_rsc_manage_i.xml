<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<sect1 xml:base="ha_hawk_rsc_manage_i.xml" id="sec.ha.config.hawk.manage">
 <title>管理群集资源</title>

 <para>
  除了配置群集资源以外，Hawk 还可用于从<guimenu>群集状态</guimenu>屏幕管理现有资源。有关此屏幕、其不同视图及用于状态信息的颜色代码的一般概述，请参见<xref linkend="sec.ha.config.hawk.intro.main"/>。
 </para>



 <para>
  可从任何群集状态视图执行基本资源操作。<guimenu>树视图</guimenu>和<guimenu>表视图</guimenu>都允许您直接访问各个资源。但是，在<guimenu>摘要视图</guimenu>中，需要先单击资源类别中的链接才能显示资源细节。此详细视图还会显示为该资源设置的任何属性。对于基元资源（普通基元、组子项、克隆或多状态资源），将会额外显示以下信息：
 </para>

 <itemizedlist mark="bullet" spacing="normal">
  <listitem>
   <para>
    资源的错误计数
   </para>
   <para>
    上次失败时戳（如果错误计数 &gt; 0）
   </para>
  </listitem>
  <listitem>
   <para>
    操作历史记录和时间（调用 ID、操作、上次运行时戳、执行时间、队列时间、返回代码和上次更改时戳）
   </para>
  </listitem>
 </itemizedlist>

 <figure>
  <title>查看资源的细节</title>
  <mediaobject>
   <imageobject role="fo">
    <imagedata fileref="hawk-resource-details.png" width="60%" format="PNG"/>
   </imageobject>
   <imageobject role="html">
    <imagedata fileref="hawk-resource-details.png" width="55%"/>
   </imageobject>
  </mediaobject>
 </figure>

 <sect2 id="sec.ha.config.hawk.start">
  <title>启动资源</title>
  <para>
   启动群集资源之前，应确保资源设置正确。例如，如果要使用 Apache 服务器作为群集资源，请先设置 Apache 服务器。完成 Apache 配置，然后才能启动群集中的相应资源。
  </para>
  <note>
   <title>不要处理由群集管理的服务</title>
   <para>
    通过 High Availability Extension 管理资源时，不得以其他方式（在群集外，例如手动或者引导时或重引导时）启动或停止同一资源。High Availability Extension 软件负责所有服务的启动或停止操作。
   </para>
   <para>
    但是，如果要检查服务是否正确配置，可手动启动该服务，但请确保在 High Availability 接管前再次停止该服务。
   </para>
   <para>
    要对群集当前管理的资源进行干预，请按<xref linkend="pro.ha.config.hawk.maint.mode.rsc"/>中所述先将资源设置为<literal>维护模式</literal>。
   </para>
  </note>
  <para>
   使用 Hawk 创建资源时，可通过 <literal>target-role</literal> 元属性设置其初始状态。如果将其值设置为 <literal>stopped</literal>，则该资源在创建后不会自动启动。
  </para>
  <procedure id="pro.ha.config.hawk.start">
   <title>启动新资源</title>
   <step performance="required">
    <para>
     按<xref linkend="sec.ha.config.hawk.intro.connect"/>中所述，启动 Web 浏览器并登录到群集。
    </para>
   </step>
   <step performance="required">
    <para>
     在左侧导航栏中，选择<guimenu>群集状态</guimenu>。
    </para>
   </step>
   <step performance="required">
    <para>
     在其中某个资源视图中，单击资源旁边的扳手图标，然后选择<guimenu>启动</guimenu>。要继续，请确认显示的消息。资源启动后，Hawk 会将资源的颜色更改为绿色并显示运行该资源的节点。
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 id="sec.ha.config.hawk.cleanup">
  <title>清理资源</title>
  <para>
   如果资源失败，它会自动重启动，但每次失败都会增加资源的失败计数。
  </para>
  <para>
   如果已为资源设置 <literal>migration-threshold</literal>，当失败次数达到迁移阈值时，节点将不再运行该资源。
  </para>
  <para>
   可自动重设置资源的失败计数（通过设置资源的 <literal>failure-timeout</literal> 选项），也可如下所述手动重设置。
  </para>
  <procedure id="pro.ha.config.hawk.clean">
   <title>清理资源</title>
   <step performance="required">
    <para>
     按<xref linkend="sec.ha.config.hawk.intro.connect"/>中所述，启动 Web 浏览器并登录到群集。
    </para>
   </step>
   <step performance="required">
    <para>
     在左侧导航栏中，选择<guimenu>群集状态</guimenu>。
    </para>
   </step>
   <step performance="required">
    <para>
     在其中某个资源视图中，单击失败的资源旁边的扳手图标，然后选择<guimenu>清理</guimenu>。要继续，请确认显示的消息。
    </para>

    <para>
     这将对指定节点上的指定资源执行命令 <command>crm_resource <option>-C</option></command> 和 <command>crm_failcount <option>-D</option></command>。
    </para>
   </step>
  </procedure>
  <para>
   有关更多信息，请参见手册页 <command>crm_resource</command> 和 <command>crm_failcount</command>。
  </para>
 </sect2>

 <sect2 id="sec.ha.config.hawk.remove">
  <title>删除群集资源</title>
  <para>
   如果需要从群集中删除资源，请遵循以下过程以免出现配置错误：
  </para>


  <procedure id="pro.ha.config.hawk.rm">
   <title>删除群集资源</title>
   <step performance="required">
    <para>
     按<xref linkend="sec.ha.config.hawk.intro.connect"/>中所述，启动 Web 浏览器并登录到群集。
    </para>
   </step>
   <step performance="required">
    <para>
     在左侧导航栏中，选择<guimenu>群集状态</guimenu>。
    </para>
   </step>
   <step performance="required">
    <para>
     按<xref linkend="pro.ha.config.hawk.clean"/>中所述清理所有节点上的资源。
    </para>
   </step>
   <step performance="required">
    <para>
     在其中某个资源视图中，单击资源旁边的扳手图标，然后选择<guimenu>停止</guimenu>。要继续，请确认显示的消息。
    </para>
   </step>


   <step performance="required">
    <para>
     如果资源已停止，则单击它旁边的扳手图标，然后选择<guimenu>删除资源</guimenu>。
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 id="sec.ha.config.hawk.migrate">
  <title>迁移群集资源</title>
  <para>
   如<xref linkend="sec.ha.config.hawk.failover"/>中所述，如果软件或硬件发生故障，群集会根据可自定义的特定参数（例如，迁移阈值或资源粘性），自动进行资源故障转移（迁移）。除此之外，还可以手动将资源迁移到群集中的其他节点。或者，您可以将它移出当前节点，并让群集决定要将它放置到哪个位置。
  </para>
  <procedure id="pro.ha.config.hawk.migrate">
   <title>手动迁移资源</title>
   <step performance="required">
    <para>
     按<xref linkend="sec.ha.config.hawk.intro.connect"/>中所述，启动 Web 浏览器并登录到群集。
    </para>
   </step>
   <step performance="required">
    <para>
     在左侧导航栏中，选择<guimenu>群集状态</guimenu>。
    </para>
   </step>
   <step performance="required">
    <para>
     在其中某个资源视图中，单击资源旁边的扳手图标，然后选择<guimenu>移动</guimenu>。
    </para>
   </step>
   <step performance="required">
    <para>
     在新窗口中，选择资源要移动到的节点。
    </para>
    <para>
     此操作将创建目标节点分数为 <literal>INFINITY</literal> 的位置约束。
    </para>
   </step>
   <step performance="required">
    <para>
     或者，选择移动资源<guimenu>离开当前节点</guimenu>。
    </para>
    <informalfigure>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="hawk-move-rsc.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="hawk-move-rsc.png" width="60%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </informalfigure>
    <para>
     此操作将为当前节点创建分数为 <literal>-INFINITY</literal> 的位置约束。
    </para>

   </step>

   <step performance="required">
    <para>
     单击 <guimenu>OK</guimenu>（确定）确认迁移。
    </para>
   </step>
  </procedure>
  <para>
   要使资源重新移回，请按如下操作：
  </para>
  <procedure id="pro.ha.config.hawk.migrate.back">
   <title>清除迁移约束</title>
   <step performance="required">
    <para>
     按<xref linkend="sec.ha.config.hawk.intro.connect"/>中所述，启动 Web 浏览器并登录到群集。
    </para>
   </step>
   <step performance="required">
    <para>
     在左侧导航栏中，选择<guimenu>群集状态</guimenu>。
    </para>
   </step>
   <step performance="required">
    <para>
     在其中某个资源视图中，单击资源旁边的扳手图标，然后选择<guimenu>丢弃重定位规则</guimenu>。要继续，请确认显示的消息。
    </para>
    <para>
     这将使用 <command>crm_resource <option>-U</option></command> 命令。资源<emphasis>可以</emphasis>移回到其原始位置，也可以留在当前位置（取决于资源黏性）。
    </para>
   </step>
  </procedure>
  <para>
   有关更多信息，请参见 <command>crm_resource</command> 手册页，或<citetitle>“Pacemaker Explained”</citetitle>（Pacemaker 配置说明），可从 <ulink url="http://www.clusterlabs.org/doc/"/> 获取。请参见<citetitle>“Resource Migration”</citetitle>（资源迁移）一章。
  </para>
 </sect2>

 <sect2 id="sec.ha.config.hawk.maint.mode">
  <title>使用维护模式</title>
    <para>您可能不时地需要对单个群集组件或整个群集执行测试或维护任务 - 更改群集配置、更新单个节点的软件包，或者将群集升级到更高的产品版本。 </para>
    <para>
   为此，High Availability Extension 提供了数种级别的 <literal>maintenance</literal> 选项：
  </para>
  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     <xref linkend="pro.ha.config.hawk.maint.mode.rsc" xrefstyle="select:title"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="pro.ha.config.hawk.maint.mode.nodes" xrefstyle="select:title"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="pro.ha.config.hawk.maint.mode.cluster" xrefstyle="select:title"/>
    </para>
   </listitem>
  </itemizedlist>
   
   <warning>
   <title>数据丢失风险</title>
   <para>当服务在群集控制下运行时，如果您需要执行任何测试或维护任务，请确保遵照以下说明操作：</para>
   <orderedlist spacing="normal">
    <listitem>
     <para>在开始之前，请将单个资源、节点或整个群集设置到维护模式。这有助于避免一些不利的负面影响，例如，资源未按顺序启动、群集节点之间出现 CIB 不同步的风险，或者丢失数据。 </para>
    </listitem>
    <listitem>
     <para>执行维护任务或测试。</para>
    </listitem>
    <listitem>
     <para>完成后，请解除维护模式以开始正常的群集操作。</para>
    </listitem>
   </orderedlist>
  </warning>
   
   <para>
   有关处于维护模式的资源和群集的行为的细节，请参见<xref linkend="sec.ha.config.basics.maint.mode"/>。
  </para>
  <procedure id="pro.ha.config.hawk.maint.mode.rsc">
   <title>对资源应用维护模式</title>
   <step performance="required">
    <para>
     按<xref linkend="sec.ha.config.hawk.intro.connect"/>中所述，启动 Web 浏览器并登录到群集。
    </para>
   </step>
   <step performance="required">
    <para>
     在左侧导航栏中，选择<guimenu>资源</guimenu>。 选择要置于维护模式或不受管理模式的资源，单击该资源旁边的扳手图标，然后选择<guimenu>编辑资源</guimenu>。
    </para>
   </step>
   <step performance="required">
    <para>
     打开<guimenu>元属性</guimenu>类别。
    </para>
   </step>
   <step performance="required">
    <para>
     从空下拉列表中，选择 <guimenu>maintenance</guimenu> 属性，然后单击加号图标添加该属性。
    </para>
   </step>
   <step performance="required">
    <para>
     选中 <literal>maintenance</literal> 旁边的复选框，以将 maintenance 属性设置为 <literal>yes</literal>。
    </para>
   </step>
   <step performance="required">
    <para>
     确认更改。
    </para>
   </step>
   <step performance="required">
    <para>
     完成该资源的维护任务之后，取消选中该资源的 <literal>maintenance</literal> 属性旁边的复选框。
    </para>
    <para>
     此后，资源将再次由 High Availability Extension 软件管理。
    </para>
   </step>
  </procedure>

  <procedure id="pro.ha.config.hawk.maint.mode.nodes">
   <title>对节点应用维护模式</title>
   <para>
    有时候需要将单个节点设置为维护模式。

   </para>
   <step performance="required">
    <para>
     按<xref linkend="sec.ha.config.hawk.intro.connect"/>中所述，启动 Web 浏览器并登录到群集。
    </para>
   </step>
   <step performance="required">
    <para>
     在左侧导航栏中，选择<guimenu>群集状态</guimenu>。
    </para>
   </step>
   <step performance="required">
    <para>
     在其中某个节点视图中，单击节点旁边的扳手图标，然后选择<guimenu>维护</guimenu>。
    </para>
    <para>
     这会将以下实例属性添加至节点：<literal>maintenance="true"</literal>。先前在维护模式节点上运行的资源将变为 <literal>unmanaged</literal>。在该节点脱离维护模式之前，系统不会向其分配新的资源。
    </para>
   </step>
   <step performance="required">
    <para>
     要停用维护模式，请单击节点旁边的扳手图标，然后选择<guimenu>就绪</guimenu>。
    </para>
   </step>
  </procedure>
  <procedure id="pro.ha.config.hawk.maint.mode.cluster">
   <title>对群集应用维护模式</title>
   <para>
    要对整个群集设置或取消设置维护模式，请执行以下操作：
   </para>
   <step performance="required">
    <para>
     按<xref linkend="sec.ha.config.hawk.intro.connect"/>中所述，启动 Web 浏览器并登录到群集。
    </para>
   </step>
   <step performance="required">
    <para>
     在左侧导航栏中，选择<guimenu>群集配置</guimenu>。
    </para>
   </step>
   <step performance="required">
    <para>
     在 <guimenu>CRM 配置</guimenu>组中，从空下拉框中选择 <guimenu>maintenance-mode</guimenu> 属性，然后单击加号图标添加该属性。
    </para>
   </step>
   <step performance="required">
    <para>
     要设置 <literal>maintenance-mode</literal>，请选中 <literal>maintenance-mode</literal> 旁边的复选框，并确认您所做的更改。
    </para>
   </step>
   <step performance="required">
    <para>
     完成整个群集的维护任务之后，取消选中 <literal>maintenance-mode</literal> 属性旁边的复选框。
    </para>
    <para>
     此后，High Availability Extension 将再次接管群集管理工作。
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 id="sec.ha.config.hawk.history">
  <title>查看群集历史记录</title>

  <para>
   Hawk 提供了以下可行的方法来查看群集上的过去的事件（按照不同级别和不同细节）。
  </para>
  <procedure id="pro.ha.config.hawk.recent">
   <title>查看节点或资源的最近事件</title>
   <step performance="required">
    <para>
     按<xref linkend="sec.ha.config.hawk.intro.connect"/>中所述，启动 Web 浏览器并登录到群集。
    </para>
   </step>
   <step performance="required">
    <para>
     在左侧导航栏中，选择<guimenu>群集状态</guimenu>。
    </para>
   </step>
   <step performance="required">
    <para>
     在<guimenu>树视图</guimenu>或<guimenu>表视图</guimenu>中，单击感兴趣的资源或节点旁边的扳手图标，然后选择<guimenu>查看最近的事件</guimenu>。
    </para>
    <para>
     打开的对话框显示过去一小时的事件。
    </para>
   </step>
  </procedure>
  <procedure id="pro.ha.config.hawk.history.explorer">
   <title>使用历史记录浏览器查看转换</title>
   <para>
    <guimenu>历史记录浏览器</guimenu>提供可由您定义的时间范围内的转换信息。它还会列出其先前运行的记录，并允许您<guimenu>删除</guimenu>不再需要的报告。<guimenu>历史记录浏览器</guimenu>使用 <literal>hb_report</literal> 提供的信息。 

   </para>
   <step performance="required">
    <para>
     按<xref linkend="sec.ha.config.hawk.intro.connect"/>中所述，启动 Web 浏览器并登录到群集。
    </para>
   </step>
   <step performance="required">
    <para>
     在左侧导航栏中，选择<guimenu>历史记录浏览器</guimenu>。
    </para>
   </step>
   <step performance="required">
    <para>
     默认情况下，浏览期限设置为过去 24 小时。要修改此期限，请设置其他<guimenu>开始时间</guimenu>和<guimenu>结束时间</guimenu>。
    </para>
   </step>
   <step performance="required">
    <para>
     单击<guimenu>显示</guimenu>开始收集转换数据。
    </para>
   </step>
  </procedure>
  <figure>
   <title>Hawk - 历史记录报告</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="hawk-history-report.png" width="100%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="hawk-history-report.png" width="90%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
  <para>
   接着将显示下列信息：
  </para>
  <variablelist id="vl.hawk.history.results">
   <title>历史记录浏览器结果</title>
   <varlistentry>
    <term><guimenu>时间</guimenu>
    </term>
    <listitem>
     <para>
      群集中所有过去转换的时间线。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>PE 输入</guimenu>/<guimenu>节点</guimenu>
    </term>
    <listitem>
     <para>
      每个转换的 <filename>pe-input*</filename> 文件以及在其上生成文件的节点。对于每次转换，群集都会保存一份提供给策略引擎的状态副本，以此作为输入。会记录此存档的路径。这些 <filename>pe-input*</filename> 文件只在指定协调器 (DC) 上生成，但由于 DC 可以更改，多个节点中也可能有 <filename>pe-input*</filename> 文件。这些文件显示策略引擎 (PE) <emphasis>计划</emphasis>要执行的操作。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>细节</guimenu>/<guimenu>完整日志</guimenu>
    </term>

    <listitem>
     <para>
      打开含有属于该特定转换的日志记录数据片段的弹出窗口。窗口显示的细节数量会有所不同：单击<guimenu>细节</guimenu>会显示 <command>crm history transition <replaceable>peinput</replaceable></command> 的输出（其中包括资源代理的日志讯息）。而<guimenu>完整日志</guimenu>还会包括来自 <systemitem>pengine</systemitem>、<systemitem>crmd</systemitem> 和 <systemitem>lrmd</systemitem> 的细节，其细节数量与 <command>crm history transition log <replaceable>peinput</replaceable></command> 相当。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>图形</guimenu>/<guimenu>XML</guimenu>
    </term>
    <listitem>
     <para>
      每个转换的图形和 XML 表示法。如果选择显示<guimenu>图形</guimenu>，将重调用 PE（使用 <filename>pe-input*</filename> 文件）并生成转换的图形显示。或者也可以查看图形的 XML 表示。
     </para>
     <figure>
      <title>Hawk 历史记录报告 - 转换图</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="hawk-history-graph.png" width="80%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="hawk-history-graph.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>差别</guimenu>
    </term>

    <listitem>
     <para>
      如果列出两个或多个 pe-input，<guimenu>差别</guimenu>链接将会出现在每对 pe-input 的右边。单击它以显示配置和状态和差别。
     </para>

    </listitem>
   </varlistentry>
  </variablelist>
 </sect2>

 <sect2 id="sec.ha.config.hawk.simulator">
  <title>浏览可能的失败方案</title>

  <para>
   Hawk 提供<guimenu>模拟器</guimenu>供您了解可能会发生的失败情况以防患于未然。切换到模拟器模式后，您可以更改节点的状态、添加或编辑资源和约束、更改群集配置或执行多个资源操作，以查看当这些事件发生时群集会如何操作。只要激活了模拟器模式，一个控制对话框就会显示在<guimenu>群集状态</guimenu>屏幕的右下角。模拟器会收集来自所有屏幕的更改，并将这些更改添加到它自己的内部事件队列中。除非在控制对话框中手动触发，否则不会用排入队列的事件执行模拟运行。进行模拟运行之后，您可以查看和分析已发生情况的细节（日志片段、转换图和 CIB 状态）。
  </para>
  <procedure id="pro.ha.config.hawk.simulator">
   <title>切换到模拟器模式</title>
   <step performance="required">
    <para>
     按<xref linkend="sec.ha.config.hawk.intro.connect"/>中所述，启动 Web 浏览器并登录到群集。
    </para>
   </step>
   <step performance="required">
    <para>
     通过单击顶行中（用户名旁边）的扳手图标并选择<guimenu>模拟器</guimenu>，激活模拟器模式。
    </para>
    <para>
     Hawk 的背景颜色更改表示模拟器处于活动状态。<guimenu>群集状态</guimenu>屏幕右下角将显示一个模拟器控制对话框。它的标题<guimenu>模拟器（初始状态）</guimenu>指示目前尚未运行任何模拟器。
    </para>
   </step>
   <step performance="required">
    <para>
     填充模拟器的事件队列：
    </para>
    <substeps performance="required">
     <step performance="required">
      <para>
       要模拟节点的状态更改：单击模拟器控制对话框中的 <guimenu>+节点</guimenu>。选择要操作的<guimenu>节点</guimenu>，然后选择其目标<guimenu>状态</guimenu>。确认更改以将其添加到控制器对话框中列出的事件队列中。
      </para>
     </step>
     <step performance="required">
      <para>
       要模拟资源操作：单击模拟器控制对话框中的 <guimenu>+操作</guimenu>。选择要操作的<guimenu>资源</guimenu>和要模拟的<guimenu>操作</guimenu>。如果必要，请定义<guimenu>间隔</guimenu>。选择要运行操作的<guimenu>节点</guimenu>及目标<guimenu>结果</guimenu>。确认更改以将其添加到控制器对话框中列出的事件队列中。
      </para>
     </step>
    </substeps>
   </step>
   <step performance="required">
    <para>
     对要模拟的任何其他节点状态更改或资源操作重复上述步骤。
    </para>
    <figure>
     <title>Hawk - 使用注入的事件的模拟器</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="hawk-simulator-injected.png" width="90%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="hawk-simulator-injected.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </step>
   <step performance="required">
    <para>
     要注入想要模拟的其他更改，请执行以下操作：
    </para>
    <substeps performance="required">
     <step performance="required">
      <para>
       切换到下列一个或多个 Hawk 屏幕：<guimenu>群集状态</guimenu>、<guimenu>设置向导</guimenu>、<guimenu>群集配置</guimenu>、<guimenu>资源</guimenu>或<guimenu>约束</guimenu>。
      </para>
      <note>
       <title>历史记录浏览器和模拟器模式</title>
       <para>
        单击<guimenu>历史记录浏览器</guimenu>选项卡将停用模拟器模式。
       </para>
      </note>
     </step>
     <step performance="required">
      <para>
       根据需要在屏幕上添加或修改参数。
      </para>
      <para>
       模拟器会收集来自所有屏幕的更改，并将这些更改添加到它自己的内部事件队列中。
       
      </para>
     </step>
     <step performance="required">
      <para>
       要返回到模拟器控制对话框，请切换到<guimenu>群集状态</guimenu>屏幕或单击顶行中的扳手图标，然后再次单击<guimenu>模拟器</guimenu>。
      </para>
     </step>
    </substeps>
   </step>
   <step performance="required">
    <para>
     如果要删除<guimenu>注入的状态</guimenu>中列出的事件，请选择相应的条目，然后单击列表下的减号图标。
    </para>
   </step>
   <step performance="required">
    <para>
     通过在模拟器控制对话框中单击<guimenu>运行</guimenu>，开始模拟运行。<guimenu>群集状态</guimenu>屏幕显示模拟的事件。例如，如果将一个节点标记为未清理，则它现在将显示为脱机，其所有资源都将停止。模拟器控制对话框更改为<guimenu>模拟器（最终状态）</guimenu>。
    </para>
    <figure>
     <title>Hawk - 处于最终状态的模拟器</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="hawk-simulator-final.png" width="90%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="hawk-simulator-final.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </step>
   <step performance="required">
    <para>
     要查看关于模拟运行的更详细的信息：
    </para>
    <substeps performance="required">
     <step performance="required">
      <para>
       单击模拟器对话框中的<guimenu>细节</guimenu>链接可以查看已发生情况的日志片段。
      </para>
     </step>
     <step performance="required">
      <para>
       单击<guimenu>图形</guimenu>链接可以显示转换图。
      </para>
     </step>
     <step performance="required">
      <para>
       单击 <guimenu>CIB（初始）</guimenu>可以显示初始 CIB 状态。要查看转换后的 CIB，请单击 <guimenu>CIB（输出）</guimenu>。
      </para>
     </step>
    </substeps>
   </step>
   <step performance="required">
    <para>
     要用新模拟从头开始，请使用<guimenu>重设置</guimenu>按钮。
    </para>
   </step>
   <step performance="required">
    <para>
     要退出模拟模式，请关闭模拟器控制对话框。<guimenu>群集状态</guimenu>屏幕切换回其正常颜色并显示当前的群集状态。
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 id="sec.ha.config.hawk.crm_report">
  <title>生成群集报告</title>

  <para>
   为了对群集上发生的问题进行分析和诊断，Hawk 可以生成一个群集报告，用来收集群集中所有节点的信息。
  </para>
  <procedure id="pro.ha.config.hawk.crm_report">
   <title>生成 <literal>hb_report</literal></title>
   <step performance="required">
    <para>
     按<xref linkend="sec.ha.config.hawk.intro.connect"/>中所述，启动 Web 浏览器并登录到群集。
    </para>
   </step>
   <step performance="required">
    <para>
     单击顶行中用户名旁边的扳手图标，然后选择<guimenu>生成 hb_report</guimenu>。
    </para>
   </step>
   <step performance="required">
    <para>
     默认情况下，检查期限为过去一小时。要修改此期限，请设置其他<guimenu>开始时间</guimenu>和<guimenu>结束时间</guimenu>。
    </para>
   </step>
   <step performance="required">
    <para>
     单击<guimenu>生成</guimenu>。
    </para>
   </step>
   <step performance="required">
    <para>
     创建报告后，通过单击相应链接下载 <filename>*.tar.bz2</filename> 文件。
    </para>
   </step>
  </procedure>
  <para>
   有关 <literal>hb_report</literal> 和 <literal>crm_report</literal> 等工具涵盖的日志文件的更多信息，请参见<xref linkend="vle.ha.crm_report"/>。
  </para>
 </sect2>
</sect1>
