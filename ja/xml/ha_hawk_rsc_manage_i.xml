<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<sect1 xml:base="ha_hawk_rsc_manage_i.xml" id="sec.ha.config.hawk.manage">
 <title>クラスタリソースの管理</title>

 <para>
  Hawkでは、クラスタリソースを設定することに加えて、<guimenu>クラスタステータス</guimenu>画面で既存のリソースを管理することができます。画面、それぞれのビュー、およびステータス情報で使用するカラーコードの一般的な概要は、<xref linkend="sec.ha.config.hawk.intro.main"/>を参照してください。
 </para>



 <para>
  基本的なリソース操作は、クラスタステータスビューから実行できます。<guimenu>ツリービュー</guimenu>および<guimenu>テーブルビュー</guimenu>は、どちらからでも、個々のリソースに直接アクセスすることができます。ただし、<guimenu>サマリビュー</guimenu>では、リソースの詳細を表示するのに、まずリソースカテゴリの中のリンクをクリックする必要があります。詳細ビューにもそのリソースのすべての属性が表示されます。プリミティブリソース(通常のプリミティブ、グループの子、クローン、またはマルチステートリソース)については、次の情報が追加で表示されます。
 </para>

 <itemizedlist mark="bullet" spacing="normal">
  <listitem>
   <para>
    リソースの失敗回数
   </para>
   <para>
    最終失敗時のタイムスタンプ(失敗回数が0より大きい場合)
   </para>
  </listitem>
  <listitem>
   <para>
    操作履歴とタイミング(コールID、操作、最終実行時のタイムスタンプ、実行時間、キュー時間、戻りコード、最後の変更タイムスタンプ)
   </para>
  </listitem>
 </itemizedlist>

 <figure>
  <title>リソースの詳細の表示</title>
  <mediaobject>
   <imageobject role="fo">
    <imagedata fileref="hawk-resource-details.png" width="60%" format="PNG"/>
   </imageobject>
   <imageobject role="html">
    <imagedata fileref="hawk-resource-details.png" width="55%"/>
   </imageobject>
  </mediaobject>
 </figure>

 <sect2 id="sec.ha.config.hawk.start">
  <title>リソースの開始</title>
  <para>
   クラスタリソースは、起動する前に、正しく設定されているようにします。たとえば、Apacheサーバをクラスタリソースとして使用する場合は、まず、Apacheサーバをセットアップし、Apacheの環境設定を完了してから、クラスタで個々のリソースを起動します。
  </para>
  <note>
   <title>クラスタによって管理されるサービスには介入しないでください。</title>
   <para>
    High Availability Extensionでリソースを管理しているときに、同じリソースを他の方法(クラスタ外で、たとえば、手動、ブート、再起動など)で開始したり、停止してはなりません。High Availability Extensionソフトウェアが、すべてのサービスの開始または停止アクションを実行します。
   </para>
   <para>
    ただし、サービスが適切に構成されているか確認したい場合は手動で開始しますが、High Availabilityが起動する前に停止してください。
   </para>
   <para>
    現在クラスタで管理されているリソースへの介入については、まず、<xref linkend="pro.ha.config.hawk.maint.mode.rsc"/>で説明されているように、リソースを<literal>maintenance mode</literal>に設定します。
   </para>
  </note>
  <para>
   Hawkでリソースを作成するときには、<literal>target-role</literal>メタ属性でその初期状態を設定することができます。その値を<literal>stopped</literal>に設定した場合、リソースは、作成後、自動的に開始することはありません。
  </para>
  <procedure id="pro.ha.config.hawk.start">
   <title>新しいリソースを起動する</title>
   <step performance="required">
    <para>
     <xref linkend="sec.ha.config.hawk.intro.connect"/>で説明したように、Webブラウザを起動してクラスタにログインします。
    </para>
   </step>
   <step performance="required">
    <para>
     左のナビゲーションバーで、<guimenu>クラスタステータス</guimenu>を選択します。
    </para>
   </step>
   <step performance="required">
    <para>
     個々のリソースビューのいずれかで、リソースの隣のレンチアイコンをクリックして、<guimenu>開始</guimenu>を選択します。継続するには、表示されるメッセージに対して確認します。リソースが開始すると、Hawkはすぐにリソースの色を緑に変え、それがどのノードで実行されているかを表示します。
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 id="sec.ha.config.hawk.cleanup">
  <title>リソースのクリーンアップ</title>
  <para>
   リソースは、失敗した場合は自動的に再起動しますが、失敗のたびにリソースの失敗回数が増加します。
  </para>
  <para>
   リソースに対して<literal>migration-threshold</literal>が設定されていた場合、失敗回数が移行しきい値に達すると、そのリソースはそのノードでは実行されなくなります。
  </para>
  <para>
   リソースの失敗回数は、(リソースに<literal>failure-timeout</literal>オプションを設定することにより)自動的にリセットするか、または次に示すように手動でリセットできます。
  </para>
  <procedure id="pro.ha.config.hawk.clean">
   <title>リソースをクリーンアップする</title>
   <step performance="required">
    <para>
     <xref linkend="sec.ha.config.hawk.intro.connect"/>で説明したように、Webブラウザを起動してクラスタにログインします。
    </para>
   </step>
   <step performance="required">
    <para>
     左のナビゲーションバーで、<guimenu>クラスタステータス</guimenu>を選択します。
    </para>
   </step>
   <step performance="required">
    <para>
     個々のリソースビューのいずれかで、リソースの隣のレンチアイコンをクリックして、<guimenu>クリーンアップ</guimenu>を選択します。継続するには、表示されるメッセージに対して確認します。
    </para>

    <para>
     これによって指定したノード上の指定したリソースに対して、コマンド<command>crm_resource<option> -C</option></command>および<command>crm_failcount<option> -D</option></command>が実行されます。
    </para>
   </step>
  </procedure>
  <para>
   詳細は、<command>crm_resource</command>および<command>crm_failcount</command>のマニュアルページを参照してください。
  </para>
 </sect2>

 <sect2 id="sec.ha.config.hawk.remove">
  <title>クラスタリソースの削除</title>
  <para>
   リソースをクラスタから削除する必要がある場合は、次の手順に従って、設定エラーが発生しないようにします。
  </para>


  <procedure id="pro.ha.config.hawk.rm">
   <title>クラスタリソースの削除</title>
   <step performance="required">
    <para>
     <xref linkend="sec.ha.config.hawk.intro.connect"/>で説明したように、Webブラウザを起動してクラスタにログインします。
    </para>
   </step>
   <step performance="required">
    <para>
     左のナビゲーションバーで、<guimenu>クラスタステータス</guimenu>を選択します。
    </para>
   </step>
   <step performance="required">
    <para>
     <xref linkend="pro.ha.config.hawk.clean"/>の説明に従って、すべてのノードでリソースをクリーンアップします。
    </para>
   </step>
   <step performance="required">
    <para>
     個々のリソースビューのいずれかで、リソースの隣のレンチアイコンをクリックして、<guimenu>開始</guimenu>を選択します。継続するには、表示されるメッセージに対して確認します。
    </para>
   </step>


   <step performance="required">
    <para>
     変更するリソースを選択し、その隣のレンチアイコンをクリックして、<guimenu>リソースの削除</guimenu>を選択します。
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 id="sec.ha.config.hawk.migrate">
  <title>クラスタリソースの移行</title>
  <para>
   <xref linkend="sec.ha.config.hawk.failover"/>で説明したように、ソフトウェアまたはハードウェアの障害時には、クラスタは定義可能な特定のパラメータ(たとえばマイグレーションしきい値やリソースの固着性など)に従って、リソースを自動的にフェールオーバー(マイグレート)させます。それ以外に、クラスタ内の別のノードにリソースを手動で移行させることもできます。または、リソースを現在のノードから出して、どこに移動するかはクラスタに判断させることもできます。
  </para>
  <procedure id="pro.ha.config.hawk.migrate">
   <title>リソースを手動で移行する</title>
   <step performance="required">
    <para>
     <xref linkend="sec.ha.config.hawk.intro.connect"/>で説明したように、Webブラウザを起動してクラスタにログインします。
    </para>
   </step>
   <step performance="required">
    <para>
     左のナビゲーションバーで、<guimenu>クラスタステータス</guimenu>を選択します。
    </para>
   </step>
   <step performance="required">
    <para>
     個々のリソースビューのいずれかで、リソースの隣のレンチアイコンをクリックして、<guimenu>移動</guimenu>を選択します。
    </para>
   </step>
   <step performance="required">
    <para>
     新規ウィンドウで、リソースの移動先ノードを選択します。
    </para>
    <para>
     これによって移動先ノードに対して<literal>INFINITY</literal>スコアの場所の制約が作成されます。
    </para>
   </step>
   <step performance="required">
    <para>
     または、リソースを<guimenu>現在のノードから</guimenu>移動するように選択します。
    </para>
    <informalfigure>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="hawk-move-rsc.png" width="70%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="hawk-move-rsc.png" width="60%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </informalfigure>
    <para>
     これによって現在のノードに対して<literal>-INFINITY</literal>スコアによる場所の制約が作成されます。
    </para>

   </step>

   <step performance="required">
    <para>
     <guimenu>OK</guimenu>をクリックして、マイグレーションを確認します。
    </para>
   </step>
  </procedure>
  <para>
   リソースを再び元に戻すには、次の手順に従います。
  </para>
  <procedure id="pro.ha.config.hawk.migrate.back">
   <title>移行制約をクリアする</title>
   <step performance="required">
    <para>
     <xref linkend="sec.ha.config.hawk.intro.connect"/>で説明したように、Webブラウザを起動してクラスタにログインします。
    </para>
   </step>
   <step performance="required">
    <para>
     左のナビゲーションバーで、<guimenu>クラスタステータス</guimenu>を選択します。
    </para>
   </step>
   <step performance="required">
    <para>
     個々のリソースビューのいずれかで、リソースの隣のレンチアイコンをクリックして、<guimenu>再配置ルールを無視</guimenu>を選択します。継続するには、表示されるメッセージに対して確認します。
    </para>
    <para>
     これによって、<command>crm_resource <option>-U</option></command>コマンドが使用されます。リソースは元の場所に戻ることができます<emphasis/>。あるいは現在の場所に残ることもあります(リソースの固着性によって)。
    </para>
   </step>
  </procedure>
  <para>
   詳細は、<command>crm_resource</command>のマニュアルページ、または<citetitle>Pacemaker Explained</citetitle>を参照してください。<ulink url="http://www.clusterlabs.org/doc/"/>から入手できます。特に、「<citetitle>Resource Migration</citetitle>」のセクションを参照してください。
  </para>
 </sect2>

 <sect2 id="sec.ha.config.hawk.maint.mode">
  <title>保守モードの使用</title>
    <para>クラスタ設定の変更時、個々のノードに対するソフトウェアパッケージの更新時、または上位製品バージョンへのクラスタのアップグレード時であっても、個々のクラスタコンポーネント上、またはクラスタ全体でテストや保守タスクを実行する必要がある場合があります。 </para>
    <para>
   それに関して、High Availability Extensionは、次のレベルで<literal>maintenance</literal>オプションを提供しています。
  </para>
  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     <xref linkend="pro.ha.config.hawk.maint.mode.rsc" xrefstyle="select:title"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="pro.ha.config.hawk.maint.mode.nodes" xrefstyle="select:title"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="pro.ha.config.hawk.maint.mode.cluster" xrefstyle="select:title"/>
    </para>
   </listitem>
  </itemizedlist>
   
   <warning>
   <title>データ損失の危険</title>
   <para>クラスタ制御下でサービスを実行しているときにテストまたは保守タスクを実行する必要がある場合は、次のアウトラインに従ってください。</para>
   <orderedlist spacing="normal">
    <listitem>
     <para>手順を開始する前に、個々のリソース、ノード、またはクラスタ全体を保守モードに設定します。これにより、順序正しくリソースを起動できないなどの望ましくない影響、クラスタノード間でCIBが同期されないリスク、またはデータ損失を避けることができます。 </para>
    </listitem>
    <listitem>
     <para>保守タスクまたはテストを実行します。</para>
    </listitem>
    <listitem>
     <para>完了したら、保守モードを解除して、通常のクラスタ操作を開始します。</para>
    </listitem>
   </orderedlist>
  </warning>
   
   <para>
   保守モード中にリソースおよびクラスタで何が発生するかの詳細については、<xref linkend="sec.ha.config.basics.maint.mode"/>を参照してください。
  </para>
  <procedure id="pro.ha.config.hawk.maint.mode.rsc">
   <title>リソースへの保守モードの適用</title>
   <step performance="required">
    <para>
     <xref linkend="sec.ha.config.hawk.intro.connect"/>で説明したように、Webブラウザを起動してクラスタにログインします。
    </para>
   </step>
   <step performance="required">
    <para>
     左のナビゲーションバーで、<guimenu>リソース</guimenu>を選択します。保守モードまたは非管理対象モードにするリソースを選択し、そのリソースの隣のレンチアイコンをクリックして、<guimenu>リソースの編集</guimenu>を選択します。
    </para>
   </step>
   <step performance="required">
    <para>
     <guimenu>メタ属性</guimenu>カテゴリが開きます。
    </para>
   </step>
   <step performance="required">
    <para>
     空のドロップダウンリストから<guimenu>maintenance</guimenu>属性を選択し、プラスアイコンをクリックして追加します。
    </para>
   </step>
   <step performance="required">
    <para>
     <literal>maintenance</literal>の隣のチェックボックスをオンにして、maintenance属性を<literal>yes</literal>に設定します。
    </para>
   </step>
   <step performance="required">
    <para>
     変更内容を確認します。
    </para>
   </step>
   <step performance="required">
    <para>
     該当するリソースの保守作業が完了したら、そのリソースの<literal>maintenance</literal>属性の隣のチェックボックスをオフにします。
    </para>
    <para>
     リソースは、この時点から再びHigh Availability Extensionソフトウェアによって管理されます。
    </para>
   </step>
  </procedure>

  <procedure id="pro.ha.config.hawk.maint.mode.nodes">
   <title>ノードへの保守モードの適用</title>
   <para>
    1つのノードを保守モードにする必要がある場合があります。

   </para>
   <step performance="required">
    <para>
     <xref linkend="sec.ha.config.hawk.intro.connect"/>で説明したように、Webブラウザを起動してクラスタにログインします。
    </para>
   </step>
   <step performance="required">
    <para>
     左のナビゲーションバーで、<guimenu>クラスタステータス</guimenu>を選択します。
    </para>
   </step>
   <step performance="required">
    <para>
     個々のノードのビューのいずれかで、ノードの隣のレンチアイコンをクリックして、<guimenu>保守</guimenu>を選択します。
    </para>
    <para>
     これにより、<literal>maintenance="true"</literal>というインスタンス属性がノードに追加されます。保守モードのノードでこれまで実行されていたリソースは、<literal>unmanaged</literal>になります。保守モードを終了するまで、このノードに新しいリソースが割り当てられることはありません。
    </para>
   </step>
   <step performance="required">
    <para>
     保守モードを無効化するには、そのノードの隣のレンチアイコンをクリックして<guimenu>準備完了</guimenu>を選択します。
    </para>
   </step>
  </procedure>
  <procedure id="pro.ha.config.hawk.maint.mode.cluster">
   <title>クラスタへの保守モードの適用</title>
   <para>
    クラスタ全体に保守モードを設定または設定解除するには、次の手順に従います。
   </para>
   <step performance="required">
    <para>
     <xref linkend="sec.ha.config.hawk.intro.connect"/>で説明したように、Webブラウザを起動してクラスタにログインします。
    </para>
   </step>
   <step performance="required">
    <para>
     左のナビゲーションバーで、<guimenu>クラスタ設定</guimenu>を選択します。
    </para>
   </step>
   <step performance="required">
    <para>
     <guimenu>CRMの環境設定</guimenu>グループで、空のドロップダウンボックスから<guimenu>maintenance-mode</guimenu>属性を選択し、プラスアイコンをクリックして追加します。
    </para>
   </step>
   <step performance="required">
    <para>
     <literal>maintenance-mode=true</literal>を設定するには、<literal>maintenance-mode</literal>の隣のチェックボックスをオンにして、変更を確認します。
    </para>
   </step>
   <step performance="required">
    <para>
     クラスタ全体の保守作業が完了したら、<literal>maintenance-mode</literal>属性の隣のチェックボックスをオフにします。
    </para>
    <para>
     この時点から、High Availability Extensionはクラスタ管理をもう一度引き継ぎます。
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 id="sec.ha.config.hawk.history">
  <title>クラスタ履歴の表示</title>

  <para>
   Hawkには、クラスタの過去のイベントを表示する、次のような機能があります(いくつかの詳細さのレベルがあります)。
  </para>
  <procedure id="pro.ha.config.hawk.recent">
   <title>ノードまたリソースの最近のイベントの表示</title>
   <step performance="required">
    <para>
     <xref linkend="sec.ha.config.hawk.intro.connect"/>で説明したように、Webブラウザを起動してクラスタにログインします。
    </para>
   </step>
   <step performance="required">
    <para>
     左のナビゲーションバーで、<guimenu>クラスタステータス</guimenu>を選択します。
    </para>
   </step>
   <step performance="required">
    <para>
     <guimenu>ツリービュー</guimenu>または<guimenu>テーブルビュー</guimenu>で、対象とするリソースまたはノードの隣のレンチアイコンをクリックして、<guimenu>最近のイベントを表示</guimenu>を選択します。
    </para>
    <para>
     表示されるダイアログには、直前の1時間のイベントが表示されます。
    </para>
   </step>
  </procedure>
  <procedure id="pro.ha.config.hawk.history.explorer">
   <title>履歴エクスプローラで遷移を表示する </title>
   <para>
    <guimenu>履歴エクスプローラ</guimenu>には、定義できるタイムフレームでの遷移情報が表示されます。ここではこれまでの実行内容が一覧され、不必要になったレポートを<guimenu>削除</guimenu>することができます。<guimenu>履歴エクスプローラ</guimenu>は、<literal>hb_report</literal>で提供される情報を使用します。 

   </para>
   <step performance="required">
    <para>
     <xref linkend="sec.ha.config.hawk.intro.connect"/>で説明したように、Webブラウザを起動してクラスタにログインします。
    </para>
   </step>
   <step performance="required">
    <para>
     左のナビゲーションバーで、<guimenu>履歴エクスプローラ</guimenu>を選択します。
    </para>
   </step>
   <step performance="required">
    <para>
     デフォルトでは、表示する期間は直前の24時間に設定されています。これを変更するには、<guimenu>開始時刻</guimenu> および<guimenu>終了時刻</guimenu>を設定します。
    </para>
   </step>
   <step performance="required">
    <para>
     <guimenu>表示</guimenu>をクリックして、遷移データの収集を開始します。
    </para>
   </step>
  </procedure>
  <figure>
   <title>Hawk - 履歴レポート</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="hawk-history-report.png" width="100%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="hawk-history-report.png" width="90%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
  <para>
   次の情報が表示されます。
  </para>
  <variablelist id="vl.hawk.history.results">
   <title>履歴エクスプローラの結果</title>
   <varlistentry>
    <term><guimenu>時刻</guimenu>
    </term>
    <listitem>
     <para>
      クラスタ内の過去のすべての遷移のタイムライン。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>PE Input</guimenu>/<guimenu>Node</guimenu>
    </term>
    <listitem>
     <para>
      それぞれの遷移とそれが生成されたノードに関する<filename>pe-input*</filename>ファイル。遷移ごとに、クラスタは状態のコピーを保存します。これはポリシーエンジンに入力として提供されます。このアーカイブがログ記録されるパス。<filename>pe-input*</filename>ファイルは指定コーディネータ(DC)上でのみ生成されますが、DCは変更できるので、複数のノードからの<filename>pe-input*</filename>ファイルが存在する可能性があります。これらのファイルは、ポリシーエンジン(PE)が何を行うよう「予定」されているかを示します。<emphasis/>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>Details</guimenu>/<guimenu>Full Log</guimenu>
    </term>

    <listitem>
     <para>
      ポップアップウィンドウが開き、その特定の遷移に属しているログ記録データのスニペットが表示されます。さまざまな詳細レベルを表示できます。<guimenu>詳細情報</guimenu>をクリックすると、<command>crm history transition <replaceable>peinput</replaceable></command> (リソースエージェントのログメッセージを含む)の出力が表示されますが、<guimenu>ログ全体</guimenu>には<systemitem>pengine</systemitem>、<systemitem>crmd</systemitem>、<systemitem>lrmd</systemitem>の詳細も含まれており、<command>crm history transition log <replaceable>peinput</replaceable></command>に相当します。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>Graph</guimenu>/<guimenu>XML</guimenu>
    </term>
    <listitem>
     <para>
      それぞれの遷移のグラフとXML表現。<guimenu>グラフ</guimenu>を表示するように選択した場合、(<filename>pe-input*</filename>ファイルを使用して) PEが再度呼び出され、遷移のグラフィカルな表現が生成されます。または、グラフのXML表現を表示することもできます。
     </para>
     <figure>
      <title>Hawk履歴レポート - 遷移グラフ</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="hawk-history-graph.png" width="80%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="hawk-history-graph.png" width="70%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><guimenu>差分</guimenu>
    </term>

    <listitem>
     <para>
      複数のpe-inputが一覧表示されている場合、pe-inputの各ペアの右側に<guimenu>差分</guimenu>リンクが表示されます。これをクリックすると、設定とステータスの差異が表示されます。
     </para>

    </listitem>
   </varlistentry>
  </variablelist>
 </sect2>

 <sect2 id="sec.ha.config.hawk.simulator">
  <title>可能性のある障害シナリオを調べる</title>

  <para>
   Hawkには<guimenu>シミュレータ</guimenu>が用意されており、障害シナリオを、実際に発生する前に調べることができます。シミュレータモードに切り替える前に、ノードのステータスを変更したり、リソースと制約を追加または編集したり、クラスタ設定を変更したり、複数のリソース操作を実行したりして、どのようなクラスタの動作によってこれらのイベントが発生するのかを確認することができます。シミュレータモードが有効になっている間は、<guimenu>クラスタステータス</guimenu>画面の右下隅にコントロールダイアログが表示されます。シミュレータはすべての画面の変更内容を収集し、イベントの内部キューにそれらを追加します。キューに入れられたイベントによる実行シミュレーションは、コントロールダイアログで手動でトリガされるまでは実行されません。シミュレーションの実行後、実行結果の詳細(ログスニペット、遷移グラフ、CIB状態)を表示して分析することができます。
  </para>
  <procedure id="pro.ha.config.hawk.simulator">
   <title>シミュレータモードに切り替える</title>
   <step performance="required">
    <para>
     <xref linkend="sec.ha.config.hawk.intro.connect"/>で説明したように、Webブラウザを起動してクラスタにログインします。
    </para>
   </step>
   <step performance="required">
    <para>
     最上位の行(ユーザ名の横)にあるレンチアイコンをクリックし、<guimenu>シミュレータ</guimenu>を選択することで、シミュレータモードをアクティブ化します。
    </para>
    <para>
     Hawkのバックグラウンド色が変化して、シミュレータがアクティブであることが示されます。<guimenu>クラスタステータス</guimenu>画面の右下隅にシミュレータのコントロールダイアログが表示されます。そのタイトル<guimenu>シミュレータ(初期状態)</guimenu>は、まだシミュレータが実行されていないことを示します。
    </para>
   </step>
   <step performance="required">
    <para>
     シミュレータのイベントキューを埋めます。
    </para>
    <substeps performance="required">
     <step performance="required">
      <para>
       ノードのステータスの変更をシミュレートするには、まずシミュレータコントロールダイアログの<guimenu>+Node</guimenu>をクリックします。操作する<guimenu>ノード</guimenu>を選択し、そのターゲット<guimenu>状態</guimenu>を選択します。変更を確認して、それらをコントローラダイアログに一覧表示されるイベントのキューに追加します。
      </para>
     </step>
     <step performance="required">
      <para>
       リソースの操作をシミュレートするには、まずシミュレータコントロールダイアログの<guimenu>+Op</guimenu>をクリックします。操作する<guimenu>リソース</guimenu>を選択し、シミュレートする<guimenu>操作</guimenu>を選択します。 必要に応じて、<guimenu>間隔</guimenu>を定義します。操作を実行する<guimenu>ノード</guimenu>を選択し、ターゲットとする<guimenu>結果</guimenu>を選択します。変更を確認して、それらをコントローラダイアログに一覧表示されるイベントのキューに追加します。
      </para>
     </step>
    </substeps>
   </step>
   <step performance="required">
    <para>
     シミュレートするその他のノードのステータス変更やリソース操作に対して、前の手順を繰り返します。
    </para>
    <figure>
     <title>Hawk - イベントが挿入されたシミュレータ</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="hawk-simulator-injected.png" width="90%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="hawk-simulator-injected.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </step>
   <step performance="required">
    <para>
     シミュレートするその他の変更を挿入するには:
    </para>
    <substeps performance="required">
     <step performance="required">
      <para>
       <guimenu>クラスタステータス</guimenu>、<guimenu>セットアップウィザード</guimenu>、<guimenu>クラスタ設定</guimenu>、<guimenu>リソース</guimenu>、または<guimenu>制約</guimenu>といったHawk画面のいずれかに切り替えます。
      </para>
      <note>
       <title>履歴エクスプローラとシミュレータモード</title>
       <para>
        <guimenu>履歴エクスプローラ</guimenu>タブをクリックすると、シミュレータモードが無効になります。
       </para>
      </note>
     </step>
     <step performance="required">
      <para>
       必要に応じて、画面上でパラメータの追加や変更を行います。
      </para>
      <para>
       シミュレータはすべての画面の変更内容を収集し、イベントの内部キューにそれらを追加します。
       
      </para>
     </step>
     <step performance="required">
      <para>
       シミュレータコントロールダイアログに戻るには、<guimenu>クラスタステータス</guimenu>画面に切り替えるか、もう一度最上位の行のレンチアイコンをクリックして<guimenu>シミュレータ</guimenu>をクリックします。
      </para>
     </step>
    </substeps>
   </step>
   <step performance="required">
    <para>
     <guimenu>挿入された状態</guimenu>に一覧されているイベントを削除する場合は、それぞれのエントリを選択して、リストのすぐ下のマイナスアイコンをクリックします。
    </para>
   </step>
   <step performance="required">
    <para>
     シミュレータコントロールダイアログで<guimenu>実行</guimenu>をクリックして、シミュレーションの実行を開始します。<guimenu>クラスタステータス</guimenu>画面に、シミュレートされるイベントが表示されます。たとえば、あるノードをアンクリーンとしてマークした場合、それはオフラインとして表示され、そのすべてのリソースは停止されます。シミュレータコントロールダイアログは、<guimenu>シミュレータ(最終状態)</guimenu>に変わります。
    </para>
    <figure>
     <title>Hawk - 最終状態のシミュレータ</title>
     <mediaobject>
      <imageobject role="fo">
       <imagedata fileref="hawk-simulator-final.png" width="90%" format="PNG"/>
      </imageobject>
      <imageobject role="html">
       <imagedata fileref="hawk-simulator-final.png" width="70%" format="PNG"/>
      </imageobject>
     </mediaobject>
    </figure>
   </step>
   <step performance="required">
    <para>
     シミュレーションの実行に関する詳細情報を表示するには:
    </para>
    <substeps performance="required">
     <step performance="required">
      <para>
       シミュレータダイアログの<guimenu>詳細</guimenu>リンクをクリックして、実行結果のログスニペットを表示します。
      </para>
     </step>
     <step performance="required">
      <para>
       <guimenu>グラフ</guimenu>リンクをクリックして遷移グラフを表示します。
      </para>
     </step>
     <step performance="required">
      <para>
       <guimenu>CIB (in)</guimenu>をクリックしてCIB状態を表示します。遷移の後のCIBを表示するには、<guimenu>CIB (out)</guimenu>をクリックします。
      </para>
     </step>
    </substeps>
   </step>
   <step performance="required">
    <para>
     新しいシミュレーションを最初から開始するには、 <guimenu>リセット</guimenu>ボタンをクリックします。 
    </para>
   </step>
   <step performance="required">
    <para>
     シミュレーションモードを終了するには、シミュレータコントロールダイアログを閉じます。<guimenu>クラスタステータス</guimenu>画面は切り替わって、元の色に戻り、クラスタの現在の状態を表示します。
    </para>
   </step>
  </procedure>
 </sect2>

 <sect2 id="sec.ha.config.hawk.crm_report">
  <title>クラスタレポートの生成</title>

  <para>
   クラスタで発生している問題の分析と診断のために、Hawkはクラスタレポートを生成することができます。これは、クラスタ内のすべてのノードからの情報を集めたものです。
  </para>
  <procedure id="pro.ha.config.hawk.crm_report">
   <title><literal>hb_report</literal>を生成する</title>
   <step performance="required">
    <para>
     <xref linkend="sec.ha.config.hawk.intro.connect"/>で説明したように、Webブラウザを起動してクラスタにログインします。
    </para>
   </step>
   <step performance="required">
    <para>
     最上位の行のユーザ名の隣にあるレンチアイコンをクリックして、<guimenu>hb_reportの生成</guimenu>を選択します。
    </para>
   </step>
   <step performance="required">
    <para>
     デフォルトでは、調査する期間は直前の1時間です。これを変更するには、<guimenu>開始時刻</guimenu> および<guimenu>終了時刻</guimenu>を設定します。
    </para>
   </step>
   <step performance="required">
    <para>
     <guimenu>生成</guimenu>をクリックします。
    </para>
   </step>
   <step performance="required">
    <para>
     レポートが作成されたら、対応するリンクをクリックして、<filename>*.tar.bz2</filename>ファイルをダウンロードします。
    </para>
   </step>
  </procedure>
  <para>
   <literal>hb_report</literal>および<literal>crm_report</literal>のようなツールが対応するログファイルの詳細については、<xref linkend="vle.ha.crm_report"/>を参照してくだい。
  </para>
 </sect2>
</sect1>
