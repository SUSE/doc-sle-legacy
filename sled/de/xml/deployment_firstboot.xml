<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE chapter PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN"
"novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<chapter xml:base="deployment_firstboot.xml" id="cha-deployment-firstboot">
 <title>Installieren von benutzerdefinierten Vorinstallationen</title>
 <para>
  
  Durch die Verteilung angepasster Vorinstallationen von <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> auf einer großen Anzahl identischer Rechner können Sie es vermeiden, die Installation auf jedem einzelnen Rechner durchführen zu müssen. Gleichzeitig erhalten die Endbenutzer ein standardisiertes Installationsverfahren. Erstellen Sie mit YaST Firstboot benutzerdefinierte Vorinstallations-Images und legen Sie den Workflow für die abschließenden Personalisierungsschritte fest, bei denen das Eingreifen der Endbenutzer erforderlich ist (im Gegensatz zu AutoYaST, das vollständig automatische Installationen zulässt; weitere Informationen finden Sie unter <xref linkend="cha-deployment-autoinst"/>).
  
 </para>
 <para>
  Führen Sie die folgenden Schritte aus, um eine benutzerdefinierte Installation zu erstellen, an Ihre Hardware zu verteilen und das endgültige Produkt anzupassen:
 </para>
 <procedure>
  <step performance="required">
   <para>
    Bereiten Sie den Master-Computer vor, dessen Festplatte auf die Client-Computer geklont werden muss. Weitere Informationen hierzu finden Sie in <xref linkend="sec-fb-master"/>.
   </para>
  </step>
  <step performance="required">
   <para>
    Passen Sie den Firstboot-Workflow an. Weitere Informationen hierzu finden Sie in <xref linkend="sec-fb-customize"/>.
   </para>
  </step>
  <step performance="required">
   <para>
    Erstellen Sie einen Klon der Festplatte des Master-Rechners und verteilen Sie das Image auf den Festplatten der Clients. Weitere Informationen hierzu finden Sie in <xref linkend="sec-fb-clone"/>.
   </para>
  </step>
  <step performance="required">
   <para>
    Lassen Sie den Endbenutzer die Instanz von <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> personalisieren. Weitere Informationen hierzu finden Sie in <xref linkend="sec-fb-personalize"/>.
   </para>
  </step>
 </procedure>
 <sect1 id="sec-fb-master">
  <title>Vorbereiten des Master-Rechners</title>

  <para>
   Um einen Master-Rechner für einen Firstboot-Workflow vorzubereiten, gehen Sie wie folgt vor:
  </para>

  <procedure>
   <step id="st-master1" performance="required">
    <para>
     Legen Sie das Installationsmedium in den Master-Rechner ein.
    </para>
   </step>
   <step id="st-master2" performance="required">
    <para>
     Booten Sie den Rechner.
    </para>
   </step>
   <step id="st-master3" performance="required">
    <para>
     
     Führen Sie eine normale Installation mit allen notwendigen Konfigurationsschritten durch und warten Sie, bis der installierte Rechner gebootet ist. Installieren Sie außerdem das <systemitem>yast2-firstboot</systemitem>-Paket.
    </para>
   </step>
   <step id="st-master4" performance="required">
    <para>
     Um Ihren eigenen Workflow von YaST-Konfigurationsschritten für den Endbenutzer zu definieren oder diesem Workflow Ihre eigenen YaST-Module hinzuzufügen, fahren Sie mit <xref linkend="sec-fb-customize"/> fort. Fahren Sie andernfalls direkt bei <xref linkend="st-master5"/> fort.
    </para>
   </step>
   <step id="st-master5" performance="required">
    <para>
     Aktivieren Sie Firstboot als <systemitem class="username">root</systemitem>:
    </para>


    <para>
     Erstellen Sie eine leere Datei <filename>/var/lib/YaST2/reconfig_system</filename>, um die Ausführung von firstboot auszulösen. Diese Datei wird gelöscht, sobald die Firstboot-Konfiguration erfolgreich durchgeführt wurde. Erstellen Sie diese Datei mit dem folgenden Befehl:
    </para>
<screen>touch /var/lib/YaST2/reconfig_system</screen>







   </step>
   <step performance="required">
    <para>
     Fahren Sie mit <xref linkend="sec-fb-clone"/> fort.
    </para>
   </step>
  </procedure>
 </sect1>
 <sect1 id="sec-fb-customize">
  <title>Anpassen der firstboot-Installation</title>

  <para>
   Beim Anpassen des Arbeitsflusses der firstboot-Installation können mehrere verschiedenen Komponenten angepasst werden. Die Anpassung dieser Komponenten ist optional. Wenn Sie keine Änderungen vornehmen, führt firstboot die Installation mithilfe von Standardeinstellungen aus. Mit den zur Verfügung stehenden Optionen können Sie:
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     Meldungen an den Benutzer wie unter <xref linkend="sec-fb-customize-msg"/> beschrieben anpassen
    </para>
   </listitem>
   <listitem>
    <para>
     Lizenzen und Lizenzaktionen wie unter <xref linkend="sec-fb-customize-license"/> beschrieben anpassen 
    </para>
   </listitem>
   <listitem>
    <para>
     Versionshinweise für die Anzeige wie unter <xref linkend="sec-fb-customize-rn"/> beschrieben anpassen
    </para>
   </listitem>
   <listitem>
    <para>
     Reihenfolge und Anzahl der an der Installation beteiligten Komponenten wie unter <xref linkend="sec-fb-customize-wf"/> beschrieben anpassen
    </para>
   </listitem>
   <listitem>
    <para>
     Zusätzliche optionale Skripten wie unter <xref linkend="sec-fb-customize-script"/> beschrieben konfigurieren
    </para>
   </listitem>
  </itemizedlist>

  <para>
   So bearbeiten Sie die folgenden Konfigurationsdateien, um diese Komponenten anzupassen:
  </para>

  <variablelist>
   <varlistentry>
    <term><filename>/etc/sysconfig/firstboot</filename>
    </term>
    <listitem>
     <para>
      Konfiguriert verschiedene Aspekte von Firstboot (wie Versionshinweise, Skripten und Lizenzaktionen).
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><filename>/etc/YaST2/firstboot.xml</filename>
    </term>
    <listitem>
     <para>
      Zur Konfiguration des Installations-Workflows durch Aktivierung oder Deaktivierung von Komponenten oder Hinzufügen von benutzerdefinierten Komponenten
     </para>
     <para>
      Bietet Übersetzungen für den Workflow einer angepassten Installation wie unter <xref linkend="sec-fb-provide-trans"/> beschrieben.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>



  

  <para>
   Wenn Sie mehr als nur die Arbeitsflusskomponenten anpassen möchten, finden Sie Informationen in der Dokumentation zu <filename>control.xml</filename> unter <phrase os="sled;sles"><ulink url="http://doc.opensuse.org/projects/YaST/SLES11/tdg/inst_in_general_chap.html#product_control"/></phrase>.
  </para>

  <sect2 id="sec-fb-customize-msg">
   <title>Anpassen von YaST-Meldungen</title>
   <para>
    Standardmäßig enthält eine Installation von <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> verschiedene Standardnachrichten, die in verschiedenen Phasen des Installationsprozesses lokalisiert und angezeigt werden. Dazu gehört eine Willkommensmitteilung, eine Lizenzmitteilung und eine Glückwunschmitteilung am Ende der Installation. Sie können diese Meldungen durch eigene Versionen ersetzen und lokalisierte Versionen in die Installation aufnehmen. Gehen Sie wie folgt vor, um Ihre eigene Willkommensmitteilung einzubinden:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Melden Sie sich als <systemitem class="username">root</systemitem>-Benutzer an.
     </para>
    </step>
    <step performance="required">
     <para>
      Öffnen Sie die Konfigurationsdatei <filename>/etc/sysconfig/firstboot</filename>, und wenden Sie die folgenden Änderungen an:
     </para>
     <substeps performance="required">
      <step performance="required">
       <para>
        Legen Sie <envar>FIRSTBOOT_WELCOME_DIR</envar> auf den Verzeichnispfad fest, in dem Sie die Dateien speichern möchten, die die Willkommensnachricht und die lokalisierten Versionen enthalten, z.B.:
       </para>
<screen>FIRSTBOOT_WELCOME_DIR="/usr/share/firstboot/"
</screen>
      </step>
      <step performance="required">
       <para>
        Wenn die Willkommensnachricht andere Dateinamen hat als <filename>welcome.txt</filename> und <filename>welcome_<replaceable>locale</replaceable>.txt</filename> (wobei <replaceable>locale</replaceable> dem ISO 639-Sprachcode entspricht, wie <quote>cs</quote> oder <quote>de</quote>), legen Sie das Dateinamensmuster in <envar>FIRSTBOOT_WELCOME_PATTERNS</envar> fest. Beispiel:
       </para>
<screen>FIRSTBOOT_WELCOME_PATTERNS="mywelcome.txt"</screen>
       <para>
        Falls nicht anderweitig festgelegt, wird vom Standardwert <filename>welcome.txt</filename> ausgegangen.
       </para>
      </step>
     </substeps>
    </step>
    <step performance="required">
     <para>
      Erstellen Sie die Willkommensdatei und die lokalisierten Versionen, und legen Sie sie in das in der Konfigurationsdatei <filename>/etc/sysconfig/firstboot</filename> angegebene Verzeichnis ab.
     </para>
    </step>
   </procedure>
   <para>
    Gehen Sie genauso vor, um angepasste Lizenz- und Beendigungsmitteilungen zu konfigurieren. Diese Variablen lauten <envar>FIRSTBOOT_LICENSE_DIR</envar> und <envar>FIRSTBOOT_FINISH_FILE</envar>.
   </para>
   <para>
    Ändern Sie die Einstellung von <envar>SHOW_Y2CC_CHECKBOX</envar> in <quote>Ja</quote>, wenn der Benutzer in der Lage sein soll, YaST direkt nach dem Ausführen der Installation zu starten.
   </para>
  </sect2>

  <sect2 id="sec-fb-customize-license">
   <title>Anpassen der Lizenzaktion</title>
   <para>
    Sie können die Reaktion des Installationssystems auf Benutzer, die die Lizenzvereinbarung nicht akzeptieren, anpassen. Das System kann auf die folgenden drei Arten auf dieses Szenario reagieren:
   </para>
   <variablelist>
    <varlistentry>
     <term>Halt</term>
     <listitem>
      
      <para>
       Die firstboot-Installation wird abgebrochen und das gesamte System wird heruntergefahren. Das ist die Standardeinstellung.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Fortsetzen</term>
     <listitem>
      <para>
       Die Firstboot-Installation wird fortgesetzt.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Abbrechen</term>
     <listitem>
      <para>
       Die Firstboot-Installation wird abgebrochen, das System versucht jedoch zu booten.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    Wählen Sie die geeignete Option aus, und stellen Sie für <envar>LICENSE_REFUSAL_ACTION</envar> den entsprechenden Wert ein.
   </para>
  </sect2>

  <sect2 id="sec-fb-customize-rn">
   <title>Anpassen der Versionshinweise</title>
   <para>
    Je nachdem, ob Sie die Instanz von <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase>, die Sie mit Firstboot installieren möchten, geändert haben, müssen Sie die Endbenutzer möglicherweise über wichtige Aspekte ihres neuen Betriebssystems unterrichten. Eine Standardinstallation verwendet Versionshinweise (angezeigt in einer der abschließenden Phasen der Installation), um Benutzer über wichtige Änderungen zu informieren. Wenn Ihre eigenen bearbeiteten Versionshinweise als Teil einer firstboot-Installation angezeigt werden sollen, gehen Sie wie folgt vor:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Erstellen Sie Ihre eigene Versionshinweisdatei. Verwenden Sie das RTF-Format wie in der Beispieldatei in <filename>/usr/share/doc/release-notes</filename> und speichern Sie das Ergebnis als <filename>VERSIONSHINWEISE</filename>.
     </para>
    </step>
    <step performance="required">
     <para>
      Speichern Sie die optional lokalisierte Version neben der ursprünglichen Version und ersetzen Sie den Teil <literal>en</literal> des Dateinamens durch den tatsächlichen ISO 639-Sprachcode, beispielsweise <literal>de</literal> für Deutsch.
     </para>
    </step>
    <step performance="required">
     <para>
      Öffnen Sie die firstboot-Konfigurationsdatei von <filename>/etc/sysconfig/firstboot</filename> und stellen Sie <envar>FIRSTBOOT_RELEASE_NOTES_PATH</envar> auf das tatsächliche Verzeichnis ein, in dem die Versionshinweisdateien gespeichert sind.
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 id="sec-fb-customize-wf">
   <title>Anpassen des Workflows</title>
   <para>
    Standardmäßig enthält ein Standard-Firstboot-Workflow die folgenden Komponenten:
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      Sprachauswahl
     </para>
    </listitem>
    <listitem>
     <para>
      Willkommen
     </para>
    </listitem>

    <listitem>
     <para>
      Lizenzvereinbarung
     </para>
    </listitem>
    <listitem>
     <para>
      Hostname
     </para>
    </listitem>

    <listitem>
     <para>
      Netzwerk
     </para>
    </listitem>

    <listitem>
     <para>
      Zeit und Datum
     </para>
    </listitem>

    <listitem>
     <para>
      Desktop
     </para>
    </listitem>

    <listitem>
     <para>
      root-Passwort
     </para>
    </listitem>
    <listitem>
     <para>
      Benutzerbeglaubigungsmethode
     </para>
    </listitem>
    <listitem>
     <para>
      Benutzerverwaltung
     </para>
    </listitem>
    <listitem>
     <para>
      Hardwarekonfiguration
     </para>
    </listitem>
    <listitem>
     <para>
      Beenden der Einrichtung
     </para>
    </listitem>
   </itemizedlist>
   <para>
    Dieses Standard-Layout eines firstboot-Installations-Workflows ist nicht obligatorisch. Sie können bestimmte Komponenten aktivieren oder deaktivieren oder Ihre eigenen Module in den Workflow integrieren. Um den firstboot-Workflow zu ändern, bearbeiten Sie die firstboot-Konfigurationsdatei <filename>/etc/YaST2/firstboot.xml</filename>. Die XML-Datei ist eine Teilmenge der Standarddatei <filename>control.xml</filename>, die von YaST verwendet wird, um den Installations-Workflow zu steuern.
   </para>
   <para>
    Eine Übersicht mit Vorschlägen finden Sie unter <xref linkend="ex-fb-proposal"/>. Dort werden Ihnen alle Hintergrundinformationen bereitgestellt, die Sie benötigen, um den Workflow für die firstboot-Installation zu ändern. Die Basissyntax der Firstboot-Konfigurationsdatei (und die Konfiguration der Schlüsselelemente) werden mit diesem Beispiel erklärt.
   </para>
   <example id="ex-fb-proposal">
    <title>Konfigurieren von Vorschlagsbildschirmen</title>
<screen>
    …
    &lt;proposals config:type="list"&gt;<co id="co-fb-plist"/>
        &lt;proposal&gt;<co id="co-fb-p"/>
            &lt;name&gt;firstboot_hardware&lt;/name&gt;<co id="co-fb-pname"/>
            &lt;mode&gt;installation&lt;/mode&gt;<co id="co-fb-pmode"/>
            &lt;stage&gt;firstboot&lt;/stage&gt;<co id="co-fb-pstage"/>
            &lt;label&gt;Hardware Configuration&lt;/label&gt;<co id="co-fb-plabel"/>
            &lt;proposal_modules config:type="list"&gt;<co id="co-fb-pmodl"/>
                &lt;proposal_module&gt;printer&lt;/proposal_module&gt;<co id="co-fb-pmod"/>
            &lt;/proposal_modules&gt;
        &lt;/proposal&gt;
        &lt;proposal&gt;
        …
        &lt;/proposal&gt;
    &lt;/proposals&gt;
   </screen>
   </example>
   <calloutlist>
    <callout arearefs="co-fb-plist">
     <para>
      Der Container für alle Vorschläge, die Teil des firstboot-Workflows sein sollen.
     </para>
    </callout>
    <callout arearefs="co-fb-p">
     <para>
      Der Container für einen einzelnen Vorschlag.
     </para>
    </callout>
    <callout arearefs="co-fb-pname">
     <para>
      Der interne Name des Vorschlags.
     </para>
    </callout>
    <callout arearefs="co-fb-pmode">
     <para>
      Der Modus dieses Vorschlags. Nehmen Sie hier keine Änderungen vor. Für eine firstboot-Installation muss diese Option auf <literal>Installation</literal> eingestellt sein.
     </para>
    </callout>
    <callout arearefs="co-fb-pstage">
     <para>
      Die Phase des Installationsprozesses, in der dieser Vorschlag aufgerufen wird. Nehmen Sie hier keine Änderungen vor. Für eine firstboot-Installation muss diese Option auf <literal>firstbook</literal> eingestellt sein.
     </para>
    </callout>
    <callout arearefs="co-fb-plabel">
     <para>
      Die auf dem Vorschlag anzuzeigende Kennung.
     </para>
    </callout>
    <callout arearefs="co-fb-pmodl">
     <para>
      Der Container für alle Module, die Teil des Vorschlagbildschirms sind.
     </para>
    </callout>
    <callout arearefs="co-fb-pmod">
     <para>
      Ein oder mehrere Module, die Teil des Vorschlagbildschirms sind.
     </para>
    </callout>
   </calloutlist>
   <para>
    Der nächste Abschnitt der firstboot-Konfigurationsdatei besteht aus der Workflow-Definition. Alle Module, die Teil des firstboot-Installations-Workflows sein sollen, müssen hier aufgeführt werden.
   </para>
   <example id="ex-fb-wf">
    <title>Konfigurieren des Workflow-Abschnitts</title>
<screen>
    &lt;workflows  config:type="list"&gt;
        &lt;workflow&gt;
            &lt;defaults&gt;
                &lt;enable_back&gt;yes&lt;/enable_back&gt;
                &lt;enable_next&gt;yes&lt;/enable_next&gt;
                &lt;archs&gt;all&lt;/archs&gt;
            &lt;/defaults&gt;
            &lt;stage&gt;firstboot&lt;/stage&gt;
            &lt;label&gt;Configuration&lt;/label&gt;
            &lt;mode&gt;installation&lt;/mode&gt;
            … &lt;!–– list of modules  ––&gt;
            &lt;/modules&gt;
        &lt;/workflow&gt;
    &lt;/workflows&gt;
    …
  </screen>
   </example>
   <para>
    Die Gesamtstruktur des Abschnitts <literal>Workflows</literal> entspricht weitgehend dem des Abschnitts <literal>Vorschläge</literal>. Ein Container enthält die Workflow-Elemente, die Workflow-Elemente enthalten wiederum Informationen zu Stufe, Kennung und Modus (wie die in <xref linkend="ex-fb-proposal"/> eingeführten Vorschläge). Der Abschnitt <filename>Standard</filename> ist am unterschiedlichsten. Er enthält grundlegende Design-Informationen für die Workflow-Komponenten:
   </para>
   <variablelist>
    <varlistentry>
     <term><literal>enable_back</literal>
     </term>
     <listitem>
      <para>
       Zeigt in allen Dialogfeldern die Schaltfläche <guimenu>Zurück</guimenu> an.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>enable_next</literal>
     </term>
     <listitem>
      <para>
       Zeigt in allen Dialogfeldern die Schaltfläche <guimenu>Weiter</guimenu> an.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><literal>archs</literal>
     </term>
     <listitem>
      <para>
       Geben Sie die Hardware-Architekturen an, in denen dieser Workflow verwendet werden soll.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <example id="ex-fb-wfmod">
    <title>Konfigurieren der Liste der Workflow-Komponenten</title>
<screen>
    &lt;modules  config:type="list"&gt;<co id="co-fb-modl"/>
        &lt;module&gt;<co id="co-fb-mod"/>
            &lt;label&gt;Language&lt;/label&gt;<co id="co-fb-label"/>
            &lt;enabled config:type="boolean"&gt;false&lt;/enabled&gt;<co id="co-fb-en"/>
            &lt;name&gt;firstboot_language&lt;/name&gt;<co id="co-fb-name"/>
        &lt;/module&gt;
    &lt;modules&gt;
  </screen>
   </example>
   <calloutlist>
    <callout arearefs="co-fb-modl">
     <para>
      Der Container für alle Komponenten des Workflows
     </para>
    </callout>
    <callout arearefs="co-fb-mod">
     <para>
      Die Moduldefinitionen
     </para>
    </callout>
    <callout arearefs="co-fb-label">
     <para>
      Die mit allen Modulen angezeigte Kennung
     </para>
    </callout>
    <callout arearefs="co-fb-en">
     <para>
      Der Schalter zum Aktivieren/Deaktivieren dieser Komponenten im Workflow
     </para>
    </callout>
    <callout arearefs="co-fb-name">
     <para>
      Der Modulname Das Modul selbst muss sich unterhalb von <filename>/usr/share/YaST2/clients</filename> befinden und über die Dateierweiterung <filename>.ycp</filename> verfügen.
     </para>
    </callout>
   </calloutlist>
   <para>
    Um während der firstboot-Installation Änderungen an der Zahl und Reihenfolge der Vorschlagsbildschirme durchzuführen, fahren Sie fort wie folgt:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Öffnen Sie die firstboot-Konfigurationsdatei unter <filename>/etc/YaST2/firstboot.xml</filename>.
     </para>
    </step>
    <step performance="required">
     <para>
      Löschen Sie Vorschlagsbildschirme, fügen Sie Bildschirme hinzu oder ändern Sie die Reihenfolge von vorhandenen Bildschirmen:
     </para>
     <itemizedlist mark="bullet" spacing="normal">
      <listitem>
       <para>
        Um einen Gesamtvorschlag zu löschen, entfernen Sie das Element <literal>Vorschlag</literal> einschließlich aller Unterelemente aus dem Abschnitt <literal>Vorschläge</literal> und entfernen Sie das entsprechende Element <literal>Modul</literal> (mit Unterelementen) aus dem Workflow.
       </para>
      </listitem>
      <listitem>
       <para>
        Um einen neuen Vorschlag hinzuzufügen, erstellen Sie ein neues Element <literal>Vorschlag</literal>, und tragen Sie alle erforderlichen Unterelemente ein. Stellen Sie sicher, dass der Vorschlag in <filename>/usr/share/YaST2/clients</filename> als YaST-Modul vorhanden ist.
       </para>
      </listitem>
      <listitem>
       <para>
        Um die Reihenfolge der Vorschläge zu ändern, verschieben Sie die entsprechenden Modulelemente <literal>Modul</literal>, die die Vorschlagsbildschirme enthalten, im Workflow. Beachten Sie, dass Abhängigkeiten zu anderen Installationsschritten bestehen können, die eine bestimmte Reihenfolge der Vorschläge und Workflow-Komponenten voraussetzen.
       </para>
      </listitem>
     </itemizedlist>
    </step>
    <step performance="required">
     <para>
      Wenden Sie Ihre Änderungen an und schließen Sie die Konfigurationsdatei.
     </para>
    </step>
   </procedure>
   <para>
    Sie können den Workflow der Konfigurationsschritte immer ändern, wenn der Standard Ihren Anforderungen nicht entspricht. Aktivieren oder deaktivieren Sie bestimmte Module im Workflow (oder fügen Sie eigene Workflows hinzu).
   </para>
   <para>
    Um den Status eines Moduls im firstboot-Workflow umzuschalten, gehen Sie wie folgt vor:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Öffnen Sie die Konfigurationsdatei <filename>/etc/YaST2/firstboot.xml</filename>.
     </para>
    </step>
    <step performance="required">
     <para>
      Ändern Sie den Wert für das Element <literal>enabled</literal> von <literal>true</literal> in <filename>false</filename>, um das Modul zu deaktivieren oder von <literal>false</literal> in <literal>true</literal>, um es erneut zu aktivieren.
     </para>
<screen>
&lt;module&gt;
    &lt;label&gt;Time and Date&lt;/label&gt;
    &lt;enabled config:type="boolean"&gt;true&lt;/enabled&gt;
    &lt;name&gt;firstboot_timezone&lt;/name&gt;
&lt;/module&gt;
</screen>
    </step>
    <step performance="required">
     <para>
      Wenden Sie Ihre Änderungen an und schließen Sie die Konfigurationsdatei.
     </para>
    </step>
   </procedure>
   <para>
    Um dem benutzerdefinierten Modul einen Workflow hinzuzufügen, gehen Sie wie folgt vor:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Erstellen Sie Ihr eigenes YaST-Modul, und speichern Sie die Moduldatei <filename><replaceable>module_name</replaceable>.ycp</filename> in <filename>/usr/share/YaST2/clients</filename>.
     </para>
    </step>
    <step performance="required">
     <para>
      Öffnen Sie die Konfigurationsdatei <filename>/etc/YaST2/firstboot.xml</filename>.
     </para>
    </step>
    <step performance="required">
     <para>
      Legen Sie fest, an welchem Punkt des Workflows Ihr neues Modul ausgeführt werden soll. Stellen Sie dabei sicher, dass mögliche Abhängigkeiten zu anderen Schritten im Workflow berücksichtigt und aufgelöst werden.
     </para>
    </step>
    <step performance="required">
     <para>
      Erstellen Sie im Container <literal>Module</literal> ein neues <literal>Modul</literal>-Element und fügen Sie die entsprechenden Unterelemente hinzu:
     </para>
<screen>&lt;modules config:type="list"&gt;
     …
     &lt;module&gt;
        &lt;label&gt;<replaceable>my_module</replaceable>&lt;/label&gt;
        &lt;enabled config:type="boolean"&gt;true&lt;/enabled&gt;
        &lt;name&gt;<replaceable>filename_my_module</replaceable>&lt;/name&gt;
     &lt;/module&gt;
&lt;/modules&gt;
</screen>
     <substeps performance="required">
      <step performance="required">
       <para>
        Geben Sie die Kennung ein, die im Element <literal>Kennung</literal> auf Ihrem Modul angezeigt werden soll.
       </para>
      </step>
      <step performance="required">
       <para>
        Stellen Sie sicher, dass <literal>Enabled</literal> auf <literal>true</literal> eingestellt ist, damit Ihr Modul in den Workflow aufgenommen wird.
       </para>
      </step>
      <step performance="required">
       <para>
        Geben Sie den Dateinamen Ihres Moduls in das Element <literal>Name</literal> ein. Lassen Sie den vollständigen Pfad und das Suffix <filename>.ycp</filename> weg.
       </para>
      </step>
     </substeps>
    </step>
    <step performance="required">
     <para>
      Wenden Sie Ihre Einstellungen an, und schließen Sie die Konfigurationsdatei.
     </para>
    </step>
   </procedure>
   <tip>
    <title>Suchen der angeschlossenen Netzwerkschnittstelle für die automatische Konfiguration</title>
    <para>
     Falls die Zielhardware mehrere Netzwerkschnittstellen besitzt, fügen Sie das <systemitem>network-autoconfig</systemitem>-Paket zum Anwendungs-Image hinzu. <systemitem>network-autoconfig</systemitem> stellt sicher, dass während firstboot alle verfügbaren Ethernetschnittstellen durchlaufen werden, bis eine erfolgreich mit DHCP konfiguriert wurde.
    </para>
   </tip>
  </sect2>

  <sect2 id="sec-fb-customize-script">
   <title>Konfigurieren von zusätzlichen Skripten</title>
   
   <para>
    Firstboot kann so konfiguriert werden, dass zusätzliche Skripten ausgeführt werden, nachdem der Firstboot-Workflow abgeschlossen wurde. Um der firstboot-Sequenz zusätzliche Skripten hinzuzufügen, gehen Sie wie folgt vor:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Öffnen Sie die Konfigurationsdatei <filename>/etc/sysconfig/firstboot</filename>, und stellen Sie sicher, dass der für <envar>SCRIPT_DIR</envar> angegebene Pfad korrekt ist. Der Standardwert ist <filename>/usr/share/firstboot/scripts</filename>.
     </para>
    </step>
    <step performance="required">
     <para>
      Erstellen Sie Ihr Shell-Skript, speichern Sie es in das angegebene Verzeichnis und wenden Sie die entsprechenden Dateiberechtigungen an.
     </para>
    </step>
   </procedure>
  </sect2>



  <sect2 id="sec-fb-provide-trans">
   <title>Bereitstellen von Übersetzungen des Installations-Workflows</title>
   <para>
    Abhängig vom Endbenutzer könnten Übersetzungen des benutzerdefinierten Workflows gewünscht werden. Diese Übersetzungen könnten notwendig sein, wenn Sie den Workflow durch Ändern der Datei <filename>/etc/YaST2/firstboot.xml</filename> wie unter <xref linkend="sec-fb-customize-wf"/> beschrieben angepasst haben. Dies unterscheidet sich von der Lokalisierung benutzerdefinierter YaST-Meldungen, was bereits unter <xref linkend="sec-fb-customize-msg"/> beschrieben ist.
   </para>
   <para>
    Wenn Sie die Datei <filename>/etc/YaST2/firstboot.xml</filename> geändert und Änderungen an Zeichenketten vorgenommen haben, erstellen Sie eine neue Übersetzungsvorlagendatei (<filename>.pot</filename>-Datei), und verwenden Sie die <systemitem>gettext</systemitem>-Toolkette zur Übersetzung. Installieren Sie die übersetzten Dateien schließlich in den YaST-Locale-Verzeichnissen (<filename>/usr/share/YaST2/locale</filename>) als kompilierte <filename>.mo</filename>-Dateien. Führen Sie dazu die folgenden Schritte aus:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Ändern Sie die Einstellung <systemitem>textdomain</systemitem> von:
     </para>
<screen>&lt;textdomain&gt;firstboot&lt;/textdomain&gt;</screen>
     <para>
      zu beispielsweise
     </para>
<screen>&lt;textdomain&gt;firstboot-oem&lt;/textdomain&gt;</screen>
    </step>
    <step performance="required">
     <para>
      Verwenden Sie <command>xgettext</command>, um die übersetzbaren Zeichenketten zur Übersetzungsvorlagendatei (<filename>.pot</filename>-Datei) hinzuzufügen, zum Beispiel zu <filename>firstboot-oem.pot</filename>:
     </para>
<screen>xgettext -L Glade -o firstboot-oem.pot /etc/YaST2/firstboot.xml</screen>
    </step>
    <step performance="required">
     <para>
      Starten Sie den Übersetzungsprozess. Packen Sie anschließend die übersetzten Dateien (<filename><replaceable>LL_code</replaceable>.po</filename>-Dateien) genauso wie die Übersetzungen der anderen Projekte und installieren Sie die kompilierten <filename>firstboot-oem.mo</filename>-Dateien.
     </para>
    </step>
   </procedure>
   <para>
    Falls Sie Übersetzungen für zusätzliche oder geänderte YaST-Module benötigen, stellen Sie die Übersetzungen in einem derartigen Modul selbst bereit. Wenn Sie ein vorhandenes Modul gerade geändert haben, ändern Sie auf jeden Fall auch dessen textdomain-Anweisung, um unerwünschte Nebeneffekte zu vermeiden.
   </para>
   <tip>
    <title>Weiterführende Informationen</title>
    <para>
     Weitere Informationen zur YaST-Bereitstellung finden Sie in <ulink url="http://en.opensuse.org/openSUSE:YaST_development"/>. Detaillierte Informationen über YaST Firstboot finden Sie unter <phrase os="sled;sles"><ulink url="http://doc.opensuse.org/projects/YaST/SLES11/tdg/bk09ch01s02.html"/></phrase>.
    </para>
   </tip>
  </sect2>
 </sect1>

 <sect1 id="sec-fb-clone">
  <title>Klonen der Master-Installation </title>

  <para>
   Klonen Sie die Festplatte des Master-Rechners mit einem verfügbaren Imaging-Mechanismus und führen Sie die Images auf den Zielrechnern ein. Weitere Informationen zum Imaging finden Sie unter <xref linkend="cha-kiwi"/>.
  </para>
 </sect1>
 <sect1 id="sec-fb-personalize">
  <title>Anpassen der Installation</title>

  <para>
   Sobald das geklonte Festplatten-Image gestartet wurde, startet firstboot und die Installation fährt genauso fort wie in <xref linkend="sec-fb-customize-wf"/> beschrieben. Nur die Komponenten werden gestartet, die in der firstboot-Workflow-Konfiguration enthalten sind. Alle anderen Installationsschritte werden übersprungen. Der Endbenutzer passt Sprache, Tastatur, Netzwerk und Passworteinstellungen an, um den Arbeitsplatzrechner zu personalisieren. Nach Abschluss dieses Vorgangs verhält sich ein mit Firstboot installiertes System wie eine normale Instanz von <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase>.
  </para>
 </sect1>
</chapter>
