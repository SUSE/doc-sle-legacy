<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet href="urn:x-suse:xslt:profiling:docbook51-profile.xsl"
    type="text/xml"
    title="Profiling step"
?>
<!DOCTYPE sect2
[
   <!ENTITY % entities SYSTEM "entity-decl.ent">
   %entities;
]>


<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<section xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.1" xml:base="system_repair.xml" xml:id="sec-trouble-data-recover">
 <title>Wiederherstellen eines beschädigten Systems</title><indexterm> <primary>Wiederherstellen von Systemen</primary> </indexterm>
 <para>
  Ein System kann aus mehreren Gründen nicht aktiviert und ordnungsgemäß betrieben werden. Zu den häufigsten Gründen zählen ein beschädigtes Dateisystem nach einem Systemabsturz, beschädigte Konfigurationsdateien oder eine beschädigte Bootloader-Konfiguration.
 </para>

 <para os="sles;sled">
  <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> bietet zwei verschiedene Methoden zur Behebung dieser Situationen. Sie können entweder die YaST-Systemreparatur verwenden oder das Rettungssystem booten. Die folgenden Abschnitte befassen sich mit beiden Methoden zur Systemreparatur.
 </para>

 <section xml:id="sec-trouble-data-recover-yast" os="sles;sled">
  <title>Verwenden der YaST-Systemreparatur</title><indexterm> <primary>YaST</primary> <secondary>Reparieren von Systemen</secondary> </indexterm> <indexterm> <primary>Reparieren von Systemen</primary> </indexterm>
  <note>
   <title>Tastatur- und Spracheinstellungen</title>
   <para>
    Wenn Sie die Spracheinstellungen nach dem Booten ändern, wird Ihre Tastatur ebenfalls angepasst.
   </para>
  </note>
  <para>
   Vor dem Start des YaST-Moduls zur Systemreparatur sollten Sie ermitteln, in welchem Modus das Modul ausgeführt werden sollte, damit es am besten Ihren Bedürfnissen entspricht. Je nach dem Schweregrad und der Ursache des Systemausfalls (sowie Ihren Fachkenntnissen) können Sie zwischen drei verschiedenen Modi wählen.
  </para>
  <variablelist>
   <varlistentry>
    <term>Automatische Reparatur</term>
    <listitem>
     <para>
      Wenn Ihr System aufgrund einer unbekannten Ursache ausgefallen ist und Sie nicht wissen, welcher Teil des Systems für den Ausfall verantwortlich ist, sollten Sie die <guimenu>Automatische Reparatur</guimenu> verwenden. Eine umfassende automatische Prüfung wird an allen Komponenten des installierten Systems durchgeführt. Eine detaillierte Beschreibung dieses Verfahrens finden Sie in <xref linkend="sec-trouble-data-recover-yast-auto"/>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Benutzerdefinierte Reparatur</term>
    <listitem>
     <para>
      Wenn Ihr System ausgefallen ist und Sie bereits wissen, an welcher Komponente es liegt, können Sie die langwierige Systemprüfung von <guimenu>Automatische Reparatur</guimenu> abkürzen, indem Sie den Bereich der Systemanalyse auf die betreffenden Komponenten beschränken. Wenn die Systemmeldungen vor dem Ausfall beispielsweise auf einen Fehler mit der Paketdatenbank hindeuten, können Sie das Analyse- und Reparaturverfahren so einschränken, dass nur dieser Aspekt des Systems überprüft und wiederhergestellt wird. Eine detaillierte Beschreibung dieses Verfahrens finden Sie in <xref linkend="sec-trouble-data-recover-yast-custom"/>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Expertenwerkzeuge</term>
    <listitem>
     <para>
      Wenn Sie bereits eine klare Vorstellung davon haben, welche Komponente ausgefallen ist und wie dieser Fehler behoben werden kann, können Sie die Analyseläufe überspringen und die für die Reparatur der betreffenden Komponente erforderlichen Werkzeuge unmittelbar anwenden. Detaillierte Informationen finden Sie in <xref linkend="sec-trouble-data-recover-yast-expert"/>.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
  <para>
   Wählen Sie einen der oben beschriebenen Reparaturmodi aus und setzen Sie die Systemreparatur, wie in den folgenden Abschnitten beschrieben, fort.
  </para>
  <section xml:id="sec-trouble-data-recover-yast-auto">
   <title>Automatische Reparatur</title>
   <procedure>
    <para>
     Um den Modus für automatische Reparatur der YaST-Systemreparatur zu starten, gehen Sie wie folgt vor:
    </para>
    <step>
     <para>
      Legen Sie das Installationsmedium von <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> in das DVD-Laufwerk ein.
     </para>
    </step>
    <step>
     <para>
      Booten Sie das System neu.
     </para>
    </step>
    <step>
     <para>
      Wählen Sie im Boot-Fenster die Option <guimenu>Installiertes System reparieren</guimenu> aus.
     </para>
    </step>
    <step>
     <para>
      Bestätigen Sie die Lizenzvereinbarung, und klicken Sie auf <guimenu>Weiter</guimenu>.
     </para>
    </step>
    <step>
     <para>
      Wählen Sie <guimenu>Automatische Reparatur</guimenu>.
     </para>
     <para>
      YaST startet nun eine umfassende Analyse des installierten Systems. Der Verlauf des Vorgangs wird unten auf dem Bildschirm mit zwei Verlaufsbalken angezeigt. Der obere Balken zeigt den Verlauf des aktuell ausgeführten Tests. Der untere Balken zeigt den Gesamtverlauf des Analysevorgangs. Im Protokollfenster im oberen Abschnitt werden der aktuell ausgeführte Test und sein Ergebnis aufgezeichnet. Weitere Informationen hierzu finden Sie unter <xref linkend="fig-trouble-data-recover-yast-auto"/>.
     </para>
     <figure xml:id="fig-trouble-data-recover-yast-auto">
      <title>Modus „Automatische Reparatur“</title>
      <mediaobject>
       <imageobject role="fo">
        <imagedata fileref="i_y2_repair_auto.png" width="75%" format="PNG"/>
       </imageobject>
       <imageobject role="html">
        <imagedata fileref="i_y2_repair_auto.png" width="75%" format="PNG"/>
       </imageobject>
      </mediaobject>
     </figure>
     <para>
      Die folgenden Haupttestläufe werden bei jeder Ausführung durchgeführt. Sie enthalten jeweils eine Reihe einzelner Untertests:
     </para>
     <variablelist>
      <varlistentry>
       <term>Partitionstabellen prüfen</term>
       <listitem>
        <para>
         Überprüft Validität und Kohärenz der Partitionstabellen aller erkannten Festplatten.
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>Prüfen des Swap-Bereichs</term>
       <listitem>
        <para>
         Die Swap-Partitionen des installierten Systems werden erkannt, getestet und gegebenenfalls zur Aktivierung angeboten. Dieses Angebot sollte angenommen werden, um eine höhere Geschwindigkeit für die Systemreparatur zu erreichen.
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>Prüfen der Dateisysteme</term>
       <listitem>
        <para>
         Alle gefundenen Dateisysteme werden einer dateisystem-spezifischen Prüfung unterworfen.
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>Prüfen der fstab-Einträge</term>
       <listitem>
        <para>
         Die Einträge in der Datei werden auf Vollständigkeit und Konsistenz überprüft. Alle gültigen Partitionen werden eingehängt.
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>Paketdatenbank prüfen</term>
       <listitem>
        <para>
         Mit dieser Option wird überprüft, ob alle für den Betrieb einer Minimalinstallation erforderlichen Pakete vorliegen. Es ist zwar möglich, die Basispakete ebenfalls zu analysieren, dies dauert jedoch aufgrund ihrer großen Anzahl sehr lange.
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>Prüfen der Bootloader-Konfiguration</term>
       <listitem>
        <para>
         Die Bootloader-Konfiguration des installierten Systems (GRUB oder LILO) wird auf Vollständigkeit und Kohärenz überprüft. Boot- und Root-Geräte werden untersucht, und die Verfügbarkeit der initrd-Module wird überprüft.
        </para>
       </listitem>
      </varlistentry>
     </variablelist>
    </step>
    <step>
     <para>
      Immer wenn ein Fehler gefunden wird, wird der Vorgang angehalten und es öffnet sich ein Dialogfeld, in dem die Details und die möglichen Lösungen beschrieben werden.
     </para>
     <para>
      Lesen Sie die Bildschirmmeldungen genau durch, bevor Sie die vorgeschlagene Reparaturmöglichkeit akzeptieren. Wenn Sie eine vorgeschlagene Lösung ablehnen, werden keine Änderungen am System vorgenommen.
     </para>
    </step>
    <step>
     <para>
      Klicken Sie nach erfolgreicher Beendigung des Reparaturvorgangs auf <guimenu>OK</guimenu> und <guimenu>Verlassen</guimenu> und entfernen Sie die Installationsmedien. Das System wird automatisch neu gebootet.
     </para>
    </step>
   </procedure>
  </section>
  <section xml:id="sec-trouble-data-recover-yast-custom">
   <title>Benutzerdefinierte Reparatur</title>
   <procedure>
    <para>
     Um den Modus <guimenu>Benutzerdefinierte Reparatur</guimenu> zu starten und ausgewählte Komponenten des installierten Systems zu prüfen, gehen Sie wie folgt vor:
    </para>
    <step>
     <para>
      Legen Sie das Installationsmedium von <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> in das DVD-Laufwerk ein.
     </para>
    </step>
    <step>
     <para>
      Booten Sie das System neu.
     </para>
    </step>
    <step>
     <para>
      Wählen Sie im Boot-Fenster die Option <guimenu>Installiertes System reparieren</guimenu> aus.
     </para>
    </step>
    <step>
     <para>
      Bestätigen Sie die Lizenzvereinbarung, und klicken Sie auf <guimenu>Weiter</guimenu>.
     </para>
    </step>
    <step>
     <para>
      Wählen Sie <guimenu>Benutzerdefinierte Reparatur</guimenu>.
     </para>
     <para>
      Bei Auswahl von <guimenu>Benutzerdefinierte Reparatur</guimenu> wird eine Liste der Testläufe angezeigt, die zunächst alle für die Ausführung markiert sind. Der Gesamttestbereich entspricht dem der automatischen Reparatur. Wenn Sie bereits Systembereiche kennen, in denen kein Schaden vorliegt, heben Sie die Markierung der entsprechenden Tests auf. Beim Klicken auf <guimenu>Weiter</guimenu> wird ein engeres Testverfahren gestartet, für dessen Ausführung vermutlich wesentlich weniger Zeit erforderlich ist.
     </para>
     <para>
      Nicht alle Testgruppen können individuell angewendet werden. Die Analyse der fstab-Einträge ist stets an eine Untersuchung der Dateisysteme gebunden, einschließlich bestehender Swap-Partitionen. YaST löst solche Abhängigkeiten automatisch auf, indem es die kleinste Zahl an erforderlichen Testläufen auswählt. YaST unterstützt keine verschlüsselten Partitionen. Falls eine verschlüsselte Partition vorhanden ist, informiert YaST Sie darüber.
     </para>
    </step>
    <step>
     <para>
      Immer wenn ein Fehler gefunden wird, wird der Vorgang angehalten und es öffnet sich ein Dialogfeld, in dem die Details und die möglichen Lösungen beschrieben werden.
     </para>
     <para>
      Lesen Sie die Bildschirmmeldungen genau durch, bevor Sie die vorgeschlagene Reparaturmöglichkeit akzeptieren. Wenn Sie eine vorgeschlagene Lösung ablehnen, werden keine Änderungen am System vorgenommen.
     </para>
    </step>
    <step>
     <para>
      Klicken Sie nach erfolgreicher Beendigung des Reparaturvorgangs auf <guimenu>OK</guimenu> und <guimenu>Verlassen</guimenu> und entfernen Sie die Installationsmedien. Das System wird automatisch neu gebootet.
     </para>
    </step>
   </procedure>
  </section>
  <section xml:id="sec-trouble-data-recover-yast-expert">
   <title>Expertenwerkzeuge</title>
   <para>
    Wenn Sie mit <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> vertraut sind und bereits eine genaue Vorstellung davon haben, welche Komponenten in Ihrem System repariert werden müssen, können Sie die Systemanalyse überspringen und die Werkzeuge direkt anwenden.
   </para>
   <para>
    Um die Funktion <guimenu>Expertenwerkzeuge</guimenu> der YaST-Systemreparatur zu verwenden, fahren Sie wie folgt fort:
   </para>
   <procedure>
    <step>
     <para>
      Legen Sie das Installationsmedium von <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> in das DVD-Laufwerk ein.
     </para>
    </step>
    <step>
     <para>
      Booten Sie das System neu.
     </para>
    </step>
    <step>
     <para>
      Wählen Sie im Boot-Fenster die Option <guimenu>Installiertes System reparieren</guimenu> aus.
     </para>
    </step>
    <step>
     <para>
      Bestätigen Sie die Lizenzvereinbarung, und klicken Sie auf <guimenu>Weiter</guimenu>.
     </para>
    </step>
    <step>
     <para>
      Klicken Sie auf <guimenu>Expertenwerkzeuge</guimenu> und wählen Sie dann eine Reparaturoption aus.
     </para>
    </step>
    <step>
     <para>
      Klicken Sie nach erfolgreicher Beendigung des Reparaturvorgangs auf <guimenu>OK</guimenu> und <guimenu>Verlassen</guimenu> und entfernen Sie die Installationsmedien. Das System wird automatisch neu gebootet.
     </para>
    </step>
   </procedure>
   <para>
    Unter <guimenu>Expertenwerkzeugen</guimenu> stehen folgende Optionen zum Reparieren des fehlerhaften Systems zur Verfügung:
   </para>
   <variablelist>
    <varlistentry>
     <term><guimenu>Neuen Bootloader installieren</guimenu>
     </term>
     <listitem>
      <para>
       Dadurch wird das Konfigurationsmodul für den YaST-Bootloader gestartet. Einzelheiten finden Sie in <xref linkend="sec-boot-yast2-config"/>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Installiertes System booten</guimenu>
     </term>
     <listitem>
      <para>
       Versuchen Sie, ein bereits installiertes Linux-System zu booten.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Partitionierer starten</guimenu>
     </term>
     <listitem>
      <para>
       Mit dieser Option wird das Expertenwerkzeug für die Partitionierung in YaST gestartet.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Reparatur des Dateisystems</guimenu>
     </term>
     <listitem>
      <para>
       Mit dieser Option werden die Dateisysteme Ihrer installierten Systeme überprüft. Ihnen wird zunächst eine Auswahl aller erkannten Partitionen angeboten, aus denen Sie die zu überprüfenden auswählen können.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Verlorene Partitionen wiederherstellen</guimenu> <indexterm> <primary>Wiederherstellen von Partitionen</primary> </indexterm>
     </term>
     <listitem>
      <para>
       Sie können versuchen, beschädigte Partitionstabellen zu rekonstruieren. Zunächst wird eine Liste der erkannten Festplatten zur Auswahl angeboten. Durch Klicken auf <guimenu>OK</guimenu> wird die Untersuchung gestartet. Dies kann je nach der Geschwindigkeit Ihres Computers und der Größe und Geschwindigkeit der Festplatte einige Zeit in Anspruch nehmen.
      </para>
      <important>
       <title><guimenu>Rekonstruktion von Partitionstabellen</guimenu></title>
       <para>
        Die Rekonstruktion einer Partitionstabellen ist ein komplizierter Vorgang. YaST versucht, verloren gegangene Partitionen durch Analyse der Datensektoren der Festplatte wiederherzustellen. Die verlorenen Partitionen werden, wenn sie erkannt werden, zur neu erstellten Partitionstabelle hinzugefügt. Dies ist jedoch nicht in allen vorstellbaren Fällen erfolgreich.
       </para>
      </important>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Systemeinstellungen auf Diskette speichern</guimenu>
     </term>
     <listitem>
      <para>
       Mit dieser Option werden wichtige Systemdateien auf eine Diskette gespeichert. Wenn eine dieser Dateien beschädigt wird, kann Sie von der Diskette wiederhergestellt werden.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><guimenu>Installierte Software prüfen</guimenu>
     </term>
     <listitem>
      <para>
       Mit dieser Option werden die Konsistenz der Paketdatenbank und die Verfügbarkeit der wichtigsten Pakete überprüft. Mit diesem Werkzeug können alle beschädigten Installationspakete wiederhergestellt werden.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </section>
 </section>
 <section xml:id="sec-trouble-data-recover-rescue">
  <title>Verwenden des Rettungssystems</title><indexterm> <primary>Rettungssystem</primary> </indexterm> <indexterm> <primary>System</primary> <secondary>Rettung</secondary> </indexterm>
  <para>
   <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> umfasst ein Rettungssystem. Das Rettungssystem ist ein kleines Linux-System, das auf einen RAM-Datenträger geladen und als Root-Dateisystem eingehängt werden kann. Es ermöglicht Ihnen so den externen Zugriff auf Ihre Linux-Partitionen. Mithilfe des Rettungssystems kann jeder wichtige Aspekt Ihres Systems wiederhergestellt oder geändert werden:
  </para>
  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     Jede Art von Konfigurationsdatei kann bearbeitet werden.
    </para>
   </listitem>
   <listitem>
    <para>
     Das Dateisystem kann auf Fehler hin überprüft und automatische Reparaturvorgänge können gestartet werden.
    </para>
   </listitem>
   <listitem>
    <para>
     Der Zugriff auf das installierte System kann in einer <quote>change-root</quote>-Umgebung erfolgen.
    </para>
   </listitem>
   <listitem>
    <para>
     Die Bootloader-Konfiguration kann überprüft, geändert und neu installiert werden.
    </para>
   </listitem>
   <listitem>
    <para>
     Eine Wiederherstellung ab einem fehlerhaft installierten Gerätetreiber oder einem nicht verwendbaren Kernel kann durchgeführt werden.
    </para>
   </listitem>
   <listitem>
    <para>
     Die Größe von Partitionen kann mithilfe des parted-Kommandos verändert werden. Weitere Informationen zu diesem Werkzeug finden Sie auf der Website von GNU Parted <link xlink:href="http://www.gnu.org/software/parted/parted.html"/>.
    </para>
   </listitem>
  </itemizedlist>
  <para>
   Das Rettungssystem kann aus verschiedenen Quellen und von verschiedenen Speicherorten geladen werden. Am einfachsten lässt sich das Rettungssystem vom Original-Installationsmedium booten:
  </para>
  <procedure><indexterm> <primary>Rettungssystem</primary><secondary>Start vom Medium</secondary> </indexterm>
   <step>
    <para>
     Legen Sie das Installationsmedium in Ihr DVD-Laufwerk ein.
    </para>
   </step>
   <step>
    <para>
     Booten Sie das System neu.
    </para>
   </step>
   <step>
    <para>
     Drücken Sie im Boot-Fenster <keycap>F4</keycap> und wählen Sie <guimenu>DVD-ROM</guimenu>. Wählen Sie dann im Hauptmenü die Option <guimenu>Rettungssystem</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Geben Sie an der Eingabeaufforderung <literal>Rescue:</literal><literal>root</literal> ein. Ein Passwort ist nicht erforderlich.
    </para>
   </step>
  </procedure>
  <procedure xml:id="proc-trouble-data-recover-rescue-network"><indexterm> <primary>Rettungssystem </primary><secondary>Start von Netzwerkquelle</secondary> </indexterm>
   <para>
    Wenn Ihnen kein DVD-Laufwerk zur Verfügung steht, können Sie das Rettungssystem von einer Netzwerkquelle booten. Das nachfolgende Beispiel bezieht sich auf das entfernte Booten – wenn Sie ein anderes Boot-Medium verwenden, beispielsweise eine DVD, ändern Sie die Datei <filename>info</filename> entsprechend, und führen Sie den Boot-Vorgang wie bei einer normalen Installation aus.
   </para>
   <step>
    <para>
     Geben Sie die Konfiguration Ihres PXE-Boot-Setups ein und fügen Sie die Zeilen <literal>install=<replaceable>protocol</replaceable>://<replaceable>instsource</replaceable></literal> und <literal>rescue=1</literal> hinzu. Wenn das Reparatursystem gestartet werden soll, verwenden Sie stattdessen <literal>repair=1</literal>. Wie bei einer normalen Installation steht <replaceable>protokoll</replaceable> für eines der unterstützten Netzwerkprotokolle (NFS, HTTP, FTP usw.) und <replaceable>instquelle</replaceable> für den Pfad zur Netzwerkinstallationsquelle.
    </para>
   </step>
   <step>
    <para>
     Booten Sie das System mit <quote>Wake on LAN</quote>, wie im <xref linkend="sec-deployment-remoteinst-boot-wol"/> erläutert.
    </para>
   </step>
   <step>
    <para>
     Geben Sie an der Eingabeaufforderung <literal>Rescue:</literal><literal>root</literal> ein. Ein Passwort ist nicht erforderlich.
    </para>
   </step>
  </procedure>
  <para>
   Sobald Sie sich im Rettungssystem befinden, können Sie die virtuellen Konsolen verwenden, die über die Tasten <keycombo><keycap function="alt"/><keycap>F1</keycap></keycombo> bis <keycombo><keycap function="alt"/><keycap>F6</keycap></keycombo> aufgerufen werden.
  </para>
  <para>
   Eine Shell und viele andere hilfreiche Dienstprogramme, beispielsweise das mount-Programm, stehen im Verzeichnis <filename>/bin</filename> zur Verfügung. Das Verzeichnis <filename>sbin</filename> enthält wichtige Datei- und Netzwerkdienstprogramme, mit denen das Dateisystem überprüft und repariert werden kann. In diesem Verzeichnis finden Sie auch die wichtigsten Binärdateien für die Systemwartung, beispielsweise fdisk, mkfs, mkswap, mount, mount, init und shutdown sowie ifconfig, ip, route und netstat für die Netzwerkwartung. Das Verzeichnis <filename>/usr/bin</filename> enthält den vi-Editor, find, less sowie ssh.
  </para>
  <para>
   Die Systemmeldungen können über das Kommando <command>dmesg</command> angezeigt werden; Sie können auch die Datei <filename>/var/log/messages</filename> zurate ziehen.
  </para>
  <section xml:id="sec-trouble-data-recover-rescue-file">
   <title>Überprüfen und Bearbeiten von Konfigurationsdateien</title>
   <para>
    Als Beispiel für eine Konfiguration, die mithilfe des Rettungssystems repariert werden kann, soll eine beschädigte Konfigurationsdatei dienen, die das ordnungsgemäße Booten des Systems verhindert. Dieses Problem kann mit dem Rettungssystem behoben werden.
   </para>
   <procedure>
    <para>
     Gehen Sie zum Bearbeiten einer Konfigurationsdatei folgendermaßen vor:
    </para>
    <step>
     <para>
      Starten Sie das Rettungssystem mithilfe einer der oben erläuterten Methoden.
     </para>
    </step>
    <step>
     <para>
      Verwenden Sie zum Einhängen eines Root-Dateisystems unter <filename>/dev/sda6</filename> in das Rettungssystem folgendes Kommando:
     </para>
<screen>mount /dev/sda6 /mnt</screen>
     <para>
      Sämtliche Verzeichnisse des Systems befinden sich nun unter <filename>/mnt</filename>
     </para>
    </step>
    <step>
     <para>
      Wechseln Sie in das eingehängte Root -Dateisystem:
     </para>
<screen>cd /mnt</screen>
    </step>
    <step>
     <para>
      Öffnen Sie die fehlerhafte Konfigurationsdatei im vi-Editor. Passen Sie die Konfiguration an und speichern Sie sie.
     </para>
    </step>
    <step>
     <para>
      Hängen Sie das Root-Dateisystem aus dem Rettungssystem aus:
     </para>
<screen>umount /mnt</screen>
    </step>
    <step>
     <para>
      Booten Sie den Computer neu.
     </para>
    </step>
   </procedure>
  </section>
  <section xml:id="sec-trouble-data-recover-rescue-filesystem">
   <title>Reparieren und Überprüfen von Dateisystemen</title><indexterm> <primary>Dateisysteme</primary> <secondary>Reparieren</secondary> </indexterm>
   <para>
    Generell ist das Reparieren von Dateisystemen auf einem zurzeit aktiven System nicht möglich. Bei ernsthaften Problemen ist möglicherweise nicht einmal das Einhängen Ihres Root-Dateisystems möglich und das Booten des Systems endet unter Umständen mit einer so genannten <quote>Kernel-Panic</quote>. In diesem Fall ist nur die externe Reparatur des Systems möglich. <phrase os="sles;sled">Für diese Aufgabe wird die Verwendung der YaST-Systemreparatur dringend empfohlen (siehe <xref linkend="sec-trouble-data-recover-yast"/>). Wenn Sie jedoch die manuelle Überprüfung bzw. Reparatur des Dateisystems durchführen müssen, booten Sie das Rettungssystem. </phrase> Es enthält die Dienstprogramme für die Überprüfung und Reparatur der Dateisysteme <literal>btrfs</literal>, <literal>ext2</literal>, <literal>ext3</literal>, <literal>ext4</literal>, <literal>reiserfs</literal>, <literal>xfs</literal>, <literal>dosfs</literal> und <literal>vfat</literal>.
   </para>
  </section>
  <section xml:id="sec-trouble-data-recover-rescue-access">
   <title>Zugriff auf das installierte System</title>
   <para>
    Wenn Sie vom Rettungssystem aus auf das installierte System zugreifen müssen, ist dazu eine <emphasis>change-root</emphasis>-Umgebung erforderlich. Beispiele: Bearbeiten der Bootloader-Konfiguration oder Ausführen eines Dienstprogramms zur Hardwarekonfiguration.
   </para>
   <para>
    Gehen Sie zur Einrichtung einer change-root-Umgebung, die auf dem installierten System basiert, folgendermaßen vor:
   </para>
   <procedure>
    <step>
     <para>
      Hängen Sie zunächst die Root-Partition des installierten Systems und des Gerätedateisystems ein (ändern Sie den Gerätenamen entsprechend Ihren aktuellen Einstellungen):
     </para>
<screen>mount /dev/sda6 /mnt
mount --bind /dev /mnt/dev</screen>
    </step>
    <step>
     <para>
      Nun können Sie per <quote>change-root</quote> in die neue Umgebung wechseln:
     </para>
<screen>chroot /mnt</screen>
    </step>
    <step>
     <para>
      Hängen Sie dann <filename>/proc</filename> und <filename>/sys</filename> ein:
     </para>
<screen>mount /proc
mount /sys</screen>
    </step>
    <step>
     <para>
      Abschließend hängen Sie die restlichen Partitionen vom installierten System ein:
     </para>
<screen>mount -a</screen>
    </step>
    <step>
     <para>
      Nun können Sie auf das installierte System zugreifen. Hängen Sie vor dem Reboot des Systems die Partitionen mit <command>umount</command> <option>-a</option> aus und verlassen Sie die <quote>change-root</quote>-Umgebung mit <command>exit</command>.
     </para>
    </step>
   </procedure>
   <warning>
    <title>Einschränkungen</title>
    <para>
     Obwohl Sie über uneingeschränkten Zugriff auf die Dateien und Anwendungen des installierten Systems verfügen, gibt es einige Beschränkungen. Der Kernel, der ausgeführt wird, ist der Kernel, der mit dem Rettungssystem gebootet wurde, nicht mit der change-root-Umgebung. Er unterstützt nur essenzielle Hardware, und das Hinzufügen von Kernel-Modulen über das installierte System ist nur möglich, wenn die Kernel-Versionen genau übereinstimmen. Überprüfen Sie immer die Version des aktuell ausgeführten (Rettungssytem-) Kernels mit <command>uname -r</command> und stellen Sie fest, ob im Verzeichnis <filename>/lib/modules</filename> in der change-root-Umgebung passende Unterverzeichnisse vorhanden sind. Wenn dies der Fall ist, können Sie die installierten Module verwenden. Andernfalls müssen Sie diese in den richtigen Version von einem anderen Medium, z. B. einem USB-Stick, bereitstellen. In den meisten Fällen weicht die Kernel-Version des Rettungssystems von der des installierten ab – dann können Sie z. B. nicht einfach auf eine Soundkarte zugreifen. Der Aufruf einer grafischen Bedienoberfläche ist ebenfalls nicht möglich.
    </para>
    <para>
     Beachten Sie außerdem, dass Sie die <quote>change-root</quote>-Umgebung verlassen, wenn Sie die Konsole mit <keycombo><keycap function="alt"/><keycap>F1</keycap></keycombo> bis <keycombo><keycap function="alt"/><keycap>F6</keycap></keycombo> umschalten.
    </para>
   </warning>
  </section>
  <section xml:id="sec-trouble-data-recover-rescue-grub">
   <title>Bearbeiten und erneutes Installieren des Bootloader</title>
   <para>
    In einigen Fällen kann ein System aufgrund einer beschädigten Bootloader-Konfiguration nicht gebootet werden. Die Start-Routinen sind beispielsweise nicht in der Lage, physische Geräte in die tatsächlichen Speicherorte im Linux-Dateisystem zu übersetzen, wenn der Bootloader nicht ordnungsgemäß funktioniert.
   </para>
   <para>
    Gehen Sie wie folgt vor, um die Bootloader-Konfiguration zu überprüfen und den Bootloader neu zu installieren:
   </para>
   <procedure>
    <step>
     <para>
      Führen Sie die unter <xref linkend="sec-trouble-data-recover-rescue-access"/> erläuterten erforderlichen Schritte für den Zugriff auf das installierte System aus.
     </para>
    </step>
    <step>
     <para>
      Vergewissern Sie sich, dass die nachfolgend angegebenen Dateien gemäß den in <xref linkend="cha-grub"/> erläuterten GRUB-Konfigurationsgrundlagen ordnungsgemäß konfiguriert sind, und wenden Sie Fixes an, falls erforderlich.
     </para>
     <itemizedlist mark="bullet" spacing="normal">
      <listitem>
       <para>
        <filename>/etc/grub.conf</filename>
       </para>
      </listitem>
      <listitem>
       <para>
        <filename>/boot/grub/device.map</filename>
       </para>
      </listitem>
      <listitem>
       <para>
        <filename>/boot/grub/menu.lst</filename>
       </para>
      </listitem>
      <listitem>
       <para>
        <filename>/etc/sysconfig/bootloader</filename>
       </para>
      </listitem>
     </itemizedlist>
    </step>
    <step>
     <para>
      Installieren Sie den Bootloader mit folgender Kommandosequenz neu:
     </para>
<screen>grub --batch &lt; /etc/grub.conf</screen>
    </step>
    <step>
     <para>
      Hängen Sie die Partitionen aus, melden Sie sich von der <quote>change-root</quote>-Umgebung ab und führen Sie den Reboot des Systems durch:
     </para>
<screen>umount -a
exit
reboot</screen>
    </step>
   </procedure>
  </section>
  <section xml:id="sec-trouble-data-recover-rescue-dud">
   <title>Korrektur der Kernel-Installation</title>
   <para>
    Ein Kernel-Update kann einen neuen Fehler verursachen, der sich auf Ihr System auswirken kann. Es kann z. B. ein Treiber für eine Hardwarekomponente in Ihrem System falsch sein, weshalb Sie nicht auf die Komponente zugreifen und diese nicht verwenden können. Kehren Sie in diesem Fall zum letzten funktionierenden Kernel zurück (sofern er im System verfügbar ist) oder installieren Sie den Original-Kernel vom Installationsmedium.
   </para>
   <tip>
    <title>So erhalten Sie die aktuellsten Kernels nach dem Update</title>
    <para>
     Um Fehler beim Booten durch eine fehlerhaften Kernel-Aktualisierung zu vermeiden, können Sie die Multiversionsfunktion für Kernel nutzen und <systemitem>libzypp</systemitem> mitteilen, welche Kernel Sie nach der Aktualisierung erhalten möchten.
    </para>
    <para>
     Damit z. B. immer die beiden letzten Kernels und der aktuell ausgeführte erhalten bleiben, fügen Sie
    </para>
<screen>multiversion.kernels = latest,latest-1,running</screen>
    <para>
     zur Datei <filename>/etc/zypp/zypp.conf</filename> hinzu.
    </para>
   </tip>
   <para>
    Ähnlich verhält es sich, wenn Sie einen defekten Treiber für ein nicht durch <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase> unterstütztes Gerät neu installieren oder aktualisieren müssen. Wenn z. B. ein Hardwarehersteller ein bestimmtes Gerät verwendet, wie einen Hardware-RAID-Controller, für den es erforderlich ist, dass ein Binärtreiber durch das Betriebssystem erkannt wird. Der Hersteller veröffentlicht in der Regel ein Treiberupdate mit der korrigierten oder aktualisierten Version des benötigten Treibers.
   </para>
   <para>
    In beiden Fällen müssen Sie im Rettungsmodus auf das installierte System zugreifen und das mit dem Kernel zusammenhängende Problem beheben, da das System andernfalls nicht korrekt booten wird:
   </para>
   <procedure>
    <step>
     <para>
      Booten Sie von den <phrase role="productname"><phrase os="sled">SUSE Linux Enterprise Desktop</phrase></phrase>-Installationsmedien.
     </para>
    </step>
    <step>
     <para>
      Überspringen Sie diese Schritt, wenn Sie eine Wiederherstellung nach einer fehlerhaften Kernel-Aktualisierung durchführen. Wenn Sie eine Driver Update Disk (DUD) verwenden, drücken Sie <keycap>F6</keycap>, um die Treiberaktualisierung nach der Anzeige des Bootmenüs zu laden, wählen Sie den Pfad oder die URL für die Treiberaktualisierung aus und bestätigen Sie die Auswahl mit <guimenu>Ja</guimenu>.
     </para>
    </step>
    <step>
     <para>
      Wählen Sie im Bootmenü <guimenu>Rettungssystem</guimenu> aus und drücken Sie die <keycap>Eingabetaste</keycap>. Wenn Sie eine DUD verwenden, werden Sie aufgefordert, den Speicherplatz der Treiberaktualisierung anzugeben.
     </para>
    </step>
    <step>
     <para>
      Geben Sie an der Eingabeaufforderung <literal>Rescue:</literal><literal>root</literal> ein. Ein Passwort ist nicht erforderlich.
     </para>
    </step>
    <step>
     <para>
      Hängen Sie das Zielsystem manuell ein und führen Sie <quote>change root</quote> in die neue Umgebung durch. Weitere Informationen finden Sie unter <xref linkend="sec-trouble-data-recover-rescue-access"/>.
     </para>
    </step>
    <step>
     <para>
      Wenn Sie eine DUD verwenden, installieren oder aktualisieren Sie das fehlerhafte Treiberpaket. Stellen Sie stets sicher, dass die installierte Kernel-Version exakt mit der Version des Treibers übereinstimmt, den Sie installieren möchten.
     </para>
     <para>
      Wenn Sie eine fehlerhafte Installation einer Treiberaktualisierung korrigieren, können Sie nach dem folgenden Verfahren den Originaltreiber vom Installationsmedium installieren.
     </para>
     <substeps performance="required">
      <step>
       <para>
        Identifizieren Sie Ihr DVD-Laufwerk mit <command>hwinfo --cdrom</command> und hängen Sie es mit <command>mount /dev/sr0 /mnt</command> ein.
       </para>
      </step>
      <step>
       <para>
        Navigieren Sie zum Verzeichnis, in dem Ihre Kernel-Dateien auf der DVD gespeichert sind, z. B. <command>cd /mnt/suse/x86_64/</command>.
       </para>
      </step>
      <step>
       <para>
        Installieren Sie die benötigten <systemitem>kernel-*</systemitem>-, <systemitem>kernel-*-base</systemitem>- und <systemitem>kernel-*-extra</systemitem>-Pakete mit dem Kommando <command>rpm -i</command>.
       </para>
      </step>
      <step>
       <para>
        Prüfen Sie nach Abschluss der Installation, ob für den neu installierten Kernel ein neuer Menüeintrag zur Bootloader-Konfigurationsdatei (<filename>/boot/grub/menu.lst</filename> für <systemitem>grub</systemitem>) hinzugefügt wurde.
       </para>
      </step>
     </substeps>
    </step>
    <step>
     <para>
      Aktualisieren Sie Konfigurationsdateien und initialisieren Sie den Bootloader gegebenenfalls neu. Weitere Informationen finden Sie in <xref linkend="sec-trouble-data-recover-rescue-grub"/>.
     </para>
    </step>
    <step>
     <para>
      Entfernen Sie alle bootbaren Medien aus dem Systemlaufwerk und booten Sie neu.
     </para>
    </step>
   </procedure>
  </section>
 </section>
</section>
