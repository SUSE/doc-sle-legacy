<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sect1 PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN"
"novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<sect1 xml:base="net_config_files.xml" id="sec.basicnet.manconf">
 <title>ネットワークの手動環境設定</title><indexterm id="idx.networks_configuring" class="startofrange"> <primary>ネットワーク</primary><secondary>設定</secondary></indexterm><indexterm id="idx.configuring_networks_manually" class="startofrange"><primary>設定</primary><secondary>ネットワーク</secondary><tertiary>手動 </tertiary></indexterm>

 <para>
  ネットワークソフトウェアの手動環境設定は、常に最後の手段です。設定には可能な限りYaSTを使用してください。しかし、ここで説明するネットワーク環境設定の背景知識がYaSTでの設定作業に役立つことがあります。
 </para>



 <para>
  カーネルは、ネットワークカードを検出し、対応するネットワークインタフェースを作成する際に、デバイスディスカバリの順序またはカーネルモジュールのロード順序によって、デバイスに名前を割り当てます。デフォルトのカーネルデバイス名は、非常にシンプルまたは厳しく制御されたハードウェア環境でのみ予測可能です。ランタイム時にハードウェアの追加や削除が可能なシステム、またはデバイスの自動設定をサポートするシステムでは、カーネルにより割り当てられたネットワークデバイス名がリブート後も変わらないと期待することはできません。
 </para>

 <para>
  しかし、すべてのシステム設定ツールは、永続的なインタフェース名に依存しています。この問題は、udevで解決されます。udevの永続的ネットジェネレータ(<filename>/lib/udev/rules.d/75-persistent-net-generator.rules</filename>)は、ハードウェアを照合するルール(デフォルトでは、そのハードウェアアドレスを使用)を生成し、ハードウェアに永続的に固有のインタフェースを割り当てます。udevのネットワークインタフェースデータベースは、ファイル<filename>/etc/udev/rules.d/70-persistent-net.rules</filename>に保存されます。このファイルの行ごとに、1つのネットワークインタフェースが記述され、永続名が指定されます。システム管理者は、<literal>NAME=""</literal>項目を編集することにより、割り当て名を変更できます。永続的ルールも、YaSTで変更できます。
 </para>

 <para>
  <xref linkend="tab.net.script.conf"/>に、ネットワークの環境設定関連の最も重要なスクリプトをまとめます。
 </para>

 <table id="tab.net.script.conf">
  <title>手動ネットワーク環境設定用スクリプト</title>
  <tgroup cols="2">
   <thead>
    <row>
     <entry>
      <para>
       コマンド
      </para>
     </entry>
     <entry>
      <para>
       機能
      </para>
     </entry>
    </row>
   </thead>
   <tbody>
    <row>
     <entry>
      <para>
       <command>ifup、ifdown、ifstatus</command>
      </para>
     </entry>
     <entry>
      <para>
       <literal>if</literal>スクリプトは、ネットワークインタフェースの起動や停止を行ったり、指定のインタフェースのステータスを返したりします。詳細については、<systemitem>ifup</systemitem>のマニュアルページを参照してください。
      </para>
     </entry>
    </row>
    <row>
     <entry>
      <para>
       <command>rcnetwork</command>
      </para>
     </entry>
     <entry>
      <para>
       <literal>rcnetwork</literal>スクリプトを使用すると、すべてのネットワークインタフェースまたは特定のネットワークインタフェースだけを起動、停止、または再起動できます。ネットワークインタフェースの停止には<command>rcnetwork stop</command>、起動には<command>rcnetwork start</command>、再起動には<command>rcnetwork restart</command>を使用します。1つのインタフェースだけを停止、起動、または再起動したい場合は、コマンドの後にインタフェース名を指定します(たとえば、<command>rcnetwork restart eth0</command>)。<command>rcnetwork status</command>コマンドを使用すると、インタフェースの状態、IPアドレス、およびDHCPクライアントが実行中かどうかが表示されます。<command>rcnetwork stop-all-dhcp-clients</command>または <command>rcnetwork restart-all-dhcp-clients</command>を使用すると、ネットワークインタフェースで実行中のDHCPクライアントを停止または再起動できます。
      </para>
     </entry>
    </row>
   </tbody>
  </tgroup>
 </table>

 <para>
  udevおよび永続的デバイス名については、<xref linkend="cha.udev"/>を参照してください。
 </para>

 <sect2 id="sec.basicnet.manconf.files">
  <title>環境設定ファイル</title><indexterm> <primary>環境設定ファイル</primary></indexterm><indexterm id="idx.networks_configuration_files" class="startofrange"><primary>ネットワーク</primary><secondary>環境設定ファイル </secondary></indexterm>
  <para>
   ここでは、ネットワークの環境設定ファイルの概要を紹介し、その目的と使用される形式について説明します。
  </para>
  <sect3 id="sec.basicnet.manconf.files.ifcfg">
   <title><filename>/etc/sysconfig/network/ifcfg-*</filename></title>
   <para>
    これらのファイルには、ネットワークインタフェースの環境設定が含まれています。これには、実行モード、IPアドレスなどが含まれます。指定可能なパラメータについては、<systemitem>ifup</systemitem>のマニュアルページを参照してください。また、一般的設定を1つのインタフェースだけに使用する場合は、<filename>dhcp</filename>ファイルのほとんどの変数を<filename>ifcfg-*</filename>ファイルで使用できます。ただし、<filename>/etc/sysconfig/network/config</filename>の変数の大半はグローバル変数であり、ifcfgファイル内で上書きすることはできません。たとえば、<systemitem>NETWORKMANAGER</systemitem>変数や<systemitem>NETCONFIG_*</systemitem>変数はグローバルです。
   </para>
   <para>
    <filename>ifcfg.template</filename>については、<xref linkend="sec.basicnet.manconf.files.config-etc"/>を参照してください。
   </para><indexterm> <primary>環境設定ファイル</primary> <secondary>ifcfg-*</secondary> </indexterm>
   
  </sect3>
  <sect3 id="sec.basicnet.manconf.files.config-etc">
   <title><filename>/etc/sysconfig/network/config</filename>と<filename>/etc/sysconfig/network/dhcp</filename></title><indexterm> <primary>設定ファイル</primary> <secondary>ネットワーク</secondary></indexterm><indexterm> <primary>設定ファイル</primary> <secondary>dhcp</secondary></indexterm>
   <para>
    <filename>config</filename>ファイルは、<command>ifup</command>、<command>ifdown</command>、および<command>ifstatus</command>の動作の一般設定を含み、<filename>dhcp</filename>は、DHCの設定を含みます。両方の設定ファイルの変数はコメント付きです。<filename>/etc/sysconfig/network/config</filename>内の一部の変数は、<filename>ifcfg-*</filename>ファイルでも使用できます。このファイルでは、高い優先度が設定されます。<filename>/etc/sysconfig/network/ifcfg.template</filename>ファイルは、インタフェースごとに指定できる変数を一覧表示します。ただし、<filename>/etc/sysconfig/network/config</filename>の変数の大半はグローバル変数であり、ifcfgファイル内で上書きすることはできません。たとえば、<systemitem>NETWORKMANAGER</systemitem>や<systemitem>NETCONFIG_*</systemitem>は、グローバル変数です。
   </para>
  </sect3>
  <sect3>
   <title><filename>/etc/sysconfig/network/routes</filename>と<filename>/etc/sysconfig/network/ifroute-*</filename></title><indexterm id="idx.routing" class="startofrange"> <primary>ルーティング</primary> </indexterm> <indexterm> <primary>ルーティング</primary> <secondary>ルート</secondary> </indexterm> <indexterm> <primary>環境設定ファイル</primary> <secondary>ルート</secondary> </indexterm> <indexterm> <primary>設定</primary> <secondary>ルーティング</secondary> </indexterm>
   <para>
    TCP/IPパケットの静的ルーティングが設定されています。ホストへのルート、ゲートウェイ経由のホストへのルート、およびネットワークへのルートなど、さまざまなシステムタスクが必要とするすべての静的ルートは、<filename>/etc/sysconfig/network/routes</filename>ファイルに指定できます。個別のルーティングが必要な各インタフェースに対して、付加環境設定ファイル<filename>/etc/sysconfig/network/ifroute-*</filename>を定義します。*<literal>はインタフェース名で読み替えてください。</literal>経路の環境設定ファイルのエントリは次のようになります。<indexterm><primary>ルーティング</primary><secondary>静的</secondary></indexterm>
   </para>
<screen># Destination     Dummy/Gateway     Netmask            Device
#
127.0.0.0         0.0.0.0           255.255.255.0      lo
204.127.235.0     0.0.0.0           255.255.255.0      eth0
default           204.127.235.41    0.0.0.0            eth0
207.68.156.51     207.68.145.45     255.255.255.255    eth1
192.168.0.0       207.68.156.51     255.255.0.0        eth1</screen>
   <para>
    第1列は、経路の宛先です。この列には、ネットワークまたはホストのIPアドレスが入ります。<emphasis>到達可能な</emphasis>ネームサーバの場合は、完全に修飾されたネットワークまたはホスト名が入ります。
   </para>
   <para>
    第2列は、デフォルトゲートウェイ、すなわちホストまたはネットワークにアクセスする際に経由するゲートウェイです。第3列は、ゲートウェイの背後にあるネットワークまたはホストのネットマスクです。たとえば、ゲートウェイの背後にあるホストのネットマスクは、<systemitem class="netmask">255.255.255.255</systemitem>になります。
   </para>
   <para>
    最後の列は、ローカルホスト(ループバック、イーサネット、ISDN、PPP、ダミーデバイスなど)に接続されたネットワークのみに関連します。ここには、デバイス名を指定する必要があります。
   </para>
   <para>
    (オプションの) 5番目のコラムには、経路のタイプを指定することができます。必要ではないコラムには、マイナス記号<literal>-</literal>を記入してください。これは、パーサがコマンドを正しく解釈できるようにするためです。詳細は、<systemitem>routes(5)</systemitem>マニュアルページを参照してください。
   </para>
   <para>
    IPv4とIPv6の統合形式は、次のようになります。
   </para>
<screen><replaceable>prefix</replaceable>/<replaceable>length</replaceable><replaceable>gateway</replaceable> -            [<replaceable>interface</replaceable>]
</screen>
   <para>
    いわゆる互換形式は、次のようになります。
   </para>
<screen><replaceable>prefix</replaceable><replaceable>gateway</replaceable><replaceable>length</replaceable>       [<replaceable>interface</replaceable>]
</screen>
   <para>
    IPv4については、ネットマスクを使用する古い形式もまだ使用できます。
   </para>
<screen><replaceable>ipv4-network</replaceable><replaceable>gateway</replaceable><replaceable>ipv4-netmask</replaceable> [<replaceable>interface</replaceable>]
</screen>
   <para>
    次の例は、互いに同等です。
   </para>
<screen>2001:db8:abba:cafe::/64 2001:db8:abba:cafe::dead  -            eth0
208.77.188.0/24         208.77.188.166            -            eth0

2001:db8:abba:cafe::    2001:db8:abba:cafe::dead 64            eth0
208.77.188.0            208.77.188.166           24            eth0

208.77.188.0            208.77.188.166           255.255.255.0 eth0
</screen>
<indexterm class="endofrange" startref="idx.routing"/>
  </sect3>
  <sect3>
   <title><filename>/etc/resolv.conf</filename></title><indexterm> <primary>環境設定ファイル </primary><secondary>resolv.conf</secondary> </indexterm>
   <para>
    このファイルには、ホストが属するドメインが指定されています(キーワード<systemitem>search</systemitem>)。また、アクセスするネームサーバアドレスのステータスのリストも記述されています（キーワード<systemitem>nameserver</systemitem>）。このファイルでは、複数のドメイン名を指定できます。完全修飾でない名前を解決する場合は、<systemitem>search</systemitem>の各エントリを付加して完全修飾名の生成が試みられます。複数のネームサーバを、<systemitem>nameserver</systemitem>で始まる複数行で指定できます。コメントの先頭には<literal>#</literal>記号が付きます。<xref linkend="dat.netz.etc.resolv.conf"/>には、<filename>/etc/resolv.conf</filename>の可能な内容が示されています。<indexterm> <primary>DNS</primary><secondary>ドメイン</secondary> </indexterm> <indexterm> <primary>DNS</primary> <secondary>ネームサーバ</secondary> </indexterm>
   </para>
   <para>
    ただし、<filename>/etc/resolv.conf</filename>は、手動では編集しないでください。このファイルは、<command>netconfig</command>スクリプトで生成されます。YaSTを使用せずに静的DNS設定を定義するには、<filename>/etc/sysconfig/network/config</filename>ファイルの該当する変数を手動で編集します。
   </para>
   <variablelist>
    <varlistentry>
     <term><systemitem>NETCONFIG_DNS_STATIC_SEARCHLIST</systemitem>
     </term>
     <listitem>
      <para>
       ホスト名の検索に使用されるDNSドメイン名のリスト
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>NETCONFIG_DNS_STATIC_SERVERS</systemitem>
     </term>
     <listitem>
      <para>
       ホスト名の検索されるネームサーバIPアドレスのリスト
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>NETCONFIG_DNS_FORWARDER</systemitem>
     </term>
     <listitem>
      <para>
       設定する必要のあるDNSフォワーダの名前の定義
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    netconfigでDNS環境設定を無効にするには、<literal>NETCONFIG_DNS_POLICY=''</literal>を設定します。<command>netconfig</command>の詳細については、<command>man 8 netconfig</command>を参照してください。
   </para>
   <example id="dat.netz.etc.resolv.conf">
    <title><filename>/etc/resolv.conf</filename></title>
<screen># Our domain
search example.com
#
# We use dns.example.com (192.168.1.116) as name server
nameserver 192.168.1.116</screen>
   </example>
  </sect3>

  <sect3 id="sec.basicnet.manconf.netconfig">
   <title><filename>/sbin/netconfig</filename></title>
   <para>
    <command>netconfig</command>は、追加のネットワーク環境設定を管理するモジュール式ツールです。このツールは、事前定義されたポリシーに従って、DHCPまたはPPPなどの自動設定メカニズムにより提供される設定と、静的に定義された設定をマージします。要求された変更は、netconfigモジュールの呼び出しによって適用されます。このモジュールは、環境設定ファイルの変更と、サービスまたは同様のアクションの再起動を行います。
   </para>
   <para>
    <command>netconfig</command>は、3つの主要なアクションを認識します。<command>netconfig modify</command>コマンドと<command>netconfig remove</command>コマンドは、 DHCPやPPPなどのデーモンによって使用され、netconfigの設定値を提供したり、削除します。ユーザが使用できるのは、<command>netconfig update</command>コマンドだけです。
   </para>
   <variablelist>
    <varlistentry>
     <term><command>変更</command>
     </term>
     <listitem>
      <para>
       <command>netconfig modify</command>コマンドは、現在のインタフェースとサービス固有の動的設定を変更し、ネットワーク設定を更新します。netconfigは、標準入力からか、または<option>--lease-file <replaceable>filename</replaceable></option>オプションで指定されたファイルから設定を読み込み、システムのリブートまたは次の変更/削除アクションまで、それらの設定を内部的に保存します。同じインタフェースとサービスの組み合わせに関する既存設定は、上書きされます。インタフェースは、<option>-i <replaceable>interface_name</replaceable></option>パラメータで指定されます。サービスは、<option>-s <replaceable>service_name</replaceable></option>パラメータで指定されます。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>削除</command>
     </term>
     <listitem>
      <para>
       <command>netconfig remove</command>コマンドは、特定のインタフェースとコマンドの組み合わせに対する変更アクションによる動的設定を削除し、ネットワーク設定を更新します。インタフェースは、<option>-i <replaceable>interface_name</replaceable></option>パラメータで指定されます。サービスは、<option>-s <replaceable>service_name</replaceable></option>パラメータで指定されます。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>update</command>
     </term>
     <listitem>
      <para>

       <command>netconfig update</command>コマンドは、現在の設定で、ネットワーク設定を更新します。これは、ポリシーや静的環境設定が変更された場合に便利です。指定したサービスのみ(<systemitem>dns</systemitem>、<systemitem>nis</systemitem>、または<systemitem>ntp</systemitem>)を更新するには、<option>-m <replaceable>module_type</replaceable></option>パラメータを使用します。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>

   <para>
    netconfigポリシーおよび静的環境設定は、手動またはYaSTで、<filename>/etc/sysconfig/network/config</filename>ファイル内で定義します。dhcpやpppなどの自動設定ツールで提供された動的設定は、<command>netconfig modify</command>および<command>netconfig remove</command>のアクションで、これらのツールによって直接配信されます。NetworkManagerは、<command>netconfig modify</command>および<command>netconfig remove</command>アクションも使用します。NetworkManagerが有効な場合、netconfig (ポリシーモードが<literal>auto</literal>)は、NetworkManagerの設定のみを使用し、従来のifup方式で設定された他のインタフェースからの設定を無視します。NetworkManagerが設定を提供しない場合は、静的設定がフォールバックとして使用されます。NetworkManagerと従来のifup方式の混合使用はサポートされません。
   </para>
   <para>
    <command>netconfig</command>の詳細については、<command>man 8 netconfig</command>を参照してください。
   </para>
  </sect3>
  <sect3 id="sec.basicnet.manconf.hosts">
   <title><filename>/etc/hosts</filename></title><indexterm> <primary>環境設定ファイル </primary><secondary>hosts</secondary> </indexterm>
   <para>
    このファイル(<xref linkend="dat.netz.etc.hosts"/>を参照)では、IIPアドレスがホスト名に割り当てられています。ネームサーバが実装されていない場合は、IP接続をセットアップするすべてのホストをここにリストする必要があります。ファイルには、各ホストについて1行を入力し、IPアドレス、完全修飾ホスト名、およびホスト名を指定します。IPアドレスは、行頭に指定し、各エントリはブランクとタブで区切ります。コメントは常に<literal>#</literal>記号の後に記入します。
   </para>
   <example id="dat.netz.etc.hosts">
    <title><filename>/etc/hosts</filename></title>
<screen>127.0.0.1 localhost
192.168.2.100 jupiter.example.com jupiter
192.168.2.101 venus.example.com venus</screen>
   </example>
  </sect3>
  <sect3>
   <title><filename>/etc/networks</filename></title><indexterm><primary>環境設定ファイル</primary><secondary>ネットワーク</secondary></indexterm>
   <para>
    このファイルには、ネットワーク名とネットワークアドレスの対応が記述されています。形式は、ネットワーク名をアドレスの前に指定すること以外は、<filename>hosts</filename>ファイルと同様です。詳細については、<xref linkend="dat.netz.networks"/>を参照してください。
   </para>
   <example id="dat.netz.networks">
    <title><filename>/etc/networks</filename></title>
<screen>loopback     127.0.0.0
localnet     192.168.0.0</screen>
   </example>
  </sect3>
  <sect3>
   <title><filename>/etc/host.conf</filename></title><indexterm> <primary>環境設定ファイル</primary><secondary>host.conf</secondary> </indexterm>
   <para>
    このファイルは、名前解決(<emphasis>resolver</emphasis>ライブラリによるホスト名とネットワーク名の変換)を制御します。このファイルは、libc4またはlibc5にリンクされているプログラムについてのみ使用されます。最新のglibcプログラムについては、<filename>/etc/nsswitch.conf</filename>の設定を参照してください。パラメータは、その行内で常に独立しています。コメントは<literal>#</literal>記号の後に記入します。<xref linkend="tab.netz.param.hostconf"/>に、利用可能なパラメータを示します。<filename>/etc/host.conf</filename>の例については、<xref linkend="dat.netz.etc.hostconf"/>を参照してください。
   </para>
   <table id="tab.netz.param.hostconf">
    <title>/etc/host.confファイルのパラメータ</title>
    <tgroup cols="2" align="left">
     <tbody>
      <row>
       <entry>
        <para>
         order <emphasis>hosts</emphasis>,<emphasis>bind</emphasis>
        </para>
       </entry>
       <entry>
        <para>
         名前の解決の際、サービスがアクセスされる順序を指定します。有効な引数は次のとおりです(空白またはカンマで区切ります)。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para/>
       </entry>
       <entry>
        <para>
         <emphasis>hosts</emphasis>: <filename>/etc/hosts</filename>ファイルを検索します。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para/>
       </entry>
       <entry>
        <para>
         <emphasis>bind</emphasis>: ネームサーバにアクセスします。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para/>
       </entry>
       <entry>
        <para>
         <emphasis>nis</emphasis>: NISを使用します。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         multi <emphasis>on</emphasis>/<emphasis>off</emphasis>
        </para>
       </entry>
       <entry>
        <para>
         <filename>/etc/hosts</filename>に指定されているホストが、複数のIPアドレスを持てるかどうかを定義します。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         nospoof <emphasis>on</emphasis> spoofalert <emphasis>on</emphasis>/<emphasis>off</emphasis>
        </para>
       </entry>
       <entry>
        <para>
         これらのパラメータは、ネームサーバ<emphasis>spoofing</emphasis>に影響を与えますが、ネットワークの環境設定にはまったく影響を与えません。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         trim <emphasis>domainname</emphasis>
        </para>
       </entry>
       <entry>
        <para>
         ホスト名が解決された後、指定したドメイン名をホスト名から切り離します(ホスト名にドメイン名が含まれている場合)。ローカルドメインにある名前は<filename>/etc/hosts</filename>ファイルにありますが、付加されるドメイン名でも認識する必要がある場合には便利なオプションです。
        </para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </table>
   <example id="dat.netz.etc.hostconf">
    <title><filename>/etc/host.conf</filename></title>
<screen># We have named running
order hosts bind
# Allow multiple address
multi on</screen>
   </example>
  </sect3>
  <sect3>
   <title><filename>/etc/nsswitch.conf</filename></title><indexterm> <primary>環境設定ファイル</primary> <secondary>nsswitch.conf</secondary> </indexterm>
   <para>
    GNU C Library 2.0を導入すると、<emphasis>Name Service Switch</emphasis> (NSS)も合わせて導入されます。詳細については、<systemitem>nsswitch.conf(5)</systemitem> manページおよび『<emphasis>The GNU C Library Reference Manual</emphasis>』を参照してください。<indexterm> <primary>NSS</primary> </indexterm>
   </para>
   <para>
    クエリの順序は、ファイル<filename>/etc/nsswitch.conf</filename>で定義します。<filename>nsswitch.conf</filename>の例については、<xref linkend="dat.netz.nsswitchconf"/>を参照してください。コメントの先頭には<literal>#</literal>記号が付きます。この例では、<filename>hosts</filename>データベースのエントリによると、要求がDNS経由で<filename>/etc/hosts</filename> (<option>files</option>)に送信されています。
   </para>
   <example id="dat.netz.nsswitchconf">
    <title><filename>/etc/nsswitch.conf</filename></title>
<screen>passwd:     compat
group:      compat

hosts:      files dns
networks:   files dns

services:   db files
protocols:  db files
rpc:        files
ethers:     files
netmasks:   files
netgroup:   files nis
publickey:  files

bootparams: files
automount:  files nis
aliases:    files nis
shadow:     compat
</screen>
   </example>
   <para>
    NSSで利用できる<quote>データベース</quote>については、<xref linkend="tab.netz.nnswitch.db"/>を参照してください。<indexterm><primary>NSS</primary><secondary>データベース</secondary></indexterm> NSSデータベースの環境設定オプションについては、<xref linkend="tab.netz.nnswitch.conf"/>を参照してください。
   </para>
   <table id="tab.netz.nnswitch.db">
    <title>/etc/nsswitch.confで利用できるデータベース</title>
    <tgroup cols="2" align="left">
     <tbody>
      <row>
       <entry>
        <para>
         <option>aliases</option>
        </para>
       </entry>
       <entry>
        <para>
         <filename>sendmail</filename>によって実行されたメールエイリアス。<command>man</command> <option>5 aliases</option>コマンドで、マニュアルページを参照してください。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>ethers</option>
        </para>
       </entry>
       <entry>
        <para>
         イーサネットアドレス。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>netmasks</option>
        </para>
       </entry>
       <entry>
        <para>
         ネットワークとそのサブネットマスクのリスト。サブネットを使用する場合のみ必要です。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>group</option>
        </para>
       </entry>
       <entry>
        <para>
         <filename>getgrent</filename>によって使用されるユーザグループ。<command>group</command>のマニュアルページも参照してください。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>hosts</option>
        </para>
       </entry>
       <entry>
        <para>
         <filename>gethostbyname</filename>および同類の関数によって使用されるホスト名とIPアドレス。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>netgroup</option>
        </para>
       </entry>
       <entry>
        <para>
         アクセス許可を制御するための、ネットワーク内にある有効なホストとユーザのリスト。<systemitem>netgroup(5)</systemitem> manページを参照してください。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>networks</option>
        </para>
       </entry>
       <entry>
        <para>
         ネットワーク名とアドレス。<filename> getnetent</filename>によって使用されます。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>publickey</option>
        </para>
       </entry>
       <entry>
        <para>
         NFSとNIS+によって使用されるSecure_RPCの公開鍵と秘密鍵。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>passwd</option>
        </para>
       </entry>
       <entry>
        <para>
         ユーザパスワード。<filename>getpwent</filename>によって使用されます。<systemitem>passwd(5)</systemitem> manページを参照してください。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>protocols</option>
        </para>
       </entry>
       <entry>
        <para>
         ネットワークプロトコル。<filename>getprotoent</filename>によって使用されます。<systemitem>protocols(5)</systemitem> manページを参照してください。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>rpc</option>
        </para>
       </entry>
       <entry>
        <para>
         リモートプロシージャコール名とアドレス。<filename> getrpcbyname</filename>および同様の関数によって使用されます。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>services</option>
        </para>
       </entry>
       <entry>
        <para>
         ネットワークサービス。<filename>getservent</filename>によって使用されます。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>shadow</option>
        </para>
       </entry>
       <entry>
        <para>
         ユーザのシャドウパスワード。<filename>getspnam</filename>によって使用されます。<option>shadow(5)</option> manページを参照してください。
        </para>
       </entry>
      </row>

     </tbody>
    </tgroup>
   </table>
   <table id="tab.netz.nnswitch.conf">
    <title>NSS <quote>データベース</quote>の環境設定オプション</title>
    <tgroup cols="2" align="left">
     <tbody>
      <row>
       <entry>
        <para>
         <option>ファイル</option>
        </para>
       </entry>
       <entry>
        <para>
         直接アクセスファイル。たとえば<filename>/etc/aliases</filename>。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>db</option>
        </para>
       </entry>
       <entry>
        <para>
         データベース経由のアクセス。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>nis</option>、<option>nisplus</option>
        </para>
       </entry>
       <entry>
        <para>
         NIS。<xref linkend="cha.nis"/>を参照。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>dns</option>
        </para>
       </entry>
       <entry>
        <para>
         <option>hosts</option>および<option>networks</option>の拡張としてのみ使用できます。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>compat</option>
        </para>
       </entry>
       <entry>
        <para>
         <option>passwd</option>、<option>shadow</option>、および<option>group</option>の拡張としてのみ使用できます。
        </para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </table>
  </sect3>
  <sect3>
   <title><filename>/etc/nscd.conf</filename></title><indexterm> <primary>環境設定ファイル</primary><secondary>nscd.conf</secondary> </indexterm>
   <para>
    このファイルは、nscd (name service cache daemon)の環境設定に使用します。<systemitem>nscd(8)</systemitem>および<systemitem>nscd.conf(5)</systemitem>マニュアルページを参照してください。デフォルトでは、nscdによって<option>passwd</option>と<option>groups</option>のシステムエントリがキャッシュされます。キャッシュが行われないと名前やグループにアクセスするたびにネットワーク接続が必要になるため、このキャッシュ処理は NIS や LDAP といったディレクトリサービスのパフォーマンスに関して重要な意味を持ちます。<option>hosts</option>はデフォルトではキャッシュされません。これは、nscd でホストをキャッシュすると、ローカルシステムで正引き参照と逆引き参照のルックアップチェックを信頼できなくなるからです。したがって、nscdを使用して名前をキャッシュするのではなく、キャッシュDNSサーバをセットアップします。
   </para>
   <para>
    <option>passwd</option>オプションのキャッシュを有効にすると、新しく追加したローカルユーザが認識されるまで、通常、約15秒かかります。この待ち時間を短縮するには、コマンド<command>rcnscd</command><option>restart</option>を使用してnscdを再起動します。
   </para>
  </sect3>
  <sect3>
   <title><filename>/etc/HOSTNAME </filename></title><indexterm> <primary>環境設定ファイル</primary> <secondary>HOSTNAME</secondary> </indexterm>
   <para>
    このファイルには、ドメイン名付きで完全修飾されたホスト名が含まれています。このファイルは、マシンの起動時に複数のスクリプトによって読み込まれます。指定できるのは、ホスト名が設定されている1行のみです。
   </para><indexterm class="endofrange" startref="idx.networks_configuration_files"/>
  </sect3>
 </sect2>

 <sect2 id="sec.basicnet.manconf.testing">
  <title>設定のテスト</title>
  <para>
   設定内容を設定ファイルに書き込む前に、それをテストすることができます。テスト環境を設定するには、<command>ip</command>コマンドを使用します。接続をテストするには、<command>ping</command>コマンドを使用します。また、以前の設定ツールの<command>ifconfig</command>や<command>route</command>も使用することができます。
  </para>
  <para>
   <command>ip</command>、<command>ifconfig</command>、および<command>route</command>コマンドは、ネットワーク設定を直接変更します。ただし、変更内容は設定ファイルに保存されません。正しい設定ファイルに変更内容を保存しない限り、変更したネットワーク設定は再起動時に失われてしまいます。
  </para>
  <sect3 id="sec.basicnet.manconf.ip">
   <title><command>ip</command>によるネットワークインタフェースの設定</title><indexterm> <primary>コマンド</primary> <secondary>ip</secondary> </indexterm>
   
   <para>
    <command>ip </command>は、ネットワークデバイス、ルーティング、ポリシールーティング、およびトンネルの表示と設定を行うツールです。
   </para>
   <para>
    <command>ip</command>は非常に複雑なツールです。一般的には、<command>ip</command><option><replaceable>options</replaceable><replaceable>object</replaceable><replaceable>command</replaceable></option>の形式で指定します。objectの部分には、次のオブジェクトを指定することができます。
   </para>
   <variablelist>
    <varlistentry>
     <term>リンク</term>
     <listitem>
      <para>
       ネットワークデバイスを表します。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>アドレス</term>
     <listitem>
      <para>
       デバイスのIPアドレスを表します。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>隣接</term>
     <listitem>
      <para>
       ARPまたはNDISCキャッシュエントリを表します。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>route</term>
     <listitem>
      <para>
       ルーティングテーブルエントリを表します。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>ルール</term>
     <listitem>
      <para>
       ルーティングポリシーデータベース中のルールを表します。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>maddress</term>
     <listitem>
      <para>
       マルチキャストアドレスを表します。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>mroute</term>
     <listitem>
      <para>
       マルチキャストルーティングキャッシュエントリを表します。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>tunnel</term>
     <listitem>
      <para>
       IPトンネルを表します。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    commandを指定しないと、デフォルトのコマンド(通常は<command>list</command>)が使用されます。
   </para>
   <para>
    デバイスの状態を変更するには、<command>ip link set</command><option><replaceable>device_name</replaceable></option> <command><replaceable>command</replaceable></command>コマンドを使用します。たとえば、デバイスeth0を無効にするには、<command>ip link set</command><option>eth0 down</option>を実行します。このデバイスを再び有効にする場合は、<command>ip link set</command><option>eth0 up</option>を実行します。
   </para>
   <para>
    デバイスを有効にしたら、そのデバイスを設定することができます。デバイスのIPアドレスを使用する場合は、<command>ip addr add</command><option><replaceable>ip_address</replaceable> + dev <replaceable>device_name</replaceable></option>を使用します。たとえば、インタフェースeth0にアドレス「 192.168.12.154/30」を設定し、標準のブロードキャスト(<option>brd</option>オプション)を使用する場合は、「<command>ip addr</command><option>add 192.168.12.154/30 brd + dev eth0</option>」と入力します。
   </para>
   <para>
    接続を実際に利用可能にするには、デフォルトゲートウェイの設定も必要です。システムのゲートウェイを設定するには、「<command>ip route add</command> <option>gateway_ip_address</option>」を入力します。あるIPアドレスを別のIPアドレスに変換するには、<command>nat</command>: <command>ip route add nat</command> <option>ip_address</option> <command>via</command> <option>other_ip_address</option>を使用します。
   </para>
   <para>
    すべてのデバイスを表示する場合は、<command>ip link ls</command>を使用します。動作しているインタフェースだけを表示する場合は、<command>ip link ls up</command>を使用します。デバイスのインタフェース統計情報を印刷する場合は、「<command>ip -s link ls</command><option>device_name</option>」と入力します。デバイスのアドレスを表示する場合は、「<command>ip addr</command>」と入力します。<command>ip addr</command>の出力には、デバイスのMACアドレスに関する情報も表示されます。すべてのルートを表示する場合は、<command>ip route show</command>を使用します。
   </para>
   <para>
    <command>ip</command>の使用方法の詳細については、<command>ip</command><option>help</option>を入力するか、または<systemitem>ip(8)</systemitem>マニュアルページを参照してください。<option>help</option>オプションは、すべての<command>ip</command>サブコマンドに関して利用できます。たとえば、<command>ip</command> <option>addr</option>のヘルプが必要な場合は、<command>ip</command><option>addr help</option>と入力します。<command>ip</command>マニュアルについては、 <filename>/usr/share/doc/packages/iproute2/ip-cref.pdf</filename>を参照してください。
   </para>
  </sect3>
  <sect3 id="sec.basicnet.manconf.testingping">
   <title>pingを使った接続のテスト</title><indexterm> <primary>コマンド</primary> <secondary>ping</secondary> </indexterm> <indexterm> <primary>ping</primary> </indexterm>
   <para>
    <command>ping</command>コマンドは、TCP/IP接続が正常に動作しているかどうかを調べるための、標準ツールです。pingコマンドはICMPプロトコルを使って、小さなデータパケットECHO_REQUESTデータグラムを、宛先ホストに送信し、即時応答を要求します。この作業が成功した場合、<command>ping</command>コマンドは、その結果を知らせるメッセージを表示します。これは、ネットワークリンクが基本的に機能していることを意味します。
   </para>
   <para>
    <command>ping</command>は、2台のコンピュータ間の接続機能をテストするだけでなく、接続品質に関する基本的な情報も提供します。ping<xref linkend="ex.basicnet.manconf.ping"/>コマンドの実行結果例は、<command>を参照してください。</command>最後から2番目の行に、転送パケット数、失われたパケット数、および<command>ping</command>の実行時間の合計が記載されています。
   </para>
   <para>
    pingの宛先には、ホスト名またはIPアドレスを指定することができます。たとえば、<command>ping</command> <option>example.com</option>や<command>ping</command> <option>192.168.3.100</option>のように指定します。pingコマンドを実行すると、<keycombo><keycap>Ctrl</keycap><keycap>C</keycap></keycombo>を押すまでの間、継続的にパケットが送信されます。
   </para>
   <para>
    接続されているかどうかを確認するだけで良い場合は、<option>-c</option>オプションを使って送信するパケット数を指定することができます。たとえば、PINGを3パケットに制限する場合は、「<command>ping</command> <option>-c 3 example.com</option>」を入力します。
   </para>
   <example id="ex.basicnet.manconf.ping">
    <title>pingコマンドの出力</title>
<screen>ping -c 3 example.com
PING example.com (192.168.3.100) 56(84) bytes of data.
64 bytes from example.com (192.168.3.100): icmp_seq=1 ttl=49 time=188 ms
64 bytes from example.com (192.168.3.100): icmp_seq=2 ttl=49 time=184 ms
64 bytes from example.com (192.168.3.100): icmp_seq=3 ttl=49 time=183 ms
--- example.com ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2007ms
rtt min/avg/max/mdev = 183.417/185.447/188.259/2.052 ms</screen>
   </example>
   <para>
    デフォルトでは、pingは1秒ごとにパケットを送信します。間隔を変更するには、 <option>-i </option>オプションを指定します。たとえば、pingの間隔を10秒に増やす場合は、「<command>ping</command> <option>-i 10 example.com</option>」と入力します。
   </para>
   <para>
    複数のネットワークデバイスを持つシステムの場合、特定のインタフェースアドレスを指定してpingを実行することができます。その場合は、<option>-I</option>オプションを、選択したデバイスの名前とともに使用します。たとえば、<command>ping</command> <option>-I wlan1 example.com</option>と指定します。
   </para>
   <para>
    pingのオプションと使用方法の詳細については、「<command>ping</command><option>-h</option>」と入力するか、または<systemitem>ping(8)</systemitem>のマニュアルページを参照してください。
   </para>
   <tip>
    <title>IPv6アドレスのping</title>
    <para>
     IPv6の場合は、<command>ping6</command>コマンドを使用します。ただし、リンクローカルアドレスをpingするには、<option>-I</option>でインタフェースを指定する必要があります。アドレスが<literal>eth1</literal>を介して到達可能な場合は、次のコマンドが有効です。
    </para>
<screen>ping6 -I eth1 fe80::117:21ff:feda:a425</screen>
   </tip>
  </sect3>
  <sect3 id="sec.basicnet.manconf.testingifconfig">
   <title>ifconfigを使ったネットワークの設定</title><indexterm> <primary>コマンド</primary> <secondary>ifconfig</secondary> </indexterm>
   <para>
    <command>ifconfig</command>は、ネットワーク設定ツールです。
   </para>
   <note>
    <title><command/>ifconfigとip<command/></title>
    <para>
     <command>ifconfig</command>ツールは廃止されました。代わりに、<command>ip</command>を使用してください。<command>ip</command>と異なり、<command>ifconfig</command>は、インタフェースの設定にのみ使用できます。ただし、インタフェース名は9文字までに制限されます。
    </para>
   </note>
   <para>
    <command>ifconfig</command>に引数を指定しないと、現在アクティブなインタフェースのステータスが表示されます。<xref linkend="ex.basicnet.manconf.ifconfig"/>が示すように、<command>ifconfig</command>は、非常にわかりやすく表示された詳細情報を出力します。この出力では、デバイスのMACアドレス(<option>HWaddr</option>の値)も1行目に表示されています。
   </para>
   <example id="ex.basicnet.manconf.ifconfig">
    <title><command>ifconfig</command>コマンドの出力</title>
<screen>eth0      Link encap:Ethernet  HWaddr 00:08:74:98:ED:51
          inet6 addr: fe80::208:74ff:fe98:ed51/64 Scope:Link
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:634735 errors:0 dropped:0 overruns:4 frame:0
          TX packets:154779 errors:0 dropped:0 overruns:0 carrier:1
          collisions:0 txqueuelen:1000
          RX bytes:162531992 (155.0 Mb)  TX bytes:49575995 (47.2 Mb)
          Interrupt:11 Base address:0xec80

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:8559 errors:0 dropped:0 overruns:0 frame:0
          TX packets:8559 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:533234 (520.7 Kb)  TX bytes:533234 (520.7 Kb)    

wlan1     Link encap:Ethernet  HWaddr 00:0E:2E:52:3B:1D
          inet addr:192.168.2.4  Bcast:192.168.2.255  Mask:255.255.255.0
          inet6 addr: fe80::20e:2eff:fe52:3b1d/64 Scope:Link
          UP BROADCAST NOTRAILERS RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:50828 errors:0 dropped:0 overruns:0 frame:0
          TX packets:43770 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:45978185 (43.8 Mb)  TX bytes:7526693 (7.1 MB)</screen>
   </example>
   <para>
    <command>ifconfig</command>のオプションと使用方法の詳細については、<command>ifconfig</command><option>-h</option>を入力するか、または<systemitem>ifconfig(8)</systemitem>マニュアルページを参照してください。
   </para>
  </sect3>
  <sect3>
   <title><command>route</command>によるルーティングの設定</title><indexterm> <primary>コマンド</primary> <secondary>route</secondary> </indexterm>
   <para>
    <command>route</command>は、IPルーティングテーブルを操作するプログラムです。このコマンドを使用すると、ルーティングの設定を表示したり、ルートを追加または削除できます。
   </para>
   <note>
    <title><command/>routeとip<command/></title>
    <para>
     <command>route</command>プログラムは廃止されました。代わりに、<command>ip</command>を使用してください。
    </para>
   </note>
   <para>
    <command>routeは、総合的なルーティング情報を素早く参照して、ルーティングに関する問題を探す場合などに役立ちます。</command>現在のルーティング設定を表示するには、<systemitem class="username">root</systemitem>として<command>route</command> <option>-n</option>を入力します。
   </para>
   <example id="ex.basicnet.manconf.route">
    <title><command>route <option>-n</option></command>コマンドの出力</title>
<screen><?dbsuse-fo font-size="7pt"?>

route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface
10.20.0.0       *               255.255.248.0   U         0 0          0 eth0
link-local      *               255.255.0.0     U         0 0          0 eth0
loopback        *               255.0.0.0       U         0 0          0 lo
default         styx.exam.com   0.0.0.0         UG        0 0          0 eth0</screen>
   </example>
   <para>
    routeのオプションと使用方法の詳細については、「<command>route</command><option>-h</option>」を入力するか、または<systemitem>route (8)</systemitem>マニュアルページを参照してください。
   </para>
  </sect3>
 </sect2>

 <sect2 id="sec.basicnet.manconf.scripts">
  <title>スタートアップスクリプト</title><indexterm> <primary>スクリプト</primary> <secondary>init.d</secondary> </indexterm>
  <para>
   前述の環境設定ファイルに加え、マシンのブート時にネットワークプログラムをロードするさまざまなスクリプトも用意されています。これらは、システムが<emphasis>マルチユーザランレベル</emphasis>のいずれかに切り替わったときに起動します。これらのスクリプトの一部は、<xref linkend="tab.netz.start.skripte"/>で説明されています。
  </para>
  <table id="tab.netz.start.skripte">
<?dbsuse-latex tablehead="p{.4\linewidth}p{.55\linewidth}"?>


   <title>ネットワークプログラム用スタートアップスクリプト</title>
   <tgroup cols="2" align="left">
    <tbody>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/network</filename> <indexterm> <primary>スクリプト</primary> <secondary>init.d</secondary> <tertiary>ネットワーク</tertiary> </indexterm>
       </para>
      </entry>
      <entry>
       <para>
        このスクリプトは、ネットワークインタフェースの環境設定を処理します。<command>network</command>サービスが開始されなかった場合、ネットワークインタフェースは実装されません。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/xinetd</filename> <indexterm> <primary>スクリプト</primary> <secondary>init.d</secondary> <tertiary>xinetd</tertiary> </indexterm>
       </para>
      </entry>
      <entry>
       <para>
        xinetdを開始します。xinetdを使用すると、サーバサービスがシステム上で利用できるようになります。たとえば、FTP接続の開始時に必ずvsftpdを起動することができます。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/rpcbind</filename> <indexterm> <primary>スクリプト</primary> <secondary>init.d</secondary> <tertiary>rpcbind</tertiary> </indexterm>
       </para>
      </entry>
      <entry>
       <para>
        RPCプログラム番号をユニバーサルアドレスに変換するrpcbindユーティリティを起動します。NFSサーバなどのRPCサービスで必要です。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/nfsserver</filename><indexterm> <primary>スクリプト</primary> <secondary>init.d</secondary> <tertiary>nfsserver</tertiary> </indexterm>
       </para>
      </entry>
      <entry>
       <para>
        NFSサーバを起動します。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/postfix</filename><indexterm> <primary>スクリプト</primary> <secondary>init.d</secondary> <tertiary>postfix</tertiary> </indexterm>
       </para>
      </entry>
      <entry>
       <para>
        postfixプロセスを制御します。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/ypserv</filename><indexterm> <primary>スクリプト</primary> <secondary>init.d</secondary> <tertiary>ypserv</tertiary> </indexterm>
       </para>
      </entry>
      <entry>
       <para>
        NISサーバを起動します。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/ypbind</filename><indexterm> <primary>スクリプト</primary> <secondary>init.d</secondary> <tertiary>ypbind</tertiary> </indexterm>
       </para>
      </entry>
      <entry>
       <para>
        NISクライアントを起動します。
       </para>
      </entry>
     </row>
    </tbody>
   </tgroup>
  </table><indexterm startref="idx.networks_configuring" class="endofrange"/><indexterm startref="idx.configuring_networks_manually" class="endofrange"/>
 </sect2>
</sect1>
