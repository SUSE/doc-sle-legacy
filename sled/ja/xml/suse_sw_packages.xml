<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet href="urn:x-suse:xslt:profiling:docbook51-profile.xsl"
    type="text/xml"
    title="Profiling step"
?>
<!DOCTYPE sect1
[
   <!ENTITY % entities SYSTEM "entity-decl.ent">
   %entities;
]>


<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<section xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.1" xml:base="suse_sw_packages.xml" xml:id="sec-suse-packages">
 <title>特殊ソフトウェアパッケージ</title>

 <para>
  <systemitem class="resource">bash</systemitem>、<systemitem class="resource">cron</systemitem>、<systemitem class="resource">logrotate</systemitem>、<systemitem class="resource">locate</systemitem>、<systemitem class="resource">ulimit</systemitem>、<systemitem class="resource">free</systemitem>といったプログラムは、システム管理者および多くのユーザにとって非常に重要です。manのページとinfoのページは、コマンドについての2つの役立つ情報源ですが、その両方が常に利用できるとは限りません。GNU Emacsは、人気のある、自由度に設定できるテキストエディタです。
 </para>

 <section xml:id="sec-suse-packages-bash">
  <title>bashパッケージと/etc/profile</title><indexterm> <primary>Bash</primary> <secondary>プロファイル</secondary> </indexterm> <indexterm> <primary>環境設定ファイル</primary> <secondary>プロファイル</secondary> </indexterm>
  <para>
   Bashはデフォルトのシステムシェルです。ログインシェルとして使用する場合には、いくつかの初期化ファイルを読み込みます。Bashは、各ファイルを次の順序で処理します。
  </para>



  <orderedlist spacing="normal">
   <listitem>
    <para>
     <filename>/etc/profile</filename>
    </para>
   </listitem>
   <listitem>
    <para>
     <filename>~/.profile</filename>
    </para>
   </listitem>
   <listitem>
    <para>
     <filename>/etc/bash.bashrc</filename>
    </para>
   </listitem>
   <listitem>
    <para>
     <filename>~/.bashrc</filename>
    </para>
   </listitem>
  </orderedlist><indexterm> <primary>Bash</primary> <secondary>.bashrc</secondary> </indexterm> <indexterm> <primary>Bash</primary> <secondary>.profile</secondary> </indexterm> <indexterm> <primary>環境設定ファイル</primary> <secondary>.bashrc</secondary> </indexterm> <indexterm> <primary>環境設定ファイル</primary> <secondary>.profile</secondary> </indexterm>
  <para>
   <filename>~/.profile</filename>または<filename>~/.bashrc</filename>に、カスタム設定を行います。これらのファイルを正しく処理するには、基本設定ファイル<filename>/etc/skel/.profile</filename>または<filename>/etc/skel/.bashrc</filename>を、ユーザのホームディレクトリにコピーする必要があります。更新後、<filename>/etc/skel</filename>から設定ファイルをコピーすることをお勧めします。次のシェルコマンドを実行して、既存の個人別設定が失われるのを防止します。
  </para>
<screen>mv ~/.bashrc ~/.bashrc.old
cp /etc/skel/.bashrc ~/.bashrc
mv ~/.profile ~/.profile.old
cp /etc/skel/.profile ~/.profile</screen>
  <para>
   それから、個人的な調整点を、<literal>*.old</literal>ファイルから書き戻します。

  </para>
 </section>

 <section xml:id="sec-suse-packages-cron">

  <title>cronパッケージ</title><indexterm> <primary>cron</primary> </indexterm> <indexterm> <primary>環境設定ファイル</primary> <secondary>crontab</secondary> </indexterm>
  <para>
   コマンドを、前もって決めた時間に、定期的かつ自動的にバックグラウンドで実行したい場合、cronを用います。cronは特別な形式のタイムテーブルに従って起動します。その一部はシステムに付属しています。ユーザは必要に応じ、独自のテーブルを作成できます。
  </para>
  <para>
   cronテーブルは、<filename>/var/cron/tabs</filename>にあります。<filename>/etc/crontab</filename>はシステム全体のcronテーブルとして機能します。ユーザ名を入力して、タイムテーブルの後、コマンドの前に直接コマンドを実行するようにします。<xref linkend="ex-suse-packages-cron"/>では、<systemitem class="username">root</systemitem>が入力されています。<filename>/etc/cron.d</filename>にあるパッケージ固有のテーブルも同じ形式です。<command>cron</command>のマニュアルページを参照してください(<command>man cron</command>使用)。
  </para>
  <example xml:id="ex-suse-packages-cron">
   <title>/etc/crontab内のエントリ</title>
<screen>1-59/5 * * * *   root   test -x /usr/sbin/atrun &amp;&amp; /usr/sbin/atrun</screen>
  </example>
  <para>
   <filename>/etc/crontab</filename>を、<command>crontab -e</command>コマンドで編集することはできません。これは、エディタに直接ロードして、変更し、保存する必要があります。
  </para>
  <para>
   複数のパッケージによりシェルスクリプトが<filename>/etc/cron.hourly</filename>、<filename>/etc/cron.daily</filename>、<filename>/etc/cron.weekly</filename>、および<filename>/etc/cron.monthly</filename>の各ディレクトリにインストールされます。これらの実行は、<filename>/usr/lib/cron/run-crons</filename>によって制御されます。<filename>/usr/lib/cron/run-crons</filename>は、 15分おきにメインテーブル(<filename>/etc/crontab</filename>)から実行されます。これにより、無視されていたプロセスが、適切な時刻に実行されることが保証されます。
  </para>
  <para>
   <filename>hourly</filename>、<filename>daily</filename>、または他の特定の周期の管理スクリプトをカスタム時間で実行するには、<filename>/etc/crontab</filename>のエントリを使用して、定期的にタイムスタンプファイルを削除します(<xref linkend="ex-suse-packages-cron-time"/>を参照してください。そこでは、<filename>hourly</filename>という名前の付いているファイルが毎時59分に、<filename>daily</filename>という名前の付いているファイルが毎日午前2時14分に削除されるようになっています)。
  </para>
  <example xml:id="ex-suse-packages-cron-time">
   <title>/etc/crontab:タイムスタンプファイルの削除</title>
<screen>59 *  * * *     root  rm -f /var/spool/cron/lastrun/cron.hourly
14 2  * * *     root  rm -f /var/spool/cron/lastrun/cron.daily
29 2  * * 6     root  rm -f /var/spool/cron/lastrun/cron.weekly
44 2  1 * *     root  rm -f /var/spool/cron/lastrun/cron.monthly</screen>
  </example>
  <para>
   または、<literal>/etc/sysconfig/cron</literal>の<filename>DAILY_TIME</filename>を<filename>cron.daily</filename>を起動する時刻に設定します。<literal>MAX_NOT_RUN</literal>の設定では、ユーザが長期間、指定した<literal>DAILY_TIME</literal>にコンピュータを起動しなくても、毎日のタスクの実行がトリガされるようにします。<literal>MAX_NOT_RUN</literal>の最大値は14日です。
  </para>
  <para>
   日常のシステムメンテナンスジョブは、わかりやすいようにさまざまなスクリプトに分散されています。これらはパッケージ<systemitem class="resource">aaa_base</systemitem>に含まれています。<filename>/etc/cron.daily</filename>に含まれています。このパッケージには、たとえば、コンポーネント<filename>suse.de-backup-rpmdb</filename>、<filename>suse.de-clean-tmp</filename>、または<filename>suse.de-cron-local</filename>が含まれています。
   
  </para>
 </section>

 <xi:include href="suse_logfiles.xml" parse="xml"/>

 <section xml:id="sec-suse-locate">
  <title>locateコマンド</title><indexterm> <primary>ファイル</primary> <secondary>検索</secondary> </indexterm> <indexterm> <primary>locate</primary> </indexterm>
  <para>
   ファイルをすばやく検索するためのコマンド<command>locate</command>は、標準のインストール済みソフトウェアには含まれていません。必要であれば、パッケージ<systemitem>findutils-locate</systemitem>をインストールしてください。updatedbプロセスは、毎晩、またはシステムをブートしてから約15分で自動的に起動します。
  </para>
 </section>

 <section xml:id="sec-suse-ulimit">
  <title>ulimitコマンド</title><indexterm> <primary>ulimit</primary> </indexterm> <indexterm> <primary>コアファイル</primary> </indexterm> <indexterm> <primary>システム</primary> <secondary>リソースの使用制限</secondary> </indexterm>
  <para>
   <command>ulimit</command>(<emphasis>user limits</emphasis>)コマンドを使用すると、システムリソースの使用量に制限を設定して、それを表示できます。<command>ulimit</command>はアプリケーションが使用できるメモリの制限に特に役立ちます。これを使用して、アプリケーションがシステムリソースを過剰に使用して速度が低下したり、オペレーティングシステムをハングさせたりすることを防止できます。
  </para>
  <para>
   <command>ulimit</command>コマンドには、さまざまなオプションがあります。メモリの使用量を制限するには、<xref linkend="tab-suse-packages-ulimit"/>に示すオプションを使用します。
  </para><indexterm> <primary>ulimit</primary> <secondary>オプション</secondary> </indexterm>
  <table xml:id="tab-suse-packages-ulimit">
   <title><command>ulimit</command>:ユーザのためのリソースの設定</title>

   <tgroup cols="2">
    <tbody>
     <row>
      <entry>
       <para>
        <option>-m</option>
       </para>
      </entry>
      <entry>
       <para>
        最大常駐セットサイズ
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>-v</option>
       </para>
      </entry>
      <entry>
       <para>
        シェルが使用できる仮想メモリの最大量
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>-s</option>
       </para>
      </entry>
      <entry>
       <para>
        最大スタックサイズ
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>-c</option>
       </para>
      </entry>
      <entry>
       <para>
        作成されるコアファイルの最大サイズ
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <option>-a</option>
       </para>
      </entry>
      <entry>
       <para>
        すべての現在の制限値の報告
       </para>
      </entry>
     </row>
    </tbody>
   </tgroup>
  </table><indexterm> <primary>環境設定ファイル</primary> <secondary>プロファイル</secondary> </indexterm>
  <para>
   システム全体のエントリは、<filename>/etc/profile</filename>で設定できます。コアファイルの作成を有効にします(プログラマが<emphasis>デバッグ</emphasis>を行うために必要)。通常のユーザは、<filename>/etc/profile</filename>ファイルでシステム管理者が指定した値を大きくすることはできませんが、<filename>~/.bashrc</filename>に特別なエントリを作成することは可能です。
  </para><indexterm> <primary>環境設定ファイル</primary> <secondary>.bashrc</secondary> </indexterm>
  <example xml:id="ex-u-ulimit-bashrc">
   <title>ulimit:~/.bashrc中の設定</title>
<screen># Limits maximum resident set size (physical memory):
ulimit -m 98304
 
# Limits of virtual memory:
ulimit -v 98304</screen>
  </example>
  <para>
   メモリ割り当ては、KB単位で指定する必要があります。詳細については、<command>man bash</command>コマンドでマニュアルページを参照してください。
  </para>
  <important>
   <para>
    すべてのシェルが<command>ulimit</command>ディレクティブをサポートするわけではありません。ユーザが制約を包括的に設定する必要がある場合、PAM(たとえば、<literal>pam_limits</literal>)を使用すれば、包括的な調整が可能になります。
   </para>
  </important>
 </section>

 <section xml:id="sec-suse-free">
  <title>freeコマンド</title><indexterm> <primary>メモリ</primary> <secondary>RAM</secondary> </indexterm> <indexterm> <primary>コマンド</primary> <secondary>free</secondary> </indexterm>
  <para>
   <command>free</command>コマンドは、空いている物理メモリ、使用済み物理メモリ、システム内のスワップ領域のほか、カーネルによって消費されたバッファとキャッシュの合計量を表示します。利用可能な RAM<emphasis> という概念は、統一的なメモリ管理が生まれる以前の遺物です。</emphasis>空きメモリは悪いメモリ<emphasis>というスローガンは、Linux にぴったりです。</emphasis>結果として、Linuxでは、空きメモリや未使用メモリを実質的に発生させず、キャッシュの量を調整するよう努力が重ねられてきました。
  </para>
  <para>
   基本的に、カーネルは、アプリケーションやユーザデータについての直接的な知識はありません。その代わりにカーネルは、<emphasis>ページキャッシュ</emphasis>のアプリケーションとユーザデータを管理します。メモリが不足すると、その一部はスワップパーティションかファイルに書き込まれ、そこから <command>mmap</command>コマンドで読み込まれます(<command>man mmap</command> コマンドでmanページを参照)。
  </para><indexterm> <primary>カーネル</primary> <secondary>キャッシュ</secondary> </indexterm>
  <para>
   カーネルには、たとえば、ネットワークアクセスに使用されたキャッシュが格納されている<emphasis>slabキャッシュ</emphasis>などの別のキャッシュがあります。これが<filename>/proc/meminfo</filename>のカウンタ間の違いになります。全部ではありませんが、これらのキャッシュのほとんどは、<filename>/proc/slabinfo</filename>でアクセスできます。
  </para>
  <para>
   ただし、目的が現在のRAM使用量である場合は、<filename>/proc/meminfo</filename>で情報を見つけてください。
  </para>
 </section>

 <section xml:id="sec-suse-manpages">
  <title>manページとinfoページ</title><indexterm> <primary>マニュアルページ</primary> </indexterm> <indexterm> <primary>infoページ</primary> </indexterm> <indexterm> <primary>ヘルプ</primary> <secondary>マニュアルページ</secondary> </indexterm> <indexterm> <primary>ヘルプ</primary> <secondary>infoページ</secondary> </indexterm>
  <para>
   一部のGNUアプリケーション(tarなど)では、manページが提供されなくなりました。manページが用意されていたコマンドについては、<option>--help</option>オプションを使用して簡単な概要を表示するか、詳細な手順を説明するinfoページを使用します。infoは、GNUのハイパーテキストシステムです。このシステムについての説明は、「<command>info</command> <option>info</option>」と入力してください。Info ページは、「<command>emacs</command> <option> -f info</option>」コマンドを入力してEmacsを起動するか、コンソールで直接「<command>info</command>」と入力します。あるいは、tkinfo、xinfo、またはヘルプシステムを使用して、infoページを表示できます。
  </para>
 </section>



 <section xml:id="sec-suse-packages-man">
  <title><command>man</command>コマンドを使用したマニュアルページの選択</title>
  <para>
   マニュアルページを読み込むには、<command>man マニュアルページ</command> <replaceable/>を入力します。同じ名前でさまざまなセクションに存在するマニュアルページは、対応するセクション番号とともに一覧表示されます。表示するマニュアルページを選択します。セクション番号を数秒内に入力しないと、最初のマニュアルページが表示されます。
  </para>
  <para>
   これをデフォルトのシステム動作に戻すには、<filename>~/.bashrc</filename>などのシェル初期化ファイルで<literal>MAN_POSIXLY_CORRECT=1</literal>を設定します。
  </para>
 </section>

 <xi:include href="suse_emacs.xml" parse="xml"/>
</section>
