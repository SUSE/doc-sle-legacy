<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet href="urn:x-suse:xslt:profiling:docbook51-profile.xsl"
    type="text/xml"
    title="Profiling step"
?>
<!DOCTYPE sect1
[
   <!ENTITY % entities SYSTEM "entity-decl.ent">
   %entities;
]>


<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<section xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.1" xml:base="net_config_files.xml" xml:id="sec-basicnet-manconf">
 <title>Configurando uma conexão de rede manualmente</title><indexterm xml:id="idx-networks-configuring" class="startofrange"> <primary>redes</primary> <secondary>configurando</secondary> </indexterm> <indexterm xml:id="idx-configuring-networks-manually" class="startofrange"> <primary>configurando</primary> <secondary>redes</secondary> <tertiary>manualmente</tertiary> </indexterm>

 <para>
  A configuração manual do software de rede deve ser sempre a última alternativa. É recomendável usar o YaST. Entretanto, essas informações de base sobre a configuração de rede também podem ajudar você na utilização do YaST.
 </para>



 <para>
  Quando o Kernel detecta uma placa de rede e cria uma interface de rede correspondente, ele atribui um nome de dispositivo de acordo com a ordem de descoberta de dispositivos ou a ordem de carregamento dos módulos do Kernel. Os nomes de dispositivos padrão do Kernel são previsíveis apenas em ambientes de hardware muito simples ou altamente controlados. Os sistemas que permitem adicionar ou remover hardware durante o tempo de execução ou que suportam a configuração automática de dispositivos não podem contar com nomes estáveis de dispositivos de rede atribuídos pelo Kernel durante as reinicializações.
 </para>

 <para>
  Entretanto, todas as ferramentas de configuração do sistema contam com nomes de interface persistentes. Esse problema é solucionado pelo udev. O gerador de rede persistente udev (<filename>/lib/udev/rules.d/75-persistent-net-generator.rules</filename>) gera uma regra que corresponde ao hardware (usando seu endereço de hardware por padrão) e atribui uma interface exclusiva persistente ao hardware. O banco de dados de interfaces de rede do udev fica armazenado no arquivo <filename>/etc/udev/rules.d/70-persistent-net.rules</filename>. Todas as linhas do arquivo descrevem uma interface de rede e especifique seu nome persistente. Os administradores de sistema podem mudar os nomes atribuídos editando as entradas <literal>NAME=""</literal>. As regras persistentes também podem ser modificadas por meio do YaST.
 </para>

 <para>
  A <xref linkend="tab-net-script-conf"/> resume os scripts mais importantes envolvidos na configuração de rede.
 </para>

 <table xml:id="tab-net-script-conf">
  <title>Scripts de configuração de rede manual</title>
  <tgroup cols="2">
   <thead>
    <row>
     <entry>
      <para>
       Comando
      </para>
     </entry>
     <entry>
      <para>
       Função
      </para>
     </entry>
    </row>
   </thead>
   <tbody>
    <row>
     <entry>
      <para>
       <command>ifup, ifdown, ifstatus</command>
      </para>
     </entry>
     <entry>
      <para>
       Os scripts <literal>if</literal> iniciam ou param interfaces de rede ou retornam o status da interface especificada. Para obter mais informações, consulte a página de manual <systemitem>ifup</systemitem>.
      </para>
     </entry>
    </row>
    <row>
     <entry>
      <para>
       <command>rcnetwork</command>
      </para>
     </entry>
     <entry>
      <para>
       O script <literal>rcnetwork</literal> pode ser usado para iniciar, parar ou reiniciar todas as interfaces de rede (ou apenas uma específica). Use <command>rcnetwork stop</command> para parar, <command>rcnetwork start</command> para iniciar e <command>rcnetwork restart</command> para reiniciar interfaces de rede. Se você quiser parar, iniciar ou reiniciar apenas uma interface, use o comando seguido pelo nome da interface, por exemplo, <command>rcnetwork restart eth0</command>. O comando <command>rcnetwork status</command> exibe o estado das interfaces, seus endereços IP e indica se há um cliente DHCP em execução. Com <command>rcnetwork stop-all-dhcp-clients</command> e <command>rcnetwork restart-all-dhcp-clients</command>, você pode parar ou reiniciar clientes DHCP em execução nas interfaces de rede.
      </para>
     </entry>
    </row>
   </tbody>
  </tgroup>
 </table>

 <para>
  Para obter mais informações sobre o udev e os nomes de dispositivo persistentes, consulte o <xref linkend="cha-udev"/>.
 </para>

 <section xml:id="sec-basicnet-manconf-files">
  <title>Arquivos de configuração</title><indexterm> <primary>arquivos de configuração</primary> </indexterm> <indexterm xml:id="idx-networks-configuration-files" class="startofrange"> <primary>redes</primary> <secondary>arquivos de configuração</secondary> </indexterm>
  <para>
   Esta seção fornece uma visão geral dos arquivos de configuração de rede e explica sua finalidade e formato usado.
  </para>
  <section xml:id="sec-basicnet-manconf-files-ifcfg">
   <title><filename>/etc/sysconfig/network/ifcfg-*</filename></title>
   <para>
    Esses arquivos contêm as configurações de interfaces de rede. Eles incluem informações, como o modo de início e o endereço IP. Os parâmetros possíveis são descritos na página de manual de <systemitem>ifup</systemitem>. Além disso, a maioria das variáveis do arquivo <filename>dhcp</filename> poderá ser usada nos arquivos <filename>ifcfg-*</filename> se uma configuração geral for usada para apenas uma interface. Entretanto, a maioria das variáveis de <filename>/etc/sysconfig/network/config</filename> é global e não pode ser anulada em arquivos ifcfg. Por exemplo, as variáveis <systemitem>NETWORKMANAGER</systemitem> ou <systemitem>NETCONFIG_*</systemitem> são globais.
   </para>
   <para>
    Para saber sobre o <filename>ifcfg.template</filename>, consulte a <xref linkend="sec-basicnet-manconf-files-config-etc"/>.
   </para><indexterm> <primary>arquivos de configuração</primary> <secondary>ifcfg-*</secondary> </indexterm>
   
  </section>
  <section xml:id="sec-basicnet-manconf-files-config-etc">
   <title><filename>/etc/sysconfig/network/config</filename> e <filename>/etc/sysconfig/network/dhcp</filename></title><indexterm> <primary>arquivos de configuração</primary> <secondary>rede</secondary></indexterm><indexterm> <primary>arquivos de configuração</primary> <secondary>dhcp</secondary></indexterm>
   <para>
    O arquivo <filename>config</filename> contém configurações gerais para o comportamento de <command>ifup</command>, <command>ifdown</command> e <command>ifstatus</command>. <filename>dhcp</filename> contém configurações para DHCP. As variáveis em ambos os arquivos de configuração são comentadas. Algumas das variáveis de <filename>/etc/sysconfig/network/config</filename> também podem ser usadas nos arquivos <filename>ifcfg-*</filename>, nos quais recebem prioridade mais alta. O arquivo <filename>/etc/sysconfig/network/ifcfg.template</filename> lista as variáveis que podem ser especificadas para cada interface. Entretanto, a maioria das variáveis de <filename>/etc/sysconfig/network/config</filename> é global e não pode ser anulada em arquivos ifcfg. Por exemplo, as variáveis <systemitem>NETWORKMANAGER</systemitem> ou <systemitem>NETCONFIG_*</systemitem> são globais.
   </para>
  </section>
  <section>
   <title><filename>/etc/sysconfig/network/routes</filename> e <filename>/etc/sysconfig/network/ifroute-*</filename></title><indexterm xml:id="idx-routing" class="startofrange"> <primary>roteamento</primary> </indexterm> <indexterm> <primary>roteamento</primary> <secondary>rotas</secondary> </indexterm> <indexterm> <primary>arquivos de configuração</primary> <secondary>rotas</secondary> </indexterm> <indexterm> <primary>configurando</primary> <secondary>roteamento</secondary> </indexterm>
   <para>
    O roteamento estático dos pacotes TCP/IP é determinado aqui. Todas as rotas estáticas requeridas pelas várias tarefas do sistema podem ser digitadas no arquivo <filename>/etc/sysconfig/network/routes</filename> file: rotas para um host, rotas para um host via gateway e rotas para uma rede. Para cada interface que precisa de roteamento individual, defina um arquivo de configuração adicional: <filename>/etc/sysconfig/network/ifroute-*</filename>. Substitua <literal>*</literal> pelo nome da interface. As entradas nos arquivos de configuração de roteamento terão esta aparência: <indexterm> <primary>roteamento</primary> <secondary>estático</secondary> </indexterm>
   </para>
<screen># Destination     Dummy/Gateway     Netmask            Device
#
127.0.0.0         0.0.0.0           255.255.255.0      lo
204.127.235.0     0.0.0.0           255.255.255.0      eth0
default           204.127.235.41    0.0.0.0            eth0
207.68.156.51     207.68.145.45     255.255.255.255    eth1
192.168.0.0       207.68.156.51     255.255.0.0        eth1</screen>
   <para>
    O destino da rota está na primeira coluna. Essa coluna pode conter o endereço IP de uma rede ou host ou, no caso de servidores de nomes <emphasis>acessíveis</emphasis>, a rede ou o nome completo do host.
   </para>
   <para>
    A segunda coluna contém o gateway padrão ou um gateway por meio do qual um host ou uma rede podem ser acessados. A terceira coluna contém a máscara de rede para redes ou hosts atrás de um gateway. Por exemplo, a máscara em <systemitem class="netmask">255.255.255.255</systemitem> para um host atrás de um gateway.
   </para>
   <para>
    A quarta coluna só é relevante para redes conectadas ao host local, como loopback, Ethernet, ISDN, PPP e dispositivo simulado. O nome do dispositivo deve ser digitado aqui.
   </para>
   <para>
    Uma quinta coluna (opcional) pode ser usada para especificar o tipo de uma rota. As colunas desnecessárias devem conter um sinal de subtração <literal>-</literal> para garantir que o analisador interpretará o comando corretamente. Para obter mais detalhes, consulte a página de manual <systemitem>routes(5)</systemitem>.
   </para>
   <para>
    O formato unificado para IPv4 e IPv6 agora tem a seguinte aparência:
   </para>
<screen><replaceable>prefix</replaceable>/<replaceable>length</replaceable><replaceable>gateway</replaceable> -            [<replaceable>interface</replaceable>]
</screen>
   <para>
    E o chamado formato de compatibilidade tem esta aparência:
   </para>
<screen><replaceable>prefix</replaceable><replaceable>gateway</replaceable><replaceable>length</replaceable>       [<replaceable>interface</replaceable>]
</screen>
   <para>
    Para IPv4 ainda pode-se usar o antigo formato com máscara de rede:
   </para>
<screen><replaceable>ipv4-network</replaceable><replaceable>gateway</replaceable><replaceable>ipv4-netmask</replaceable> [<replaceable>interface</replaceable>]
</screen>
   <para>
    Os exemplos seguintes são equivalentes:
   </para>
<screen>2001:db8:abba:cafe::/64 2001:db8:abba:cafe::dead  -            eth0
208.77.188.0/24         208.77.188.166            -            eth0

2001:db8:abba:cafe::    2001:db8:abba:cafe::dead 64            eth0
208.77.188.0            208.77.188.166           24            eth0

208.77.188.0            208.77.188.166           255.255.255.0 eth0
</screen>
<indexterm class="endofrange" startref="idx-routing"/>
  </section>
  <section>
   <title><filename>/etc/resolv.conf</filename></title><indexterm> <primary>arquivos de configuração</primary> <secondary>resolv.conf</secondary> </indexterm>
   <para>
    O domínio ao qual o host pertence é especificado neste arquivo (palavra-chave <systemitem>search</systemitem>). Também está listado o status do endereço do servidor de nomes para acesso (palavra-chave <systemitem>nameserver</systemitem>). Vários nomes de domínio podem ser especificados no arquivo. Durante a resolução de um nome incompleto, uma tentativa de gerar um nome será feita, anexando as entradas de <systemitem>pesquisa</systemitem> individuais. Vários servidores de nomes podem ser especificados em várias linhas, cada uma delas começando com <systemitem>nameserver</systemitem>. Comentários são precedidos pelo sinal <literal>#</literal>. O <xref linkend="dat-netz-etc-resolv-conf"/> exemplifica como pode ser a aparência do <filename>/etc/resolv.conf</filename>. <indexterm> <primary>DNS</primary> <secondary>domínios</secondary> </indexterm> <indexterm> <primary>DNS</primary> <secondary>servidores de nomes</secondary> </indexterm>
   </para>
   <para>
    Entretanto, o <filename>/etc/resolv.conf</filename> não deve ser editado manualmente. Isso porque ele é gerado pelo script <command>netconfig</command>. Para definir configurações DNS estáticas sem usar o YaST, edite as variáveis apropriadas manualmente no arquivo <filename>/etc/sysconfig/network/config</filename>:
   </para>
   <variablelist>
    <varlistentry>
     <term><systemitem>NETCONFIG_DNS_STATIC_SEARCHLIST</systemitem>
     </term>
     <listitem>
      <para>
       lista de nomes de domínio DNS usada para pesquisa de nome de host
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>NETCONFIG_DNS_STATIC_SERVERS</systemitem>
     </term>
     <listitem>
      <para>
       lista de endereços IP de servidor de nomes usada para pesquisa de nome de host
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>NETCONFIG_DNS_FORWARDER</systemitem>
     </term>
     <listitem>
      <para>
       define o nome do forwarder de DNS que precisa ser configurado
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    Para desabilitar a configuração do DNS usando o netconfig, defina <literal>NETCONFIG_DNS_POLICY=''</literal>. Para obter mais informações sobre o <command>netconfig</command>, consulte <command>man 8 netconfig</command>.
   </para>
   <example xml:id="dat-netz-etc-resolv-conf">
    <title><filename>/etc/resolv.conf</filename></title>
<screen># Our domain
search example.com
#
# We use dns.example.com (192.168.1.116) as name server
nameserver 192.168.1.116</screen>
   </example>
  </section>

  <section xml:id="sec-basicnet-manconf-netconfig">
   <title><filename>/sbin/netconfig</filename></title>
   <para>
    O <command>netconfig</command> é uma ferramenta modular destinada a gerenciar configurações de rede adicionais. Ele funde as configurações definidas estaticamente com as configurações fornecidas pelos mecanismos de configuração automática, como DHCP ou PPP, de acordo com uma política predefinida. As mudanças necessárias são aplicadas ao sistema chamando-se os módulos do netconfig responsáveis pela modificação de um arquivo de configuração e pela reinicialização de um serviço ou uma ação semelhante.
   </para>
   <para>
    O <command>netconfig</command> reconhece três ações principais. Os comandos <command>netconfig modify</command> e <command>netconfig remove</command> são usados por daemons, como DHCP ou PPP, para fornecer ou remover configurações do netconfig. Apenas o comando <command>netconfig update</command> está disponível para o usuário:
   </para>
   <variablelist>
    <varlistentry>
     <term><command>modify</command>
     </term>
     <listitem>
      <para>
       O comando <command>netconfig modify</command> modifica as configurações dinâmicas específicas de interface e serviço, além de atualizar a configuração da rede. O netconfig lê as configurações da entrada padrão ou de um arquivo especificado pela opção <option>--lease-file <replaceable>nome_de_arquivo</replaceable></option> e as armazena internamente até a próxima reinicialização do sistema (ou a próxima ação modify ou remove). As configurações que já existirem para a mesma combinação de interface e serviço serão sobregravadas. A interface é especificada pelo parâmetro <option>-i <replaceable>nome_da_interface</replaceable></option>. O serviço é especificado pelo parâmetro <option>-s <replaceable>nome_do_serviço</replaceable></option>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>remove</command>
     </term>
     <listitem>
      <para>
       O comando <command>netconfig remove</command> remove as configurações dinâmicas fornecidas por uma ação modificadora para a combinação de interface e serviço especificada, além de atualizar a configuração da rede. A interface é especificada pelo parâmetro <option>-i <replaceable>nome_da_interface</replaceable></option>. O serviço é especificado pelo parâmetro <option>-s <replaceable>nome_do_serviço</replaceable></option>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>update</command>
     </term>
     <listitem>
      <para>

       O comando <command>netconfig update</command> atualiza a configuração da rede usando as configurações atuais. Isso é útil quando a política ou a configuração estática é mudada. Use o parâmetro <option>-m <replaceable>tipo_de_módulo</replaceable></option> se desejar atualizar apenas um serviço especificado (<systemitem>dns</systemitem>,<systemitem>nis</systemitem> ou <systemitem>ntp</systemitem>).
      </para>
     </listitem>
    </varlistentry>
   </variablelist>

   <para>
    A política do netconfig e as configurações estáticas são definidas manualmente ou por meio do YaST no arquivo <filename>/etc/sysconfig/network/config</filename>. As configurações dinâmicas fornecidas pelas ferramentas de configuração automática, como DHCP ou PPP, são entregues diretamente por essas ferramentas com as ações <command>netconfig modify</command> e <command>netconfig remove</command>. O NetworkManager também usa as ações <command>netconfig modify</command> e <command>netconfig remove</command>. Quando o NetworkManager está habilitado, o netconfig (no modo de política <literal>auto</literal>) usa apenas as configurações do NetworkManager, ignorando as configurações de qualquer outra interface configurada pelo método tradicional ifup. Se o NetworkManager não fornecer nenhuma configuração, as configurações estáticas serão usadas como fallback. Não há suporte para a utilização mista do NetworkManager nem para o método tradicional ifup.
   </para>
   <para>
    Para obter mais informações sobre o <command>netconfig</command>, consulte <command>man 8 netconfig</command>.
   </para>
  </section>
  <section xml:id="sec-basicnet-manconf-hosts">
   <title><filename>/etc/hosts</filename></title><indexterm> <primary>arquivos de configuração</primary> <secondary>hosts</secondary> </indexterm>
   <para>
    Nesse arquivo, mostrado no <xref linkend="dat-netz-etc-hosts"/>, os endereços IP são designados a nomes de host. Se nenhum servidor de nomes for implementado, todos os hosts nos quais uma conexão IP for configurada precisarão ser listados aqui. Para cada host, digite uma linha no arquivo com o endereço IP, o nome completo do host e o nome de host. O endereço IP precisa estar no início da linha e as entradas separadas por espaços vazios e guias. Comentários são sempre precedidos pelo sinal <literal>#</literal>.
   </para>
   <example xml:id="dat-netz-etc-hosts">
    <title><filename>/etc/hosts</filename></title>
<screen>127.0.0.1 localhost
192.168.2.100 jupiter.example.com jupiter
192.168.2.101 venus.example.com venus</screen>
   </example>
  </section>
  <section>
   <title><filename>/etc/networks</filename></title><indexterm> <primary>arquivos de configuração</primary> <secondary>redes</secondary> </indexterm>
   <para>
    Aqui, os nomes de rede são convertidos em endereços de rede. O formato é semelhante ao do arquivo <filename>hosts</filename>, exceto que os nomes de rede precedem os endereços. Consulte o <xref linkend="dat-netz-networks"/>.
   </para>
   <example xml:id="dat-netz-networks">
    <title><filename>/etc/networks</filename></title>
<screen>loopback     127.0.0.0
localnet     192.168.0.0</screen>
   </example>
  </section>
  <section>
   <title><filename>/etc/host.conf</filename></title><indexterm> <primary>arquivos de configuração</primary> <secondary>host.conf</secondary> </indexterm>
   <para>
    Resolução de nomes — a conversão de nomes de host e de rede através da biblioteca <emphasis>resolver</emphasis> é controlada por esse arquivo. Esse arquivo é usado somente para programas vinculados a libc4 ou libc5. Para programas glibc atuais, consulte as configurações em <filename>/etc/nsswitch.conf</filename>. Um parâmetro precisa estar sempre independente em sua própria linha. Comentários são precedidos pelo sinal <literal>#</literal>. A <xref linkend="tab-netz-param-hostconf"/> mostra os parâmetros disponíveis. Uma amostra de <filename>/etc/host.conf</filename> é mostrada no <xref linkend="dat-netz-etc-hostconf"/>.
   </para>
   <table xml:id="tab-netz-param-hostconf">
    <title>Parâmetros para /etc/host.conf</title>
    <tgroup cols="2" align="left">
     <tbody>
      <row>
       <entry>
        <para>
         order <emphasis>hosts</emphasis>, <emphasis>bind</emphasis>
        </para>
       </entry>
       <entry>
        <para>
         Especifica em que ordem os serviços são acessados para a resolução de nomes. Os argumentos disponíveis são (separados por espaços vazios ou vírgulas):
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para/>
       </entry>
       <entry>
        <para>
         <emphasis>hosts</emphasis>: pesquisa o arquivo <filename>/etc/hosts</filename>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para/>
       </entry>
       <entry>
        <para>
         <emphasis>bind</emphasis>: acessa um servidor de nomes
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para/>
       </entry>
       <entry>
        <para>
         <emphasis>nis</emphasis>: usa o NIS
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         multi <emphasis>on</emphasis>/<emphasis>off</emphasis>
        </para>
       </entry>
       <entry>
        <para>
         Define se um host digitado em <filename>/etc/hosts</filename> pode ter vários endereços IP.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         nospoof <emphasis>on</emphasis> spoofalert <emphasis>on</emphasis>/<emphasis>off</emphasis>
        </para>
       </entry>
       <entry>
        <para>
         Esses parâmetros influenciam o <emphasis>spoof</emphasis> do servidor de nomes, mas não exercem qualquer influência na configuração da rede.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         trim <emphasis>domainname</emphasis>
        </para>
       </entry>
       <entry>
        <para>
         O nome de domínio especificado é separado do nome de host depois da resolução do nome de host (desde que o nome de host inclua o nome de domínio). Essa opção é útil apenas quando os nomes do domínio local estão no arquivo <filename>/etc/hosts</filename>, mas ainda devem ser reconhecidos com os nomes de domínio anexados.
        </para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </table>
   <example xml:id="dat-netz-etc-hostconf">
    <title><filename>/etc/host.conf</filename></title>
<screen># We have named running
order hosts bind
# Allow multiple address
multi on</screen>
   </example>
  </section>
  <section>
   <title><filename>/etc/nsswitch.conf</filename></title><indexterm> <primary>arquivos de configuração</primary> <secondary>nsswitch.conf</secondary> </indexterm>
   <para>
    O lançamento do GNU C Library 2.0 foi acompanhado pelo lançamento do <emphasis>NSS</emphasis> (Name Service Switch). Consulte a página de manual do <systemitem>nsswitch.conf(5)</systemitem> e <emphasis>The GNU C Library Reference Manual</emphasis> (Manual de Referência da Biblioteca GNU C) para obter mais detalhes. <indexterm> <primary>NSS</primary> </indexterm>
   </para>
   <para>
    A ordem das consultas é definida no arquivo <filename>/etc/nsswitch.conf</filename>. Uma amostra do <filename>nsswitch.conf</filename> é mostrada no <xref linkend="dat-netz-nsswitchconf"/>. Comentários são precedidos pelo sinal <literal>#</literal>. Nesse exemplo, a entrada no banco de dados <filename>hosts</filename> significa que uma solicitação foi enviada para <filename>/etc/hosts</filename> (<option>arquivos</option>) através do DNS.
   </para>
   <example xml:id="dat-netz-nsswitchconf">
    <title><filename>/etc/nsswitch.conf</filename></title>
<screen>passwd:     compat
group:      compat

hosts:      files dns
networks:   files dns

services:   db files
protocols:  db files
rpc:        files
ethers:     files
netmasks:   files
netgroup:   files nis
publickey:  files

bootparams: files
automount:  files nis
aliases:    files nis
shadow:     compat
</screen>
   </example>
   <para>
    Os <quote>bancos de dados</quote> disponíveis em NSS estão listados na <xref linkend="tab-netz-nnswitch-db"/>. <indexterm> <primary>NSS</primary> <secondary>bancos de dados</secondary> </indexterm> As opções de configuração para bancos de dados NSS estão listadas na <xref linkend="tab-netz-nnswitch-conf"/>.
   </para>
   <table xml:id="tab-netz-nnswitch-db">
    <title>Bancos de dados disponíveis por /etc/nsswitch.conf</title>
    <tgroup cols="2" align="left">
     <tbody>
      <row>
       <entry>
        <para>
         <option>aliases</option>
        </para>
       </entry>
       <entry>
        <para>
         Álias de correio implementados por <filename>sendmail</filename>; consulte <command>man</command> <option>5 aliases</option>.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>ethers</option>
        </para>
       </entry>
       <entry>
        <para>
         Endereços de Ethernet.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>netmasks</option>
        </para>
       </entry>
       <entry>
        <para>
         Lista de redes e suas máscaras de sub-rede. Apenas necessário quando se usa sub-redes.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>group</option>
        </para>
       </entry>
       <entry>
        <para>
         Para grupos de usuários usados por <filename>getgrent</filename>. Consulte também a página de manual para <command>group</command>.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>hosts</option>
        </para>
       </entry>
       <entry>
        <para>
         Para nomes de hosts e endereços IP, usados por <filename>gethostbyname</filename> e funções similares.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>netgroup</option>
        </para>
       </entry>
       <entry>
        <para>
         Listas de usuários e hosts válidos na rede com a finalidade de controlar permissões de acesso, consulte a página de manual do <systemitem>netgroup(5)</systemitem>.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>networks</option>
        </para>
       </entry>
       <entry>
        <para>
         Nomes e endereços de redes, usados por <filename>getnetent</filename>.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>publickey</option>
        </para>
       </entry>
       <entry>
        <para>
         Chaves públicas e secretas de Secure_RPC usadas pelo NFS e NIS+.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>passwd</option>
        </para>
       </entry>
       <entry>
        <para>
         Senhas de usuários, usadas por <filename>getpwent</filename>; consulte a página de manual do <systemitem>passwd(5)</systemitem>.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>protocols</option>
        </para>
       </entry>
       <entry>
        <para>
         Protocolos de rede, usados por <filename>getprotoent</filename>; consulte a página de manual do <systemitem>protocols(5)</systemitem>.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>rpc</option>
        </para>
       </entry>
       <entry>
        <para>
         Nomes e endereços de RPC (Remote Procedure Call) usados por <filename>getrpcbyname</filename> e funções similares.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>services</option>
        </para>
       </entry>
       <entry>
        <para>
         Serviços de rede, usados por <filename>getservent</filename>.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>shadow</option>
        </para>
       </entry>
       <entry>
        <para>
         Senhas transitórias de usuários, usadas por <filename>getspnam</filename>; consulte a página de manual do <option>shadow(5)</option>.
        </para>
       </entry>
      </row>

     </tbody>
    </tgroup>
   </table>
   <table xml:id="tab-netz-nnswitch-conf">
    <title>Opções de configuração para bancos de dados <quote>NSS</quote></title>
    <tgroup cols="2" align="left">
     <tbody>
      <row>
       <entry>
        <para>
         <option>files</option>
        </para>
       </entry>
       <entry>
        <para>
         arquivos de acesso direto, por exemplo, <filename>/etc/aliases</filename>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>db</option>
        </para>
       </entry>
       <entry>
        <para>
         acesso através de um banco de dados
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>nis</option>, <option>nisplus</option>
        </para>
       </entry>
       <entry>
        <para>
         NIS, consulte também o <xref linkend="cha-nis"/>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>dns</option>
        </para>
       </entry>
       <entry>
        <para>
         só pode ser usada como extensão de <option>hosts</option> e <option>networks</option>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>compat</option>
        </para>
       </entry>
       <entry>
        <para>
         só pode ser usada como extensão de <option>passwd</option>, <option>shadow</option> e <option>group</option>
        </para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </table>
  </section>
  <section>
   <title><filename>/etc/nscd.conf</filename></title><indexterm> <primary>arquivos de configuração</primary> <secondary>nscd.conf</secondary> </indexterm>
   <para>
    Esse arquivo é usado para configurar o nscd (name service cache daemon). Consulte as páginas de manual de <systemitem>nscd(8)</systemitem> e <systemitem>nscd.conf(5)</systemitem>. Por padrão, as entradas do sistema de <option>passwd</option> e <option>groups</option> são armazenadas em cache pelo nscd. Isso é importante para o desempenho de serviços de diretório, como NIS e LDAP, pois, caso contrário, a conexão de rede precisaria ser usada para cada acesso a nomes ou grupos. <option>hosts</option> não é armazenado em cache por padrão, porque o mecanismo no nscd para armazenar hosts em cache impede o sistema local de confiar em verificações de pesquisa forward e reverse. Em vez de solicitar ao nscd para armazenar nomes em cache, configure um servidor DNS para armazenamento em cache.
   </para>
   <para>
    Se o armazenamento em cache de <option>passwd</option> estiver ativado, normalmente levará quinze segundos para que um usuário local recentemente adicionado seja reconhecido. Reduza esse tempo de espera reiniciando o nscd com o comando <command>rcnscd</command> <option>restart</option>.
   </para>
  </section>
  <section>
   <title><filename>/etc/HOSTNAME </filename></title><indexterm> <primary>arquivos de configuração</primary> <secondary>HOSTNAME</secondary> </indexterm>
   <para>
    Contém o nome completo do host com o nome de domínio anexado. Esse arquivo é lido por vários scripts durante o boot da máquina. Ele deve conter apenas uma linha (na qual o nome de host é definido).
   </para><indexterm class="endofrange" startref="idx-networks-configuration-files"/>
  </section>
 </section>

 <section xml:id="sec-basicnet-manconf-testing">
  <title>Testando a configuração</title>
  <para>
   Antes de gravar sua configuração nos arquivos de configuração, você pode testá-la. Para definir uma configuração de teste, use o comando <command>ip</command>. Para testar a conexão, use o comando <command>ping</command>. As antigas ferramentas de configuração <command>ifconfig</command> e <command>route</command> também estão disponíveis.
  </para>
  <para>
   Os comandos <command>ip</command>, <command>ifconfig</command> e <command>route</command> mudam a configuração da rede diretamente sem gravá-la no arquivo de configuração. A menos que você insira a configuração nos arquivos de configuração corretos, a configuração de rede mudada será perdida na reinicialização.
  </para>
  <section xml:id="sec-basicnet-manconf-ip">
   <title>Configurando uma interface de rede com <command>ip</command></title><indexterm> <primary>comandos</primary> <secondary>ip</secondary> </indexterm>
   
   <para>
    <command>ip</command> é uma ferramenta para mostrar e configurar dispositivos de rede, roteamentos, roteamento de políticas e túneis.
   </para>
   <para>
    <command>ip</command> é uma ferramenta muito complexa. Sua sintaxe comum é <command>ip</command> <option><replaceable>opções</replaceable> <replaceable>objeto</replaceable> <replaceable>comando</replaceable></option>. Você pode trabalhar com os seguintes objetos:
   </para>
   <variablelist>
    <varlistentry>
     <term>link</term>
     <listitem>
      <para>
       Este objeto representa um dispositivo de rede.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>address</term>
     <listitem>
      <para>
       Este objeto representa o endereço IP do dispositivo.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>neighbor</term>
     <listitem>
      <para>
       Este objeto representa uma entrada de cache ARP ou NDISC.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>route</term>
     <listitem>
      <para>
       Este objeto representa a entrada da tabela de roteamento.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rule</term>
     <listitem>
      <para>
       Este objeto representa uma regra no banco de dados de políticas de roteamento.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>maddress</term>
     <listitem>
      <para>
       Este objeto representa um endereço multicast.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>mroute</term>
     <listitem>
      <para>
       Este objeto representa uma entrada de cache de roteamento multicast.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>tunnel</term>
     <listitem>
      <para>
       Este objeto representa um túnel sobre IP.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    Se nenhum comando for fornecido, será usado o comando padrão (normalmente <command>list</command>).
   </para>
   <para>
    Mude o estado de um dispositivo com o comando <command>ip link set</command> <option><replaceable>nome_do_dispositivo</replaceable></option> <command/> . Por exemplo, para desativar o dispositivo eth0, digite <command>ip link set</command> <option>eth0 down</option>. Para ativá-lo novamente, use <command>ip link set</command> <option>eth0 up</option>.
   </para>
   <para>
    Após ativar um dispositivo, você poderá configurá-lo. Para definir o endereço IP, use <command>ip addr add</command> <option><replaceable>endereço_ip</replaceable> + dev <replaceable>nome_do_dispositivo</replaceable></option>. Por exemplo, para definir o endereço da interface eth0 como 192.168.12.154/30 com o broadcast padrão (opção <option>brd</option>), digite <command>ip addr</command> <option>add 192.168.12.154/30 brd + dev eth0</option>.
   </para>
   <para>
    Para ter uma conexão ativa, você também precisa configurar o gateway padrão. Para definir um gateway para o sistema, digite <command>ip route add</command> <option>endereço_ip_do_gateway</option>. Para traduzir um endereço IP para outro, use <command>nat</command>: <command>ip route add nat</command> <option>endereço_ip</option> <command>via</command> <option>outro_endereço_ip</option>.
   </para>
   <para>
    Para exibir todos os dispositivos, use <command>ip link ls</command>. Para exibir apenas as interfaces em execução, use <command>ip link ls up</command>. Para imprimir as estatísticas de interface de um dispositivo, digite <command>ip -s link ls</command> <option>nome_do_dispositivo</option>. Para ver os endereços dos dispositivos, digite <command>ip addr</command>. Na saída do comando <command>ip addr</command>, você também pode encontrar informações sobre os endereços MAC dos dispositivos. Para mostrar todas as rotas, use <command>ip route show</command>.
   </para>
   <para>
    Para obter mais informações sobre como usar o <command>ip</command>, digite <command>ip</command> <option>help</option> ou consulte a página de manual de <systemitem>ip(8)</systemitem>. A opção <option>help</option> também está disponível para todos os subcomandos <command>ip</command>. Se, por exemplo, você precisar de ajuda para <command>ip</command> <option>addr</option>, digite <command>ip</command> <option>addr help</option>. Encontre o manual do <command>ip</command> em <filename>/usr/share/doc/packages/iproute2/ip-cref.pdf</filename>.
   </para>
  </section>
  <section xml:id="sec-basicnet-manconf-testingping">
   <title>Testando uma conexão com o comando ping</title><indexterm> <primary>comandos</primary> <secondary>ping</secondary> </indexterm> <indexterm> <primary>ping</primary> </indexterm>
   <para>
    O comando <command>ping</command> é a ferramenta padrão para testar o funcionamento de uma conexão TCP/IP. Ele usa o protocolo ICMP para enviar um pequeno pacote de dados, o datagrama ECHO_REQUEST, para o host de destino, solicitando uma resposta imediata. Se isso funcionar, o <command>ping</command> exibirá uma mensagem que indica que o link da rede está basicamente funcionando.
   </para>
   <para>
    O <command>ping</command> vai além de simplesmente testar a função da conexão entre dois computadores; ele também fornece algumas informações básicas sobre a qualidade da conexão. No <xref linkend="ex-basicnet-manconf-ping"/>, você pode ver um exemplo da saída do <command>ping</command>. A penúltima linha contém informações sobre o número de pacotes transmitidos, o número de pacotes perdidos e o tempo total da execução do <command>ping</command>.
   </para>
   <para>
    No destino, você pode usar o nome de host ou endereço IP, por exemplo, <command>ping</command> <option>example.com</option> ou <command>ping</command> <option>192.168.3.100</option>. O programa enviará pacotes até que você pressione <keycombo><keycap>Ctrl</keycap><keycap>C</keycap></keycombo>.
   </para>
   <para>
    Se você só precisar verificar a funcionalidade da conexão, poderá limitar o número dos pacotes com a opção <option>-c</option>. Por exemplo, para limitar o ping a três pacotes, digite <command>ping</command> <option>-c 3 exemplo.com</option>.
   </para>
   <example xml:id="ex-basicnet-manconf-ping">
    <title>Saída do comando ping</title>
<screen>ping -c 3 example.com
PING example.com (192.168.3.100) 56(84) bytes of data.
64 bytes from example.com (192.168.3.100): icmp_seq=1 ttl=49 time=188 ms
64 bytes from example.com (192.168.3.100): icmp_seq=2 ttl=49 time=184 ms
64 bytes from example.com (192.168.3.100): icmp_seq=3 ttl=49 time=183 ms
--- example.com ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2007ms
rtt min/avg/max/mdev = 183.417/185.447/188.259/2.052 ms</screen>
   </example>
   <para>
    O intervalo padrão entre dois pacotes é um segundo. Para mudar o intervalo, o ping fornece a opção <option>-i</option>. Por exemplo, para aumentar o intervalo do ping para dez segundos, digite <command>ping</command> <option>-i 10 exemplo.com</option>.
   </para>
   <para>
    Em um sistema com vários dispositivos de rede, às vezes é útil enviar o ping através de um endereço de interface específico. Para isso, use a opção <option>-I</option> com o nome do dispositivo selecionado, por exemplo, <command>ping</command> <option>-I wlan1 exemplo.com</option>.
   </para>
   <para>
    Para obter mais opções e informações sobre como usar o ping, digite <command>ping</command> <option>-h</option> ou consulte a página de manual de <systemitem>ping (8)</systemitem>.
   </para>
   <tip>
    <title>Executando ping em endereços IPv6</title>
    <para>
     Para endereços IPv6, use o comando <command>ping6</command>. Observe que, para executar ping em endereços locais de link, deve-se especificar a interface com <option>-I</option>. O comando a seguir funcionará se o endereço for acessível via <literal>eth1</literal>:
    </para>
<screen>ping6 -I eth1 fe80::117:21ff:feda:a425</screen>
   </tip>
  </section>
  <section xml:id="sec-basicnet-manconf-testingifconfig">
   <title>Configurando a rede com o ifconfig</title><indexterm> <primary>comandos</primary> <secondary>ifconfig</secondary> </indexterm>
   <para>
    <command>ifconfig</command> é uma ferramenta de configuração de rede.
   </para>
   <note>
    <title><command/>ifconfig e ip<command/></title>
    <para>
     A ferramenta <command>ifconfig</command> está obsoleta. Em vez disso, use <command>ip</command>. Ao contrário do <command>ip</command>, pode-se usar <command>ifconfig</command> apenas para configuração de interfaces. Ele limita nomes de interface a 9 caracteres.
    </para>
   </note>
   <para>
    Sem argumentos, o <command>ifconfig</command> exibe o status das interfaces atualmente ativas. Como você pode ver em <xref linkend="ex-basicnet-manconf-ifconfig"/>, o <command>ifconfig</command> tem uma saída detalhada e bem organizada. A saída também contém informações sobre o endereço MAC do seu dispositivo (o valor de <option>HWaddr</option>) na primeira linha.
   </para>
   <example xml:id="ex-basicnet-manconf-ifconfig">
    <title>Saída do comando <command>ifconfig</command></title>
<screen>eth0      Link encap:Ethernet  HWaddr 00:08:74:98:ED:51
          inet6 addr: fe80::208:74ff:fe98:ed51/64 Scope:Link
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:634735 errors:0 dropped:0 overruns:4 frame:0
          TX packets:154779 errors:0 dropped:0 overruns:0 carrier:1
          collisions:0 txqueuelen:1000
          RX bytes:162531992 (155.0 Mb)  TX bytes:49575995 (47.2 Mb)
          Interrupt:11 Base address:0xec80

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:8559 errors:0 dropped:0 overruns:0 frame:0
          TX packets:8559 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:533234 (520.7 Kb)  TX bytes:533234 (520.7 Kb)    

wlan1     Link encap:Ethernet  HWaddr 00:0E:2E:52:3B:1D
          inet addr:192.168.2.4  Bcast:192.168.2.255  Mask:255.255.255.0
          inet6 addr: fe80::20e:2eff:fe52:3b1d/64 Scope:Link
          UP BROADCAST NOTRAILERS RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:50828 errors:0 dropped:0 overruns:0 frame:0
          TX packets:43770 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:45978185 (43.8 Mb)  TX bytes:7526693 (7.1 MB)</screen>
   </example>
   <para>
    Para obter mais opções e informações sobre como usar o <command>ifconfig</command>, digite <command>ifconfig</command> <option>-h</option> ou consulte a página de manual de <systemitem>ifconfig (8)</systemitem>.
   </para>
  </section>
  <section>
   <title>Configurando o roteamento com <command>route</command></title><indexterm> <primary>comandos</primary> <secondary>route</secondary> </indexterm>
   <para>
    <command>route</command> é um programa usado para manipular a tabela de roteamento IP. Você pode usá-lo para ver sua configuração de roteamento e adicionar ou remover rotas.
   </para>
   <note>
    <title><command/>route e ip<command/></title>
    <para>
     O programa <command>route</command> está obsoleto. Em vez disso, use <command>ip</command>. 
    </para>
   </note>
   <para>
    <command>O comando route será especialmente útil se você precisar de informações rápidas e compreensíveis sobre a configuração do roteamento para identificar problemas de roteamento. </command> Para ver a configuração de roteamento atual, digite <command>route</command><option>-n</option> as <systemitem class="username">root</systemitem>.
   </para>
   <example xml:id="ex-basicnet-manconf-route">
    <title>Saída do comando <command>route</command> <option>-n</option></title>
<screen><?dbsuse-fo font-size="7pt"?>

route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface
10.20.0.0       *               255.255.248.0   U         0 0          0 eth0
link-local      *               255.255.0.0     U         0 0          0 eth0
loopback        *               255.0.0.0       U         0 0          0 lo
default         styx.exam.com   0.0.0.0         UG        0 0          0 eth0</screen>
   </example>
   <para>
    Para obter mais informações sobre como usar o route, digite <command>route</command> <option>-h</option> ou consulte a página de manual de <systemitem>route (8)</systemitem>.
   </para>
  </section>
 </section>

 <section xml:id="sec-basicnet-manconf-scripts">
  <title>Scripts de inicialização</title><indexterm> <primary>scripts</primary> <secondary>init.d</secondary> </indexterm>
  <para>
   Além dos arquivos de configuração descritos acima, há também vários scripts que carregam os programas de rede durante o boot da máquina. Eles são iniciados assim que o sistema é alternado para um dos <emphasis>níveis de execução multiusuário</emphasis>. Alguns desses scripts são descritos na <xref linkend="tab-netz-start-skripte"/>.
  </para>
  <table xml:id="tab-netz-start-skripte">
<?dbsuse-latex tablehead="p{.4\linewidth}p{.55\linewidth}"?>


   <title>Alguns scripts de inicialização para programas de rede</title>
   <tgroup cols="2" align="left">
    <tbody>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/network</filename> <indexterm> <primary>scripts</primary> <secondary>init.d</secondary> <tertiary>rede</tertiary> </indexterm>
       </para>
      </entry>
      <entry>
       <para>
        Este script controla a configuração das interfaces de rede. Se o serviço <command>network</command> não tiver sido iniciado, nenhuma interface de rede será implementada.
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/xinetd</filename> <indexterm> <primary>scripts</primary> <secondary>init.d</secondary> <tertiary>xinetd</tertiary> </indexterm>
       </para>
      </entry>
      <entry>
       <para>
        Inicia o xinetd. O xinetd pode ser usado para disponibilizar os serviços do servidor no sistema. Por exemplo, ele pode iniciar o vsftpd sempre que uma conexão FTP for inicializada.
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/rpcbind</filename> <indexterm> <primary>scripts</primary> <secondary>init.d</secondary> <tertiary>rpcbind</tertiary> </indexterm>
       </para>
      </entry>
      <entry>
       <para>
        Inicia o utilitário rpcbind, que converte os números de programa RPC em endereços universais. Necessário para os serviços RPC, como um servidor NFS.
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/nfsserver</filename> <indexterm> <primary>scripts</primary> <secondary>init.d</secondary> <tertiary>nfsserver</tertiary> </indexterm>
       </para>
      </entry>
      <entry>
       <para>
        Inicia o servidor NFS.
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/postfix</filename> <indexterm> <primary>scripts</primary> <secondary>init.d</secondary> <tertiary>postfix</tertiary> </indexterm>
       </para>
      </entry>
      <entry>
       <para>
        Controla o processo de postfix.
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/ypserv</filename> <indexterm> <primary>scripts</primary> <secondary>init.d</secondary> <tertiary>ypserv</tertiary> </indexterm>
       </para>
      </entry>
      <entry>
       <para>
        Inicia o servidor NIS.
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/ypbind</filename> <indexterm> <primary>scripts</primary> <secondary>init.d</secondary> <tertiary>ypbind</tertiary> </indexterm>
       </para>
      </entry>
      <entry>
       <para>
        Inicia o cliente NIS.
       </para>
      </entry>
     </row>
    </tbody>
   </tgroup>
  </table><indexterm startref="idx-networks-configuring" class="endofrange"/><indexterm startref="idx-configuring-networks-manually" class="endofrange"/>
 </section>
</section>
