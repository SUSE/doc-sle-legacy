<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet href="urn:x-suse:xslt:profiling:novdoc-profile.xsl"
  type="text/xml" 
  title="Profiling step"?>
<!DOCTYPE sect1 PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN"
                      "novdocx.dtd"
[
<!ENTITY % NOVDOC.DEACTIVATE.IDREF "IGNORE">
<!ENTITY % entities SYSTEM "entity-decl.ent">
%entities;
]>
<sect1 id="sec_ha_quick_nfs_prereq">
 <title>Prerequisites and Installation</title>

 <para>
  Before you proceed with <xref linkend="sec_ha_quick_nfs_initial"/>, make
  sure that the following prerequisites are fulfilled.
 </para>

 <sect2 id="sec_ha_quick_nfs_prereq_pkg">
  <title>Software Requirements</title>
  <itemizedlist os="sles">
   <listitem>
<!--taroth 2011-04-21:  &productnumber;-->
    <para>
     &slsreg; 11 is installed on all nodes that will be part of the cluster.
     All available online updates for the product are installed.
    </para>
   </listitem>
   <listitem>
<!--taroth 2011-04-21:  &productname; &productnumber;-->
    <para>
     &sle; &hasi; 11 is installed on all nodes that will be part of the
     cluster. All available online updates for the product are installed.
    </para>
   </listitem>
  </itemizedlist>
  <para os="sles">
   For instructions on how to install the &hasi; as add-on on top of &sls;,
   refer to <xref
          linkend="sec.ha.installation.add-on"/>.
  </para>
  <para>
   In order to create a highly available NFS service, you need to have the
   following software packages installed:
  </para>
  <itemizedlist>
   <listitem>
    <para os="sles">
     <systemitem class="resource">pacemaker</systemitem>: A cluster resource
     management framework which you will use to automatically start, stop,
     monitor, and migrate resources.
    </para>
    <para os="linbit">
     Pacemaker is a cluster resource management framework which you will use
     to automatically start, stop, monitor, and migrate resources.
     Distributions typically bundle Pacemaker in a package simply named
     <literal>pacemaker</literal>. This technical guide assumes that you are
     using at least Pacemaker 1.0.9.
    </para>
   </listitem>
   <listitem>
    <para os="sles">
     <systemitem class="resource"
            >corosync</systemitem>: A
     cluster messaging layer. Pacemaker is capable of using two cluster
     messaging layers: <literal>Heartbeat</literal> or
     <literal>&corosync;</literal>. &corosync; is the only supported
     Pacemaker messaging layer in &sle; 11.
    </para>
    <para os="linbit">
     <literal>Heartbeat</literal> is one of the cluster messaging layers
     that Pacemaker is capable of using. In distributions, the Heartbeat
     package is usually named <literal>heartbeat</literal>. This guide
     assumes at least Heartbeat version 3.0.3. &corosync; is the only
     supported Pacemaker messaging layer in Red Hat Enterprise Linux 6 and
     SUSE Linux Enterprise Server 11, other distributions ship both
     &corosync; and Heartbeat. For the sake of simplicity, this technical
     guide presents the solution on only one messaging layer, which is
     Heartbeat.
    </para>
   </listitem>
   <listitem>
    <para os="sles">
     <systemitem class="resource">drbd-utils</systemitem> and
     <systemitem class="resource"
            >drbd-kmp-</systemitem><replaceable>your_kernel</replaceable>:
     Both belong to DRBD, the Kernel block-level synchronous replication
     facility which serves as an imported shared-nothing cluster building
     block.
    </para>
    <para os="linbit">
     <literal>DRBD</literal> is a Kernel block-level synchronous replication
     facility which serves as an imported shared-nothing cluster building
     block. If your distribution ships with a 2.6.33 or newer Linux Kernel,
     you will only need to install the DRBD userspace management utilities
     (typically named <literal>drbd-utils</literal>,
     <literal>drbd8-utils</literal>, or similar). If it does not, most
     distribution ship a separate DRBD Kernel module package
     (<literal>drbd8-module</literal>, <literal>kmod-drbd8</literal>, or
     similar), which you will have to install it along with the userspace
     tools.
    </para>
   </listitem>
   <listitem>
    <para os="sles">
     <systemitem class="resource"
            >lvm2</systemitem>: Linux
     Logical Volume Management, version 2, which you may use for easy and
     flexible data management including online volume expansion and
     point-in-time snapshots.
    </para>
    <para os="linbit">
     <literal>LVM2</literal> is Linux Logical Volume Management,
     version&nbsp;2, which you may use for easy and flexible data management
     including online volume expansion and point-in-time snapshots.
     Distributions usually ship LVM2 in a package named
     <literal>lvm2</literal>.
    </para>
   </listitem>
   <listitem>
    <para os="sles">
     <systemitem class="resource"
              >nfs-kernel-server</systemitem>:
     The in-kernel Linux NFS daemon. It serves locally mounted file systems
     out to clients via the NFS network protocol.
    </para>
    <para os="linbit">
     The <literal>NFS Kernel Server</literal> is the in-kernel Linux NFS
     daemon. It serves locally mounted file systems out to clients via the
     NFS network protocol. In distributions, the NFS server is often
     packaged as <literal>nfsserver</literal>, <literal>nfs</literal>,
     <literal>nfs-kernel-server</literal>, or similar.
    </para>
   </listitem>
  </itemizedlist>
  <important os="sles">
   <title>Product Registration And Updates</title>
   <para>
    Proper registration at &ncc; is mandatory for the system to receive
    updates. During the registration process, the respective online update
    repositories are automatically configured.
   </para>
   <para>
    The repositories for installation and update automatically provide the
    package versions needed for the setup of highly available NFS storage as
    described in this document.
   </para>
  </important>
  <note>
   <title>Package Dependencies</title>
   <para os="sles">
    You may be required to install packages other than the above-mentioned
    ones due to package dependencies. However, when using a package
    management utility such as <command>zypper</command> or &yast;, these
    dependencies are automatically taken care of.
   </para>
   <para os="linbit">
    You may be required to install packages other than the above-mentioned
    ones due to package dependencies. However, when using a package
    management utility such as <literal>aptitude</literal>,
    <literal>yum</literal>, or <literal>zypper</literal>, these dependencies
    are automatically taken care of.
   </para>
  </note>
 </sect2>

 <sect2 id="sec_ha_quick_nfs_prereq_services">
  <title>Services at Boot Time</title>
  <para os="sles">
   After you have installed the required packages, take care of a few
   settings applying to your boot process.
  </para>
  <para os="linbit">
   After you have installed the required packages, take care of a few
   settings applying to your boot process, using your distribution&#8217;s
   preferred utility for doing so (typically either
   <literal>chkconfig</literal>, <literal>insserv</literal>, or
   <literal>update-rc.d</literal>).
  </para>
  <para os="sles">
   Use <literal>chkconfig</literal>, <literal>insserv</literal> or
   <guimenu>&yast; System Services (Runlevel)</guimenu> to make sure that:
  </para>
  <para os="linbit">
   Make sure that:
  </para>
  <itemizedlist>
   <listitem>
    <para>
     &ais; <emphasis>does</emphasis> start automatically on system boot.
     This will also start Pacemaker.
    </para>
   </listitem>
   <listitem>
    <para>
     The <literal>drbd</literal> init script <emphasis>does not</emphasis>
     start automatically on system boot. Pacemaker takes care of all
     DRBD-related functionality&mdash;the init script is not needed for this
     purpose.
    </para>
   </listitem>
  </itemizedlist>
 </sect2>
</sect1>
