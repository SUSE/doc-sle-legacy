<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE refentry PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN" "novdocx.dtd"
[
  <!ENTITY % NOVDOC.DEACTIVATE.IDREF "INCLUDE">
  <!ENTITY % entities SYSTEM "entity-decl.ent">
  %entities;
]>
<refentry id="man.crmresource">
 <refmeta>
  <refentrytitle>crm_resource</refentrytitle>
  <manvolnum>8</manvolnum>
 </refmeta>
 <refnamediv>
  <refname>crm_resource</refname><refpurpose>Perform tasks related to cluster resources</refpurpose>
 </refnamediv>
 <refsect1>
  <title>Synopsis</title>
<screen><command>crm_resource</command>  [-?|-V|-S] -L|-Q|-W|-D|-C|-P|-p [options]</screen>
 </refsect1>
 <refsect1>
  <title>Description</title>
  <para>
   The <command>crm_resource</command> command performs various
   resource-related actions on the cluster. It can modify the definition of
   configured resources, start and stop resources, and delete and migrate
   resources between nodes.
  </para>
  <variablelist>
   <varlistentry>
    <term><option>--help</option>, <option>-?</option>
    </term>
    <listitem>
     <para>
      Print the help message.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--verbose</option>, <option>-V</option>
    </term>
    <listitem>
     <para>
      Turn on debug information.
     </para>
     <note>
      <para>
       Increase the level of verbosity by providing additional instances.
      </para>
     </note>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--quiet</option>, <option>-Q</option>
    </term>
    <listitem>
     <para>
      Print only the value on stdout (for use with <option>-W</option>).
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </refsect1>
 <refsect1>
  <title>Commands</title>
  <variablelist>
   <varlistentry>
    <term><option>--list</option>, <option>-L</option>
    </term>
    <listitem>
     <para>
      List all resources.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--query-xml</option>, <option>-x</option>
    </term>
    <listitem>
     <para>
      Query a resource.
     </para>
     <para>
      Requires: <option>-r</option>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--locate</option>, <option>-W</option>
    </term>
    <listitem>
     <para>
      Locate a resource.
     </para>
     <para>
      Requires: <option>-r</option>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--migrate</option>, <option>-M</option>
    </term>
    <listitem>
     <para>
      Migrate a resource from its current location. Use <option>-N</option>
      to specify a destination.
     </para>
     <para>
      If <option>-N</option> is not specified, the resource is forced to
      move by creating a rule for the current location and a score of
      <option>-INFINITY</option>.
     </para>
     <note>
      <para>
       This prevents the resource from running on this node until the
       constraint is removed with <option>-U</option>.
      </para>
     </note>
     <para>
      Requires: <option>-r</option>, Optional: <option>-N</option>,
      <option>-f</option>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--un-migrate</option>, <option>-U</option>
    </term>
    <listitem>
     <para>
      Remove all constraints created by <option>-M</option>
     </para>
     <para>
      Requires: <option>-r</option>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--delete</option>, <option>-D</option>
    </term>
    <listitem>
     <para>
      Delete a resource from the CIB.
     </para>
     <para>
      Requires: <option>-r</option>, <option>-t</option>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--cleanup</option>, <option>-C</option>
    </term>
    <listitem>
     <para>
      Delete a resource from the LRM.
     </para>
     <para>
      Requires: <option>-r</option>. Optional: <option>-H</option>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--reprobe</option>, <option>-P</option>
    </term>
    <listitem>
     <para>
      Recheck for resources started outside the CRM.
     </para>
     <para>
      Optional: <option>-H</option>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--refresh</option>, <option>-R</option>
    </term>
    <listitem>
     <para>
      Refresh the CIB from the LRM.
     </para>
     <para>
      Optional: <option>-H</option>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--set-parameter <replaceable>string</replaceable></option>, <option>-p <replaceable>string</replaceable></option>
    </term>
    <listitem>
     <para>
      Set the named parameter for a resource.
     </para>
     <para>
      Requires: <option>-r</option>, <option>-v</option>. Optional:
      <option>-i</option>, <option>-s</option>, and <option>--meta</option>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--get-parameter <replaceable>string</replaceable></option>, <option>-g <replaceable>string</replaceable></option>
    </term>
    <listitem>
     <para>
      Get the named parameter for a resource.
     </para>
     <para>
      Requires: <option>-r</option>. Optional: <option>-i</option>,
      <option>-s</option>, and <option>--meta</option>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--delete-parameter <replaceable>string</replaceable></option>, <option>-d <replaceable>string</replaceable></option>
    </term>
    <listitem>
     <para>
      Delete the named parameter for a resource.
     </para>
     <para>
      Requires: <option>-r</option>. Optional: <option>-i</option>, and
      <option>--meta</option>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--list-operations <replaceable>string</replaceable></option>
    </term>
    <term><option>-O <replaceable>string</replaceable></option>
    </term>
    <listitem>
     <para>
      List the active resource operations. Optionally filtered by resource,
      node, or both. Optional: <option>-N</option>, <option>-r</option>
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--list-all-operations <replaceable>string</replaceable></option>
    </term>
    <term><option>-o <replaceable>string</replaceable></option>
    </term>
    <listitem>
     <para>
      List all resource operations. Optionally filtered by resource, node,
      or both. Optional: <option>-N</option>, <option>-r</option>
     </para>
    </listitem>
   </varlistentry>
<!--<varlistentry>
    <term><option>&#x2d;&#x2d;get-property <replaceable>string</replaceable></option>, <option>-G <replaceable>string</replaceable></option></term>
    <listitem>
     <para>Get the named property (such as <option>class</option>,
      <option>type</option>, or <option>is-managed</option>) of a resource.</para>
     <para>Requires: <option>-r</option></para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>&#x2d;&#x2d;set-property <replaceable>string</replaceable></option>, <option>-S <replaceable>string</replaceable></option></term>
    <listitem>
     <para>Set the named property (not parameter) for a resource.</para>
     <para>Requires: <option>-r</option>, <option>-t</option>, <option>-v</option></para>
    </listitem>
   </varlistentry>-->
  </variablelist>
 </refsect1>
 <refsect1>
  <title>Options</title>
  <variablelist>
   <varlistentry>
    <term><option>--resource <replaceable>string</replaceable></option>, <option>-r <replaceable>string</replaceable></option>
    </term>
    <listitem>
     <para>
      Specify the resource ID.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--resource-type <replaceable>string</replaceable></option>, <option>-t <replaceable>string</replaceable></option>
    </term>
    <listitem>
     <para>
      Specify the resource type (<option>primitive</option>,
      <option>clone</option>, <option>group</option>, etc.).
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--property-value <replaceable>string</replaceable></option>, <option>-v <replaceable>string</replaceable></option>
    </term>
    <listitem>
     <para>
      Specify the property value.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--node <replaceable>string</replaceable></option>, <option>-N <replaceable>string</replaceable></option>
    </term>
    <listitem>
     <para>
      Specify the hostname.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--meta</option>
    </term>
    <listitem>
     <para>
      Modify a resource's configuration option rather than one which is
      passed to the resouce agent script. For use with <option>-p</option>,
      <option>-g</option> and <option>-d</option>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--lifetime
        <replaceable>string</replaceable></option>,
      <option>-u <replaceable>string</replaceable></option>
    </term>
    <listitem>
     <para>
      Lifespan of migration constraints.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>--force</option>, <option>-f</option>
    </term>
    <listitem>
     <para>
      Force the resource to move by creating a rule for the current location
      and a score of <option>-INFINITY</option>
     </para>
     <para>
      This should be used if the resource's stickiness and constraint scores
      total more than <option>INFINITY</option> (currently 100,000).
     </para>
     <note>
      <para>
       This prevents the resource from running on this node until the
       constraint is removed with <option>-U</option>.
      </para>
     </note>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>-s <replaceable>string</replaceable></option>
    </term>
    <listitem>
     <para>
      (Advanced Use Only) Specify the ID of the
      <option>instance_attributes</option> object to change.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term><option>-i <replaceable>string</replaceable></option>
    </term>
    <listitem>
     <para>
      (Advanced Use Only) Specify the ID of the <option>nvpair</option>
      object to change or delete.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </refsect1>
 <refsect1>
  <title>Examples</title>
  <variablelist>
   <varlistentry>
    <term>Listing all resources:</term>
    <listitem>
<screen><command>crm_resource</command> <option>-L</option></screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Checking where a resource is running (and if it is):</term>
    <listitem>
<screen><command>crm_resource</command> <option>-W</option> <option>-r</option> my_first_ip</screen>
     <para>
      If the <literal>my_first_ip</literal> resource is running, the output
      of this command reveals the node on which it is running. If it is not
      running, the output shows this.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Start or stop a resource:</term>
    <listitem>
<screen><command>crm_resource</command> <option>-r</option> my_first_ip <option>-p</option> target_role <option>-v</option> started
</screen>
<screen><command>crm_resource</command> <option>-r</option> my_first_ip <option>-p</option> target_role <option>-v</option> stopped
</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Query the definition of a resource:</term>
    <listitem>
<screen><command>crm_resource</command> <option>-Q</option> <option>-r</option> my_first_ip
</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Migrate a resource away from its current location:</term>
    <listitem>
<screen><command>crm_resource</command> <option>-M</option> <option>-r</option> my_first_ip
</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Migrate a resource to a specific location:</term>
    <listitem>
<screen><command>crm_resource</command> <option>-M</option> <option>-r</option> my_first_ip <option>-H</option> c001n02
</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Allow a resource to return to its normal location:</term>
    <listitem>
<screen><command>crm_resource</command> <option>-U</option> <option>-r</option> my_first_ip
</screen>
     <note>
      <para>
       The values of <option>resource_stickiness</option> and
       <option>default_resource_stickiness</option> may mean that it does
       not move back. In such cases, you should use <option>-M</option> to
       move it back before running this command.
      </para>
     </note>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Delete a resource from the CRM:</term>
    <listitem>
<screen><command>crm_resource</command> <option>-D</option> <option>-r</option> my_first_ip <option>-t</option> primitive
</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Delete a resource group from the CRM:</term>
    <listitem>
<screen><command>crm_resource</command> <option>-D</option> <option>-r</option> my_first_group <option>-t</option> group
</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Disable resource management for a resource in the CRM:</term>
    <listitem>
<screen><command>crm_resource</command> <option>-p</option> is-managed <option>-r</option> my_first_ip <option>-t</option> primitive <option>-v</option> off
</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Enable resource management for a resource in the CRM:</term>
    <listitem>
<screen><command>crm_resource</command> <option>-p</option> is-managed <option>-r</option> my_first_ip <option>-t</option> primitive <option>-v</option> on
</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Reset a failed resource after having been manually cleaned
     up:</term>
    <listitem>
<screen><command>crm_resource</command> <option>-C</option> <option>-H</option> c001n02 <option>-r</option> my_first_ip
</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Recheck all nodes for resources started outside the CRM:</term>
    <listitem>
<screen><command>crm_resource</command> <option>-P</option>
</screen>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Recheck one node for resources started outside the CRM:</term>
    <listitem>
<screen><command>crm_resource</command> <option>-P</option> <option>-H</option> c001n02
</screen>
    </listitem>
   </varlistentry>
  </variablelist>
 </refsect1>
 <refsect1>
  <title>Files</title>
  <para>
   <filename>/var/lib/heartbeat/crm/cib.xml</filename>&mdash;the CIB (minus
   status section) on disk. Editing this file directly is strongly
   discouraged.
  </para>
 </refsect1>
 <refsect1>
  <title>See Also</title>
  <para>
   <xref linkend="man.cibadmin"/>, <xref linkend="man.crmadmin"/>,
   lrmadmin(8), heartbeat(8)
  </para>
 </refsect1>
<!-- 
 <refsect1>
  <title>Author</title>
  <para>
   <command>crm_resource</command> was written by Andrew Beekhof.
  </para>
 </refsect1>
 -->
</refentry>
