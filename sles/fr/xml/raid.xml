<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet href="urn:x-suse:xslt:profiling:docbook51-profile.xsl"
    type="text/xml"
    title="Profiling step"
?>
<!DOCTYPE sect1
[
   <!ENTITY % entities SYSTEM "entity-decl.ent">
   %entities;
]>


<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<section xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.1" xml:base="raid.xml" xml:id="sec-yast2-system-raid">
 <title>Configuration de Soft RAID</title><indexterm> <primary>YaST</primary> <secondary>RAID</secondary></indexterm><indexterm> <primary>RAID</primary> <secondary>YaST</secondary></indexterm><indexterm> <primary>Soft RAID</primary> <see>RAID</see></indexterm>



 <para>
  L'objectif de la technologie RAID (Redundant Array of Independent Disks - Réseau redondant de disques indépendants) consiste à combiner plusieurs partitions de disque dur en un seul disque dur <emphasis>virtuel</emphasis>, plus volumineux, afin d'optimiser les performances et/ou la sécurité des données. La plupart des contrôleurs RAID utilisent le protocole SCSI car il gère mieux un nombre de disques plus important que le protocole IDE. En outre, le protocole SCSI est plus adapté au traitement parallèle des commandes. Certains contrôleurs RAID prennent en charge les disques durs IDE ou SATA. Soft RAID présente les mêmes avantages que les systèmes RAID, tout en vous épargnant le coût supplémentaire des contrôleurs RAID matériels. Toutefois, cette technologie sollicite les ressources de l'unité centrale et ses exigences en termes de mémoire sont inadaptées aux ordinateurs hautes performances.
 </para>

 <para>
  <phrase role="productname"><phrase os="sles">SUSE® Linux Enterprise Server</phrase></phrase> permet de combiner plusieurs disques durs en un seul système Soft RAID. RAID exploite plusieurs stratégies pour combiner plusieurs disques durs en un seul système RAID, chacune avec des objectifs, des caractéristiques et des avantages différents. Ces variantes sont généralement appelées <emphasis>niveaux RAID</emphasis>.
 </para>

 <para>
  Les niveaux RAID courants sont les suivants :
 </para>

 <variablelist>
  <varlistentry>
   <term>RAID 0</term>
   <listitem>
    <para>
     Ce niveau améliore les performances de l'accès aux données, en répartissant des blocs de chaque fichier sur plusieurs disques. En réalité, il ne s'agit pas vraiment d'une configuration RAID, car elle n'assure pas la sauvegarde des données, mais le nom <emphasis>RAID 0</emphasis> attribué à ce système est devenu un standard. Dans la configuration RAID 0, au moins deux disques sont mutualisés. Les performances sont très satisfaisantes, mais, en cas de défaillance d'un seul disque dur, tout le système RAID est détruit et vos données sont perdues.
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term>RAID 1</term>
   <listitem>
    <para>
     Ce niveau assure un degré de sécurité acceptable pour vos données, car elles sont copiées sur un autre disque, selon un système 1:1, appelé <emphasis>mise en miroir de disques durs</emphasis>. Si un disque est détruit, une copie de son contenu est toujours disponible sur un autre disque. Tous les disques, sauf un, peuvent être endommagés sans mettre vos données en danger. Toutefois, si le dommage n'est pas détecté, les données endommagées peuvent être mises en miroir sur le disque sain. Ceci risque d'entraîner une perte des données. Dans le cadre du processus de copie, les performances d'écriture sont réduites par rapport à l'utilisation d'un accès disque unique (10 à 20 % plus lent), mais l'accès en lecture est beaucoup plus rapide par rapport à l'accès à un disque dur physique normal. En effet, les données étant dupliquées, elles peuvent être consultées en parallèle. En général, le niveau 1 offre une vitesse de lecture presque deux fois supérieure à celle d'un disque unique et une vitesse d'écriture presque égale.
    </para>
   </listitem>
  </varlistentry>

  <varlistentry>
   <term>RAID 5</term>
   <listitem>
    <para>
     RAID 5 est un compromis optimisé entre le niveau 0 et le niveau 1, en ce qui concerne les performances et la redondance. L'espace disque dur équivaut au nombre de disques utilisés moins un. Les données sont réparties sur les disques durs, comme avec le RAID 0. Des <emphasis>blocs de parité</emphasis> sont créés sur l'une des partitions pour des raisons de sécurité. Ils sont liés les uns aux autres par l'opérateur OR exclusif (XOR) ; le contenu peut ainsi être reconstruit, avec ce même opérateur, par le bloc de parité correspondant, en cas de défaillance du système. RAID 5 ne gère pas les défaillances simultanées de plusieurs disques. Si un disque dur tombe en panne, remplacez-le dès que possible pour éviter tout risque de perte de données.
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term>RAID 6</term>
   <listitem>
    <para>
     Pour augmenter renforcer la fiabilité du système RAID, vous pouvez utiliser RAID 6. Avec ce niveau, le tableau peut toujours être reconstruit même si deux disques tombent en panne. Avec RAID 6, au moins 4 disques durs sont nécessaires pour exécuter le tableau. Lors de l'exécution d'un système RAID logiciel, cette configuration a besoin de beaucoup de temps et de mémoire processeur.
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term>RAID 10 (RAID 1+0)</term>
   <listitem>
    <para>
     Cette mise en oeuvre RAID associe les fonctionnalités des systèmes RAID 0 et RAID 1 : les données sont d'abord mises en miroir dans des piles de disques distinctes, qui sont insérées dans une nouvelle pile de type RAID 0. Dans chaque sous-pile RAID 1, un disque peut tomber en panne sans que les données ne soient endommagées. Un minimum de quatre disques est requis pour exécuter un système RAID 10 et la quantité de disques doit être un nombre pair. Ce type de RAID est utilisé pour une application de base de données susceptible de contenir une charge importante.
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term>Autres niveaux RAID</term>
   <listitem>
    <para>
     D'autres niveaux RAID ont été développés (RAID 2, RAID 3, RAID 4, RAIDn, RAID 10, RAID 0+1, RAID 30, RAID 50, etc.), dont certains dans le cadre de configurations propriétaires créées par des fabricants de matériel. Ces niveaux étant peu répandus, ils ne sont pas détaillés ici.
    </para>
   </listitem>
  </varlistentry>
 </variablelist>

 <section xml:id="sec-yast2-system-raid-conf">
  <title>Configuration de Soft RAID avec YaST</title>
  <para>
   Pour configurer <guimenu>RAID</guimenu> avec YaST, utilisez l'outil de partitionnement en mode expert de YaST, décrit à la <xref linkend="sec-yast2-i-y2-part-expert"/>. Cet outil de partitionnement permet de modifier et de supprimer des partitions existantes, et d'en créer de nouvelles pour les utiliser avec Soft RAID :
  </para>
  <procedure>
   <step>
    <para>
     Sélectionnez un disque dur dans <guimenu>Disques durs</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Placez-vous sur l'onglet <guimenu>Partitions</guimenu>.
    </para>
   </step>
   <step>
    <para>
     Cliquez sur <guimenu>Ajouter</guimenu> et indiquez la taille de la partition RAID souhaitée sur ce disque.
    </para>
   </step>
   <step>
    <para>
     Cliquez sur <guimenu>Ne pas formater la partition</guimenu> et remplacez l'<guimenu>ID du système de fichiers</guimenu> par <guimenu>0xFD Linux RAID</guimenu>. Ne montez pas cette partition.
    </para>
   </step>
   <step>
    <para>
     Répétez cette procédure jusqu'à ce que vous ayez défini tous les volumes physiques souhaités sur les disques disponibles.
    </para>
   </step>
  </procedure>
  <para>
   Pour RAID 0 et RAID 1, au moins deux partitions sont nécessaires ; pour RAID 1, vous devez même en avoir exactement deux, pas plus. Si vous utilisez RAID 5, vous devez disposez d'au moins trois partitions, et pour RAID 6 et RAID 10, il vous en faut au minimum quatre. Il est recommandé d'utiliser des partitions de même taille. Les partitions RAID doivent être situées sur des disques durs différents afin de diminuer le risque de perte de données au cas où l'une des partitions serait défectueuse (RAID 1 et 5) et afin d'optimiser les performances de RAID 0. Après avoir créé toutes les partitions à utiliser avec RAID, cliquez sur <menuchoice><guimenu>RAID</guimenu><guimenu>Ajouter un RAID</guimenu></menuchoice> pour démarrer la configuration de RAID.
  </para>
  <para>
   Dans la boîte de dialogue suivante, choisissez entre les niveaux RAID 0, 1, 5, 6 ou 10. Sélectionnez ensuite toutes les partitions de type <quote>Linux RAID</quote> ou <quote>Linux native</quote>que doit utiliser le système RAID. Aucune partition d'échange ou DOS n'est affichée.
  </para>
  <tip>
   <para>
    Dans le cas des types RAID où l'ordre des disques ajoutés a de l'importance, vous pouvez marquer chaque disque avec une lettre comprise entre A et E. Cliquez sur le bouton <guimenu>Classer</guimenu>, sélectionnez le disque et cliquez ensuite sur l'un des boutons <guimenu>Classe X</guimenu>, où X correspond à la lettre que vous souhaitez assigner au disque. Utilisez cette méthode pour assigner tous les disques RAID disponibles, puis confirmez en cliquant sur <guimenu>OK</guimenu>. Vous pouvez facilement trier les disques classés à l'aide des boutons <guimenu>Triés</guimenu> ou <guimenu>Intercalés</guimenu>, ou encore ajouter un modèle à partir d'un fichier texte à l'aide de l'option <guimenu>Fichier de modèle</guimenu>.
   </para>
  </tip>
  <figure xml:id="fig-yast2-system-raid-conf">
   <title>Partitions RAID</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="yast2_raid4.png" width="75%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="yast2_raid4.png" width="75%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
  <para>
   Pour ajouter une partition non assignée au volume RAID sélectionné, cliquez d'abord sur la partition, puis sur <guimenu>Ajouter</guimenu>. Assignez toutes les partitions réservées pour RAID. Sinon, l'espace de ces partitions reste inutilisé. Après avoir assigné toutes les partitions, cliquez sur <guimenu>Suivant</guimenu> pour sélectionner les <guimenu>Options RAID</guimenu> disponibles.
  </para>
  <para>
   À la dernière étape, définissez le système de fichiers à utiliser, ainsi que le codage et le point de montage du volume RAID. Une fois la configuration terminée (cliquez sur <guimenu>Terminer</guimenu>), vous pouvez voir le périphérique <filename>/dev/md0</filename>, ainsi que les autres, signalés par <emphasis>RAID</emphasis> dans le programme de partitionnement en mode expert.
  </para>
 </section>

 <section>
  <title>Dépannage</title>
  <para>
   Reportez-vous au fichier <filename>/proc/mdstat</filename> pour savoir si une partition RAID a été endommagée. En cas de défaillance système, arrêtez votre système Linux et remplacez le disque dur défectueux par un nouveau disque partitionné de la même manière. Redémarrez ensuite votre système et entrez la commande <command>mdadm /dev/mdX --add /dev/sdX</command>. Remplacez « X » par vos identificateurs de périphérique. Cette commande intègre automatiquement le nouveau disque dur dans le système RAID et le reconstruit complètement.
  </para>
  <para>
   Bien que vous puissiez accéder à toutes les données lors de la reconstruction, vous rencontrerez peut-être des problèmes de performances jusqu'à ce que le RAID soit complètement reconstruit.
  </para>
 </section>

<?dbfo-need height="10em"?>



 <section>
  <title>pour plus d'informations</title>
  <para>
   Vous trouverez des instructions de configuration, ainsi que d'autres détails sur Soft RAID, dans les HOWTO (Guides pratiques), à l'adresse suivante :
  </para>
  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     <filename>/usr/share/doc/packages/mdadm/Software-RAID.HOWTO.html</filename>
    </para>
   </listitem>
   <listitem>
    <para>
     <link xlink:href="http://raid.wiki.kernel.org"/>
    </para>
   </listitem>
  </itemizedlist>
  <para>
   Des listes de diffusion concernant Linux RAID sont disponibles, notamment à l'adresse <link xlink:href="http://marc.info/?l=linux-raid"/>.
  </para>
 </section>
</section>
