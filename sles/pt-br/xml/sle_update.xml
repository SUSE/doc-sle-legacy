<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet href="urn:x-suse:xslt:profiling:docbook51-profile.xsl"
    type="text/xml"
    title="Profiling step"
?>
<!DOCTYPE chapter
[
   <!ENTITY % entities SYSTEM "entity-decl.ent">
   %entities;
]>


<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.1" xml:base="sle_update.xml" xml:id="cha-update-sle"><title>Atualizando o SUSE Linux Enterprise</title><info><abstract>
  <para>
   O SUSE® Linux Enterprise (SLE) tem a opção de atualizar um sistema existente para a nova versão sem reinstalá-lo completamente. Não há necessidade de uma nova instalação. Dados existentes, como diretórios pessoais e configuração do sistema, permanecem intactos. Durante o ciclo de vida do produto, é possível aplicar Service Packs para aumentar a segurança do sistema, corrigir defeitos de software e obter acesso a novos recursos. Faça a instalação de uma unidade de CD ou de DVD ou de uma fonte de instalação de rede central.
  </para>
 </abstract></info>
 
 
 <section xml:id="sec-update-terminology">
  <title>Terminologia</title>

  <para>
   Este capítulo menciona vários termos. Para compreender as informações, leia as definições abaixo:
  </para>

  <variablelist>
   <varlistentry>
    <term>Backporting</term>
    <listitem>
     <para>
      Backporting é o ato de adaptar mudanças específicas de uma versão mais recente do software e aplicá-las a uma versão mais antiga. Ele é mais utilizado para corrigir falhas de segurança em componentes de software mais antigos. Normalmente, ele também faz parte de um modelo de manutenção que oferece melhorias ou (menos comum) novos recursos.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>

    <term>Deltarpm</term>
    <listitem>
     <para>
      Deltarpm consiste apenas na diferença binária entre duas versões definidas de um pacote e, portanto, tem o menor tamanho de download. Antes de ser instalado, o pacote RPM completo é reconstruído na máquina local.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Downstream</term>
    <listitem>
     <para>
      Uma metáfora de como o software é desenvolvido no mundo open source (compare com <emphasis>upstream</emphasis>). O termo <emphasis>downstream</emphasis> refere-se a pessoas ou organizações, como SUSE, que integram o código-fonte de upstream a outro software para compilar uma distribuição para ser utilizada pelos usuários finais. Dessa maneira, o software flui de forma descendente (downstream) de seus desenvolvedores até os usuários finais por meio dos integradores.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Migração Online</term>
    <listitem>
     <para>
      Atualização para um Service Pack (SP) usando as ferramentas de atualização online (e não a mídia de instalação) para instalar os respectivos patches. Isso atualiza todos os pacotes do sistema instalado para o estado mais recente, incluindo as atualizações do SP3 e do SP2.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>

    <term>Pacote</term>
    <listitem>
     <para>
      Pacote é um arquivo comprimido no formato <literal>rpm</literal> que contém todos os arquivos de determinado programa, incluindo componentes opcionais como configuração, exemplos e documentação.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>

    <term>Patch</term>
    <listitem>
     <para>
      Um patch consiste em um ou mais pacotes e pode ser aplicado por meio de deltarpms. Ele também pode introduzir dependências nos pacotes que ainda não estão instalados.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Service Packs (SP)</term>
    <listitem>
     <para>
      Combina vários patches em um formulário fácil de instalar ou implantar. Os service packs são numerados, geralmente contendo correções de segurança, atualizações, upgrades ou aprimoramentos de programas.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Upstream</term>
    <listitem>
     <para>
      Uma metáfora de como o software é desenvolvido no mundo open source (compare com <emphasis>downstream</emphasis>). O termo <emphasis>upstream</emphasis> refere-se ao projeto original, autor ou mantenedor de um software que é distribuído como código-fonte. Feedback, patches, melhorias de recursos ou outros aperfeiçoamentos fluem dos usuários finais ou colaboradores até os desenvolvedores de upstream. Eles decidem se a solicitação será integrada ou rejeitada.
     </para>
     <para>
      Se os membros do projeto decidirem integrar a solicitação, ela aparecerá nas versões mais recentes do software. Uma solicitação aceita beneficia todas as partes envolvidas.
     </para>
     <para>
      Se a solicitação não for aceita, vários motivos poderão estar em jogo. Talvez seu estado não seja compatível com as diretrizes do projeto, seja inválido, já esteja integrado ou não seja do interesse nem faça parte dos planos de um projeto. Uma solicitação não aceita dificulta o trabalho dos desenvolvedores de upstream, já que eles precisam manter seus patches em sincronia com o código de upstream. Essa prática em geral é evitada, mas às vezes ainda é necessária.
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term>Atualização</term>
    <listitem>
     <para>
      Instalação de uma versão mais recente <emphasis>secundária</emphasis> de um pacote.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Upgrade</term>
    <listitem>
     <para>
      Instalação de uma versão mais recente <emphasis>principal</emphasis> de um pacote ou distribuição, que agrega <emphasis> novos recursos</emphasis>.
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </section>
 <section xml:id="sec-update-nmm">
  <title>Modelo de manutenção do SUSE Linux Enterprise 11</title>

  <para>
   O Modelo de Manutenção do SUSE Linux Enterprise 11 combina a flexibilidade e o controle dos seus service packs. Ele oferece as seguintes vantagens:
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     Torna os service packs mais leves e fáceis de serem testados e implantados.
    </para>
   </listitem>
   <listitem>
    <para>
     Permite a coexistência com versões mais antigas, mas com suporte a todo o sistema.
    </para>
   </listitem>
   <listitem>
    <para>
     Atende às necessidades do mercado entre os service packs através de aprimoramentos seletivos e permite mais atualizações no repositório de atualizações geral. Com a seleção dos aprimoramentos, ele reduz os longos períodos entre os service packs.
    </para>
   </listitem>
  </itemizedlist>

  <section xml:id="sec-update-background">
   <title>Informações de segundo plano</title>
   <para>
    Nos últimos anos, com o nítido desejo de fazer melhorias com base nos feedbacks dos clientes, o SUSE implementou diversas mudanças no que diz respeito à forma como disponibilizamos atualizações aos nossos usuários:
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      No SLES 9, havia apenas um repositório de atualizações que coletava todas as atualizações; a atualização da versão mais recente era a única suportada.
     </para>
    </listitem>
    <listitem>
     <para>
      A partir do SLES 10 SP1, foi introduzido o conceito de um <quote>repositório específico ao SP</quote>. Isso significa que todas as atualizações para determinado service pack são disponibilizadas em um repositório específico. Assim que os usuários migrassem para um service pack mais recente, eles perderiam o acesso aos repositórios anteriores caso se registrassem diretamente no Novell Customer Center. Os usuários do SMT ou do SUSE Manager podiam, e ainda podem, assinar qualquer canal de SP gratuitamente. O principal motivo dessa mudança era o conceito de um período de substituição de 6 meses (suporte a service pack n-1) para permitir a validação do service pack lançado e um tempo para a migração dos clientes, durante o qual eles continuariam sendo mantidos e suportados integralmente dentro do SP antigo.
     </para>
    </listitem>
    <listitem>
     <para>
      O SLES 11 GA e o SLES 11 SP1 seguiam o modelo do SLES 10. Com o SLES 11 SP2, nós apresentamos um novo modelo de repositório que consiste em:
     </para>
     <orderedlist numeration="lowerroman" spacing="normal">
      <listitem>
       <para>
        Repositório de atualizações do SLES 11 SP1 ainda assinado. Todas as atualizações que se aplicavam ao SP2 eram também, ou unicamente, lançadas no repositório de atualizações do SP1. Isso significa que todas as atualizações compatíveis com a ABI e a API continuavam sendo disponibilizadas aqui.
       </para>
      </listitem>
      <listitem>
       <para>
        O Repositório de atualizações do SLES 11 SP2 inclui apenas as atualizações mais recentes e inovadoras que não podem ser disponibilizadas no Repositório de atualizações do SP1 (por vários motivos). Além disso, nós introduzimos um repositório básico com um <quote>espaço</quote> para os pacotes que não eram lançados no repositório de atualizações nem do SP1 nem do SP2.
       </para>
      </listitem>
      <listitem>
        <para>O SLES 11 SP4 terá um modelo de canal semelhante ao do SLES 10. O modelo foi tido como o modo mais simples e rápido de lançar atualizações para determinado Service Pack. Todas as atualizações serão lançadas por meio de um canal de atualização especial. Haverá outros canais disponíveis na máquina, mas os canais antigos serão removidos. </para>
      </listitem>
     </orderedlist>
    </listitem>
   </itemizedlist>
   <para>
    A <xref linkend="fig-update-maintenance-evolution"/> demonstra alguns dos aspectos mencionados acima.
   </para>
   <figure xml:id="fig-update-maintenance-evolution">
    <title>Evolução da entrega da manutenção (aplica-se também ao SLED)</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="new-maintenance-model.svg" width="75%"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="new-maintenance-model.png" width="75%"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    Nossos produtos possuem um ciclo de vida de 10 anos: suporte geral de 10 anos e suporte estendido de 3 anos. As versões principais são criadas a cada 4 anos, e os service packs a cada 18 meses. O Suporte a Service Pack de Longo Prazo é um período de estendido ou um ciclo de vida da versão estendido (consulte a <xref linkend="fig-update-maintenance-long-term-service-pack"/>).
   </para>
   <figure xml:id="fig-update-maintenance-long-term-service-pack">
    <title>Suporte a Service Pack de longo prazo</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="long-term-service-pack-support.svg" width="75%"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="long-term-service-pack-support.png" width="75%"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    O Suporte a Service Pack de Longo Prazo requer inscrição ativa, seja do tipo padrão ou prioritário. Ele não afeta os termos da inscrição L1 ou L2. As atualizações de segurança são consideradas <quote>proativas</quote>: trata-se de quaisquer vulnerabilidades críticas não controladas pelo usuário, explorações da raiz local no Kernel ou outras explorações de raiz executadas diretamente, sem interação do usuário.
   </para>
  </section>

  <section xml:id="sec-update-supportlevel-lifecycle">
   <title>Níveis de suporte</title>
   <para>
    A faixa dos níveis de suporte estendido começa no oitavo ano e termina no décimo ano. Eles incluem diagnóstico contínuo no nível de engenharia L3 e correções de bugs críticas reativas. Esses níveis de suporte atualizam de maneira pró-ativa as explorações comuns de raiz local no Kernel ou outras explorações de raiz diretamente executáveis, sem a intervenção do usuário. Além disso, oferecem suporte a cargas de trabalho existentes, pilhas de software e hardware com lista de exclusão de pacotes limitada. Consulte a visão geral na <xref linkend="tab-security-and-bug-fixes"/>.
   </para>
   <table xml:id="tab-security-and-bug-fixes">
    <title>Atualizações de segurança e correções de bugs</title>
    <tgroup cols="6">
     <colspec colname="c1"/>
     <colspec colname="c2"/>
     <colspec colname="c3"/>
     <colspec colname="c4"/>
     <colspec colname="c5"/>
     <colspec colname="c6"/>
     <thead>
      <row>
       <entry/>
       <entry namest="c2" nameend="c5" align="center">
        <para>
         — Suporte Geral —
        </para>
       </entry>
       <entry>
        <para>
         Suporte Estendido
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         Tópico
        </para>
       </entry>
       <entry>
        <para>
         SP Atual
        </para>
       </entry>
       <entry>
        <para>
         SP (n-1)
<?dblinebreak ?>


         6 meses
        </para>
       </entry>
       <entry>
        <para>
         SP (n-1)
<?dblinebreak ?>


         com LTSS
        </para>
       </entry>
       <entry>
        <para>
         Anos 6 e 7
<?dblinebreak ?>


         com LTSS
        </para>
       </entry>
       <entry>
        <para>
         Anos 8, 9, 10
<?dblinebreak ?>


         com LTSS
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para>
         Serviços Técnicos L1/L2
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         Manutenção Pró-ativa
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry/>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry/>
      </row>
      <row>
       <entry>
        <para>
         Atualizações de Driver via PLDP
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry/>
       <entry/>
      </row>
      <row>
       <entry>
        <para>
         Atualizações de Segurança Pró-ativas
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry/>
      </row>
      <row>
       <entry>
        <para>
         Suporte de Engenharia L3
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         Backports disponíveis
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry/>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </table>
  </section>

  <section xml:id="sec-update-nmm-channels">
   <title>Modelo de canal</title>
   <para os="sles">
    Com o modelo de manutenção antigo, o <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> tinha dois canais atribuídos: <literal>SLES11-SPx-Pool</literal> e <literal>SLES11-SPx-Updates</literal>. Durante uma migração online para o SPx+1, esses canais foram temporariamente substituídos por <literal>SLES11-SPx-Online</literal>.
   </para>
   
   <para>
    Com o SUSE Linux Enterprise SP 2, o layout do canal foi modificado para permitir os benefícios do novo modelo de manutenção. A <xref linkend="tab-update-nmm-channels-sp2"/> inclui uma lista de todos os canais do SP1 ao SP3.
   </para>
   <table xml:id="tab-update-nmm-channels-sp2">
    <title>Layout do canal para SUSE Linux Enterprise 11 SP1, SP2 e SP3</title>

    <tgroup cols="3">
     <colspec colnum="1" colname="c1" colwidth="1.2*"/>
     <colspec colnum="2" colname="c2" colwidth="3*"/>
     <colspec colnum="3" colname="c3" colwidth="3*"/>
     <thead>
      <row>
       <entry>
        <para>
         Tipo
        </para>
       </entry>
       <entry>
        <para>
         SLES
        </para>
       </entry>
       <entry>
        <para>
         SLED
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para>
         Canais Obrigatórios
        </para>
       </entry>
       <entry>
        <para>
         SP1
        </para>
        <simplelist>
         <member><literal>SLES11-SP1-Pool</literal> </member> <member><literal>SLES11-SP1-Updates</literal> </member>
        </simplelist>
        <para>
         SP2
        </para>
        <simplelist>
         <member><literal>SLES11-SP1-Pool</literal> </member> <member><literal>SLES11-SP1-Updates</literal> </member> <member><literal>SLES11-SP2-Core</literal> </member> <member><literal>SLES11-SP2-Updates</literal> </member>
        </simplelist>
        <para>
         SP3
        </para>
        <simplelist>
         <member><literal>SLES11-SP3-Pool</literal> </member> <member><literal>SLES11-SP3-Updates</literal> </member>
        </simplelist>
         <para>SP4</para>
         <simplelist>
           <member><literal>SLES11-SP4-Pool</literal> </member> <member><literal>SLES11-SP4-Updates</literal></member>
         </simplelist>
       </entry>
       <entry>
        <para>
         SP1
        </para>
        <simplelist>
         <member><literal>SLED11-SP1-Pool</literal> </member> <member><literal>SLED11-SP1-Updates</literal> </member>
        </simplelist>
        <para>
         SP2
        </para>
        <simplelist>
         <member><literal>SLED11-SP1-Pool</literal> </member> <member><literal>SLED11-SP1-Updates</literal> </member> <member><literal>SLED11-SP2-Core</literal> </member> <member><literal>SLED11-SP2-Updates</literal> </member>
        </simplelist>
        <para>
         SP3
        </para>
        <simplelist>
         <member><literal>SLED11-SP3-Pool</literal> </member> <member><literal>SLED11-SP3-Updates</literal> </member>
        </simplelist>
        <para>SP4</para>
         <simplelist>
           <member><literal>SLED11-SP4-Pool</literal> </member> <member><literal>SLED11-SP4-Updates</literal></member>
         </simplelist>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         Canais Opcionais
        </para>
       </entry>
       <entry>
        <para>
         SP1
        </para>
        <simplelist>
         <member><literal>SLES11-SP1-Debuginfo-Pool</literal> </member> <member><literal>SLES11-SP1-Debuginfo-Updates</literal> </member>
        </simplelist>
        <para>
         SP2
        </para>
        <simplelist>
         <member><literal>SLES11-SP2-Debuginfo-Core</literal> </member> <member><literal>SLES11-SP2-Debuginfo-Updates</literal> </member> <member><literal>SLES11-Extras</literal> </member> <member><literal>SLES11-SP2-Extension-Store</literal> </member>
        </simplelist>
        <para>
         SP3
        </para>
        <simplelist>
         <member><literal>SLES11-SP3-Debuginfo-Core</literal> </member> <member><literal>SLES11-SP3-Debuginfo-Updates</literal> </member> <member><literal>SLES11-SP3-Extension-Store</literal> </member> <member><literal>SLES11-Extra</literal> </member>
        </simplelist>
         <para>SP4</para>
         <simplelist>
           <member><literal>SLES11-SP4-Debuginfo-Pool</literal> </member> <member><literal>SLES11-SP4-Debuginfo-Updates</literal></member> <member><literal>SLES11-Extra</literal></member> <member><literal>SLES11-Security-Module</literal></member>
         </simplelist>
       </entry>
       <entry>
        <para>
         SP1
        </para>
        <simplelist>
         <member><literal>SLED11-SP1-Debuginfo-Pool</literal> </member> <member><literal>SLED11-SP1-Debuginfo-Updates</literal> </member>
        </simplelist>
        <para>
         SP2
        </para>
        <simplelist>
         <member><literal>SLED11-SP2-Debuginfo-Core</literal> </member> <member><literal>SLED11-SP2-Debuginfo-Updates</literal> </member> <member><literal>SLED11-Extras</literal> </member> <member><literal>SLED11-SP2-Extension-Store</literal> </member>
        </simplelist>
        <para>
         SP3
        </para>
        <simplelist>
         <member><literal>SLED11-SP3-Debuginfo-Core</literal> </member> <member><literal>SLED11-SP3-Debuginfo-Updates</literal> </member> <member><literal>SLED11-SP3-Extension-Store</literal> </member> <member><literal>SLED11-Extra</literal> </member>
        </simplelist>
         <para>SP4</para>
         <simplelist>
           <member><literal>SLED11-SP4-Debuginfo-Pool</literal> </member> <member><literal>SLED11-SP4-Debuginfo-Updates</literal></member>
         </simplelist>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         (Exemplos) Específicos do Produto
        </para>
       </entry>
       <entry>
        <simplelist>
         <member><literal>SLES11-WebYaST-SP2-Pool</literal> </member> <member><literal>SLES11-WebYaST-SP2-Updates</literal> </member>
        </simplelist>
       </entry>
       <entry>
        <simplelist>
         <member><literal>SLED11-MSI-Updates</literal> </member>
        </simplelist>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </table>
   <variablelist>
    <title>Descrição dos canais obrigatórios</title>
    <varlistentry>
     <term>Principais</term>
     <listitem>
      <para>
       Um subconjunto da mídia de instalação descompactada que contém apenas os pacotes considerados <quote>básicos</quote> ao SPx (aproximadamente 30% do total do pacote). Os repositórios do SP incluem somente os pacotes específicos ao SP e seus temas (por exemplo, preparação de hardware). Existe apenas no SP2.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Atualizações</term>
     <listitem>
      <para>
       Atualizações de manutenção para pacotes no repositório <literal>Core</literal> ou <literal>Pool</literal> correspondente.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Pool</term>
     <listitem>
      <para>
       Contém todos os RPMs binários da mídia de instalação, mais as informações padrão e os metadados de status de suporte.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <variablelist>
    <title>Descrição dos canais opcionais</title>
    <varlistentry>
     <term>Debuginfo-Pool</term>
     <term>Debuginfo-Updates</term>
     <listitem>
      <para>
       Esses canais apresentam conteúdo estático. No entanto, apenas o canal <literal>Debuginfo-Updates</literal> recebe atualizações. Habilite esses canais se precisar instalar bibliotecas com informações de depuração em caso de problema.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Extension-Store</term>
     <listitem>
      <para> Ainda não está em uso. Supostamente, contém pacotes para produtos complementares (futuros). O canal Armazenamento de Extensões será removido a partir do SLES 11 SP4.</para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>LTSS-Updates</term>
     <listitem>
      <para>
       Atualizações de manutenção para pacotes no repositório <literal>Pool</literal> correspondente para instalações com LTSS (Long Term Support Service). Esses canais específicos requerem um contrato LTSS.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <section xml:id="sec-update-nmm-channels-origin">
    <title>Origem dos pacotes</title>
    <formalpara>
     <title>SUSE Linux Enterprise 11 SP3/SP4</title>
     <para>Com a instalação do SP3, há apenas dois canais disponíveis: SLES11-SP3-Pool e SLES11-SP3-Updates. Qualquer canal anterior do SP2 fica visível, mas não está habilitado. Esses canais desabilitados só são necessários para usuários com requisitos especiais. 
     </para>
    </formalpara>
   </section>
   <section xml:id="sec-update-nmm-channels-working">
    <title>Trabalhando com canais</title>
    <para>
     No registro, o sistema recebe canais do Customer Center. Os nomes dos canais são mapeados para URIs específicos no atendimento do cliente (consulte <link xlink:href="http://scc.suse.com"/>). Para listar todos os canais disponíveis em seu sistema, use <command>zypper</command> da seguinte forma:
    </para>
<screen>zypper repos -u</screen>

    <para>
     Esse comando mostra uma lista dos canais disponíveis em seu sistema. Cada canal é listado por seu álias/nome, e indica se está habilitado e se será atualizado. A opção <option>-u</option> também mostra o URI de origem.
    </para>
    <para>
     Para remover canais antigos (por exemplo, do SP1), use <command>zypper removerepo</command> e o(s) nome(s) do(s) canal(is). Por exemplo, para remover os canais antigos do SP1 e do SP2, use o seguinte comando:
    </para>
<screen>zypper removerepo SLES11-SP1-Pool SLES11-SP1-Updates \
  SLE11-SP1-Debuginfo-Pool SLE11-SP1-Debuginfo-Updates \
  SLES11-SP2-Core SLES11-SP2-Updates \
  SLE11-SP2-Debuginfo-Core SLES11-SP2-Extension-Store\
  SLE11-SP2-Debuginfo-Updates</screen>
    <para>
     Para adicionar novamente alguns dos canais, efetue login em <link xlink:href="http://www.novell.com/ncc"/> e selecione no menu <menuchoice> <guimenu>My Products (Meus Produtos) </guimenu> <guimenu>Mirror Credentials (Credenciais de Espelho)</guimenu> </menuchoice>. Você verá uma lista de URIs; somente os canais dessa lista de produtos podem ser adicionados. Por exemplo, para adicionar o Armazenamento de Extensões do SP2, use o seguinte comando (uma linha, sem barra invertida):
    </para>
<screen>zypper addrepo -n SLES11-SP2-Extension-Store \
 https://nu.novell.com/repo/$RCE/SLES11-SP2-Extension-Store/nu_novell_com:SLES11-SP2-Extension-Store</screen>
   </section>
    
    
  </section>
 
 </section>
  
 <section xml:id="sec-update-proc-prep-paths">
  <title>Caminhos de upgrade suportados para o SLE SP4</title>


  <variablelist>
   <varlistentry>
    <term>Fazendo upgrade do SLES 8, SLES 9 e NLD 9</term>
    <listitem>
     <para>
      Não há um caminho de upgrade direto suportado dessas versões. É recomendado executar uma nova instalação.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Fazendo upgrade do SUSE Linux Enterprise 10 (qualquer Service Pack)</term>
    <listitem>
      
     <para>É possível fazer upgrade do SLES 10 GA e SPx ou do SLES 11 GA e SP1 para o SLES 11 SP3, que talvez exija etapas de upgrade intermediárias:</para>
      <itemizedlist mark="bullet" spacing="normal">
        <listitem>
          <para>SLES 10 GA -&gt; SLES 10 SP1 -&gt; SLES 10 SP2 -&gt; SLES 10 SP3 -&gt; SLES 10 SP4 -&gt; SLES 11 SP3 ou</para>
        </listitem>
        <listitem>
          <para>SLES 11 GA -&gt; SLES 11 SP1 -&gt; SLES 11 SP2 -&gt; SLES 11 SP3 -&gt; SLES 11 SP4</para>
        </listitem>
      </itemizedlist>
     <para>O upgrade é permitido do SLES 10 SP4 por meio de uma mídia inicializável (incluindo boot PXE). Para obter referência, consulte as notas de versão em <link xlink:href="https://www.suse.com/releasenotes/x86_64/SUSE-SLES/11-SP4/#Update.General.Sequence"/>.
       </para>
      <para>
        Atenção usuários do SLED: alguns pacotes de desenvolvimento (devel) foram movidos da mídia de instalação <literal>SLED11-SP2</literal> para o repositório <literal>SLED11-Extras</literal>. Para evitar conflitos de dependência durante o upgrade, habilite esse repositório antes de fazer o upgrade real. Execute <command>yast2 repositories</command> e habilite <literal>SLED11-Extras</literal> nesse local. No SLES, essa etapa extra não é necessária.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Fazendo upgrade do SUSE Linux Enterprise 11 GA</term>
    <listitem>
     <para>
      Não há um caminho de migração direto suportado para o SUSE Linux Enterprise 11 SP3. Primeiramente, é necessário atualizar o SUSE Linux Enterprise 11 GA para o SP1. Depois prossiga para a <xref linkend="sec-update-sle11sp1"/> e a <xref linkend="sec-update-sle11sp2"/>.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Fazendo upgrade do SUSE Linux Enterprise 11 SP1</term>
    <listitem>
     <para>
      Consulte <xref linkend="sec-update-sle11sp1"/> para obter os detalhes.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Fazendo upgrade do SUSE Linux Enterprise 11 SP2</term>
    <listitem>
     <para>
      Consulte <xref linkend="sec-update-sle11sp2"/> para obter os detalhes.
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Fazendo upgrade do SUSE Linux Enterprise 11 SP3</term>
    <listitem>
     <para>
      Consulte <xref linkend="sec-update-sle11sp3"/> para obter os detalhes.
     </para>
    </listitem>
   </varlistentry> 
  </variablelist>

  <important>
   <title>Upgrades compatíveis com várias arquiteturas não são suportados</title>
   <para>
    
    Não há suporte para upgrades compatíveis com várias arquiteturas (32 bits para 64 bits e 64 bits para 32 bits).
   </para>
  </important>
  
 </section>
 <section xml:id="sec-update-prep">
  <title>Preparações gerais para atualização</title>

  <para>
   Antes de iniciar o procedimento de atualização, verifique se o sistema está preparado de forma apropriada. Entre outras coisas, a preparação envolve o backup dos dados e a verificação das notas de versão.
  </para>

  <section xml:id="sec-update-prep-backup">
   <title>Fazer um backup</title>
   <para>
    Antes de atualizar, copie os arquivos de configuração existentes em uma mídia separada (como dispositivo de fita, disco rígido removível, etc.) para fazer backup dos dados. Isso se aplica basicamente aos arquivos armazenados em <filename>/etc</filename>, assim como a alguns dos diretórios e arquivos em <filename>/var</filename> e <filename>/opt</filename>. Você também pode gravar os dados do usuário em <filename>/home</filename> (os diretórios <envar>HOME</envar>) em uma mídia de backup. Faça o backup desses dados como <systemitem class="username">root</systemitem>. Apenas o <systemitem class="username">root</systemitem> tem permissões de leitura para todos os arquivos locais.
   </para>
   <para>
    Se você selecionou <guimenu>Atualizar um Sistema Existente</guimenu> como o modo de instalação no YaST, poderá optar por fazer o backup (do sistema) em algum outro momento. É possível incluir todos os arquivos modificados e os arquivos do diretório <filename>/etc/sysconfig</filename>. Entretanto, esse não é um backup completo, já que todos os outros diretórios importantes mencionados anteriormente não estão incluídos. Encontre o backup no diretório <filename>/var/adm/backup</filename>.
   </para>
  </section>

  <section xml:id="sec-update-prep-disks">
   <title>Particionamento e espaço em disco</title>
   <para>
    Antes de iniciar a atualização, anote a partição raiz. O comando <command>df /</command> relaciona o nome do dispositivo da partição raiz. No <xref linkend="aus-update-df"/>, a partição raiz a ser anotada é a <filename>/dev/sda3</filename> (montada como <filename>/</filename>).
   </para>
   <example xml:id="aus-update-df">
    <title>Listar com <command>df -h</command></title>

<screen os="sles">Filesystem     Size  Used Avail Use% Mounted on
     /dev/sda3       74G   22G   53G  29% /
     tmpfs          506M     0  506M   0% /dev/shm
     /dev/sda5      116G  5.8G  111G   5% /home
     /dev/sda1       44G    4G   40G   9% /data</screen>
   </example>
   <para>
    O software tende a <quote>crescer</quote> a cada versão. Portanto, verifique o espaço de partição disponível com <command>df</command> antes de atualizar. Se você achar que está ficando sem espaço em disco, proteja os dados antes de atualizar e reparticionar o sistema. Não há uma regra geral sobre a quantidade de espaço que cada partição deve ter. As exigências de espaço dependem do seu perfil de particionamento específico e do software selecionado.
   </para>
  </section>

  <section xml:id="sec-update-prep-vms">
   <title>Encerrar máquinas virtuais</title>
   <para>
    Se a sua máquina atuar como Servidor de Host de VM do KVM ou Xen, encerre apropriadamente todos os Convidados de VM em execução antes da atualização. Do contrário, pode não ser possível acessar os convidados após a atualização.
   </para>
  </section>

  <section xml:id="sec-update-prep-relnotes">
   <title>Requisitos específicos da versão</title>
   <para>
    Para saber os requisitos específicos da versão, consulte as notas de versão incluídas no produto de atualização. Nas notas de versão, é possível encontrar informações adicionais sobre os procedimentos de upgrade.
   </para>
   <para>
    É possível ler online a versão atual do documento das notas de versão com as informações mais recentes sobre o <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> em <link xlink:href="http://www.suse.com/doc/sles11/#additional"/>.
   </para>
  </section>
 </section>
 <section xml:id="sec-update-sle11sp1">
  <title>Atualizando do SLE 11 SP1 para o SLE 11 SP2</title>

  <para>
   Há diferentes formas suportadas de atualização do sistema SUSE Linux Enterprise 11 SP1 para o Service Pack 2. É possível atualizar usando as ferramentas de atualização online para instalar os respectivos patches (<quote>Migração Online</quote>) ou através da mídia de instalação do Service Pack. Além disso, as atualizações podem ser feitas por meio de servidores que hospedam a SMT (Subscription Management Tool) ou o SUSE Manager.
  </para>

  <para>
   As seguintes ferramentas suportam a Migração Online:
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     <guimenu>YaST wagon</guimenu> (interface gráfica do usuário)
    </para>
   </listitem>
   <listitem>
    <para>
     <command>zypper</command> (linha de comando)
    </para>
   </listitem>
  </itemizedlist>

  <para>
   Se preferir, faça download da mídia completa do Service Pack (imagem ISO do DVD). Comece o processo de atualização inicializando de uma mídia física do Service Pack ou de uma fonte de instalação de rede.
  </para>

  <section xml:id="sec-update-sle11spx-online">
   <title>Migração Online</title>
   <para>
    A atualização do sistema pela migração online é feita no sistema que está em execução. Só é preciso reinicializar uma vez após o término da atualização.
   </para>
   <section xml:id="sec-update-sle11spx-online-requirements">
    <title>Requisitos</title>
    <para>
     Para fazer uma atualização online, os seguintes requisitos devem ser atendidos. Leia também a <xref linkend="sec-update-prep"/>.
    </para>
    <variablelist>
     <varlistentry>
      <term>Registro de Produto</term>
      <listitem>
       <para>
        Para se conectar aos canais de atualização, seu produto deve estar registrado. Se não estiver, execute o módulo <guimenu>Configuração do Novell Customer Center</guimenu> no YaST ou a ferramenta de linha de comando <command>suse_register</command> para iniciar o registro.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Executar Atualização Online</term>
      <listitem>
       <para>
        Verifique se a versão instalada tem os patches mais recentes também instalados. Execute a Atualização Online antes da Migração Online. Ao usar uma interface gráfica, inicie a Atualização Online ou o applet de atualização do YaST. Na linha de comando, execute os seguintes comandos (o último precisa ser executado duas vezes):
       </para>
<screen>zypper ref -s
zypper update -t patch
zypper update -t patch</screen>
       <para>
        Se necessário, reinicialize o sistema.
       </para>
       <para>
        Consulte o <xref linkend="cha-onlineupdate-you"/> ou a <xref linkend="sec-zypper-softup"/>. para obter mais informações. sobre as ferramentas de atualização online.
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Software de Terceiros</term>
      <listitem>
       <para>
        Se a configuração envolver software de terceiros ou complementar, teste esse procedimento em outra máquina para garantir que as dependências não sejam danificadas pela atualização.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <important>
     <title>Sempre executar a migração online completa</title>
     <para>
      A migração online deve sempre ser realizada do início ao fim. Se ela for interrompida durante sua execução, o sistema será corrompido sem meios de recuperação.
     </para>
    </important>
   </section>
   <section xml:id="sec-update-sle11spx-online-wagon">
    <title>Migração online com o YaST <guimenu>Wagon</guimenu></title>
     <para>Se você tem o sistema SLES 11 SP1, encontre as etapas necessárias em <link xlink:href="https://www.suse.com/support/kb/doc.php?id=7011872"/>. O seguinte procedimento aplica-se à migração online do SP2 para o SP3.</para>     
    <procedure>
     <step>
      <para>
       Com todos os requisitos atendidos (consulte a <xref linkend="sec-update-sle11spx-online-requirements"/>), o applet de atualização na bandeja exibirá uma mensagem informando que há um upgrade de distribuição disponível. Clique nela para iniciar o YaST <guimenu>Wagon</guimenu>. Se preferir, execute <command>/usr/sbin/wagon</command> como <systemitem class="username">root</systemitem> na linha de comando.
      </para>
     </step>
     <step>
      <para>
       Confirme a caixa de diálogo <guimenu>Bem-vindo</guimenu> clicando em <guimenu>Avançar</guimenu>.
      </para>
     </step>
     <step>
      <para>
       Se o <guimenu>Wagon</guimenu> determinar que os requisitos não foram cumpridos (há atualizações de manutenção necessárias disponíveis, mas que ainda não foram instaladas), ele fará uma autoatualização, o que pode exigir a reinicialização. Siga as instruções na tela.
      </para>
     </step>
     <step>
      <para>
       Escolha o método de atualização na caixa de diálogo seguinte. Escolha <guimenu>Atendimento ao Cliente</guimenu> para usar a configuração padrão (recomendada).
      </para>
      <para>
       Clique em <guimenu>URL Personalizado</guimenu> para escolher manualmente os canais de software usados na migração online. Uma lista de canais será exibida com opções para habilitar, desabilitar, adicionar ou apagar manualmente os canais. Adicione a(s) fonte(s) de atualização do SP2. Ela pode ser a mídia de instalação do SP2 ou os canais <literal>SP2-Core</literal> e <literal>SP2-Updates</literal>. Clique em <guimenu>OK</guimenu> para retornar à caixa de diálogo <guimenu>Método de Atualização</guimenu>.
      </para>
      <para>
       Para revisar as mudanças feitas na configuração de canal em virtude do processo de atualização, selecione <guimenu>Verificar Mudanças Automáticas no Repositório</guimenu>.
      </para>
      <para>
       Continue com <guimenu>Avançar</guimenu>.
      </para>
     </step>
     <step>
      <para>
       O sistema será registrado novamente. Durante esse processo, os canais <literal>SP2-Core</literal> e <literal>SP2-Updates</literal> são adicionados ao sistema (consulte a <xref linkend="sec-update-nmm-channels"/> para obter mais informações). Confirme a adição dos canais.
      </para>
     </step>
     <step>
      <para>
       Se você selecionou <guimenu>Verificar Mudanças Automáticas no Repositório</guimenu> na caixa de diálogo <guimenu>Método de Atualização</guimenu>, a lista de repositórios será exibida com opções para habilitar, desabilitar, adicionar ou apagar manualmente os canais. Quando estiver pronto, clique em <guimenu>OK</guimenu> para continuar.
      </para>
     </step>
     <step>
      <para>
       Escolha o tipo de migração:
      </para>
      <variablelist>
       <varlistentry>
        <term><guimenu>Migração completa</guimenu>
        </term>
        <listitem>
         <para>
          Atualiza todos os pacotes para o último nível do SP2.
         </para>
        </listitem>
       </varlistentry>
       <varlistentry>
        <term><guimenu>Migração Mínima</guimenu>
        </term>
        <listitem>
         <para>
          Atualiza um conjunto mínimo de pacotes para último nível do SP2.
         </para>
        </listitem>
       </varlistentry>
      </variablelist>
      <para>
       Clique em <guimenu>Avançado</guimenu> para selecionar manualmente os repositórios usados para o upgrade.
      </para>
      <para>
       Confirme sua seleção.
      </para>
     </step>
     <step>
      <para>
       A tela <guimenu>Configurações do Upgrade da Distribuição</guimenu> é aberta com um resumo da configuração de atualização. As seguintes seções estão disponíveis:
      </para>
      <variablelist>
       <varlistentry>
        <term><guimenu>Produtos acessórios</guimenu>
        </term>
        <listitem>
         <para>
          É possível adicionar produtos complementares do SUSE Linux Enterprise Server ou produtos de terceiros aqui.
         </para>
        </listitem>
       </varlistentry>
       <varlistentry>
        <term><guimenu>Opções de Atualização</guimenu>
        </term>
        <listitem>
         <para>
          Lista as ações que serão realizadas durante a atualização. Você escolhe se vai fazer download de todos os pacotes antes de instalá-los (padrão, recomendado) ou se vai fazer download e instalar os pacotes um de cada vez.
         </para>
        </listitem>
       </varlistentry>
       <varlistentry>
        <term><guimenu>Pacotes</guimenu>
        </term>
        <listitem>
         <para>
          Visão geral das estatísticas da atualização.
         </para>
        </listitem>
       </varlistentry>
       <varlistentry>
        <term>Backup</term>
        <listitem>
         <para>
          Defina as opções de backup.
         </para>
        </listitem>
       </varlistentry>
      </variablelist>
      <para>
       Clique em <guimenu>Avançar</guimenu> e em <guimenu>Iniciar Atualização</guimenu> para continuar.
      </para>
      <important>
       <title>Interrompendo a migração online</title>
       <para>
        É seguro interromper a migração online nesta tela <emphasis>antes</emphasis> de clicar em <guimenu>Iniciar Atualização</guimenu> e em todas as telas anteriores. Clique em <guimenu>Interromper</guimenu> para sair do procedimento de atualização e restaurar o sistema ao estado em que estava antes de iniciar o YaST Wagon. Siga as instruções na tela e refaça o registro antes de sair do Wagon para remover os canais SP2 do sistema.
       </para>
      </important>
     </step>
     <step>
      <para>
       Durante o procedimento de atualização, as seguintes etapas são executadas:
      </para>
      <substeps performance="required">
       <step>
        <para>
         Os pacotes serão atualizados.
        </para>
       </step>
       <step>
        <para>
         O <command>SuSEconfig</command> será executado.
        </para>
       </step>
       <step>
        <para>
         O sistema será reinicializado (clique em <guimenu>OK</guimenu>).
        </para>
       </step>
       <step>
        <para>
         O sistema recém-atualizado será registrado novamente.
        </para>
       </step>
      </substeps>
     </step>
     <step>
      <para>
       O sistema foi atualizado com êxito para o Service Pack 2.
      </para>
     </step>
    </procedure>
    
   </section>
   <section xml:id="sec-update-sle11spx-online-zypper">
    <title>Migração online com o <command>zypper</command></title>
    <procedure>
     <step>
      <para>
       Quando todos os requisitos são atendidos (consulte a <xref linkend="sec-update-sle11spx-online-requirements"/>), os <quote>produtos</quote> necessários para a migração online são adicionados ao <filename>/etc/products.d</filename>. Execute o seguinte comando para obter a lista desses produtos:
      </para>

<screen>zypper se -t product | grep -h -- "-migration" | cut -d'|' -f2</screen>
      <para>
       Esse comando deve pelo menos retornar <literal os="sles">SUSE_SLES-SP2-migration</literal>. Dependendo do escopo da instalação, mais produtos poderão aparecer na lista.
      </para>
     </step>
     <step>
      <para>
       Instale os produtos da migração recuperados na etapa anterior com o comando <command>zypper in -t product</command> <replaceable>LISTA_DE_PRODUTOS</replaceable>, por exemplo
      </para>
<screen os="sles">zypper in -t product SUSE_SLES-SP2-migration</screen>

     </step>
     <step>
      <para>
       Registre os produtos instalados na etapa anterior para acessar os seguintes canais de atualização:
      </para>
<screen>suse_register -d 2 -L /root/.suse_register.log</screen>
     </step>
     <step>
      <para>
       Atualize novamente os repositórios e os serviços:
      </para>
<screen>zypper ref -s</screen>
     </step>
     <step>
      <para>
       Verifique a lista dos repositórios que você pode recuperar usando o comando <command>zypper lr</command>. <emphasis>Pelo menos</emphasis>, os seguintes repositórios precisam estar <guimenu>Habilitados</guimenu>:
      </para>
      <itemizedlist os="sles" mark="bullet" spacing="normal">
       <listitem>
        <para>
         <literal>SLES11-SP1-Pool</literal>
        </para>
       </listitem>
       <listitem>
        <para>
         <literal>SLES11-SP1-Updates</literal>
        </para>
       </listitem>
       <listitem>
        <para>
         <literal>SLES11-SP2-Core</literal>
        </para>
       </listitem>
       <listitem>
        <para>
         <literal>SLES11-SP2-Updates</literal>
        </para>
       </listitem>
      </itemizedlist>
      
      <para>
       Dependendo do escopo da instalação, outros repositórios para extensões ou produtos complementares terão que estar habilitados.
      </para>
      <para>
       Se um desses repositórios não estiver habilitado (por padrão, os do <literal>SP2</literal> não estarão habilitados após esse workflow), habilite-os com <command>zypper modifyrepo --enable</command> <replaceable>ÁLIAS DO REPOSITÓRIO</replaceable>, por exemplo:
      </para>
<screen os="sles">zypper modifyrepo --enable SLES11-SP2-Core SLES11-SP2-Updates</screen>

      <para>
       Se a instalação incluir repositórios de terceiros que possam não ser compatíveis com o SP2, desabilite-os com <command>zypper modifyrepo --disable</command> <replaceable>ÁLIAS DO REPOSITÓRIO</replaceable>.
      </para>
     </step>
     <step>
      <para>
       Agora está tudo pronto para executar o upgrade de distribuição com <command>zypper dup --from</command> <replaceable>REPO 1</replaceable> --from <replaceable>REPO 2</replaceable> <replaceable>...</replaceable>. Liste todos os repositórios necessários com a opção <option>--from</option>, por exemplo:
      </para>
<screen os="sles">zypper dup --from SLES11-SP2-Core --from SLES11-SP2-Updates</screen>

      <para>
       Confirme com <guimenu>y</guimenu> para começar o upgrade.
      </para>
     </step>
     <step>
      <para>
       Ao término do upgrade de distribuição da etapa anterior, a Migração Mínima terá sido executada (um conjunto mínimo de pacotes atualizados para o último nível do SP2). Ignore esta etapa se você não pretende executar a Migração Completa.
      </para>
      <para>
       Para realizar a Migração Completa (atualizar todos os pacotes para o último nível do SP2), execute o seguinte comando:
      </para>
<screen>zypper update -t patch</screen>
     </step>
     <step>
      <para>
       Assim que o upgrade para o SP2 for concluído, registre novamente seu produto:
      </para>
<screen>suse_register -d 2 -L /root/.suse_register.log</screen>
     </step>
     <step>
      <para>
       Por fim, reinicialize o sistema.
      </para>
     </step>
     <step>
      <para>
       O sistema foi atualizado com êxito para o Service Pack 2.
      </para>
     </step>
    </procedure>
   </section>
  </section>

  <section xml:id="sec-update-sle11spx-medium">
   <title>Atualizando pela inicialização de uma fonte de instalação</title>
   <para>
    Como alternativa à Migração Online (consulte a <xref linkend="sec-update-sle11spx-online"/> para obter os detalhes), é possível também atualizar o sistema inicializando de uma fonte de instalação: seja um DVD ou uma rede. A atualização é iniciada como uma instalação normal.
   </para>
   <para>
    Você obtém as imagens ISO do Service Pack 2 no site <link xlink:href="http://download.novell.com/"/>. Grave-as em um DVD ou prepare a fonte de instalação de rede conforme descrito na <xref linkend="sec-deployment-remoteinst-instserver"/>.
   </para>
   <section xml:id="sec-upgrade-install-from-dvd">
    <title>Atualizando de uma unidade de DVD local</title>
    <para>
     Antes de iniciar uma nova instalação de um SP do SUSE Linux Enterprise, verifique se todas as mídias de instalação (DVDs) do Service Pack estão disponíveis.
    </para>
    <procedure xml:id="upgrade-sp-instsp-fromsp">
     <title>Inicializando da mídia do Service Pack</title>
     <step>
      <para>
       Insira o primeiro meio do SP do SUSE Linux Enterprise e inicialize a máquina. Uma tela de boot similar à da instalação original do SUSE Linux Enterprise 11 será exibida.
      </para>
     </step>
     <step>
      <para>
       Selecione <guimenu>Instalação</guimenu> e prossiga conforme descrito nas instruções de instalação do YaST no <xref linkend="cha-inst"/>.
      </para>
     </step>
    </procedure>
   </section>
   <section xml:id="sec-upgrade-install-from-network">
    <title>Atualizando de uma fonte de instalação de rede</title>
    <para>
     Antes de iniciar a atualização de um SP do SUSE Linux Enterprise de uma fonte de instalação de rede, verifique se os seguintes requisitos foram atendidos:
    </para>
    <itemizedlist mark="bullet" spacing="normal">
     <listitem>
      <para>
       A fonte de instalação de rede está configurada de acordo com a <xref linkend="sec-deployment-remoteinst-instserver"/>.
      </para>
     </listitem>
     <listitem>
      <para>
       Existe uma conexão de rede ativa no servidor de instalação e na máquina de destino, o que inclui serviço de nomes, DHCP (opcional, mas necessário para boot PXE) e OpenSLP (opcional).
      </para>
     </listitem>
     <listitem>
      <para>
       Existe um DVD 1 do SP do SUSE Linux Enterprise para inicializar o sistema de destino <emphasis>ou</emphasis> uma configuração do sistema de destino para boot PXE de acordo com a <xref linkend="sec-deployment-remoteinst-boot-pxeprep" xrefstyle="HeadingOnPage"/>.
      </para>
     </listitem>
    </itemizedlist>
    <para>
     Consulte o <xref linkend="cha-deployment-remoteinst"/> para obter informações detalhadas sobre como iniciar o upgrade de um servidor remoto.
    </para>
    <section xml:id="sec-upgrade-install-from-network-dvdboot">
     <title>Instalação de rede: inicialização do CD</title>
     <para>
      Para realizar uma instalação de rede usando o DVD do SP como a mídia de boot, faça o seguinte:
     </para>
     <procedure>
      <step>
       <para>
        Insira o DVD 1 do SP do SUSE Linux Enterprise e inicialize a máquina. Uma tela de boot similar à da instalação original do SUSE Linux Enterprise 11 será exibida.
       </para>
      </step>
      <step>
       <para>
        Selecione <guimenu>Instalação</guimenu> para inicializar o Kernel do SP e, em seguida, use a tecla <keycap>F4</keycap> para selecionar o tipo de fonte de instalação em rede (FTP, HTTP, NFS ou SMB).
       </para>
      </step>
      <step>
       <para>
        Forneça as informações apropriadas de caminho ou selecione <guimenu>SLP</guimenu> como fonte de instalação.
       </para>
      </step>
      <step>
       <para>
        Selecione o servidor de instalação apropriado entre os oferecidos ou use o prompt de opções de boot para fornecer o tipo de fonte de instalação e sua localização como na <xref linkend="sec-i-yast2-source-network"/>. O YaST é iniciado.
       </para>
       <para>
        Conclua a instalação conforme descrito na <xref linkend="sec-update-sle11spx-medium-update"/>.
       </para>
      </step>
     </procedure>
    </section>
    <section xml:id="sec-upgrade-install-from-network-pxeboot">
     <title>Instalação de rede – inicialização PXE</title>
     <para>
      Para executar uma instalação de rede de um Service Pack do SUSE Linux Enterprise por rede, faça o seguinte:
     </para>
     <procedure>
      <step>
       <para>
        Ajuste a configuração do seu servidor DHCP para fornecer as informações de endereço para a inicialização PXE conforme a <xref linkend="sec-deployment-remoteinst-boot-pxeprep"/>.
       </para>
      </step>
      <step>
       <para>
        Configure um servidor TFTP para manter a imagem de inicialização necessária para a inicialização PXE.
       </para>
       <para>
        Use o primeiro CD ou DVD do Service Pack do SUSE Linux Enterprise para essa finalidade ou siga as instruções na <xref linkend="sec-deployment-remoteinst-boot-tftp"/>.
       </para>
      </step>
      <step>
       <para>
        Prepare a inicialização PXE e o Wake-on-LAN na máquina de destino.
       </para>
      </step>
      <step>
       <para>
        Inicialize o sistema de destino e use o VNC para conectar-se remotamente à rotina de instalação que está sendo executada nessa máquina. Consulte a <xref linkend="sec-deployment-remoteinst-monitor-vnc"/> para obter mais informações.
       </para>
      </step>
      <step>
       <para>
        Conclua a instalação conforme descrito na <xref linkend="sec-update-sle11spx-medium-update"/>.
       </para>
      </step>
     </procedure>
    </section>
   </section>
   <section xml:id="sec-update-sle11spx-medium-update">
    <title>Procedimento de atualização</title>
    <para>
     Após inicializar com êxito de uma mídia de instalação ou da rede, faça o seguinte para começar a atualização:
    </para>
    <procedure>
     <step>
      <para>
       Na tela <guimenu>Bem-vindo</guimenu>, escolha <guimenu>Idioma</guimenu> e <guimenu>Teclado</guimenu> e aceite o contrato de licença. Continue com <guimenu>Avançar</guimenu>.
      </para>
     </step>
     <step>
      <para>
       Caso tenha inicializado de uma mídia física, execute a <guimenu>Verificação de Mídia</guimenu> para verificar a integridade da mídia. Apenas ignore esta etapa se já tiver verificado a mídia.
      </para>
     </step>
     <step>
      <para>
       Na tela <guimenu>Modo de Instalação</guimenu>, escolha <guimenu>Atualizar</guimenu>. Clique em <guimenu>Avançar</guimenu> para iniciar o procedimento de atualização.
      </para>
     </step>
    </procedure>
   </section>
  </section>

  <section xml:id="sec-update-sle11spx-smt">
   <title>Atualizando pela SMT (Subscription Management Tool)</title>
   <para>
    Em vez de fazer download das atualizações para cada sistema cliente do servidor de atualização da Novell, é possível usar a SMT (Subscription Management Tool) do SUSE Linux Enterprise para espelhar as atualizações para um servidor local.
   </para>
   <para>
    Essa ferramenta atua como proxy do Novell Customer Center para os registros do cliente e como repositório de atualização de software. A documentação da SMT no site <link xlink:href="http://www.suse.com/doc/smt11/"/> apresenta uma visão geral dos recursos e as instruções de como implementá-la.
   </para>
  </section>

  <section xml:id="sec-update-sle11spx-manager">
   <title>Atualizando pelo SUSE Manager</title>
   <para>
    O SUSE Manager é uma solução de servidor que oferece atualizações, patches e correções de segurança para clientes SUSE Linux Enterprise. Ele vem com um conjunto de ferramentas e uma interface do usuário baseada na Web para as tarefas de gerenciamento.
   </para>
   <para>
    A documentação do SUSE Manager no site <link xlink:href="http://www.suse.com/doc/suse_manager/"/> apresenta uma visão geral dos recursos e instruções de como configurar servidor e clientes.
   </para>
  </section>
 </section>
 <section xml:id="sec-update-sle11sp2">
  <title>Atualizando do SLE 11 SP2 para o SLE 11 SP3</title>

  

  <para>
   As seguintes ferramentas suportam a Migração Online:
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     <guimenu>YaST wagon</guimenu> (interface gráfica do usuário)
    </para>
   </listitem>
   <listitem>
    <para>
     <command>zypper</command> (linha de comando)
    </para>
   </listitem>
  </itemizedlist>

  <para>
   Ao atualizar o sistema pela migração online, a atualização é realizada com o sistema em execução. Só é preciso reinicializar uma vez após o término da atualização. Ainda é possível atualizar com as seguintes alternativas:
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     <xref linkend="sec-update-sle11spx-medium"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="sec-update-sle11spx-smt"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="sec-update-sle11spx-manager"/>
    </para>
   </listitem>
  </itemizedlist>

  <section xml:id="sec-update-sle11sp2-online-requirements">
   <title>Requisitos</title>
   <para>
    Para fazer uma atualização online, os seguintes requisitos devem ser atendidos. Leia também a <xref linkend="sec-update-prep"/>.
   </para>
   <variablelist>
    <varlistentry>
     <term>Registro de Produto</term>
     <listitem>
      <para>
       Para se conectar aos canais de atualização, seu produto deve estar registrado. Se não estiver, execute o módulo <guimenu>Configuração do Novell Customer Center</guimenu> no YaST ou a ferramenta de linha de comando <command>suse_register</command> para iniciar o registro.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Executar Atualização Online</term>
     <listitem>
      <para>
       Verifique se a versão instalada tem os patches mais recentes também instalados. Execute a Atualização Online antes da Migração Online. Ao usar uma interface gráfica, inicie a Atualização Online ou o applet de atualização do YaST. Na linha de comando, execute os seguintes comandos (o último precisa ser executado duas vezes):
      </para>
<screen>zypper ref -s
zypper update -t patch
zypper update -t patch</screen>
      <para>
       Se necessário, reinicialize o sistema.
      </para>
      <para>
       Consulte o <xref linkend="cha-onlineupdate-you"/> ou a <xref linkend="sec-zypper-softup"/> para obter mais informações sobre as ferramentas de atualização online.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Software de Terceiros</term>
     <listitem>
      <para>
       Se a configuração envolver software de terceiros ou complementar, teste esse procedimento em outra máquina para garantir que as dependências não sejam danificadas pela atualização.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <important>
    <title>Sempre executar a migração online completa</title>
    <para>
     A migração online deve sempre ser realizada do início ao fim. Se ela for interrompida durante sua execução, o sistema será corrompido sem meios de recuperação.
    </para>
   </important>
  </section>

  <section xml:id="sec-update-sle11sp2-online-wagon">
   <title>Migração online com o YaST <guimenu>Wagon</guimenu></title>
   <procedure>
    <step>
     <para>
      Com todos os requisitos atendidos (consulte a <xref linkend="sec-update-sle11spx-online-requirements"/>), o applet de atualização na bandeja exibirá uma mensagem informando que há um upgrade de distribuição disponível. Clique nela para iniciar o YaST <guimenu>Wagon</guimenu>. Se preferir, execute <command>/usr/sbin/wagon</command> como <systemitem class="username">root</systemitem> na linha de comando.
     </para>
    </step>
    <step>
     <para>
      Confirme a caixa de diálogo <guimenu>Bem-vindo</guimenu> clicando em <guimenu>Avançar</guimenu>.
     </para>
    </step>
    <step>
     <para>
      Se o <guimenu>Wagon</guimenu> determinar que os requisitos não foram cumpridos (há atualizações de manutenção necessárias disponíveis, mas que ainda não foram instaladas), ele fará uma autoatualização, o que pode exigir a reinicialização. Siga as instruções na tela.
     </para>
    </step>
    <step>
     <para>
      Escolha o método de atualização na caixa de diálogo seguinte. Escolha <guimenu>Atendimento ao Cliente</guimenu> para usar a configuração padrão (recomendada).
     </para>
     <para>
      Clique em <guimenu>URL Personalizado</guimenu> para escolher manualmente os canais de software usados na migração online. Uma lista de canais será exibida com opções para habilitar, desabilitar, adicionar ou apagar manualmente os canais. Adicione a(s) fonte(s) de atualização do SP3. Ela pode ser a mídia de instalação do SP3 ou os canais <literal>SP3-Pool</literal> e <literal>SP3-Updates</literal>. Clique em <guimenu>OK</guimenu> para retornar à caixa de diálogo <guimenu>Método de Atualização</guimenu>.
     </para>
     <para>
      Para revisar as mudanças feitas na configuração de canal em virtude do processo de atualização, selecione <guimenu>Verificar Mudanças Automáticas no Repositório</guimenu>.
     </para>
     <para>
      Continue com <guimenu>Avançar</guimenu>.
     </para>
    </step>
    <step>
     <para>
      O sistema será registrado novamente. Durante esse processo, os canais <literal>SP3-Pool</literal> e <literal>SP3-Updates</literal> são adicionados ao sistema (consulte a <xref linkend="sec-update-nmm-channels"/> para obter mais informações). Confirme a adição dos canais.
     </para>
    </step>
    <step>
     <para>
      Se você selecionou <guimenu>Verificar Mudanças Automáticas no Repositório</guimenu> na caixa de diálogo <guimenu>Método de Atualização</guimenu>, a lista de repositórios será exibida com opções para habilitar, desabilitar, adicionar ou apagar manualmente os canais. Quando estiver pronto, clique em <guimenu>OK</guimenu> para continuar.
     </para>
    </step>
    <step>
     <para>
      A tela <guimenu>Configurações do Upgrade da Distribuição</guimenu> é aberta com um resumo da configuração de atualização. As seguintes seções estão disponíveis:
     </para>
     <variablelist>
      <varlistentry>
       <term><guimenu>Produtos acessórios</guimenu>
       </term>
       <listitem>
        <para>
         É possível adicionar produtos complementares do SUSE Linux Enterprise Server ou produtos de terceiros aqui.
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term><guimenu>Opções de Atualização</guimenu>
       </term>
       <listitem>
        <para>
         Lista as ações que serão realizadas durante a atualização. Você escolhe se vai fazer download de todos os pacotes antes de instalá-los (padrão, recomendado) ou se vai fazer download e instalar os pacotes um de cada vez.
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term><guimenu>Pacotes</guimenu>
       </term>
       <listitem>
        <para>
         Visão geral das estatísticas da atualização.
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>Backup</term>
       <listitem>
        <para>
         Defina as opções de backup.
        </para>
       </listitem>
      </varlistentry>
     </variablelist>
     <para>
      Clique em <guimenu>Avançar</guimenu> e em <guimenu>Iniciar Atualização</guimenu> para continuar.
     </para>
     <important>
      <title>Interrompendo a migração online</title>
      <para>
       É seguro interromper a migração online nesta tela <emphasis>antes</emphasis> de clicar em <guimenu>Iniciar Atualização</guimenu> e em todas as telas anteriores. Clique em <guimenu>Interromper</guimenu> para sair do procedimento de atualização e restaurar o sistema ao estado em que estava antes de iniciar o YaST Wagon. Siga as instruções na tela e refaça o registro antes de sair do Wagon para remover os canais SP2 do sistema.
      </para>
     </important>
    </step>
    <step>
     <para>
      Durante o procedimento de atualização, as seguintes etapas são executadas:
     </para>
     <substeps performance="required">
      <step>
       <para>
        Os pacotes serão atualizados.
       </para>
      </step>
      <step>
       <para>
        O <command>SuSEconfig</command> será executado.
       </para>
      </step>
      <step>
       <para>
        O sistema será reinicializado (clique em <guimenu>OK</guimenu>).
       </para>
      </step>
      <step>
       <para>
        O sistema recém-atualizado será registrado novamente.
       </para>
      </step>
     </substeps>
    </step>
    <step>
     <para>
      O sistema foi atualizado com êxito para o Service Pack 3.
     </para>
    </step>
   </procedure>
  </section>

  <section xml:id="sec-update-sle11sp2-online-zypper">
   <title>Migração online com o <command>zypper</command></title>
   <procedure>
    <step>
     <para>
      Quando todos os requisitos são atendidos (consulte a <xref linkend="sec-update-sle11spx-online-requirements"/>), os <quote>produtos</quote> necessários para a migração online são adicionados ao <filename>/etc/products.d</filename>. Execute o seguinte comando para obter a lista desses produtos:
     </para>

<screen>zypper se -t product | grep -h -- "-migration" | cut -d'|' -f2</screen>
     <para>
      Esse comando deve pelo menos retornar <literal os="sles">SUSE_SLES-SP3-migration</literal>. Dependendo do escopo da instalação, mais produtos poderão aparecer na lista.
     </para>
    </step>
    <step>
     <para>
      Instale os produtos da migração recuperados na etapa anterior com o comando <command>zypper in -t product</command> <replaceable>LISTA_DE_PRODUTOS</replaceable>, por exemplo
     </para>
<screen os="sles">zypper in -t product SUSE_SLES-SP3-migration</screen>

    </step>
    <step>
     <para>
      Registre os produtos instalados na etapa anterior para acessar os seguintes canais de atualização:
     </para>
<screen>suse_register -d 2 -L /root/.suse_register.log</screen>
    </step>
    <step>
     <para>
      Atualize os repositórios e os serviços:
     </para>
<screen>zypper ref -s</screen>
    </step>
    <step>
     <para>
      Verifique a lista dos repositórios que você pode recuperar usando o comando <command>zypper lr</command>. 
     </para>
     <para>
      Se algum desses repositórios não estiver habilitado (por padrão, os do <literal>SP3</literal> não estarão habilitados após esse workflow), habilite-os com <command>zypper modifyrepo --enable</command> <replaceable>ÁLIAS DO REPOSITÓRIO</replaceable>, por exemplo:
     </para>
<screen os="sles">zypper modifyrepo --enable SLES11-SP3-Core SLES11-SP3-Updates</screen>

     <para>
      Se a instalação incluir repositórios de terceiros que possam não ser compatíveis com o SP3, desabilite-os com <command>zypper modifyrepo --disable</command> <replaceable>ÁLIAS DO REPOSITÓRIO</replaceable>.
     </para>
    </step>
    <step>
     <para>
      Agora está tudo pronto para executar o upgrade de distribuição com <command>zypper dup --from</command> <replaceable>REPO 1</replaceable> --from <replaceable>REPO 2</replaceable> <replaceable>...</replaceable>. Liste todos os repositórios necessários com a opção <option>--from</option>, por exemplo:
     </para>
<screen os="sles">zypper dup --from SLES11-SP3-Pool --from SLES11-SP3-Updates</screen>

     <para>
      Confirme com <guimenu>y</guimenu> para começar o upgrade.
     </para>
    </step>
    <step>
     <para>
      Ao término do upgrade de distribuição da etapa anterior, execute o seguinte comando:
     </para>
<screen>zypper update -t patch</screen>
    </step>
    <step>
     <para>
      Assim que o upgrade para o SP3 for concluído, registre novamente seu produto:
     </para>
<screen>suse_register -d 2 -L /root/.suse_register.log</screen>
    </step>
    <step>
     <para>
      Por fim, reinicialize o sistema.
     </para>
    </step>
    <step>
     <para>
      O sistema foi atualizado com êxito para o Service Pack 3.
     </para>
    </step>
   </procedure>
  </section>
 </section>
  
 <section xml:id="sec-update-sle11sp3">
   <title>Atualizando do SLE 11 SP3 para o SLE 11 SP4</title>
   <para>Há diferentes formas suportadas de atualização do sistema SUSE Linux Enterprise Server 11 SP3 para o Service Pack 4. É possível atualizar usando as ferramentas de atualização online para instalar os respectivos patches (Migração Online) ou através da mídia de instalação do Service Pack. Além disso, as atualizações podem ser feitas por meio de servidores que hospedam a SMT (Subscription Management Tool) ou o SUSE Manager.</para>
   <para>As seguintes ferramentas suportam a migração online:
     </para>
       <itemizedlist mark="bullet" spacing="normal">
         <listitem>
           <para>YaST wagon (interface gráfica do usuário) </para>
         </listitem>
         <listitem>
           <para><command>zypper</command> (linha de comando)</para>
         </listitem>
       </itemizedlist>
     <para>Se preferir, faça download da mídia completa do Service Pack (imagem ISO do DVD). Comece o processo de atualização inicializando de uma mídia física do Service Pack ou de uma fonte de instalação de rede. </para>
   
   <section xml:id="sec-update-sle11sp3-onlinemigration">
     <title>Migração Online</title>
     <para>A atualização do sistema pela migração online é feita no sistema que está em execução. Só é preciso reinicializar uma vez após o término da atualização.</para>
     <section>
       <title>Requisitos</title>
       <para>Para fazer uma atualização online, os seguintes requisitos devem ser atendidos. Leia também a <xref linkend="sec-update-prep"/>.
       </para>
       
       <variablelist>
         <varlistentry>
           <term>Registro de Produto</term>
           <listitem>
             <para>Para se conectar aos canais de atualização, seu produto deve estar registrado. Se não estiver, execute o módulo Configuração do Novell Customer Center no YaST ou a ferramenta de linha de comando <command>suse_register</command> para iniciar o registro. </para>
           </listitem>
         </varlistentry>
         <varlistentry>
           <term>Executar Atualização Online</term>
           <listitem>
             <para>Verifique se a versão instalada tem os patches mais recentes também instalados. Execute a Atualização Online antes da Migração Online. Ao usar uma interface gráfica, inicie a Atualização Online ou o applet de atualização do YaST. Na linha de comando, execute os seguintes comandos (o último precisa ser executado duas vezes): </para>
             <screen>zypper ref -s
zypper update -t patch
zypper update -t patch</screen>
             <para>Se necessário, reinicialize o sistema.</para>
             <para>Consulte a Seção 1.0, Atualização Online do YaST, (↑Guia de Administração) ou a Seção 6.1.3, Atualizando software com o zypper, (↑Guia de Administração). para obter mais informações. sobre as ferramentas de atualização online.</para>
           </listitem>
         </varlistentry>
         <varlistentry>
           <term>Software de Terceiros</term>
           <listitem>
             <para>Se a configuração envolver software de terceiros ou complementar, teste esse procedimento em outra máquina para garantir que as dependências não sejam danificadas pela atualização. </para>
           </listitem>
         </varlistentry>
       </variablelist>
       
       <important>
         <title>Sempre executar a migração online completa</title>
         <para>A migração online deve sempre ser realizada do início ao fim. Se ela for interrompida durante sua execução, o sistema será corrompido sem meios de recuperação.</para>
       </important>
     </section>
   
   <section xml:id="sec-update-sle11sp3-online-wagon">
     <title>Migração online com o YaST <guimenu>Wagon</guimenu></title>
     <para>Se você tem o sistema SLES 11 SP1, encontre as etapas necessárias em <link xlink:href="https://www.suse.com/support/kb/doc.php?id=7011872"/>. O seguinte procedimento aplica-se à migração online do SP3 para o SP4.</para>
     <procedure>
       <step>
         <para>
           Com todos os requisitos atendidos (consulte a <xref linkend="sec-update-sle11spx-online-requirements"/>), o applet de atualização na bandeja exibirá uma mensagem informando que há um upgrade de distribuição disponível. Clique nela para iniciar o YaST <guimenu>Wagon</guimenu>. Se preferir, execute <command>/usr/sbin/wagon</command> como <systemitem class="username">root</systemitem> na linha de comando.
         </para>
       </step>
       <step>
         <para>
           Confirme a caixa de diálogo <guimenu>Bem-vindo</guimenu> clicando em <guimenu>Avançar</guimenu>.
         </para>
       </step>
       <step>
         <para>
           Se o <guimenu>Wagon</guimenu> determinar que os requisitos não foram cumpridos (há atualizações de manutenção necessárias disponíveis, mas que ainda não foram instaladas), ele fará uma autoatualização, o que pode exigir a reinicialização. Siga as instruções na tela.
         </para>
       </step>
       <step>
         <para>
           Escolha o método de atualização na caixa de diálogo seguinte. Escolha <guimenu>Atendimento ao Cliente</guimenu> para usar a configuração padrão (recomendada).
         </para>
         <para>
           Clique em <guimenu>URL Personalizado</guimenu> para escolher manualmente os canais de software usados na migração online. Uma lista de canais será exibida com opções para habilitar, desabilitar, adicionar ou apagar manualmente os canais. Adicione a(s) fonte(s) de atualização do SP4. Ela pode ser a mídia de instalação do SP4 ou os canais <literal>SP4-Pool</literal> e <literal>SP4-Updates</literal>. Clique em <guimenu>OK</guimenu> para retornar à caixa de diálogo <guimenu>Método de Atualização</guimenu>.
         </para>
         <para>
           Para revisar as mudanças feitas na configuração de canal em virtude do processo de atualização, selecione <guimenu>Verificar Mudanças Automáticas no Repositório</guimenu>.
         </para>
         <para>
           Continue com <guimenu>Avançar</guimenu>.
         </para>
       </step>
       <step>
         <para>
           O sistema será registrado novamente. Durante esse processo, os canais <literal>SP4-Pool</literal> e <literal>SP4-Updates</literal> são adicionados ao sistema (consulte a <xref linkend="sec-update-nmm-channels"/> para obter mais informações). Confirme a adição dos canais.
         </para>
       </step>
       <step>
         <para>
           Se você selecionou <guimenu>Verificar Mudanças Automáticas no Repositório</guimenu> na caixa de diálogo <guimenu>Método de Atualização</guimenu>, a lista de repositórios será exibida com opções para habilitar, desabilitar, adicionar ou apagar manualmente os canais. Quando estiver pronto, clique em <guimenu>OK</guimenu> para continuar.
         </para>
       </step>
       <step>
         <para>Escolha o tipo de migração:</para>
         <variablelist>
           <varlistentry>
             <term>Migração completa</term>
             <listitem>
               <para>Atualiza todos os pacotes para o último nível do SP4.</para>
             </listitem>
           </varlistentry>
           <varlistentry>
             <term>Migração Mínima</term>
             <listitem>
               <para>Atualiza um conjunto mínimo de pacotes para último nível do SP4.</para>
             </listitem>
           </varlistentry>
         </variablelist>
         <para>Clique em <guimenu>Avançado</guimenu> para selecionar manualmente os repositórios usados para o upgrade. Confirme sua seleção.
         </para>
       </step>
       
       <step>
         <para>
           A tela <guimenu>Configurações do Upgrade da Distribuição</guimenu> é aberta com um resumo da configuração de atualização. As seguintes seções estão disponíveis:
         </para>
         <variablelist>
           <varlistentry>
             <term><guimenu>Produtos acessórios</guimenu>
             </term>
             <listitem>
               <para>
                 É possível adicionar produtos complementares do SUSE Linux Enterprise Server ou produtos de terceiros aqui.
               </para>
             </listitem>
           </varlistentry>
           <varlistentry>
             <term><guimenu>Opções de Atualização</guimenu>
             </term>
             <listitem>
               <para>
                 Lista as ações que serão realizadas durante a atualização. Você escolhe se vai fazer download de todos os pacotes antes de instalá-los (padrão, recomendado) ou se vai fazer download e instalar os pacotes um de cada vez.
               </para>
             </listitem>
           </varlistentry>
           <varlistentry>
             <term><guimenu>Pacotes</guimenu>
             </term>
             <listitem>
               <para>
                 Visão geral das estatísticas da atualização.
               </para>
             </listitem>
           </varlistentry>
           <varlistentry>
             <term>Backup</term>
             <listitem>
               <para>
                 Defina as opções de backup.
               </para>
             </listitem>
           </varlistentry>
         </variablelist>
         <para>
           Clique em <guimenu>Avançar</guimenu> e em <guimenu>Iniciar Atualização</guimenu> para continuar.
         </para>
         <important>
           <title>Interrompendo a migração online</title>
           <para>
             É seguro interromper a migração online nesta tela <emphasis>antes</emphasis> de clicar em <guimenu>Iniciar Atualização</guimenu> e em todas as telas anteriores. Clique em <guimenu>Interromper</guimenu> para sair do procedimento de atualização e restaurar o sistema ao estado em que estava antes de iniciar o YaST Wagon. Siga as instruções na tela e refaça o registro antes de sair do Wagon para remover os canais SP4 do sistema.
           </para>
         </important>
       </step>
       <step>
         <para>
           Durante o procedimento de atualização, as seguintes etapas são executadas:
         </para>
         <orderedlist spacing="normal">
           <listitem>
             <para>
               Os pacotes serão atualizados.
             </para>
           </listitem>
           <listitem>
             <para>
               O <command>SuSEconfig</command> será executado.
             </para>
           </listitem>
           <listitem>
             <para>
               O sistema será reinicializado (clique em <guimenu>OK</guimenu>).
             </para>
           </listitem>
           <listitem>
             <para>
               O sistema recém-atualizado será registrado novamente.
             </para>
           </listitem>
         </orderedlist>
       </step>
       <step>
         <para>
           O sistema foi atualizado com êxito para o Service Pack 4.
         </para>
       </step>
     </procedure>
   </section>
   
   <section xml:id="sec-update-sle11sp3-online-zypper">
     <title>Migração online com o <command>zypper</command></title>
     <procedure>
       <step>
         <para>
           Quando todos os requisitos são atendidos (consulte a <xref linkend="sec-update-sle11spx-online-requirements"/>), os <quote>produtos</quote> necessários para a migração online são adicionados ao <filename>/etc/products.d</filename>. Execute o seguinte comando para obter a lista desses produtos:
         </para>
         
         <screen>zypper se -t product | grep -h -- "-migration" | cut -d'|' -f2</screen>
         <para>
           Esse comando deve pelo menos retornar <literal os="sles">SUSE_SLES-SP4-migration</literal>. Dependendo do escopo da instalação, mais produtos poderão aparecer na lista.
         </para>
       </step>
       <step>
         <para>
           Instale os produtos da migração recuperados na etapa anterior com o comando <command>zypper in -t product</command> <replaceable>LISTA_DE_PRODUTOS</replaceable>, por exemplo
         </para>
         <screen os="sles">zypper in -t product SUSE_SLES-SP4-migration</screen>
         
       </step>
       <step>
         <para>
           Registre os produtos instalados na etapa anterior para acessar os seguintes canais de atualização:
         </para>
         <screen>suse_register -d 2 -L /root/.suse_register.log</screen>
       </step>
       <step>
         <para>
           Atualize os repositórios e os serviços:
         </para>
         <screen>zypper ref -s</screen>
       </step>
       <step>
         <para>
           Verifique a lista dos repositórios que você pode recuperar usando o comando <command>zypper lr</command>. Pelo menos, os seguintes repositórios precisam estar habilitados: 
         </para>
         
         <itemizedlist mark="bullet" spacing="normal">
           <listitem>
             <para>SLES11-SP4-Pool</para>
           </listitem>
           <listitem>
             <para>SLES11-SP4-Updates</para>
           </listitem>
         </itemizedlist>
         
         <para>Dependendo do escopo da instalação, outros repositórios para extensões ou produtos complementares terão que estar habilitados. </para>
         
         <para>
           Se algum desses repositórios não estiver habilitado (por padrão, os do <literal>SP4</literal> não estarão habilitados após esse workflow), habilite-os com <command>zypper modifyrepo --enable</command> <replaceable>ÁLIAS DO REPOSITÓRIO</replaceable>, por exemplo:
         </para>
         <screen os="sles">zypper modifyrepo --enable SLES11-SP4-Pool --enable SLES11-SP4-Updates</screen>
         
         <para>
           Se a instalação incluir repositórios de terceiros que possam não ser compatíveis com o SP4, desabilite-os com <command>zypper modifyrepo --disable</command> <replaceable>ÁLIAS DO REPOSITÓRIO</replaceable>.
         </para>
       </step>
       <step>
         <para>
           Agora está tudo pronto para executar o upgrade de distribuição com <command>zypper dup --from</command> <replaceable>REPO 1</replaceable> --from <replaceable>REPO 2</replaceable> <replaceable>...</replaceable>. Liste todos os repositórios necessários com a opção <option>--from</option>, por exemplo:
         </para>
         <screen os="sles">zypper dup --from SLES11-SP4-Pool --from SLES11-SP4-Updates</screen>
         
         <para>
           Confirme com <guimenu>y</guimenu> para começar o upgrade.
         </para>
       </step>
       <step>
         <para>
           Ao término do upgrade de distribuição da etapa anterior, a migração mínima terá sido executada (um conjunto mínimo de pacotes atualizados para o último nível do SP4). Ignore esta etapa se você não pretende executar a migração completa.
         </para>
         <para>Para realizar a Migração Completa (atualizar todos os pacotes para o último nível do SP4), execute o seguinte comando: </para>
         <screen>zypper update -t patch</screen>
       </step>
       <step>
         <para>
           Assim que o upgrade para o SP4 for concluído, registre novamente seu produto:
         </para>
         <screen>suse_register -d 2 -L /root/.suse_register.log</screen>
       </step>
       <step>
         <para>
           Por fim, reinicialize o sistema.
         </para>
       </step>
     </procedure>
     <para>
       O sistema foi atualizado com êxito para o Service Pack 4.
     </para>
   </section>
    
    <section>
      <title>Atualizando pela inicialização de uma fonte de instalação</title>
      <para>Como alternativa à Migração Online, é possível também atualizar o sistema inicializando de uma fonte de instalação: seja um DVD ou uma rede. A atualização é iniciada como uma instalação normal. </para>
      <para>Você obtém as imagens ISO do Service Pack 4 no site <link xlink:href="http://download.suse.com/"/>. Grave-as em um DVD ou prepare a fonte de instalação de rede conforme descrito na <xref linkend="sec-deployment-remoteinst-instserver"/>.
      </para>
    </section>
   </section>
   
 </section>
 
 <section xml:id="sec-update-backports">
  <title>Backporting do código-fonte</title>

  <para>
   O SUSE usa bastante os backports. As informações desta seção ajudam você a entender por que pode ser enganoso comparar números de versão para julgar os recursos e problemas do software.

  </para>

  <section xml:id="sec-update-backports-why">
   <title>Por que o backporting?</title>
   <para>
    O foco principal dos desenvolvedores de upstream está na evolução do software que eles criam. Em muitos casos, eles combinam correção de bugs com a introdução de novos recursos que ainda não foram amplamente testados e que podem inserir novos bugs.
   </para>
   <para>
    Para os desenvolvedores de distribuição, é importante saber a diferença entre:
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      correções de bugs com potencial limitado para interromper a funcionalidade; e
     </para>
    </listitem>
    <listitem>
     <para>
      mudanças que possam interromper a funcionalidade existente.
     </para>
    </listitem>
   </itemizedlist>
   <para>
    Na maioria dos casos, os desenvolvedores de distribuição não seguem todas as mudanças de upstream, uma vez que o pacote tenha se tornado parte de uma distribuição lançada. Normalmente, eles mantêm a versão de upstream que lançaram inicialmente e criam patches com base nas mudanças de upstream para corrigir os bugs. Esta prática é conhecida como <emphasis>backporting</emphasis>.
   </para>
   <para>
    Em geral, os desenvolvedores de distribuição apenas lançam uma nova versão do software em dois casos:
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      quando as mudanças entre os pacotes e as versões de upstream tornam-se tão grandes que o backporting não é mais viável, ou
     </para>
    </listitem>
    <listitem>
     <para>
      quando o software apresenta um comportamento inerentemente errôneo ao longo de sua vida, como um software antimalware.
     </para>
    </listitem>
   </itemizedlist>
  </section>

  <section xml:id="sec-update-backports-reasons-for">
   <title>Prós do backporting</title>
   <para>
    O SUSE usa bastante os backports para buscar o equilíbrio ideal entre as várias questões que envolvem o software empresarial. As mais importantes são:
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      Oferecer interfaces estáveis (APIs) nas quais os fornecedores de software podem confiar na hora de desenvolver produtos para usar com os produtos empresariais do SUSE.
     </para>
    </listitem>
    <listitem>
     <para>
      Garantir que os pacotes usados no lançamento dos produtos empresariais do SUSE sejam da mais alta qualidade e tenham sido completamente testados, sozinhos e como parte do produto empresarial inteiro.
     </para>
    </listitem>
    <listitem>
     <para>
      Manter as diversas certificações dos produtos empresariais do SUSE por outros fornecedores, como as certificações para produtos Oracle ou SAP.
     </para>
    </listitem>
    <listitem>
     <para>
      Permitir que os desenvolvedores do SUSE se concentrem em criar a próxima versão do produto da melhor maneira possível, e não se dispersar em uma ampla gama de versões.
     </para>
    </listitem>
    <listitem>
     <para>
      Manter uma visão clara do que compõe uma versão empresarial específica, para que nosso suporte possa oferecer informações precisas e imediatas sobre ela.
     </para>
    </listitem>
   </itemizedlist>
  </section>

  <section xml:id="sec-update-backports-reasons-against">
   <title>Contras do backporting</title>
   <para>
    Existe uma regra da política geral de que nenhuma versão nova de upstream de um pacote é introduzida em nossos produtos empresariais. Essa regra não é, na verdade, absoluta. Para uma classe limitada de pacotes, em alguns softwares antivírus, as questões de segurança têm um peso maior do que a abordagem conservadora, o que é preferível do ponto de vista do controle de qualidade. Para os pacotes dessa classe, ocasionalmente, são inseridas versões mais recentes em uma versão lançada da linha de produtos empresariais.
   </para>
   <para>
    Também para outros tipos de pacotes, às vezes a opção é introduzir uma nova versão em vez de fazer backport. Isso é feito quando a realização do backport não é economicamente viável ou quando existe um motivo técnico bastante relevante para se introduzir uma versão mais recente.
   </para>
  </section>

  <section xml:id="sec-update-backports-implication">
   <title>Implicações dos backports na interpretação dos números de versão</title>
   <para>
    Devido à prática de backporting, não é possível simplesmente comparar números de versão para determinar se um pacote do SUSE inclui a correção de determinado problema ou se um recurso específico foi adicionado a ele. Com o backporting, a parte de upstream do número de versão do pacote do SUSE apenas indica em qual versão de upstream o pacote do SUSE está baseado. Ele pode incluir correções de bugs e recursos que não estejam na versão de upstream correspondente, mas que passaram por backport no pacote do SUSE.
   </para>
   <para>
    Há vários locais onde as informações sobre essas correções de bugs e recursos são armazenadas:
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      O registro de mudanças do pacote:
     </para>
<screen>rpm -q --changelog name-of-installed-package
rpm -qp --changelog packagefile.rpm</screen>
     <para>
      A saída documenta resumidamente o histórico de mudanças do pacote.
     </para>
    </listitem>
    <listitem>
     <para>
      O registro de mudanças do pacote pode incluir entradas como <literal>bnc#1234</literal>, que fazem referência aos bugs no sistema de monitoramento Bugzilla da Novell, ou links para outros sistemas de monitoramento de bugs. (Por causa das políticas de confidencialidade, nem todas as informações podem ser acessadas por você.)
     </para>
    </listitem>
    <listitem>
     <para>
      Um pacote pode incluir um arquivo <filename>/usr/share/doc/nomedopacote/README.SUSE</filename> ou <filename>README.SuSE</filename>, com informações gerais de alto nível específicas ao pacote do SUSE.
     </para>
    </listitem>
    <listitem>
     <para>
      O pacote de origem RPM contém os patches que foram aplicados durante a compilação dos RPMs binários regulares como arquivos separados, que poderão ser interpretados se você estiver familiarizado com a leitura de código-fonte. Consulte o manual <link xlink:href="http://www.rpm.org/max-rpm/">Maximum RPM</link> (RPM Máximo) para obter mais informações.
     </para>
    </listitem>
    <listitem>
     <para>
      Para correções de bug de segurança, consulte os <link xlink:href="https://www.suse.com/support/security/#1">anúncios de segurança do SUSE</link>. Em geral, eles fazem referência aos bugs por meio de nomes padronizados, como <literal>CAN-2005-2495</literal>, que são mantidos pelo projeto <link xlink:href="http://cve.mitre.org">Common Vulnerabilities and Exposures</link> (Vulnerabilidades e Exposições Comuns).
     </para>
    </listitem>
   </itemizedlist>
   <para>
    As ferramentas de exploração de segurança são uma área específica em que pode haver problemas com esse valor limitado de números de versão quando há backporting envolvido. Algumas ferramentas de exploração de vulnerabilidades de segurança (ou alguns testes dessas ferramentas) operam exclusivamente com as informações de versão. Dessa forma, essas ferramentas/testes estão propensas a gerar <quote>falsos positivos</quote> (alegando ter encontrado alguma parte vulnerável do software que, na verdade, não é vulnerável) quando há backports envolvidos. Durante a avaliação dos relatórios das ferramentas de exploração de segurança, convém sempre investigar se uma entrada se baseia apenas no número da versão ou no teste real de uma vulnerabilidade que realmente exista.
   </para>
  </section>
 </section>
 <xi:include href="update_split_brain.xml" parse="xml"/>
 <section xml:id="sec-update-wagonhooks">
  <title>Ganchos de migração do YaST Wagon</title>



  <para>
   Os ganchos de migração permitem executar um script externo personalizado em algum ponto durante o processo de migração. Esses scripts permitem identificar problemas específicos que não podem ser identificados pelos scripts RPM comuns ou permitem executar qualquer ação extra que possa ser necessária durante a migração (não obrigatória durante a atualização normal do pacote).
  </para>

  <para>
   Os ganchos de migração são executados com privilégios de root para permitir a execução de qualquer tarefa de manutenção nos scripts (serviços de inicialização/interrupção, backup de dados, migração de dados, etc.). Os scripts não devem ser interativos; STDIN e STDOUT são redirecionados aos pipes quando executados no YaST. A sessão X não deve ser usada, já que pode não estar disponível em todos os casos (por exemplo, na execução em modo de texto). Lembre-se de definir a permissão do executável para os scripts de gancho.
  </para>

  <para>
   Os ganchos de migração são suportados no pacote <systemitem class="resource">yast2-wagon</systemitem> versão 2.17.32.1 (oferecida como atualização para o SLES11-SP2) ou 2.17.34 (incluída no SLES11-SP3) ou em versões superiores.
  </para>

  <section>
   <title>Local e convenções de nomes dos scripts de gancho</title>
   <para>
    Os scripts são pesquisados no diretório <filename>/var/lib/YaST2/wagon/hooks/</filename>. O nome do script esperado deve estar no formato <replaceable>etapa_seq_prefixo_nome</replaceable>, em que:
   </para>
   <variablelist>
    <varlistentry>
     <term><replaceable>etapa</replaceable>
     </term>
     <listitem>
      <para>
       é o nome da etapa de migração predefinido que descreve a etapa de migração atual.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>seq</replaceable>
     </term>
     <listitem>
      <para>
       é o número de sequência na faixa entre 00...99, que possibilita definir a ordem de execução dos scripts. (É importante manter os zeros iniciais para a classificação correta!)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>prefixo</replaceable>
     </term>
     <listitem>
      <para>
       deve ser exclusivo para evitar conflitos (como um namespace). Use o nome do pacote (se fizer parte de um pacote) ou o nome do fornecedor, o nome de domínio da Internet, etc., basicamente qualquer coisa que possa ser considerada exclusiva o suficiente
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>da árvore</replaceable>
     </term>
     <listitem>
      <para>
       pode ser qualquer string (apenas para diferenciar os scripts). É recomendado um nome descritivo.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <example>
    <title>Script de gancho com caminho completo</title>
<screen>/var/lib/YaST2/wagon/hooks/before_package_migration_00_postgresql_backup</screen>
   </example>
  </section>

  <section>
   <title>Valor de saída do script de gancho</title>
   <para>
    O script deve retornar o valor de saída 0. Em caso de falha (qualquer valor de saída diferente de zero), será exibida uma mensagem de erro no Wagon, e será possível reiniciar o script, ignorar a falha (e continuar com os outros scripts) ou cancelar completamente os ganchos na etapa ou fase atual.
   </para>
  </section>

  <section>
   <title>Scripts idempotentes</title>
   <para>
    Os scripts de gancho <emphasis>podem ser executados mais vezes</emphasis> (na troca de diálogos no Wagon, o Wagon pode se reiniciar ou executar algumas etapas várias vezes no workflow de migração); portanto, os scripts precisam lidar com esse fato (eles podem verificar logo no início se precisam realizar alguma ação ou se a ação já foi realizada, podem criar um arquivo de marcação temporário simples ou resolver de alguma forma as várias execuções apropriadamente).
   </para>
  </section>

  <section>
   <title>Lista de ganchos suportados</title>
   <para>
    Alguns ganchos são opcionais (porque dependem de resultados anteriores ou de valores selecionados pelo usuário). Observe que alguns ganchos são chamados várias vezes (por exemplo, o registro é chamado antes e após a migração). Veja a lista de ganchos suportados (nomes das etapas) em ordem de execução:
   </para>
   <variablelist>
    <varlistentry>
     <term><command>before_init</command>
     </term>
     <listitem>
      <para>
       iniciado bem no começo (observação: é chamado novamente após os reinícios do Wagon)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_welcome</command>
     </term>
     <term><command>after_welcome</command>
     </term>
     <listitem>
      <para>
       iniciado antes/após a exibição da caixa de diálogo de boas-vindas
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_registration_check</command>
     </term>
     <term><command>after_registration_check</command>
     </term>
     <listitem>
      <para>
       o Wagon verifica o status do registro (se o registro de alguns produtos expirar, a migração poderá falhar). Se tudo estiver correto, nenhuma caixa de diálogo será exibida e o Wagon continuará automaticamente na etapa seguinte
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_custom_url</command>
     </term>
     <term><command>after_custom_url</command>
     </term>
     <listitem>
      <para>
       o gerenciador de repositório é iniciado (opcional, apenas no modo de CD de Patch)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_self_update</command>
     </term>
     <term><command>after_self_update</command>
     </term>
     <listitem>
      <para>
       chamado antes/após o Wagon se atualizar (para garantir que a versão mais recente seja usada para migração)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_installing_migration_products</command>
     </term>
     <term><command>after_installing_migration_products</command>
     </term>
     <listitem>
      <para>
       chamado antes/após a instalação dos produtos de migração
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_selecting_migration_source</command>
     </term>
     <term><command>after_selecting_migration_source</command>
     </term>
     <listitem>
      <para>
       O Wagon solicita ao usuário para migrar usando os repositórios do Novell Customer Center ou um repositório personalizado; a etapa seguinte depende da seleção do usuário
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_registration</command>
     </term>
     <term><command>after_registration</command>
     </term>
     <listitem>
      <para>
       execução do registro do SUSE (para adicionar os repositórios de migração)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_repo_selection</command>
     </term>
     <term><command>after_repo_selection</command>
     </term>
     <listitem>
      <para>
       gerenciamento manual do repositório
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_set_migration_repo</command>
     </term>
     <term><command>after_set_migration_repo</command>
     </term>
     <listitem>
      <para>
       seleção dos repositórios de migração (migração completa/mínima ao usar o Novell Customer Center) ou seleção do repositório de atualização (migração personalizada do repositório)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_package_migration</command>
     </term>
     <listitem>
      <para>
       antes de iniciar a atualização do pacote; após esta etapa, a migração real é iniciada e não é possível voltar automaticamente para um estado anterior (a interrupção durante esta fase resulta em inconsistência no sistema (upgrade pela metade), e será necessário fazer rollback manual)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_registration</command>
     </term>
     <term><command>after_registration</command>
     </term>
     <listitem>
      <para>
       execução do registro do SUSE (para registrar os produtos atualizados)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_congratulate</command>
     </term>
     <term><command>after_congratulate</command>
     </term>
     <listitem>
      <para>
       antes/após o Wagon exibir a caixa de diálogo de parabéns como resultado de uma migração bem-sucedida
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_exit</command>
     </term>
     <listitem>
      <para>
       chamado pouco antes de o Wagon sair (sempre, independentemente do resultado da migração, também após a interrupção e no reinício)
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </section>

  <section>
   <title>Ganchos de interrupção</title>
   <para>
    Esses são ganchos especiais de interrupção, chamados quando o usuário interrompe a migração. Esses ganchos podem ser chamados em qualquer etapa do workflow de migração; portanto, a ordem de execução não é garantida. Os scripts terão que verificar o estado atual se confiarem nos resultados de outros ganchos.
   </para>
   <variablelist>
    <varlistentry>
     <term><command>before_abort</command>
     </term>
     <listitem>
      <para>
       interrupção da migração confirmada pelo usuário
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_abort_rollback</command>
     </term>
     <term><command>after_abort_rollback</command>
     </term>
     <listitem>
      <para>
       rollback confirmado pelo usuário após interrupção (revertendo para os produtos antigos instalados antes de iniciar a migração). Esses ganchos são chamados após before_abort e ignorados quando o usuário não confirma o rollback.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </section>

  <section>
   <title>Ganchos de reinício</title>
   <para>
    Esses ganchos são chamados sempre que o Wagon se reinicia.
   </para>
   <variablelist>
    <varlistentry>
     <term><command>before_restart</command>
     </term>
     <listitem>
      <para>
       O Wagon está sendo concluído e será iniciado novamente
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>after_restart</command>
     </term>
     <listitem>
      <para>
       O Wagon foi reiniciado e executará a etapa seguinte do workflow de migração
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </section>

  <section>
   <title>Ganchos geralmente usados</title>
   <para>
    A lista de ganchos é bem extensa, mas muitos deles só fazem sentido em casos especiais. Em casos de uso normal, dê preferência a estes ganchos:
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      Para executar alguma ação antes da migração do sistema (que ainda executa a versão anterior), use o gancho <command>before_package_migration</command>.
     </para>
     <para>
      Neste ponto, fica claro que a migração está pronta e prestes a ser iniciada, embora seja possível interromper a migração em todas as etapas antes desta.

     </para>
    </listitem>
    <listitem>
     <para>
      Para executar alguma ação após a migração do sistema (o sistema executa a nova versão migrada, mas alguns elementos ainda não estão ativos; por exemplo, o kernel atualizado requer reinicialização, os serviços atualizados talvez tenham que ser reiniciados, etc.), use o gancho <command>before_congratulate</command> ou <command>after_congratulate</command>.
     </para>
     <para>
      Isso pode ser usado também para limpar os resultados temporários do gancho <command>before_package_migration</command>. Neste ponto, a migração foi concluída com êxito.
     </para>
    </listitem>
    <listitem>
     <para>
      Para reverter as mudanças se a migração for interrompida, use um dos ganchos de interrupção de acordo com o caso. Lembre-se de que os ganchos de interrupção podem ser chamados a qualquer momento; portanto, a reversão talvez não seja necessária (o gancho que faz as mudanças pode ainda não ter sido chamado). Os ganchos de interrupção precisam verificar o estado atual.
     </para>
    </listitem>
   </itemizedlist>
  </section>

  <section>
   <title>Ganchos obsoletos</title>
   <para>
    As versões mais antigas do Wagon suportavam apenas dois scripts de gancho: <filename>/usr/lib/YaST2/bin/wagon_hook_init</filename> e <filename>/usr/lib/YaST2/bin/wagon_hook_finish</filename>. O problema era que somente um script podia ser executado como gancho e não era possível inserir os ganchos diretamente nos pacotes RPM.
   </para>
   <para>
    Esses scripts de gancho antigos ainda são suportados nas versões mais recentes do Wagon para compatibilidade retroativa, mas os novos ganchos <command>before_init</command> e <command>before_exit</command> devem ser usados no lugar dos ganchos obsoletos.
   </para>
  </section>
 </section>
</chapter>
