<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet href="urn:x-suse:xslt:profiling:docbook51-profile.xsl"
    type="text/xml"
    title="Profiling step"
?>
<!DOCTYPE sect1
[
   <!ENTITY % entities SYSTEM "entity-decl.ent">
   %entities;
]>


<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<section xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.1" xml:base="yast2_manpart.xml" xml:id="sec-yast2-i-y2-part-expert">
 <title>YaSTのパーティショナの使用</title><indexterm> <primary>YaST</primary> <secondary>パーティション設定</secondary> </indexterm> <indexterm> <primary>パーティション</primary> <secondary>作成</secondary> </indexterm>

 <para>
  <xref linkend="fig-yast2-i-y2-disk-part"/>に示す［上級者向けのパーティション設定］ダイアログを使って、1つまたは複数のハードディスクのパーティションを手動で設定します。パーティションの追加、削除、サイズ変更、および編集に加えて、ソフトRAIDとLVMの設定にアクセスすることもできます。
 </para>

 <warning>
  <title>稼働中システムのパーティション再設定</title>
  <para>
   システムの実行中にそのパーティションを再設定できますが、誤操作によるデータ損失のリスクが非常に高くなります。インストールしたシステムのパーティション再設定は避けて、常に再設定の前にデータを完全にバックアップしてください。
  </para>
 </warning>

 <figure xml:id="fig-yast2-i-y2-disk-part">
  <title>YaSTのパーティショナ</title>
  <mediaobject>
   <imageobject role="fo">
    <imagedata fileref="i_y2_disk_part.png" width="75%" format="PNG"/>
   </imageobject>
   <imageobject role="html">
    <imagedata fileref="i_y2_disk_part.png" width="75%" format="PNG"/>
   </imageobject>
  </mediaobject>
 </figure>

 <tip arch="zseries" os="sles">
  <title>IBM System z: デバイス名</title>
  <para>
   IBM System zは、DASDとSCSIハードディスクしか認識できません。IDEハードディスクはサポートされていません。これが理由で、これらのデバイスは、パーティションテーブル内で<filename>dasda</filename>または<filename>sda</filename>という名前で表示され、最初に認識されるデバイスになります。
  </para>
 </tip>

 <para>
  接続されているすべてのハードディスクの既存パーティションまたは提案パーティションが、YaSTの<guimenu>エキスパートパーティショナ</guimenu>ダイアログの<guimenu>Available Storage (使用できるストレージ)</guimenu>にすべて一覧表示されます。ハードディスク全体は、番号のないデバイスとしてリストされます（<filename>/dev/sda</filename><phrase arch="zseries" os="sles">や<filename>/dev/dasda</filename></phrase>など)。パーティションは、それらのデバイスの一部としてリストされます(<filename>/dev/sda1</filename><phrase arch="zseries" os="sles">や<filename>/dev/dasda1</filename></phrase>など)。ハードディスクのサイズ、タイプ、暗号化のステータス、ファイルシステム、マウントポイントと、ハードディスクのパーティションも表示されます。マウントポイントには、Linuxファイルシステムツリー内のどこにパーティションが表示されるかが指定されています。
 </para>

 <para>
  いくつかの機能ビューが<guimenu>System View</guimenu>の左側に表示されます。これらのビューを使用して、既存のストレージに関する情報を収集するか、<literal>RAID</literal>、<literal>Volume Management</literal>、<literal>Crypt Files</literal>などの機能を設定するか、または追加機能をもつファイルシステム(<literal>BTRFS</literal>、<literal>NFS</literal>、<literal>TMPFS</literal>など)を表示します。
 </para>

 <para>
  インストール中、エキスパートダイアログで作業中の場合は、未使用のハードディスクスペースも表示され、自動的に選択されます。<phrase role="productname"><phrase os="sles">SUSE® Linux Enterprise Server</phrase></phrase>で使用できるディスクスペースを広げるには、このリストの下から上の方向に(ハードディスクの最後のパーティションから最初のパーティションの方向)、必要なスペースを確保できるまで領域を解放します。
 </para>

 <section xml:id="sec-IB-part-typen">
  <title>パーティションのタイプ</title><indexterm><primary>パーティション</primary><secondary>タイプ</secondary></indexterm>
  <tip arch="zseries" os="sles">
   <title>IBM System z: ハードディスク</title>
   <para>
    IBM System zプラットフォーム上のSUSE Linux Enterprise Serverでは、SCSIハードディスクとDASD (Direct Access Storage Device)をサポートしています。SCSIディスクは以下の方法でパーティション設定することが可能ですが、DASDではパーティションテーブルに指定できるパーティションエントリが3つに限られます。
   </para>
  </tip>
  <para>
   どのハードディスクにも、パーティションテーブルがあり、4つのエントリ領域が設けられています。パーティションテーブルの各エントリは、基本パーティションまたは拡張パーティションのいずれかに対応します。ただし、拡張パーティションとして指定できるエントリは、1つだけです。
  </para>
  <para>
   基本パーティションは、単純にシリンダの連続した領域(物理ディスク領域)で構成され、これらのシリンダは、特定のオペレーティングシステムに割り当てられています。プライマリパーティションの場合、ハードディスク当たりのパーティション数は、5以上にするとパーティションテーブルに収まらないので、4までに制限されています。このような理由から、拡張パーティションが使用されます。拡張パーティションも、ディスクシリンダ上の連続範囲ですが、さらに<emphasis>論理パーティション</emphasis>に分割することができます。論理パーティションは、必ずしもパーティションテーブルに存在している必要はありません。つまり、拡張パーティションは論理パーティションのコンテナということになります。
  </para>
  <para>
   パーティションが5つ以上必要な場合は、4番目(またはそれ以前)のパーティションとして拡張パーティションを作成します。この拡張パーティションには、残りの空きシリンダ領域全体を使用します。さらに、この拡張パーティションを複数の論理パーティションに区切ります。論理パーティションの最大数は、63であり、ディスクタイプから独立しています。どのタイプのパーティションを使用しても、Linuxへの影響はありません。プライマリパーティションと論理パーティションは両方とも正常に機能します。
  </para>
  <tip os="sles">
   <title>GPTパーティションテーブル</title>
   <para>
    ハードディスク上に5つ以上のプライマリパーティションを作成する必要がある場合は、GPTパーティションタイプを使用する必要があります。このタイプを使用すると、プライマリパーティションの番号制限がなくなり、2TBを越える大型パーティションもサポートされます。
   </para>
   <para>
    GPTを使用するには、YaSTのパーティショナを実行し、<guimenu>システムビュー</guimenu>で関連のディスク名をクリックし、<menuchoice><guimenu>エキスパート</guimenu><guimenu>新しいパーティションテーブルの作成</guimenu><guimenu>GPT</guimenu></menuchoice>の順に選択します。
   </para>
  </tip>
 </section>

 <section xml:id="sec-yast2-i-y2-part-expert-newpart">
  <title>パーティションの作成</title><indexterm><primary>パーティション</primary><secondary>作成</secondary></indexterm>
  <para>
   パーティションを初めから作成するには、<guimenu>ハードディスク</guimenu>を選択して、空領域を含むハードディスクを選択します。実際の変更は、<guimenu>パーティション</guimenu>タブで行うことができます。
  </para>
  <procedure>
   <step>
    <para>
     <guimenu>追加</guimenu>を選択し、パーティションタイプ(プライマリまたは拡張)を指定します。最大4つの基本パーティションを作成するか、最大3つの基本パーティションと1つの拡張パーティションを作成します。拡張パーティション内に、いくつかの論理パーティションを作成します(詳細については、<xref linkend="sec-IB-part-typen"/>を参照してください)。
    </para>
   </step>
   <step>
    <para>
     新しいパーティションのサイズを指定します。パーティションされていないすべての空きスペースの占有とカスタムサイズの入力のいずれかを選択できます。
    </para>
   </step>
   <step>
    <para>
     使用するファイルシステムと、マウントポイントを選択します。YaSTによって、作成する各パーティション用のマウントポイントが提案されます。別のマウント方法(ラベルによるマウントなど)を使用するには、<guimenu>Fstabオプション</guimenu>を選択します。サポートされているファイルシステムについては、<systemitem class="username">root</systemitem>を参照してください。
    </para>
   </step>
   <step>
    <para>
     セットアップで必要な場合は、追加のファイルシステムオプションを指定します。たとえば、永続的デバイス名が必要な場合に必要になります。使用できるオプションの詳細については、<xref linkend="sec-yast2-i-y2-part-expert-options"/>を参照してください。
    </para>
   </step>
   <step>
    <para>
     <guimenu>完了</guimenu>をクリックして、パーティション設定を適用し、パーティション設定モジュールを終了します。
    </para>
    <para>
     インストール時にパーティションを作成した場合は、インストール概要画面に戻ります。
    </para>
   </step>
  </procedure>
  <section xml:id="yast2-btrfs">
   <title>Btrfsパーティショニング</title>
   <para>
    新しくインストールしたシステムのデフォルトのファイルシステムとしてBtrfs (Btrfsの詳細については、<xref linkend="cha-snapper"/><phrase os="sles">と<xref linkend="filesystems"/></phrase>を参照)を使用する場合は、<guimenu>インストール設定</guimenu>画面で<guimenu>パーティション</guimenu>をクリックして、<guimenu>デフォルトのファイルシステムとしてBtrfsを使用</guimenu>チェックボックスをオンにします。次にインストールシステムによって、Ext3ファイルシステムでフォーマットされた<filename>/boot</filename>パーティションと、Btrfsでフォーマットされ、デフォルトのサブボリュームセットを保持したルート<filename>/</filename>パーティションを作成するように提示されます。これらは<guimenu>エキスパートパーティショナ</guimenu>ツールを使用して後で変更することができます。
   </para>
   <para>
    ルートファイルシステムはデフォルトのサブボリュームなので、作成されたサブボリュームのリストには表示されません。デフォルトのBtrfsサブボリュームは、通常のファイルシステムとしてマウントできます。
   </para>
   <para>
    Btrfsサブボリュームのスナップショットは、システムイベントに基づいて手動または自動で作成することができます。たとえば、ファイルシステムを変更する場合、変更の前後に、<command>zypper</command>によって<command>snapper</command>コマンドが呼び出され、スナップショットが作成されます。これは、<command>zypper</command>によって行われた変更に満足できず、以前の状態に戻したい場合に役立ちます。<command>zypper</command>によって呼び出される<command>snapper</command>は、デフォルトでは<emphasis>ルート</emphasis>ファイルシステムのスナップショットを作成するので、そこに含まれるデータの性質に応じて、特定のディレクトリをスナップショットの対象から外すことは適切な処理です。次に示すような独立したサブボリュームの作成がYaSTで提案される理由はここにあります。
   </para>
   <variablelist>
    <title>提示されるBtrfsサブボリューム</title>
    <varlistentry>
     <term><filename>/tmp /var/tmp /var/run</filename>
     </term>
     <listitem>
      <para>
       頻繁に変更されるコンテンツを含むディレクトリ。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>/var/spool</filename>
     </term>
     <listitem>
      <para>
       メールなどのユーザデータが含まれます。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>/var/log</filename>
     </term>
     <listitem>
      <para>
       ロールバック不可のシステムおよびアプリケーションのログファイルが含まれます。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>/var/crash</filename>
     </term>
     <listitem>
      <para>
       クラッシュしたカーネルのメモリダンプが含まれます。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>/srv</filename>
     </term>
     <listitem>
      <para>
       FTPサーバとHTTPサーバに属しているデータファイルが含まれます。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><filename>/opt</filename>
     </term>
     <listitem>
      <para>
       サードパーティのソフトウェアが含まれます。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <tip>
    <title>Btrfsパーティションのサイズ</title>
    <para>
     スナップショットの保存には多くのディスク容量を必要とするので、Btrfsパーティションには、スナップショット機能のないパーティション(Ext3など)よりも多くの容量を確保することをお勧めします。提示されるサブボリュームを含むルートBtrfsパーティションに推奨されるサイズは20GBです。
    </para>
   </tip>
   <section xml:id="yast2-btrfs-yast">
    <title>YaSTを使用したBtrfsサブボリュームの管理</title>
    <para>
     YaSTの<guimenu>エキスパートパーティショナ</guimenu>モジュールでBtrfsパーティションのサブボリュームを管理できるようになりました。新しいサブボリュームを追加したり、既存のサブボリュームを削除したりすることができます。
    </para>
    <procedure>
     <title>YaSTによるBtrfsサブボリューム</title>
     <step>
      <para>
       <menuchoice><guimenu>システム</guimenu><guimenu>ディスクの分割</guimenu></menuchoice>の順に選択して、YaSTの<guimenu>エキスパートパーティショナ</guimenu>を起動します。
      </para>
     </step>
     <step>
      <para>
       左側の<guimenu>システムビュー</guimenu>ペインで<guimenu>BTRFS</guimenu>を選択します。
      </para>
     </step>
     <step>
      <para>
       サブボリュームを管理する必要があるBtrfsパーティションを選択し、<guimenu>編集</guimenu>をクリックします。
      </para>
     </step>
     <step>
      <para>
       <guimenu>サブボリューム処理</guimenu>をクリックします。選択したBtrfsパーティションに既存のすべてのサブボリュームのリストが表示されます。多くの<literal>@/.snapshots/xyz/snapshot</literal>エントリが確認できますが、これらのサブボリュームはそれぞれ1つの既存のスナップショットに属しています。
      </para>
     </step>
     <step>
      <para>
       サブボリュームを追加するのか、削除するのかに応じて、次の手順を実行します。
      </para>
      <substeps performance="required">
       <step>
        <para>
         サブボリュームを削除するには、<guimenu>既存のサブボリューム</guimenu>のリストからそのサブボリュームを選択して、<guimenu>削除</guimenu>を選択します。
        </para>
       </step>
       <step>
        <para>
         新しいサブボリュームを追加するには、<guimenu>新しいサブボリューム</guimenu>テキストフィールドに名前を入力し、<guimenu>新規追加</guimenu>をクリックします。
        </para>
        <figure xml:id="fig-yast2-btrfs-subvolumes">
         <title>YaSTのパーティショナでのBtrfsサブボリューム</title>
         <mediaobject>
          <imageobject role="fo">
           <imagedata fileref="yats2_btrfs_subvolumes.png" width="75%" format="PNG"/>
          </imageobject>
          <imageobject role="html">
           <imagedata fileref="yats2_btrfs_subvolumes.png" width="75%" format="PNG"/>
          </imageobject>
         </mediaobject>
        </figure>
       </step>
      </substeps>
     </step>
     <step>
      <para>
       <guimenu>OK</guimenu>および<guimenu>完了</guimenu>をクリックして確定します。
      </para>
     </step>
     <step>
      <para>
       <guimenu>完了</guimenu>をクリックしてパーティショナを閉じます。
      </para>
     </step>
    </procedure>
   </section>
  </section>
 </section>

 <section xml:id="sec-yast2-i-y2-part-expert-options">
  <title>パーティションの編集</title><indexterm><primary>パーティション</primary><secondary>パラメータ</secondary></indexterm>
  <para>
   新規パーティションの作成または既存パーティションの変更の際には、さまざまなパラメータを設定できます。新規パーティションの場合は、YaSTで設定されているデフォルトパラメータで十分であることが普通で、これらを変更する必要はありません。パーティション設定を手動で編集するには、以下の手順に従ってください。
  </para>
  <procedure>
   <step>
    <para>
     パーティションを選択します。
    </para>
   </step>
   <step>
    <para>
     <guimenu>編集</guimenu>をクリックして、パーティションの編集およびパラメータ設定を実行します。
    </para>
    <variablelist>
     <varlistentry>
      <term>ファイルシステムID</term>
      <listitem>
       <para>
        <indexterm> <primary>パーティション</primary> <secondary>LVM</secondary> </indexterm> <phrase os="sles"> </phrase> <indexterm><primary>パーティション</primary> <secondary>RAID</secondary> </indexterm>この段階でパーティションをフォーマットしたくない場合でも、パーティションにファイルシステムIDを割り当て、パーティションが正しく登録されるようにします。典型的な値は、<guimenu>Linux </guimenu>、<guimenu>Linux swap</guimenu>、<guimenu>Linux LVM</guimenu>、および<guimenu>Linux RAID</guimenu>です。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>
       ファイルシステム
      </term>
      <listitem>
       <para>
        <indexterm> <primary>ファイルシステム</primary> <secondary>変更</secondary> </indexterm> <indexterm> <primary>パーティション</primary> <secondary>再フォーマット</secondary> </indexterm>パーティションのファイルシステムを変更するには、<guimenu>パーティションをフォーマットする</guimenu>をクリックし、<guimenu>ファイルシステム</guimenu>のリストでファイルシステムのタイプを選択します。
       </para>
       <para>
        <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>では、数種類のファイルシステムをサポートしています。Btrfsは、高度な機能を備えており、最適なLinuxファイルシステムです。BtrFSは、コピーオンライト機能、スナップショットの作成、マルチデバイススパニング、サブボリュームなどの有用なテクニックをサポートします。ReiserFS、JFS、XFS、およびExt3は、ジャーナリングファイルシステムです。これらのファイルシステムは、システムクラッシュ後のシステムを非常に迅速に復元できます。これは、操作中にログされた書込みプロセスを利用できるからです。Ext2は、ジャーナリングファイルシステムではありませんが、管理にあまりディスクスペースがいらないので、小さなパーティションには十分なシステムです。
       </para>
       <note>
        <title>Ext4ファイルシステムのサポート</title>
        <para>
         Btrfsの方がExt4よりも効率性と拡張性が高いことは実証済みなので、<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> SP2では、Ext4パーティションには読み込み専用アクセスしかサポートしていません。ただし、Ext4パーティションを読み込み/書込みモードでアクセスすることも可能です。その場合は、<systemitem>ext4-writeable</systemitem>パッケージをインストールする必要があります。ただし、これはサポートされていない操作であり、カーネルに問題を発生させる可能性があることに注意してください。
        </para>
       </note>
       <para>
        スワップは、パーティションの仮想メモリとしての使用を可能にする特別なフォーマットです。最小256MBのスワップパーティションを作成します。ただし、スワップスペースを使い果たした場合は、スワップスペースを追加する代わりに、システムにメモリを追加することを検討してください。
       </para>
       <warning>
        <title>ファイルシステムの変更</title>
        <para>
         ファイルシステムを変更したり、パーティションを再フォーマットすると、パーティションからすべてのデータが完全に削除され、復元することができなくなります。
        </para>
       </warning>
       <para>
        各種ファイルシステムの詳細については、『<emphasis>ストレージ管理ガイド</emphasis>』を参照してください。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>
       デバイスの暗号化 
      </term>
      <listitem>
       <para>
        暗号化を有効にした場合、すべてのデータは暗号化された状態で、ハードディスクに書き込まれます。これにより、機密データのセキュリティが向上しますが、暗号化の処理に時間がかかるので、システムの処理速度が低下します。ファイルシステムの暗号化の詳細については、<xref linkend="cha-security-cryptofs"/>を参照してください。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>
       マウントポイント
      </term>
      <listitem>
       <para>
        ファイルシステムのツリー内でパーティションをマウントするディレクトリを指定します。YaSTによる推奨ディレクトリから選択するか、他の任意のディレクトリ名を入力します。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>
       fstabのオプション
      </term>
      <listitem>
       <para>
        グローバルファイルシステム管理ファイル(<filename>/etc/fstab</filename>)にあるさまざまなパラメータを指定します。ほとんどの設定では、デフォルト設定で動作します。たとえば、ファイルシステムIDをデバイス名からボリュームラベルに変更できます。ボリュームラベルには、<literal>/</literal>およびスペース以外のすべての文字を使用することができます。
       </para>
       <para>
        永続的なデバイス名を取得するには、マウントオプションの <guimenu>デバイスＩＤ</guimenu>、<guimenu>UUID</guimenu>、または<guimenu>ラベル</guimenu>を使用します。<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase>では、永続的なデバイス名がデフォルトで有効になっています。
       </para>
       <note os="sles" arch="zseries">
        <title>IBM System z;: パスによるマウント</title>
        <para>
         IBM System zでは、デバイスをIDでマウントしていると、クローニングの目的でディスクからディスクへのコピーを使用したときに障害が発生するので、デフォルトで<filename>/etc/fstab</filename>のパスによってデバイスがマウントされます。
        </para>
       </note>
       <para>
        パーティションをそのラベルでマウントしたい場合は、<guimenu>ボリュームラベル</guimenu>テキストエントリでラベルを定義する必要があります。たとえば、<filename>/home</filename>にマウントするパーティションには、パーティションラベル<literal>HOME</literal>を使用できます。
       </para>
       <para>
        ファイルシステムでクォータを使用する場合は、マウントオプション<guimenu>クォータサポートを有効にする</guimenu>を使用します。このオプションを指定しておかないと、YaSTの<guimenu>ユーザ管理</guimenu>モジュールでユーザのクオータを定義できません。ユーザクォータの設定方法の詳細については、<xref linkend="sec-y2-userman-adv-quota"/>を参照してください。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </step>
   <step>
    <para>
     <guimenu>完了</guimenu>を選択して、変更を保存します。
    </para>
   </step>
  </procedure>
  <note>
   <title>ファイルシステムのサイズ変更</title>
   <para>
    既存ファイルシステムのサイズを変更するには、パーティションを選択し、<guimenu>サイズ変更</guimenu>をクリックします。パーティションはマウント中にはサイズ変更できないので注意してください。パーティションをサイズ変更するには、パーティショナの実行前に該当するパーティションをアンマウントします。
   </para>
  </note>
 </section>

 <section xml:id="sec-yast2-i-y2-part-expert-options2">
  <title>エキスパート用オプション</title>
  <para>
   <guimenu>システムビュー</guimenu>ペインでハードディスクデバイス(<guimenu>sda</guimenu>など)を選択したら、<guimenu>エキスパートパーティショナ</guimenu>ウィンドウの右下部分にある<guimenu>エキスパート...</guimenu>メニューにアクセスできます。メニューには、次のオプションが含まれています。
  </para>
  <variablelist>
   <varlistentry>
    <term>新しいパーティションテーブルの作成</term>
    <listitem>
     <para>
      このオプションを使用すると、選択したデバイス上に新しいパーティションテーブルを作成できます。
     </para>
     <warning>
      <title>新しいパーティションテーブルの作成</title>
      <para>
       新しいパーティションテーブルをデバイス上に作成すると、そのデバイスからすべてのパーティションとそのデータが削除され、復元できなくなります。
      </para>
     </warning>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>このディスクのクローンを作成</term>
    <listitem>
     <para>
      このオプションを使用すると、デバイスのパーティションレイアウト(データを含まない)を他の使用可能なディスクデバイスに複製できます。
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </section>

 <section xml:id="sec-yast2-i-y2-part-expert-configure-options">
  <title>詳細オプション</title>
  <para>
   コンピュータのホスト名(<guimenu>システムビュー</guimenu>ペインにあるツリーのトップレベル)を選択したら、<guimenu>エキスパートパーティショナ</guimenu>ウィンドウの右下にある<guimenu>設定...</guimenu>メニューにアクセスできます。メニューには、次のオプションが含まれています。
  </para>
  <variablelist>
   <varlistentry>
    <term>iSCSIの設定</term>
    <listitem>
     <para>
      IPブロックデバイス上でSCSIにアクセスするには、まず、iSCSIを設定する必要があります。これによって、利用可能な追加デバイスがメインパーティションリストに表示されます。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>マルチパスの設定</term>
    <listitem>
     <para>
      このオプションを選択すると、サポートされている大容量記憶装置に対してマルチパス機能拡張を設定できます。
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </section>

 <section xml:id="sec-yast2-i-y2-part-expert-info">
  <title>パーティション設定に関するヒント</title>
  <para>
   以降のセクションでは、システムの設定時に正しい決定を下すために役立つパーティション設定に関するヒントを示します。
  </para>
  <tip>
   <title>シリンダ番号</title>
   <para>
    パーティション設定ツールによっては、パーティションのシリンダの番号を<literal>0</literal>または<literal>1</literal>で開始します。シリンダ数を計算するには、最後と最初のシリンダ番号の差に1を加えます。
   </para>
  </tip>

  <section>
   <title><literal>swap</literal>の使用</title>
   <para>
    swapは、使用可能な物理メモリの拡張に使用します。その結果、使用可能な物理RAMより多くのメモリを使用することが可能になります。2.4.10以前のカーネルのメモリ管理システムでは、安全措置としてswapが必要でした。そして、swap領域にRAMの2倍のサイズがないと、システムパフォーマンスが低下していました。これらの制限はもはや存在しません。
   </para>
   <para>
    Linuxでは、LRU(<quote>Least Recently Used</quote>)と呼ばれるページを使用して、メモリからディスクへ移動する可能性のあるページを選択します。したがって、実行中のアプリケーションがより多くのメモリを使用できるだけでなく、キャッシングもさらにスムーズに機能します。
   </para>
   <para>
    アプリケーションが最大許容メモリを割り当てようとすると、swapに伴う問題が発生する可能性があります。次の3つの主要なシナリオを検討します。
   </para>
   <variablelist>
    <varlistentry>
     <term>スワップのないシステム</term>
     <listitem>
      <para>
       アプリケーションは最大許容メモリを取得します。すべてのキャッシュが解放されるので、他のすべてのアプリケーションの速度が低下します。数分後に、カーネルのout-of-memory kill(メモリ不足解消)のメカニズムがアクティブになり、プロセスを終了させます。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>中程度のスワップ(128MB～512MB)を持つシステム</term>
     <listitem>
      <para>
       まず、スワップのないシステムと同様に、システム速度が低下します。すべての物理RAMが使い果たされると、スワップ領域も使用されます。この時点で、システムが非常に遅くなり、リモートからコマンドを実行することが不可能になります。スワップ領域を実行するハードディスクの速度によっては、out-of-memory kill(メモリ不足解消)メカニズムが問題を解決するまで、システムのこの状態が約10分から15分続きます。ただし、コンピュータが<quote>ディスクへのサスペンド</quote>を実行する場合は、一定量のスワップが必要になります。その場合、スワップには、メモリから必要なデータを取り込めるだけの大きさ(512MB～1GB)が必要です。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>大量のスワップ(数ＧＢ)を持つシステム</term>
     <listitem>
      <para>
       この場合、暴走して過剰にスワップするアプリケーションがないことが望ましい条件です。そのようなアプリケーションを使用すると、システムが回復するまで長い時間がかかります。その間に、他のプロセスにタイムアウトや障害が発生しがちで、障害のあるプロセスを終了させた場合でも、システムが定義されていない状態のままになることがあります。その場合は、ハードマシンリブートを実行して、システムの再実行を試行します。大量のスワップが役立つのは、この機能に依存するアプリケーションがある場合です。そのようなアプリケーション(データベース、グラフィック操作プログラムなどﾞ)は、多くの場合、ニーズに応じてハードディスクの領域を直接使用するオプションを持っています。大量のスワップ領域を使用する代わりに、このオプションを使用することをお勧めします。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    暴走はしないものの、しばらくするとスワップをさらに必要とするシステムの場合は、スワップ領域をオンラインで拡張できます。スワップ領域用パーティションを準備している場合は、YaSTでそのパーティションを追加してください。使用可能なパーティションがない場合は、スワップファイルを使用してスワップを拡張することもできます。スワップファイルを使用した場合は、一般に、パーティションを使用した場合より速度が遅くなりますが、物理RAMと比べると、両方とも非常に低速なので、実際の違いは無視できる程度です。
   </para>
   <procedure>
    <title>手動によるスワップファイルの追加</title>
    <para>
     実行中のシステムにスワップファイルを追加するには、次の手順に従います。
    </para>
    <step>
     <para>
      システム内で空ファイルを作成します。たとえば、128MBのスワップファイルを<filename>/var/lib/swap/swapfile</filename>に追加するには、次のコマンドを使用します。
     </para>
<screen>mkdir -p /var/lib/swap
dd if=/dev/zero of=/var/lib/swap/swapfile bs=1M count=128</screen>
    </step>
    <step>
     <para>
      このスワップファイルを次のコマンドで初期化します。
     </para>
<screen>mkswap /var/lib/swap/swapfile</screen>
    </step>
    <step>
     <para>
      スワップを次のコマンドで有効にします。
     </para>
<screen>swapon /var/lib/swap/swapfile</screen>
     <para>
      このスワップファイルを無効にするには、次のコマンドを使用します。
     </para>
<screen>swapoff /var/lib/swap/swapfile</screen>
    </step>
    <step>
     <para>
      次のコマンドで、現在使用可能なスワップ領域を確認します。
     </para>
<screen>cat /proc/swaps</screen>
     <para>
      ただし、この時点では、これは一時的なスワップ領域にすぎません。次の再起動後は使用されなくなります。
     </para>
    </step>
    <step>
     <para>
      このスワップファイルを永久的に有効にするには、次の行を<filename>/etc/fstab</filename>に追加します。
     </para>
     
     
<screen>/var/lib/swap/swapfile swap swap defaults 0 0</screen>
    </step>
   </procedure>
  </section>
 </section>

 <section>
  <title>パーティション設定とLVM</title>
  <para>
   <guimenu>エキスパートパーティショナ</guimenu>から、<guimenu>システムビュー</guimenu>ペインにある<guimenu>ボリューム管理</guimenu>項目をクリックして、LVM設定にアクセスします。ただし、システムに有効なLVM設定がすでに存在する場合は、セッションの初期LVM設定時に、そのLVM設定が自動的にアクティブになります。この場合、パーティション(アクティブ化されたボリュームグループに属する)を含むすべてのディスクの再パーティション設定は不可能です。Linuxカーネルは、ハードディスクのパーティションが使用中の場合は、そのディスクの変更されたパーティションテーブルを再読み込みすることはできません。有効なLVM設定がシステムにすでに存在する場合は、物理的なパーティション再設定は必要ありません。代わりに、論理ボリュームの設定を変更します。
  </para>
  <para>
   物理ボリューム(PV)の先頭では、そのボリュームに関する情報がパーティションに書き込まれます。こうしたパーティションをLVM以外の目的で再使用するには、このボリュームの先頭を削除ておくようにお勧めします。たとえば、VG <literal>system</literal>およびPV <filename>/dev/sda2</filename>では、これは、コマンド<command>dd</command><option>if=/dev/zero of=/dev/sda2 bs=512 count=1</option>で行うことができます。
  </para>
  <warning>
   <title>ブート用ファイルシステム</title>
   <para>
    ブートに使用するファイルシステム(rootファイルシステムまたは<filename>/boot</filename>)をLVM論理ボリュームに格納しないでください。通常の物理パーティションに格納してください。
   </para>
  </warning>
  <para os="sles">
   LVMの詳細については、<xref linkend="stor-admin"/>を参照してください。
  </para>
 </section>
</section>
