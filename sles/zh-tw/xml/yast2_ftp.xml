<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE chapter PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN"
"novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<chapter xml:base="yast2_ftp.xml" id="cha.ftp">
 <title>使用 YaST 設定 FTP 伺服器</title><indexterm> <primary>FTP 伺服器</primary> <secondary>設定</secondary> </indexterm> <indexterm> <primary>設定</primary> <secondary>FTP 伺服器</secondary> </indexterm>
 <abstract>
  <para>
   使用 YaST 的<guimenu>FTP 伺服器</guimenu>模組，可以將機器設定為 FTP (檔案傳輸通訊協定) 伺服器。匿名和/或驗證使用者可以連接至您的機器並使用 FTP 通訊協定下載檔案，還可以將檔案上載至 FTP 伺服器 (視組態而定)。YaST 為您系統上安裝的各個 FTP 伺服器精靈提供了統一的組態介面。
  </para>
 </abstract>
 <para>
  您可以使用 YaST 的 <guimenu>FTP 伺服器</guimenu>組態模組設定兩個不同的 FTP 伺服器精靈︰
 </para>
 <itemizedlist mark="bullet" spacing="normal">
  <listitem>
   <para>
    <systemitem class="daemon">vsftpd</systemitem> (非常安全的 FTP 精靈) 和
   </para>
  </listitem>
  <listitem>
   <para>
    <systemitem class="daemon">pure-ftpd</systemitem>
   </para>
  </listitem>
 </itemizedlist>
 <para>
  只能設定已安裝的伺服器。 
 </para>
 <para>
  vsftpd 與 pure-ftpd 伺服器中所含的組態選項略有不同，特別是在<guimenu>進階設定</guimenu>對話方塊中。本章將描述 vsftpd 伺服器的設定。
 </para>
 <para>
  如果 YaST FTP 伺服器模組在您的系統中不可用，請安裝 <systemitem class="resource">yast2-ftp-server</systemitem> 套件。
 </para>
 <para>
  若要使用 YaST 設定 FTP 伺服器，請執行以下步驟︰
 </para>
 <procedure>
  <step performance="required">
   <para>
    開啟 YaST 控制中心，然後選擇<menuchoice><guimenu>網路服務</guimenu> <guimenu>FTP 伺服器</guimenu></menuchoice>，或以 <systemitem class="username">root</systemitem> 身分執行 <command>yast2 ftp-server</command> 指令。
   </para>
  </step>
  <step performance="required">
   <para>
    如果系統中未安裝任何 FTP 伺服器，系統將在「YaST FTP 伺服器」模組啟動時詢問您要安裝哪個伺服器。選擇一個伺服器，然後確認對話方塊。如果安裝了兩個伺服器，請選擇首選的伺服器，然後按一下<guimenu>確定</guimenu>。
   </para>
  </step>
  <step performance="required">
   <para>
    在<guimenu>啟動</guimenu>對話方塊中，設定啟動 FTP 伺服器的相關選項。如需詳細資訊，請參閱<xref linkend="sec.ftp.start"/>。
   </para>
   <para>
    在<guimenu>一般</guimenu>對話方塊中，設定 FTP 目錄、歡迎訊息、檔案建立遮罩和各種其他參數。如需詳細資訊，請參閱<xref linkend="sec.ftp.general"/>。
   </para>
   <para>
    在<guimenu>效能</guimenu>對話方塊中，設定會影響 FTP 伺服器負載的參數。如需詳細資訊，請參閱<xref linkend="sec.ftp.performance"/>。
   </para>
   <para>
    在<guimenu>驗證</guimenu>對話方塊中，設定匿名和/或已驗證的使用者是否可使用 FTP 伺服器。如需詳細資訊，請參閱<xref linkend="sec.ftp.auth"/>。
   </para>
   <para>
    在<guimenu>進階設定</guimenu>對話方塊中，設定 FTP 伺服器的操作模式、SSL 連接與防火牆設定。如需詳細資訊，請參閱<xref linkend="sec.ftp.expert"/>。
   </para>
  </step>
  <step performance="required">
   <para>
    按<guimenu>完成</guimenu>以儲存這些組態。
   </para>
  </step>
 </procedure>
 <sect1 id="sec.ftp.start">
  <title>啟動 FTP 伺服器</title>

  <para>
   在<guimenu>FTP 啟動</guimenu>對話方塊的<guimenu>服務啟動</guimenu>框架中，可以設定 FTP 伺服器的啟動方式。您可以選擇在系統開機時自動啟動伺服器，或是手動啟動伺服器。如果 FTP 伺服器只能在提出 FTP 連接要求之後啟動，請選擇<guimenu>透過 xinetd</guimenu>。
  </para>

  <para>
   FTP 伺服器的目前狀態將顯示在<guimenu>FTP 啟動</guimenu>對話方塊的<guimenu>開啟與關閉</guimenu>框架中。按一下<guimenu>立即啟動 FTP</guimenu>可以啟動 FTP 伺服器。若要停止伺服器，可按一下<guimenu>立即停止 FTP</guimenu>。變更伺服器的設定後，請按一下<guimenu>儲存設定並立即重新啟動 FTP</guimenu>。如果按一下<guimenu>完成</guimenu>離開組態模組，組態將儲存。
  </para>

  <para>
   <guimenu>FTP 啟動</guimenu>對話方塊的<guimenu>選取的服務</guimenu>框架顯示所使用的 FTP 伺服器︰vsftpd 或 pure-ftpd。如果兩個伺服器均已安裝，可以在兩者之間切換 — 目前的組態會自動轉換。
   
  </para>

  <figure id="fig.yast2.ftp-start-up">
   <title>FTP 伺服器組態 — 啟動</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="yast2_ftp-start-up.png" width="75%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="yast2_ftp-start-up.png" width="75%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
 </sect1>
 <sect1 id="sec.ftp.general">
  <title>FTP 一般設定</title>

  <para>
   在<guimenu>FTP 一般設定</guimenu>對話方塊的<guimenu>一般設定</guimenu>框架中，您可以設定連接至 FTP 伺服器後將會顯示的<guimenu>歡迎訊息</guimenu>。
  </para>

  <para>
   如果核取<guimenu>Chroot 每一個</guimenu>選項，則所有本地使用者登入後都將進入其主目錄中的 Chroot Jail。此選項含安全性要求，特別是當使用者具有上載權限或外圍程序存取權限時，因此啟用此選項時請務必小心。
  </para>

  <para>
   如果核取<guimenu>詳細記錄</guimenu>選項，則將記錄所有 FTP 請求與回應。
  </para>

  <para>
   您可以透過 Umask 對由匿名和/或已驗證的使用者建立之檔案的權限加以限制。請在<guimenu>匿名使用者 Umask</guimenu>中為匿名使用者設定檔案建立遮罩，並在<guimenu>已驗證使用者 Umask</guimenu>中為已驗證的使用者設定檔案建立遮罩。應以八進位數字 (前面加零) 輸入遮罩。如需有關 umask 的詳細資訊，請參閱 umask 的 man 頁面 (<command>man 1p umask</command>)。
  </para>

  <para>
   在<guimenu>FTP 目錄</guimenu>框架中設定用於匿名使用者與已驗證使用者的目錄。按一下<guimenu>瀏覽</guimenu>可從本地檔案系統選取要使用的目錄。對於匿名使用者，預設 FTP 目錄為 <filename>/srv/ftp</filename>。請注意，vsftpd 不允許所有使用者都可以寫入此目錄，而會為匿名使用者建立具有寫入權限的子目錄 <filename>upload</filename>。
  </para>

  <note>
   <title>FTP 目錄的寫入權限</title>
   <para>
    pure-ftpd 伺服器允許匿名使用者可以寫入 FTP 目錄。在兩個伺服器間切換時，請確定在切換回 vsftpd 伺服器之前，已移除曾用於 pure-ftpd 之目錄中的寫入權限。
   </para>
  </note>
 </sect1>
 <sect1 id="sec.ftp.performance">
  <title>FTP 效能設定</title>

  <para>
   在<guimenu>效能</guimenu>對話方塊中，設定會影響 FTP 伺服器負載的參數。<guimenu>最大閒置時間</guimenu>表示遠端用戶端在兩個 FTP 指令之間等待的最長時間 (以分鐘計)。如果發生了更長時間的閒置，將中斷遠端用戶端的連接。<guimenu>同一個 IP 最大用戶端數</guimenu>決定可從單一 IP 位址連接的最大用戶端數量。<guimenu>最大用戶端數</guimenu>決定可以連接的最大用戶端數量。任何額外用戶端都將收到一則錯誤訊息。
  </para>

  <para>
   可在<guimenu>最大本地速率</guimenu>和<guimenu>最大匿名速率</guimenu>中分別為本地已驗證的使用者及匿名用戶端設定最大資料傳輸速率。速率設定的預設值為 <literal>0</literal>，表示資料傳輸速率無限制。
  </para>
 </sect1>
 <sect1 id="sec.ftp.auth">
  <title>驗證</title>

  <para>
   在<guimenu>驗證</guimenu>對話方塊的<guimenu>啟用/停用匿名使用者和本地使用者</guimenu>框架中，您可以設定允許存取 FTP 伺服器的使用者。您還可以從以下選項中進行選擇︰僅授予匿名使用者存取權限、僅授予驗證使用者 (擁有系統帳戶) 存取權限，或者同時授予這兩類使用者存取權限。
  </para>

  <para>
   若要允許使用者上載檔案至 FTP 伺服器，請核取<guimenu>驗證</guimenu>對話方塊之<guimenu>上載</guimenu>框架中的<guimenu>啟用上載</guimenu>。在此處核取對應的方塊後，您就可以允許包括匿名使用者在內的使用者上載或建立目錄。
  </para>

  <note>
   <title>vsftp — 允許匿名使用者上傳檔案</title>
   <para>
    如果使用的是 vsftpd 伺服器而您希望匿名使用者能夠上載檔案或建立目錄，則需要在匿名 FTP 目錄中為所有使用者建立具有寫入權限的子目錄。
   </para>
  </note>
 </sect1>
 <sect1 id="sec.ftp.expert">
  <title>進階設定</title>

  <para>
   FTP 伺服器既可以在主動模式中執行，也可以在被動模式中執行。依預設伺服器在被動模式中執行。若要切換至主動模式，只需取消核取<guimenu>進階設定</guimenu>對話方塊中的<guimenu>啟用被動模式</guimenu>選項。您還可以調整<guimenu>被動模式的最小連接埠</guimenu>與<guimenu>被動模式的最大連接埠</guimenu>選項來變更伺服器上用於資料流的連接埠範圍。
  </para>

  <para>
   若要在用戶端與伺服器之間使用加密通訊，可以選取<guimenu>啟用 SSL</guimenu>。檢查要支援之協定的版本，並指定用於 SSL 加密連接的 DSA 證書。

  </para>

  <para>
   如果系統受防火牆保護，請核取<guimenu>在防火牆中開啟埠</guimenu>以啟用到 FTP 伺服器的連接。
  </para>
 </sect1>
 <sect1 id="sec.ftp.info">
  <title>更多資訊</title>

  <para>
   如需有關 FTP 伺服器的詳細資訊，請參閱 <phrase os="sles"><command>pure-ftpd</command>、</phrase> <command>vsftpd</command> 與 <command>vsftpd.conf</command> 的手冊頁。
  </para>
 </sect1>
</chapter>
