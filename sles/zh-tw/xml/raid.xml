<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sect1 PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN"
"novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<sect1 xml:base="raid.xml" id="sec-yast2-system-raid">
 <title>軟體 RAID 組態</title><indexterm> <primary>YaST</primary><secondary>RAID</secondary></indexterm><indexterm><primary>RAID</primary><secondary>YaST</secondary></indexterm><indexterm><primary>軟體 RAID</primary><see>RAID</see></indexterm>



 <para>
  RAID (獨立磁碟備援陣列) 的用途是將數個硬碟分割區組合成一個大型<emphasis>虛擬</emphasis>硬碟，以最佳化效能和/或確保資料安全性。大多數 RAID 控制器會使用 SCSI 協定，因為它能以比 IDE 協定更有效的方式讀寫更多數量的硬碟。它也更適合平行指令處理。有部分的 RAID 控制器支援 IDE 或 SATA 硬碟。軟體 RAID 可提供 RAID 系統的優點，卻不需要硬體 RAID 控制器的額外成本。但這需要佔用一定的 CPU 時間和記憶體，因而不適用於高效能的電腦。
 </para>

 <para>
  使用 <phrase role="productname"><phrase os="sles">SUSE® Linux Enterprise Server</phrase></phrase>，您可以將數個硬碟組合為一個軟體 RAID 系統。RAID 一詞是表示將數個硬碟結合成 RAID 系統的一些策略，每個都有不同的目標、優點及特色。這些變化通常稱為 <emphasis>RAID 層級</emphasis>。
 </para>

 <para>
  常用 RAID 層級為：
 </para>

 <variablelist>
  <varlistentry>
   <term>RAID 0</term>
   <listitem>
    <para>
     此層級將每個檔案的區塊分散於多個磁碟，以提升您的資料存取效能。實際上，它不是真正的 RAID，因為它不提供資料備份，但通常將此類系統稱為 <emphasis>RAID 0</emphasis>。使用 RAID 0，就可將兩個以上的磁碟聚集在一起。效能得到增強，但是如果其中一個硬碟發生故障，RAID 系統便會損毀而且資料會遺失。
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term>RAID 1</term>
   <listitem>
    <para>
     此層級對資料提供足夠的安全性，因為資料是以 1:1 複製到另一個硬碟。這就是所謂的<emphasis>硬碟鏡像</emphasis>。如果其中一個硬碟損毀，另一個硬碟上會提供其內容的複本。如果所有其他硬碟都被損毀，但有一個可用，就不會危害到資料。但是，如果偵測不到損毀，損毀的資料可能會鏡像複製到未損毀的硬碟上。這同樣會造成資料遺失。複製過程中的寫入效能與使用單一磁碟存取相比差了一些 (慢了百分之十到二十)，但是讀取存取卻較任何一般實體硬碟快得多，因為複製的資料可以平行掃描。一般而言，「層級 1」比單一磁碟的讀取傳輸速率快了將近兩倍，而且與單一磁碟的寫入傳輸速率幾乎相同。
    </para>
   </listitem>
  </varlistentry>

  <varlistentry>
   <term>RAID 5</term>
   <listitem>
    <para>
     RAID 5 是「層級 0」與「層級 1」之間效能和備援方面的最佳折衷。硬碟空間等於使用的磁碟數減一。資料會分布至各個硬碟，這與 RAID 0 一樣。在其中一個分割區上建立的<emphasis>同位區塊</emphasis>，是基於安全性考量。它們以 XOR 互相連結，使得系統失敗時，能夠藉由對應的同位區塊重新建構內容。使用 RAID 5，不會有一個以上的硬碟同時失敗。如果一個硬碟失敗，必須立即更換以避免資料遺失的風險。
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term>RAID 6</term>
   <listitem>
    <para>
     若要進一步提高 RAID 系統的可靠性，可以使用 RAID 6。在此層級中，即使兩個磁碟失敗，仍然可以重新建構陣列。若使用 RAID 6，則至少需有 4 個硬碟才能執行陣列。請注意，做為軟體 RAID 執行時，這種組態需要使用相當多的 CPU 時間和記憶體。
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term>RAID 10 (RAID 1+0)</term>
   <listitem>
    <para>
     此 RAID 實作兼具 RAID 0 與 RAID 1 的功能：資料先鏡像複製到獨立的磁碟陣列，這些陣列隨後會插入到新的 RAID 0 類型陣列中。在每個 RAID 1 子陣列中，一個磁碟發生故障並不會損毀任何資料。若要執行 RAID 10，至少需要四個磁碟，並且磁碟數量必須是偶數。這種類型的 RAID 用於預期會產生巨大資料負載的資料庫應用程式。
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term>其他的 RAID 層級</term>
   <listitem>
    <para>
     現在已經開發了一些其他的 RAID 層級 (RAID 2、RAID 3、RAID 4、RAIDn、RAID 10、RAID 0+1、RAID 30、RAID 50 等等)，有些是硬體廠商建立的專用實作。這些層級並不是很常見，因此在這裡不做說明。
    </para>
   </listitem>
  </varlistentry>
 </variablelist>

 <sect2 id="sec-yast2-system-raid-conf">
  <title>使用 YaST 進行軟體 RAID 組態</title>
  <para>
   YaST <guimenu>RAID</guimenu> 組態可透過 YaST 進階磁碟分割程式來完成，請參閱<xref linkend="sec-yast2-i-y2-part-expert"/>。這個磁碟分割工具可讓您編輯和刪除現有分割區，以及建立將與軟體 RAID 一起使用的新分割區。
  </para>
  <procedure>
   <step performance="required">
    <para>
     從<guimenu>硬碟</guimenu>中選取一個硬碟。
    </para>
   </step>
   <step performance="required">
    <para>
     切換到<guimenu>分割區</guimenu>索引標籤。
    </para>
   </step>
   <step performance="required">
    <para>
     按一下<guimenu>新增</guimenu>，然後輸入此磁碟上 RAID 分割區所需的大小。
    </para>
   </step>
   <step performance="required">
    <para>
     使用<guimenu>不格式化分割區</guimenu>並將<guimenu>檔案系統 ID</guimenu>變更為<guimenu>0xFD Linux RAID</guimenu>。不要掛接此分割區。
    </para>
   </step>
   <step performance="required">
    <para>
     重複此程序，直到定義了可用磁碟上所有需要的實體磁碟區為止。
    </para>
   </step>
  </procedure>
  <para>
   對於 RAID 0 和 RAID 1，至少需要兩個分割區。對於 RAID 1，通常兩個剛好，無需更多。如果使用 RAID 5，則至少需要三個分割區；RAID 6 和 RAID 10 至少需要四個分割區。建議您僅使用相同大小的分割區。為減少當其中一個硬碟 (RAID 1 和 5) 損壞時會有遺失資料的風險，以及為了最佳化 RAID 0 的效能，RAID 分割區應位於不同的硬碟中。建立所有要使用 RAID 功能的分割區後，按一下<menuchoice><guimenu>RAID</guimenu><guimenu>新增 RAID</guimenu></menuchoice>開始設定 RAID 組態。
  </para>
  <para>
   在下一個對話方塊中，選擇 RAID 層級 0、1、5、6 或 10。然後選取 RAID 系統要使用且類型為<quote>Linux RAID</quote>或<quote>Linux native</quote>的所有分割區。不會顯示交換和 DOS 分割區。
  </para>
  <tip>
   <para>
    對於已新增磁碟的順序具有重要性的 RAID 類型，您可以使用字母 A 到 E 中的一個來標示個別磁碟。按一下<guimenu>分類</guimenu>按鈕，選取磁碟，然後按一下其中一個<guimenu>類別 X</guimenu>按鈕 (其中 X 是要指定給磁碟的字母)。以這種方式指定所有可用的 RAID 磁碟，然後按一下<guimenu>確定</guimenu>進行確認。使用<guimenu>已排序</guimenu>或<guimenu>交錯式</guimenu>按鈕，您可以輕鬆地對分類的磁碟進行排序，或者使用<guimenu>模式檔案</guimenu>從文字檔案新增排序模式。
   </para>
  </tip>
  <figure id="fig-yast2-system-raid-conf">
   <title>RAID 分割區</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="yast2_raid4.png" width="75%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="yast2_raid4.png" width="75%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
  <para>
   若要新增之前未指定的分割區給選取的 RAID 磁碟區，請先按一下分割區，再按 <guimenu>新增</guimenu>。指定保留給 RAID 的所有分割區。否則，仍然不會使用分割區上的空間。指定所有分割區後，按<guimenu>下一步</guimenu>選取可用的<guimenu>RAID 選項</guimenu>。
  </para>
  <para>
   在最後一個步驟中，設定要使用的檔案系統、加密以及 RAID 磁碟區的掛接點。在按一下 <guimenu>完成</guimenu> 以完成組態之後，請參閱 <filename>/dev/md0</filename> 裝置及其他在專家分割程式中以 <emphasis>RAID</emphasis> 表示的裝置。
  </para>
 </sect2>

 <sect2>
  <title>疑難排解</title>
  <para>
   檢查檔案 <filename>/proc/mdstat</filename> 以確定 RAID 分割區是否已損毀。當系統失敗時，請關閉 Linux 系統並使用以相同方式磁碟分割的新硬碟來更換損壞的硬碟。然後重新啟動系統，並輸入 <command>mdadm /dev/mdX --add /dev/sdX</command> 指令。使用特定的裝置識別碼取代 X。如此可將硬碟自動整合到 RAID 系統並完整地重新建構。
  </para>
  <para>
   請注意，雖然您可以在重建期間存取所有資料，但是在完全重建 RAID 之前，您可能會遇到一些效能問題。
  </para>
 </sect2>

<?dbfo-need height="10em"?>



 <sect2>
  <title>更多資訊</title>
  <para>
   可在下列網址的 HOWTO 中找到組態指南及軟體 RAID 的詳細資訊：
  </para>
  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     <filename>/usr/share/doc/packages/mdadm/Software-RAID.HOWTO.html</filename>
    </para>
   </listitem>
   <listitem>
    <para>
     <ulink url="http://raid.wiki.kernel.org"/>
    </para>
   </listitem>
  </itemizedlist>
  <para>
   有 Linux RAID 郵寄清單可供參考，如 <ulink url="http://marc.info/?l=linux-raid"/>。
  </para>
 </sect2>
</sect1>
