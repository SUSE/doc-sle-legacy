<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE chapter PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN"
"novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<chapter xml:base="sle_update.xml" id="cha.update.sle">
 <title>更新 SUSE Linux Enterprise</title>
 <abstract>
  <para>
   SUSE® Linux Enterprise (SLE) 可讓您將現有系統更新為新版本，而不必全面重新安裝。不需要任何新安裝。主目錄和系統組態等現有資料仍保持不變。在產品的生命週期內，您可以套用 Service Pack 來提高系統安全性、修正軟體缺陷以及取得新功能的存取權。請從本地 CD 或 DVD 光碟機或從中央網路安裝來源進行安裝。
  </para>
 </abstract>
 <sect1 id="sec.update.terminology">
  <title>術語</title>

  <para>
   本章使用了一些詞彙。若要理解本章資訊，請參閱下面的定義︰
  </para>

  <variablelist>
   <varlistentry>
    <term>回移</term>
    <listitem>
     <para>
      回移是指調整較新版軟體中的特定變更並將其套用至較舊版本。最常用的情況是修正舊軟體元件中的安全漏洞。它通常也是維護模型的一部分，用於提供增強功能或 (較少見的) 新功能。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>

    <term>Deltarpm</term>
    <listitem>
     <para>
      deltarpm 只包括某套件兩個定義版本之間的二進位差異，因此，它的下載大小最小。安裝之前，會在本地機器上重建完整的 RPM 套件。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>下游</term>
    <listitem>
     <para>
      軟體在開放原始碼領域中如何開發的一種比喻說法 (與<emphasis>上游</emphasis>相對)。<emphasis>下游</emphasis>一詞指的是這樣的人員或組織 (如 SUSE)：他們將上游中的源代碼與其他軟體相整合，以建立由終端使用者使用的套裝作業系統。因此，軟體會將下游從其開發者經由整合器流向終端使用者。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>線上移轉</term>
    <listitem>
     <para>
      使用線上更新工具 (而不是安裝媒體) 更新至 Service Pack (SP)，以安裝對應的修補程式。它會將已安裝系統的所有套件更新到 SP3 + SP2 更新的最新狀態 (包括更新)。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>

    <term>套件</term>
    <listitem>
     <para>
      套件是採用 <literal>rpm</literal> 格式的壓縮檔案，它包含特定程式的所有檔案，包括組態、範例及文件等選用元件。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>

    <term>修補程式</term>
    <listitem>
     <para>
      修補程式由一或多個套件組成，並可透過 deltarpm 的方式進行套用。它還可能引入對尚未安裝之套件的相依性。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>Service Pack (SP)</term>
    <listitem>
     <para>
      將多個修補程式合併為一種易於安裝或部署的形式。Service Pack 都指定了編號，通常包含程式的安全性修正、更新、升級或增強。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>上游</term>
    <listitem>
     <para>
      軟體在開放原始碼領域中如何開發的一種比喻說法 (與<emphasis>下游</emphasis>相對)。<emphasis>上游</emphasis>一詞指的是做為源代碼分發之軟體的原始專案、原著者或維護者。回饋、修補程式、功能增強或其他改善從終端使用者或貢獻者流向上游開發者。他們決定是整合還是拒絕申請。
     </para>
     <para>
      如果專案成員決定整合該申請，它將會在更新版本的軟體中體現出來。接受的申請將會讓有關各方均獲益。
     </para>
     <para>
      如果申請不被接受，則可能是出於不同的原因︰該申請的狀態不符合專案準則、該申請無效或已整合，或者是不符合專案的利益或藍圖。不被接受的申請使得上游開發者更難處理，因為他們必須讓其修補程式與上游代碼保持同步。一般會避免這種做法，但是有時候仍需要這樣做。
     </para>
    </listitem>
   </varlistentry>

   <varlistentry>
    <term>更新</term>
    <listitem>
     <para>
      安裝套件的較新<emphasis>次要</emphasis>版本。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>升級</term>
    <listitem>
     <para>
      安裝套件或套裝作業系統的較新<emphasis>主要</emphasis>版本，會引入<emphasis>新功能</emphasis>。
     </para>
    </listitem>
   </varlistentry>
  </variablelist>
 </sect1>
 <sect1 id="sec.update.nmm">
  <title>SUSE Linux Enterprise 11 維護模型</title>

  <para>
   SUSE Linux Enterprise 11 維護模型兼具 Service Pack 的靈活性和控制能力。它具有以下優點︰
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     使 Service Pack 更精簡，更易於測試和部署。
    </para>
   </listitem>
   <listitem>
    <para>
     可讓您繼續使用較舊版本，但又能支援整個系統。
    </para>
   </listitem>
   <listitem>
    <para>
     透過提供選擇性的增強功能及允許對一般更新儲存庫進行更多更新，滿足 Service Pack 發行空檔期的市場需求。透過選取增強功能，彌補 Service Pack 較長發行週期的影響。
    </para>
   </listitem>
  </itemizedlist>

  <sect2 id="sec.update.background">
   <title>背景資訊</title>
   <para>
    過去數年中，在希望基於客戶回饋進行改良的明確目標指引下，SUSE 在向使用者提供更新的方式方面實作了多項變更：
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      SLES 9 中只有一個收集所有更新的更新儲存庫；最近發佈的更新是唯一受支援的一項更新。
     </para>
    </listitem>
    <listitem>
     <para>
      從 SLES 10 SP1 開始，引入了<quote>SP 特定儲存庫</quote>的概念。這表示將透過一個特定的儲存庫傳送特定 Service Pack 的所有更新。使用者移轉至較新版的 Service Pack 後，如果他們直接在 Novell Customer Center 上註冊，將會失去存取之前儲存庫的權限。SMT 或 SUSE Manager 的使用者不管是過去還是現在都能自由地訂閱任何 SP 通道。此項變更的主要原因是採用了允許在 6 個月重疊期間 (n-1 Service Pack 支援) 內驗證已發佈 Service Pack 的概念，並為客戶提供了一個移轉時段，在此期間他們將繼續從舊 SP 中獲得完全維護和支援。
     </para>
    </listitem>
    <listitem>
     <para>
      SLES 11 GA 和 SLES 11 SP1 後跟 SLES 10 模型。在 SLES 11 SP2 中，我們引入了新的儲存庫模型，其含有以下各項：
     </para>
     <orderedlist numeration="lowerroman" spacing="normal">
      <listitem>
       <para>
        SLES 11 SP1 更新儲存庫保持訂閱狀態。同樣適用於 SP2 的所有更新也會或僅會發佈到 SP1 更新儲存庫中。這表示未違背 ABI 和 API 相容性的所有更新都繼續從這裡傳送。
       </para>
      </listitem>
      <listitem>
       <para>
        SLES 11 SP2 更新儲存庫僅包含因各種原因而無法傳送到 SP1 更新儲存庫的最新更新及任何創新更新。除此之外，我們還引入了一個核心儲存庫，它彌補了既無法發佈到 SP1 更新儲存庫亦無法發佈到 SP2 更新儲存庫之套件的<quote>缺陷</quote>。
       </para>
      </listitem>
      <listitem>
        <para>SLES 11 SP4 將會具有與 SLES 10 類似的通道模型。該模型是所收到的提供特定 Service Pack 更新最簡單且更快捷的方式。所有更新都將透過特殊的更新通道提供。機器上將會提供其他通道，但會移除舊通道。 </para>
      </listitem>
     </orderedlist>
    </listitem>
   </itemizedlist>
   <para>
    <xref linkend="fig.update.maintenance.evolution"/> 對上述的一些方面進行了描述。
   </para>
   <figure id="fig.update.maintenance.evolution">
    <title>維護遞送演變 (也適用於 SLED)</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="new-maintenance-model.svg" width="75%"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="new-maintenance-model.png" width="75%"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    我們的產品具有長達 10 年的生命週期：10 年的一般支援和 3 年的延伸支援。每 4 年發行一次主要版本，每 18 個月發行一次 Service Pack。「長期 Service Pack 支援」是指延伸的支援時段或延伸的主要版本生命週期 (請參閱<xref linkend="fig.update.maintenance.long-term-service-pack"/>)。
   </para>
   <figure id="fig.update.maintenance.long-term-service-pack">
    <title>長期 Service Pack 支援</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="long-term-service-pack-support.svg" width="75%"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="long-term-service-pack-support.png" width="75%"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    「長期 Service Pack 支援」需要有作用中的標準訂閱或優先訂閱。它不影響 L1 或 L2 訂閱條款。安全性更新是以<quote>主動方式</quote>處理︰這些更新用於解決任何非使用者驅動的嚴重弱點、核心中的本地根入侵或無需使用者互動即會直接執行的其他根入侵。
   </para>
  </sect2>

  <sect2 id="sec.update.supportlevel-lifecycle">
   <title>支援等級</title>
   <para>
    延伸支援層級從第 8 年開始，到第 10 年結束。這些支援包括延續的 L3 工程層級診斷和反應式重要錯誤修正。這些支援層級針對下列問題提供主動更新：核心中的本地根入侵或無需使用者互動即會直接執行的其他根入侵。此外，它們還支援現有的工作負載、軟體堆疊和硬體，其中只對少數套件不提供支援。<xref linkend="tab.security-and-bug-fixes"/> 中提供了綜覽。
   </para>
   <table id="tab.security-and-bug-fixes">
    <title>安全性更新和錯誤修正</title>
    <tgroup cols="6">
     <colspec colname="c1"/>
     <colspec colname="c2"/>
     <colspec colname="c3"/>
     <colspec colname="c4"/>
     <colspec colname="c5"/>
     <colspec colname="c6"/>
     <thead>
      <row>
       <entry/>
       <entry namest="c2" nameend="c5" align="center">
        <para>
         — 一般支援 —
        </para>
       </entry>
       <entry>
        <para>
         延長支援
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         主題
        </para>
       </entry>
       <entry>
        <para>
         目前的 SP
        </para>
       </entry>
       <entry>
        <para>
         SP (n-1)
<?dblinebreak ?>


         6 個月
        </para>
       </entry>
       <entry>
        <para>
         SP (n-1)
<?dblinebreak ?>


         提供 LTSS
        </para>
       </entry>
       <entry>
        <para>
         第 6、第 7 年
<?dblinebreak ?>


         提供 LTSS
        </para>
       </entry>
       <entry>
        <para>
         第 8、第 9、第 10 年
<?dblinebreak ?>


         提供 LTSS
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para>
         L1/L2 技術服務
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         主動式維護
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry/>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry/>
      </row>
      <row>
       <entry>
        <para>
         透過 PLDP 進行的驅動程式更新
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry/>
       <entry/>
      </row>
      <row>
       <entry>
        <para>
         主動式安全性更新
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry/>
      </row>
      <row>
       <entry>
        <para>
         L3 工程支援
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         支援回移
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry/>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
       <entry>
        <para>
         ✓
        </para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </table>
  </sect2>

  <sect2 id="sec.update.nmm.channels">
   <title>通道模型</title>
   <para os="sles">
    對於之前的維護模型，系統為 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 指定了兩個通道︰<literal>SLES11-SPx-Pool</literal> 和 <literal>SLES11-SPx-Updates</literal>。在線上移轉至 SPx+1 期間，這些通道會暫時由 <literal>SLES11-SPx-Online</literal> 取代。
   </para>
   
   <para>
    在 SUSE Linux Enterprise SP 2 中，通道配置已經過變更，可支援新維護模型的優勢。<xref linkend="tab.update.nmm.channels.sp2"/> 包含了從 SP1 到 SP3 之所有通道的清單。
   </para>
   <table id="tab.update.nmm.channels.sp2">
    <title>SUSE Linux Enterprise 11 SP1、SP2 和 SP3 的通道配置</title>

    <tgroup cols="3">
     <colspec colnum="1" colname="c1" colwidth="1.2*"/>
     <colspec colnum="2" colname="c2" colwidth="3*"/>
     <colspec colnum="3" colname="c3" colwidth="3*"/>
     <thead>
      <row>
       <entry>
        <para>
         類型
        </para>
       </entry>
       <entry>
        <para>
         SLES
        </para>
       </entry>
       <entry>
        <para>
         SLED
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para>
         必要通道
        </para>
       </entry>
       <entry>
        <para>
         SP1
        </para>
        <simplelist>
         <member><literal>SLES11-SP1-Pool</literal> </member> <member><literal>SLES11-SP1-Updates</literal> </member>
        </simplelist>
        <para>
         SP2
        </para>
        <simplelist>
         <member><literal>SLES11-SP1-Pool</literal> </member> <member><literal>SLES11-SP1-Updates</literal> </member> <member><literal>SLES11-SP2-Core</literal> </member> <member><literal>SLES11-SP2-Updates</literal> </member>
        </simplelist>
        <para>
         SP3
        </para>
        <simplelist>
         <member><literal>SLES11-SP3-Pool</literal> </member> <member><literal>SLES11-SP3-Updates</literal> </member>
        </simplelist>
         <para>SP4</para>
         <simplelist>
           <member><literal>SLES11-SP4-Pool</literal> </member> <member><literal>SLES11-SP4-Updates</literal></member>
         </simplelist>
       </entry>
       <entry>
        <para>
         SP1
        </para>
        <simplelist>
         <member><literal>SLED11-SP1-Pool</literal> </member> <member><literal>SLED11-SP1-Updates</literal> </member>
        </simplelist>
        <para>
         SP2
        </para>
        <simplelist>
         <member><literal>SLED11-SP1-Pool</literal> </member> <member><literal>SLED11-SP1-Updates</literal> </member> <member><literal>SLED11-SP2-Core</literal> </member> <member><literal>SLED11-SP2-Updates</literal> </member>
        </simplelist>
        <para>
         SP3
        </para>
        <simplelist>
         <member><literal>SLED11-SP3-Pool</literal> </member> <member><literal>SLED11-SP3-Updates</literal> </member>
        </simplelist>
        <para>SP4</para>
         <simplelist>
           <member><literal>SLED11-SP4-Pool</literal> </member> <member><literal>SLED11-SP4-Updates</literal></member>
         </simplelist>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         選擇性通道
        </para>
       </entry>
       <entry>
        <para>
         SP1
        </para>
        <simplelist>
         <member><literal>SLES11-SP1-Debuginfo-Pool</literal> </member> <member><literal>SLES11-SP1-Debuginfo-Updates</literal> </member>
        </simplelist>
        <para>
         SP2
        </para>
        <simplelist>
         <member><literal>SLES11-SP2-Debuginfo-Core</literal> </member> <member><literal>SLES11-SP2-Debuginfo-Updates</literal> </member> <member><literal>SLES11-Extras</literal> </member> <member><literal>SLES11-SP2-Extension-Store</literal> </member>
        </simplelist>
        <para>
         SP3
        </para>
        <simplelist>
         <member><literal>SLES11-SP3-Debuginfo-Core</literal> </member> <member><literal>SLES11-SP3-Debuginfo-Updates</literal> </member> <member><literal>SLES11-SP3-Extension-Store</literal> </member> <member><literal>SLES11-Extra</literal> </member>
        </simplelist>
         <para>SP4</para>
         <simplelist>
           <member><literal>SLES11-SP4-Debuginfo-Pool</literal> </member> <member><literal>SLES11-SP4-Debuginfo-Updates</literal></member> <member><literal>SLES11-Extra</literal></member> <member><literal>SLES11-Security-Module</literal></member>
         </simplelist>
       </entry>
       <entry>
        <para>
         SP1
        </para>
        <simplelist>
         <member><literal>SLED11-SP1-Debuginfo-Pool</literal> </member> <member><literal>SLED11-SP1-Debuginfo-Updates</literal> </member>
        </simplelist>
        <para>
         SP2
        </para>
        <simplelist>
         <member><literal>SLED11-SP2-Debuginfo-Core</literal> </member> <member><literal>SLED11-SP2-Debuginfo-Updates</literal> </member> <member><literal>SLED11-Extras</literal> </member> <member><literal>SLED11-SP2-Extension-Store</literal> </member>
        </simplelist>
        <para>
         SP3
        </para>
        <simplelist>
         <member><literal>SLED11-SP3-Debuginfo-Core</literal> </member> <member><literal>SLED11-SP3-Debuginfo-Updates</literal> </member> <member><literal>SLED11-SP3-Extension-Store</literal> </member> <member><literal>SLED11-Extra</literal> </member>
        </simplelist>
         <para>SP4</para>
         <simplelist>
           <member><literal>SLED11-SP4-Debuginfo-Pool</literal> </member> <member><literal>SLED11-SP4-Debuginfo-Updates</literal></member>
         </simplelist>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         產品特定 (範例)
        </para>
       </entry>
       <entry>
        <simplelist>
         <member><literal>SLES11-WebYaST-SP2-Pool</literal> </member> <member><literal>SLES11-WebYaST-SP2-Updates</literal> </member>
        </simplelist>
       </entry>
       <entry>
        <simplelist>
         <member><literal>SLED11-MSI-Updates</literal> </member>
        </simplelist>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </table>
   <variablelist>
    <title>必要通道的描述</title>
    <varlistentry>
     <term>核心</term>
     <listitem>
      <para>
       已解壓縮安裝媒體的子集，它僅包含視為 SPx <quote>核心</quote>的那些套件 (約佔套件總計的 30%)。SP 儲存庫僅包含特定於 SP 及其主題 (例如，硬體支援) 的套件。僅存在於 SP2 中。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>更新</term>
     <listitem>
      <para>
       相應<literal>核心</literal>或<literal>池</literal>儲存庫中之套件的維護更新。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>儲存池</term>
     <listitem>
      <para>
       包含安裝媒體中的所有二進位 RPM，以及模式資訊和支援狀態中繼資料。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <variablelist>
    <title>選擇性通道的描述</title>
    <varlistentry>
     <term>Debuginfo-Pool</term>
     <term>Debuginfo-Updates</term>
     <listitem>
      <para>
       這些通道包含靜態內容。不過，只有 <literal>Debuginfo-Updates</literal> 通道會接收更新。如果您需要安裝含有除錯資訊的資料庫供在發生問題時使用，請啟用這些通道。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Extension-Store</term>
     <listitem>
      <para> 尚未使用。應該包含 (未來) 附加產品的套件。從 SLES 11 SP4 開始，將會移除延伸儲存通道。</para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>LTSS-Updates</term>
     <listitem>
      <para>
       相應<literal>池</literal>儲存庫中套件的維護更新，適用於包含長期支援服務 (LTSS) 的安裝。此特定通道需要 LTSS 合約。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <sect3 id="sec.update.nmm.channels.origin">
    <title>套件的來源</title>
    <formalpara>
     <title>SUSE Linux Enterprise 11 SP3/SP4</title>
     <para>安裝 SP3 之後，只有兩個通道可供使用：SLES11-SP3-Pool 和 SLES11-SP3-Updates。SP2 中所有之前的通道都可顯示，但無法啟用。只有擁有特定需求的使用者才需要這些已停用的通道。 
     </para>
    </formalpara>
   </sect3>
   <sect3 id="sec.update.nmm.channels.working">
    <title>使用通道</title>
    <para>
     註冊時，系統會接收 Customer Center 中的通道。通道名稱會對應到 Customer Center 中的特定 URI (請參閱 <ulink url="http://scc.suse.com"/>)。若要列出系統上所有可用的通道，請按如下方式使用 <command>zypper</command>：
    </para>
<screen>zypper repos -u</screen>

    <para>
     這會顯示系統上所有可用通道的清單。對於每個通道，都會列出其別名、名稱以及它是否啟用並將重新整理。選項 <option>-u</option> 還會顯示其來源的 URI。
    </para>
    <para>
     如果您要移除舊通道 (例如，從 SP1 中)，請使用 <command>zypper removerepo</command> 及通道的名稱。例如，若要移除舊的 SP1 和 SP2 通道，請使用下列指令：
    </para>
<screen>zypper removerepo SLES11-SP1-Pool SLES11-SP1-Updates \
  SLE11-SP1-Debuginfo-Pool SLE11-SP1-Debuginfo-Updates \
  SLES11-SP2-Core SLES11-SP2-Updates \
  SLE11-SP2-Debuginfo-Core SLES11-SP2-Extension-Store\
  SLE11-SP2-Debuginfo-Updates</screen>
    <para>
     如果要重新新增某些通道，請登入 <ulink url="http://www.novell.com/ncc"/> 並從功能表<menuchoice><guimenu>我的產品</guimenu><guimenu>鏡射身分證明</guimenu></menuchoice>中進行選取。您可在其中看到一個 URI 清單；只能新增此產品清單中的通道。例如，若要新增 SP2 Extension Store，請使用下列指令 (寫在一行上，不使用反斜線)：
    </para>
<screen>zypper addrepo -n SLES11-SP2-Extension-Store \
 https://nu.novell.com/repo/$RCE/SLES11-SP2-Extension-Store/nu_novell_com:SLES11-SP2-Extension-Store</screen>
   </sect3>
    
    
  </sect2>
 
 </sect1>
  
 <sect1 id="sec.update.proc.prep.paths">
  <title>受支援的 SLE SP4 升級路徑</title>


  <variablelist>
   <varlistentry>
    <term>升級 SLES 8、SLES 9 和 NLD 9</term>
    <listitem>
     <para>
      沒有直接從這些版本升級的受支援路徑。建議您改為執行新安裝。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>從 SUSE Linux Enterprise 10 (任何 Service Pack) 升級</term>
    <listitem>
      
     <para>系統支援您透過一些方法從 SLES 10 GA 和 SPx 或 SLES 11 GA 和 SP1 升級到 SLES 11 SP3，其中有些方法可能需要中間升級步驟︰</para>
      <itemizedlist mark="bullet" spacing="normal">
        <listitem>
          <para>SLES 10 GA -&gt; SLES 10 SP1 -&gt; SLES 10 SP2 -&gt; SLES 10 SP3 -&gt; SLES 10 SP4 -&gt; SLES 11 SP3，或</para>
        </listitem>
        <listitem>
          <para>SLES 11 GA -&gt; SLES 11 SP1 -&gt; SLES 11 SP2 -&gt; SLES 11 SP3 -&gt; SLES 11 SP4</para>
        </listitem>
      </itemizedlist>
     <para>支援透過可開機媒體 (包括 PXE 開機) 從 SLES 10 SP4 升級。如需參考，請參閱版本說明 (<ulink url="https://www.suse.com/releasenotes/x86_64/SUSE-SLES/11-SP4/#Update.General.Sequence"/>)。
       </para>
      <para>
        SLED 使用者注意事項︰一些開發套件已從 <literal>SLED11-SP2</literal> 安裝媒體移動到 <literal>SLED11-Extras</literal> 儲存庫。為了避免在升級期間發生相依性衝突，請在實際升級前先啟用此儲存庫。執行 <command>yast2 repositories</command> 並就地啟用 <literal>SLED11-Extras</literal>。在 SLES 上，不需要額外執行此步驟。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>從 SUSE Linux Enterprise 11 GA 升級</term>
    <listitem>
     <para>
      不支援直接移轉到 SUSE Linux Enterprise 11 SP3 的移轉路徑。必須先執行從 SUSE Linux Enterprise 11 GA 到 SP1 的更新。然後繼續執行<xref linkend="sec.update.sle11sp1"/>和<xref linkend="sec.update.sle11sp2"/>。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>從 SUSE Linux Enterprise 11 SP1 升級</term>
    <listitem>
     <para>
      如需詳細資訊，請參閱<xref linkend="sec.update.sle11sp1"/>。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>從 SUSE Linux Enterprise 11 SP2 升級</term>
    <listitem>
     <para>
      如需詳細資訊，請參閱<xref linkend="sec.update.sle11sp2"/>。
     </para>
    </listitem>
   </varlistentry>
   <varlistentry>
    <term>從 SUSE Linux Enterprise 11 SP3 升級</term>
    <listitem>
     <para>
      如需詳細資訊，請參閱<xref linkend="sec.update.sle11sp3"/>。
     </para>
    </listitem>
   </varlistentry> 
  </variablelist>

  <important>
   <title>不支援跨架構升級</title>
   <para>
    
    不支援跨架構升級 (從 32 位元到 64 位元，反之亦然)。
   </para>
  </important>
  
 </sect1>
 <sect1 id="sec.update.prep">
  <title>更新的一般準備工作</title>

  <para>
   在開始更新程序之前，請先確定您的系統已準備妥當。此外，準備工作還包括備份資料和檢查版本說明。
  </para>

  <sect2 id="sec.update.prep.backup">
   <title>備份</title>
   <para>
    更新之前，請先將現有的組態檔案複製到單獨的媒體 (例如磁帶裝置、可移除式硬碟等) 中，以便備份資料。此作業主要適用於儲存在 <filename>/etc</filename> 中的檔案、一些目錄及 <filename>/var</filename> 和 <filename>/opt</filename> 中的檔案。您最好也將 <filename>/home</filename> (即 <envar>HOME</envar> 目錄) 中的使用者資料複製到備份媒體。將此資料備份為 <systemitem class="username">root</systemitem>。只有 <systemitem class="username">root</systemitem> 才有權讀取所有本地檔案。
   </para>
   <para>
    如果您在 YaST 中選取了<guimenu>更新現有系統</guimenu>做為安裝模式，則可以選擇稍後執行 (系統) 備份。您可以選擇包含所有已修改的檔案以及 <filename>/etc/sysconfig</filename> 目錄中的檔案。不過，這並不是一個完整備份，因為缺少上述的所有其他重要目錄。您可在 <filename>/var/adm/backup</filename> 目錄中找到該備份。
   </para>
  </sect2>

  <sect2 id="sec.update.prep.disks">
   <title>磁碟分割與磁碟空間</title>
   <para>
    開始更新前，請記住這個 root 分割區。<command>df /</command> 指令會列出根分割區的裝置名稱。在 <xref linkend="aus.update.df"/> 中，要記下的 root 分割區為 <filename>/dev/sda3</filename> (掛接位置是 <filename>/</filename>)。
   </para>
   <example id="aus.update.df">
    <title>使用 <command>df -h</command> 來列示</title>

<screen os="sles">Filesystem     Size  Used Avail Use% Mounted on
     /dev/sda3       74G   22G   53G  29% /
     tmpfs          506M     0  506M   0% /dev/shm
     /dev/sda5      116G  5.8G  111G   5% /home
     /dev/sda1       44G    4G   40G   9% /data</screen>
   </example>
   <para>
    軟體通常會隨著版本更新而<quote>擴增</quote>。因此在更新之前，先使用 <command>df</command> 來檢視可用的分割空間。如果您認為磁碟空間可能不夠，請在更新和重新分割系統前先確保您資料的安全。每個分割區應該佔用多大空間並沒有常規可循。空間需求將依特定的磁碟分割設定檔和選取軟體而有差異。
   </para>
  </sect2>

  <sect2 id="sec.update.prep.vms">
   <title>關閉虛擬機器</title>
   <para>
    如果您的機器用做 KVM 或 Xen 的虛擬機器主機伺服器，請確定在更新之前，先正常關閉所有執行中的虛擬機器客體。否則，您可能會在更新之後無法存取這些客體作業系統。
   </para>
  </sect2>

  <sect2 id="sec.update.prep.relnotes">
   <title>版本特定要求</title>
   <para>
    如需版本特定要求，請參閱更新產品隨附的版本說明。版本說明中提供了關於升級程序的其他資訊。
   </para>
   <para>
    包含有關 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 最新資訊的版本說明文件最新版本可在線上造訪 <ulink url="http://www.suse.com/doc/sles11/#additional"/> 進行閱讀。
   </para>
  </sect2>
 </sect1>
 <sect1 id="sec.update.sle11sp1">
  <title>將 SLE 11 SP1 升級到 SLE 11 SP2</title>

  <para>
   支援多種不同的方法從 SUSE Linux Enterprise 11 SP1 系統更新到 Service Pack 2。您可以使用線上更新工具安裝相應的修補程式 (<quote>線上移轉</quote>) 進行更新，也可以透過 Service Pack 安裝媒體來更新。另外，更新可透過代管訂閱管理工具或 SUSE Manager 的伺服器執行。
  </para>

  <para>
   下列工具支援線上移轉：
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     <guimenu>YaST wagon</guimenu> (圖形使用者介面)
    </para>
   </listitem>
   <listitem>
    <para>
     <command>zypper</command> (指令行)
    </para>
   </listitem>
  </itemizedlist>

  <para>
   或者，您也可以下載完整的 Service Pack 媒體 (DVD ISO 影像)。透過從實體 Service Pack 媒體或網路安裝來源開機來開始更新程序。
  </para>

  <sect2 id="sec.update.sle11spx.online">
   <title>線上移轉</title>
   <para>
    透過線上移轉更新系統的操作是從正在執行的系統中完成的。更新完成後，您只需要重新開機一次。
   </para>
   <sect3 id="sec.update.sle11spx.online.requirements">
    <title>要求</title>
    <para>
     若要執行線上更新，必須滿足下列要求。另請務必閱讀<xref linkend="sec.update.prep"/>。
    </para>
    <variablelist>
     <varlistentry>
      <term>產品註冊</term>
      <listitem>
       <para>
        為了能夠連接至更新通道，您必須註冊產品。如果未註冊，請在 YaST 中執行 <guimenu>Novell Customer Center 組態</guimenu>模組或使用 <command>suse_register</command> 指令行工具開始註冊。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>執行線上更新</term>
      <listitem>
       <para>
        確定目前安裝的版本已裝有最新的修補程式。請在執行線上移轉之前先執行線上更新。使用圖形介面時，請啟動 YaST 線上更新或更新程式 applet。在指令行上，請執行下列指令 (最後一個指令需要執行兩次)：
       </para>
<screen>zypper ref -s
zypper update -t patch
zypper update -t patch</screen>
       <para>
        視需要將系統重新開機。
       </para>
       <para>
        請參閱<xref linkend="cha.onlineupdate.you"/> 或<xref linkend="sec.zypper.softup"/> 以取得線上更新工具的詳細資訊。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>協力廠商軟體</term>
      <listitem>
       <para>
        如果您的安裝程式中有協力廠商軟體或附加軟體，請在其他機器上測試此程序，以確定相依項並未遭到更新程序的破壞。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
    <important>
     <title>始終執行完整線上移轉</title>
     <para>
      必須始終從頭到尾完成整個線上移轉。如果線上移轉中途發生中斷，系統將會損毀且無法復原。
     </para>
    </important>
   </sect3>
   <sect3 id="sec.update.sle11spx.online.wagon">
    <title>使用 YaST <guimenu>Wagon</guimenu> 進行線上移轉</title>
     <para>如果您擁有 SLES 11 SP1 系統，請在 <ulink url="https://www.suse.com/support/kb/doc.php?id=7011872"/> 中尋找所需的步驟。下面的程序適用於從 SP2 到 SP3 的線上移轉。</para>     
    <procedure>
     <step performance="required">
      <para>
       滿足所有要求 (請參閱<xref linkend="sec.update.sle11spx.online.requirements"/>) 後，系統匣中的更新 applet 將會顯示一則訊息，指出有套裝作業系統升級可用。按一下它以啟動 YaST <guimenu>Wagon</guimenu>。或者以 <systemitem class="username">root</systemitem> 身分從指令行執行 <command>/usr/sbin/wagon</command>。
      </para>
     </step>
     <step performance="required">
      <para>
       按<guimenu>下一步</guimenu>確認<guimenu>歡迎使用</guimenu>對話方塊。
      </para>
     </step>
     <step performance="required">
      <para>
       如果 <guimenu>Wagon</guimenu> 發現要求未得到滿足 (有必要的維護更新可用但尚未安裝)，它將會執行自動自我更新，而這可能需要重新開機。依照螢幕上的指示進行。
      </para>
     </step>
     <step performance="required">
      <para>
       在下面的對話方塊中選擇更新方式。選擇<guimenu>Customer Center</guimenu>以使用預設設定 (建議)。
      </para>
      <para>
       按一下<guimenu>自定 URL</guimenu>以手動選擇用於線上移轉的軟體通道。此時會顯示通道清單，供您選擇手動啟用、停用、新增或刪除通道。新增 SP2 更新來源，可以是 SP2 安裝媒體，也可以是 <literal>SP2-Core</literal> 和 <literal>SP2-Updates</literal> 通道。按一下<guimenu>確定</guimenu>以回到<guimenu>更新方式</guimenu>對話方塊。
      </para>
      <para>
       如果您要檢閱因更新程序而對通道設定引起的變更，請選取<guimenu>檢查儲存庫的自動變更</guimenu>。
      </para>
      <para>
       按<guimenu>下一步</guimenu>繼續。
      </para>
     </step>
     <step performance="required">
      <para>
       系統將會重新註冊。在此過程中，<literal>SP2-Core</literal> 和 <literal>SP2-Updates</literal> 通道將會新增到系統中 (如需詳細資訊，請參閱<xref linkend="sec.update.nmm.channels"/>)。確認新增通道。
      </para>
     </step>
     <step performance="required">
      <para>
       如果您在<guimenu>更新方式</guimenu>對話方塊中選取了<guimenu>檢查儲存庫的自動變更</guimenu>，將會顯示儲存庫清單，供您選擇手動啟用、停用、新增或刪除通道。完成後，按一下<guimenu>確定</guimenu>以繼續。
      </para>
     </step>
     <step performance="required">
      <para>
       選擇移轉類型：
      </para>
      <variablelist>
       <varlistentry>
        <term>完全移轉
        </term>
        <listitem>
         <para>
          將所有套件都更新至最新的 SP2 層級。
         </para>
        </listitem>
       </varlistentry>
       <varlistentry>
        <term>精簡移轉
        </term>
        <listitem>
         <para>
          將最小一組套件更新至最新的 SP2 層級。
         </para>
        </listitem>
       </varlistentry>
      </variablelist>
      <para>
       按一下<guimenu>進階</guimenu>以手動選取用於升級的儲存庫。
      </para>
      <para>
       確認您的選擇。
      </para>
     </step>
     <step performance="required">
      <para>
       <guimenu>套裝作業系統升級設定</guimenu>螢幕將會開啟，並顯示更新組態的摘要。可用區段如下：
      </para>
      <variablelist>
       <varlistentry>
        <term>附加產品
        </term>
        <listitem>
         <para>
          您可以在這裡新增 SUSE Linux Enterprise Server 附加產品或協力廠商產品。
         </para>
        </listitem>
       </varlistentry>
       <varlistentry>
        <term>更新選項
        </term>
        <listitem>
         <para>
          列出更新期間將會執行的動作。您可以選擇是先下載所有套件再進行安裝 (建議的預設設定)，還是逐個下載和安裝。
         </para>
        </listitem>
       </varlistentry>
       <varlistentry>
        <term>套件
        </term>
        <listitem>
         <para>
          更新的統計綜覽。
         </para>
        </listitem>
       </varlistentry>
       <varlistentry>
        <term>備份</term>
        <listitem>
         <para>
          設定備份選項。
         </para>
        </listitem>
       </varlistentry>
      </variablelist>
      <para>
       按<guimenu>下一步</guimenu>和<guimenu>開始更新</guimenu>以繼續。
      </para>
      <important>
       <title>中止線上移轉</title>
       <para>
        在按一下<guimenu>開始更新</guimenu><emphasis>之前</emphasis>，您都可以在此螢幕及所有之前螢幕上安全地中止線上移轉。按一下<guimenu>中止</guimenu>離開更新程序，並將系統還原到啟動 YaST Wagon 之前它所處的狀態。遵循螢幕上的指示，並在離開 Wagon 之前先執行重新註冊，以從您的系統中移除 SP2 通道。
       </para>
      </important>
     </step>
     <step performance="required">
      <para>
       在更新過程中，將會執行下列步驟：
      </para>
      <substeps performance="required">
       <step performance="required">
        <para>
         將會更新套件。
        </para>
       </step>
       <step performance="required">
        <para>
         將會執行 <command>SuSEconfig</command>。
        </para>
       </step>
       <step performance="required">
        <para>
         將會重新啟動系統 (按<guimenu>確定</guimenu>)。
        </para>
       </step>
       <step performance="required">
        <para>
         將會重新註冊剛更新的系統。
        </para>
       </step>
      </substeps>
     </step>
     <step performance="required">
      <para>
       您的系統已成功更新到 Service Pack 2。
      </para>
     </step>
    </procedure>
    
   </sect3>
   <sect3 id="sec.update.sle11spx.online.zypper">
    <title>使用 <command>zypper</command> 進行線上移轉</title>
    <procedure>
     <step performance="required">
      <para>
       滿足所有要求 (請參閱<xref linkend="sec.update.sle11spx.online.requirements"/>) 後，線上移轉所需的<quote>產品</quote>便已新增至 <filename>/etc/products.d</filename>。執行下列指令取得這些產品的清單：
      </para>

<screen>zypper se -t product | grep -h -- "-migration" | cut -d'|' -f2</screen>
      <para>
       此指令至少應傳回 <literal os="sles">SUSE_SLES-SP2-migration</literal>。根據安裝的範圍，可能會列出更多產品。
      </para>
     </step>
     <step performance="required">
      <para>
       使用指令 <command>zypper in -t product <replaceable>產品清單</replaceable></command>安裝上一步中取回的移轉產品，例如：
      </para>
<screen os="sles">zypper in -t product SUSE_SLES-SP2-migration</screen>

     </step>
     <step performance="required">
      <para>
       註冊上一步中安裝的產品，以便取得相應的更新通道：
      </para>
<screen>suse_register -d 2 -L /root/.suse_register.log</screen>
     </step>
     <step performance="required">
      <para>
       再次重新整理儲存庫和服務︰
      </para>
<screen>zypper ref -s</screen>
     </step>
     <step performance="required">
      <para>
       使用 <command>zypper lr</command> 檢查您可以取回的儲存庫清單。<emphasis>至少</emphasis>下列儲存庫需要處於<guimenu>已啟用</guimenu>狀態︰
      </para>
      <itemizedlist os="sles" mark="bullet" spacing="normal">
       <listitem>
        <para>
         <literal>SLES11-SP1-Pool</literal>
        </para>
       </listitem>
       <listitem>
        <para>
         <literal>SLES11-SP1-Updates</literal>
        </para>
       </listitem>
       <listitem>
        <para>
         <literal>SLES11-SP2-Core</literal>
        </para>
       </listitem>
       <listitem>
        <para>
         <literal>SLES11-SP2-Updates</literal>
        </para>
       </listitem>
      </itemizedlist>
      
      <para>
       根據安裝的範圍，需要啟用附加產品或延伸的其他儲存庫。
      </para>
      <para>
       如果這些儲存庫中的一個未啟用 (遵循此工作流程時，預設不會啟用 <literal>SP2</literal> 儲存庫)，請使用 <command>zypper modifyrepo --enable <replaceable>儲存庫別名</replaceable></command>進行啟用，例如：
      </para>
<screen os="sles">zypper modifyrepo --enable SLES11-SP2-Core SLES11-SP2-Updates</screen>

      <para>
       如果安裝程式包含無法與 SP2 相容的協力廠商儲存庫，請使用 <command>zypper modifyrepo --disable <replaceable>儲存庫別名</replaceable></command>停用這些儲存庫。
      </para>
     </step>
     <step performance="required">
      <para>
       現在一切準備就緒，您可以使用 <command>zypper dup --from <replaceable>儲存庫 1</replaceable> --from <replaceable>儲存庫 2</replaceable> <replaceable>...</replaceable></command> 執行套裝作業系統升級了。請務必使用 <option>--from</option> 列出所有需要的儲存庫，例如：
      </para>
<screen os="sles">zypper dup --from SLES11-SP2-Core --from SLES11-SP2-Updates</screen>

      <para>
       按<guimenu>y</guimenu>進行確認，以開始升級。
      </para>
     </step>
     <step performance="required">
      <para>
       完成上一步中的套裝作業系統升級後，便已執行精簡移轉 (最小一組套件已更新至最新 SP2 層級)。如果您不想執行完全移轉，請跳過此步驟。
      </para>
      <para>
       若要執行完全移轉 (將所有套件都更新到最新的 SP2 層級)，請執行下列指令：
      </para>
<screen>zypper update -t patch</screen>
     </step>
     <step performance="required">
      <para>
       SP2 的升級現已完成，您需要重新註冊產品：
      </para>
<screen>suse_register -d 2 -L /root/.suse_register.log</screen>
     </step>
     <step performance="required">
      <para>
       最後，將系統重新開機。
      </para>
     </step>
     <step performance="required">
      <para>
       您的系統已成功更新到 Service Pack 2。
      </para>
     </step>
    </procedure>
   </sect3>
  </sect2>

  <sect2 id="sec.update.sle11spx.medium">
   <title>透過從安裝來源開機進行更新</title>
   <para>
    做為線上移轉 (如需詳細資料，請參閱<xref linkend="sec.update.sle11spx.online"/>) 的替代方法，您還可以從安裝來源 (DVD 或網路安裝來源) 開機來更新系統。更新將與一般安裝一樣開始。
   </para>
   <para>
    Service Pack 2 ISO 影像可從 <ulink url="http://download.novell.com/"/> 取得。將它燒錄到 DVD，或如<xref linkend="sec.deployment.remoteinst.instserver"/> 中所示準備網路安裝來源。
   </para>
   <sect3 id="sec.upgrade.install-from-dvd">
    <title>從本地 DVD 磁碟機更新</title>
    <para>
     在開始執行 SUSE Linux Enterprise SP 的全新安裝前，請確保所有 Service Pack 安裝媒體 (DVD) 都已備妥。
    </para>
    <procedure id="upgrade.sp.instsp.fromsp">
     <title>從 Service Pack 媒體開機</title>
     <step performance="required">
      <para>
       插入第一個 SUSE Linux Enterprise SP 媒體並將機器開機。這時會出現類似 SUSE Linux Enterprise 11 原始安裝的開機畫面。
      </para>
     </step>
     <step performance="required">
      <para>
       請選取<guimenu>安裝</guimenu>並參照<xref linkend="cha.inst"/>中的 YaST 安裝指示繼續進行。
      </para>
     </step>
    </procedure>
   </sect3>
   <sect3 id="sec.upgrade.install-from-network">
    <title>從網路安裝來源更新</title>
    <para>
     在從網路安裝來源開始更新 SUSE Linux Enterprise SP 之前，請先確定滿足下列要求：
    </para>
    <itemizedlist mark="bullet" spacing="normal">
     <listitem>
      <para>
       已依據<xref linkend="sec.deployment.remoteinst.instserver"/> 所述設定好網路安裝來源。
      </para>
     </listitem>
     <listitem>
      <para>
       安裝伺服器與目標機器上都存在包含名稱服務、DHCP (選擇性，但是 PXE 開機時需要用到) 和 OpenSLP (選擇性) 的有效網路連接。
      </para>
     </listitem>
     <listitem>
      <para>
       存在用於將目標系統<emphasis>或</emphasis>依照<xref linkend="sec.deployment.remoteinst.boot.pxeprep" xrefstyle="HeadingOnPage"/>所述步驟設定 PXE 開機時所要使用的目標系統開機的 SUSE Linux Enterprise SP DVD 1。
      </para>
     </listitem>
    </itemizedlist>
    <para>
     請參閱<xref linkend="cha.deployment.remoteinst"/>，深入瞭解從遠端伺服器開始升級的相關資訊。
    </para>
    <sect4 id="sec.upgrade.install-from-network.dvdboot">
     <title>網路安裝 — 從 DVD 開機</title>
     <para>
      若要使用 SP DVD 做為開機媒體來執行網路安裝，請執行下列步驟：
     </para>
     <procedure>
      <step performance="required">
       <para>
        插入 SUSE Linux Enterprise SP DVD 1 並將機器開機。這時會出現類似 SUSE Linux Enterprise 11 原始安裝的開機畫面。
       </para>
      </step>
      <step performance="required">
       <para>
        選取<guimenu>安裝</guimenu>以將 SP 核心開機，然後使用 <keycap>F4</keycap> 選取網際網路安裝來源類型 (FTP、HTTP、NFS 或 SMB)。
       </para>
      </step>
      <step performance="required">
       <para>
        提供適當的路徑資訊，或是選取<guimenu>SLP</guimenu>作為安裝來源。
       </para>
      </step>
      <step performance="required">
       <para>
        從所提供伺服器中選擇適當的安裝伺服器，或是依照<xref linkend="sec.i.yast2.source.network"/> 所述步驟，使用開機選項提示字串提供安裝來源類型和確實位置。這樣便會啟動 YaST。
       </para>
       <para>
        請依照<xref linkend="sec.update.sle11spx.medium.update"/> 所述完成安裝。
       </para>
      </step>
     </procedure>
    </sect4>
    <sect4 id="sec.upgrade.install-from-network.pxeboot">
     <title>網路安裝 -- PXE 開機</title>
     <para>
      若要透過網路執行 SUSE Linux Enterprise Service Pack 的網路安裝，請依照下列步驟執行：
     </para>
     <procedure>
      <step performance="required">
       <para>
        依據<xref linkend="sec.deployment.remoteinst.boot.pxeprep"/> 所述，調整 DHCP 伺服器的設定，提供 PXE 開機時所需要的位址資訊。
       </para>
      </step>
      <step performance="required">
       <para>
        設定 TFTP 伺服器存放 PXE 開機時所需要的開機影像。
       </para>
       <para>
        請使用 SUSE Linux Enterprise Service Pack 的第一張 CD 或 DVD，或者依照<xref linkend="sec.deployment.remoteinst.boot.tftp"/>的指示來設定影像。
       </para>
      </step>
      <step performance="required">
       <para>
        在目標機器上準備 PXE 開機和網路喚醒功能。
       </para>
      </step>
      <step performance="required">
       <para>
        啟始目標系統開機，並使用 VNC 遠端連接到這部機器所執行的安裝常式。如需相關資訊，請參閱<xref linkend="sec.deployment.remoteinst.monitor.vnc"/>。
       </para>
      </step>
      <step performance="required">
       <para>
        請依照<xref linkend="sec.update.sle11spx.medium.update"/> 所述完成安裝。
       </para>
      </step>
     </procedure>
    </sect4>
   </sect3>
   <sect3 id="sec.update.sle11spx.medium.update">
    <title>更新程序</title>
    <para>
     從安裝媒體或網路成功開機後，請執行下列步驟開始更新：
    </para>
    <procedure>
     <step performance="required">
      <para>
       在<guimenu>歡迎使用</guimenu>螢幕上，選擇<guimenu>語言</guimenu>和<guimenu>鍵盤</guimenu>並接受授權合約。按<guimenu>下一步</guimenu>繼續。
      </para>
     </step>
     <step performance="required">
      <para>
       如果您已從實體媒體開機，請執行<guimenu>媒體檢查</guimenu>以驗證媒體的完整性。僅當您先前已檢查過媒體，方可跳過此步驟。
      </para>
     </step>
     <step performance="required">
      <para>
       在<guimenu>安裝模式</guimenu>螢幕上，選擇<guimenu>更新</guimenu>。按<guimenu>下一步</guimenu>將會開始更新程序。
      </para>
     </step>
    </procedure>
   </sect3>
  </sect2>

  <sect2 id="sec.update.sle11spx.smt">
   <title>透過訂閱管理工具 (SMT) 進行更新</title>
   <para>
    如果不想從 Novell 更新伺服器下載每個單一用戶端系統的更新，則另一個替代的方式是使用適用於 SUSE Linux Enterprise 的訂閱管理工具 (SMT)，將更新鏡射到本地伺服器。
   </para>
   <para>
    此工具可用做用戶端註冊的 Novell Customer Center 代理，也可用做軟體更新儲存庫。<ulink url="http://www.suse.com/doc/smt11/"/> 中的 SMT 文件提供了其功能的綜覽以及如何實作的相關指示。
   </para>
  </sect2>

  <sect2 id="sec.update.sle11spx.manager">
   <title>透過 SUSE Manager 進行更新</title>
   <para>
    SUSE Manager 是一個伺服器解決方案，用於提供適用於 SUSE Linux Enterprise 用戶端的更新、修補程式和安全性修正程式。它隨附一組工具和一個 Web 式使用者介面，用於執行管理任務。
   </para>
   <para>
    <ulink url="http://www.suse.com/doc/suse_manager/"/> 中的 SUSE Manager 文件提供了其功能的綜覽以及如何設定伺服器與用戶端的相關指示。
   </para>
  </sect2>
 </sect1>
 <sect1 id="sec.update.sle11sp2">
  <title>將 SLE 11 SP2 升級到 SLE 11 SP3</title>

  

  <para>
   下列工具支援線上移轉：
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     <guimenu>YaST wagon</guimenu> (圖形使用者介面)
    </para>
   </listitem>
   <listitem>
    <para>
     <command>zypper</command> (指令行)
    </para>
   </listitem>
  </itemizedlist>

  <para>
   如果要透過線上移轉更新系統，該更新會在系統執行期間進行。更新完成後，您只需要重新開機一次。您仍可以使用下列替代方法進行更新：
  </para>

  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     <xref linkend="sec.update.sle11spx.medium"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="sec.update.sle11spx.smt"/>
    </para>
   </listitem>
   <listitem>
    <para>
     <xref linkend="sec.update.sle11spx.manager"/>
    </para>
   </listitem>
  </itemizedlist>

  <sect2 id="sec.update.sle11sp2.online.requirements">
   <title>要求</title>
   <para>
    若要執行線上更新，必須滿足下列要求。另請務必閱讀<xref linkend="sec.update.prep"/>。
   </para>
   <variablelist>
    <varlistentry>
     <term>產品註冊</term>
     <listitem>
      <para>
       為了能夠連接至更新通道，您必須註冊產品。如果未註冊，請在 YaST 中執行 <guimenu>Novell Customer Center 組態</guimenu>模組或使用 <command>suse_register</command> 指令行工具開始註冊。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>執行線上更新</term>
     <listitem>
      <para>
       確定目前安裝的版本已裝有最新的修補程式。請在執行線上移轉之前先執行線上更新。使用圖形介面時，請啟動 YaST 線上更新或更新程式 applet。在指令行上，請執行下列指令 (最後一個指令需要執行兩次)：
      </para>
<screen>zypper ref -s
zypper update -t patch
zypper update -t patch</screen>
      <para>
       視需要將系統重新開機。
      </para>
      <para>
       如需線上更新工具的詳細資訊，請參閱<xref linkend="cha.onlineupdate.you"/> 或<xref linkend="sec.zypper.softup"/>。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>協力廠商軟體</term>
     <listitem>
      <para>
       如果您的安裝程式中有協力廠商軟體或附加軟體，請在其他機器上測試此程序，以確定相依項並未遭到更新程序的破壞。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <important>
    <title>始終執行完整線上移轉</title>
    <para>
     必須始終從頭到尾完成整個線上移轉。如果線上移轉中途發生中斷，系統將會損毀且無法復原。
    </para>
   </important>
  </sect2>

  <sect2 id="sec.update.sle11sp2.online.wagon">
   <title>使用 YaST <guimenu>Wagon</guimenu> 進行線上移轉</title>
   <procedure>
    <step performance="required">
     <para>
      滿足所有要求 (請參閱<xref linkend="sec.update.sle11spx.online.requirements"/>) 後，系統匣中的更新 applet 將會顯示一則訊息，指出有套裝作業系統升級可用。按一下它以啟動 YaST <guimenu>Wagon</guimenu>。或者以 <systemitem class="username">root</systemitem> 身分從指令行執行 <command>/usr/sbin/wagon</command>。
     </para>
    </step>
    <step performance="required">
     <para>
      按<guimenu>下一步</guimenu>確認<guimenu>歡迎使用</guimenu>對話方塊。
     </para>
    </step>
    <step performance="required">
     <para>
      如果 <guimenu>Wagon</guimenu> 發現要求未得到滿足 (有必要的維護更新可用但尚未安裝)，它將會執行自動自我更新，而這可能需要重新開機。依照螢幕上的指示進行。
     </para>
    </step>
    <step performance="required">
     <para>
      在下面的對話方塊中選擇更新方式。選擇<guimenu>Customer Center</guimenu>以使用預設設定 (建議)。
     </para>
     <para>
      按一下<guimenu>自定 URL</guimenu>以手動選擇用於線上移轉的軟體通道。此時會顯示通道清單，供您選擇手動啟用、停用、新增或刪除通道。新增 SP3 更新來源，可以是 SP3 安裝媒體或 <literal>SP3-Pool</literal> 和 <literal>SP3-Updates</literal> 通道。按一下<guimenu>確定</guimenu>以回到<guimenu>更新方式</guimenu>對話方塊。
     </para>
     <para>
      如果您要檢閱因更新程序而對通道設定引起的變更，請選取<guimenu>檢查儲存庫的自動變更</guimenu>。
     </para>
     <para>
      按<guimenu>下一步</guimenu>繼續。
     </para>
    </step>
    <step performance="required">
     <para>
      系統將會重新註冊。在此過程中，<literal>SP3-Pool</literal> 和 <literal>SP3-Updates</literal> 通道將會新增到系統中 (如需詳細資訊，請參閱<xref linkend="sec.update.nmm.channels"/>)。確認新增通道。
     </para>
    </step>
    <step performance="required">
     <para>
      如果您在<guimenu>更新方式</guimenu>對話方塊中選取了<guimenu>檢查儲存庫的自動變更</guimenu>，將會顯示儲存庫清單，供您選擇手動啟用、停用、新增或刪除通道。完成後，按一下<guimenu>確定</guimenu>以繼續。
     </para>
    </step>
    <step performance="required">
     <para>
      <guimenu>套裝作業系統升級設定</guimenu>螢幕將會開啟，並顯示更新組態的摘要。可用區段如下：
     </para>
     <variablelist>
      <varlistentry>
       <term>附加產品
       </term>
       <listitem>
        <para>
         您可以在這裡新增 SUSE Linux Enterprise Server 附加產品或協力廠商產品。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>更新選項
       </term>
       <listitem>
        <para>
         列出更新期間將會執行的動作。您可以選擇是先下載所有套件再進行安裝 (建議的預設設定)，還是逐個下載和安裝。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>套件
       </term>
       <listitem>
        <para>
         更新的統計綜覽。
        </para>
       </listitem>
      </varlistentry>
      <varlistentry>
       <term>備份</term>
       <listitem>
        <para>
         設定備份選項。
        </para>
       </listitem>
      </varlistentry>
     </variablelist>
     <para>
      按<guimenu>下一步</guimenu>和<guimenu>開始更新</guimenu>以繼續。
     </para>
     <important>
      <title>中止線上移轉</title>
      <para>
       在按一下<guimenu>開始更新</guimenu><emphasis>之前</emphasis>，您都可以在此螢幕及所有之前螢幕上安全地中止線上移轉。按一下<guimenu>中止</guimenu>離開更新程序，並將系統還原到啟動 YaST Wagon 之前它所處的狀態。遵循螢幕上的指示，並在離開 Wagon 之前先執行重新註冊，以從您的系統中移除 SP2 通道。
      </para>
     </important>
    </step>
    <step performance="required">
     <para>
      在更新過程中，將會執行下列步驟：
     </para>
     <substeps performance="required">
      <step performance="required">
       <para>
        將會更新套件。
       </para>
      </step>
      <step performance="required">
       <para>
        將會執行 <command>SuSEconfig</command>。
       </para>
      </step>
      <step performance="required">
       <para>
        將會重新啟動系統 (按<guimenu>確定</guimenu>)。
       </para>
      </step>
      <step performance="required">
       <para>
        將會重新註冊剛更新的系統。
       </para>
      </step>
     </substeps>
    </step>
    <step performance="required">
     <para>
      您的系統已成功更新到 Service Pack 3。
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 id="sec.update.sle11sp2.online.zypper">
   <title>使用 <command>zypper</command> 進行線上移轉</title>
   <procedure>
    <step performance="required">
     <para>
      滿足所有要求 (請參閱<xref linkend="sec.update.sle11spx.online.requirements"/>) 後，線上移轉所需的<quote>產品</quote>便會新增至 <filename>/etc/products.d</filename>。執行下列指令取得這些產品的清單：
     </para>

<screen>zypper se -t product | grep -h -- "-migration" | cut -d'|' -f2</screen>
     <para>
      此指令至少應傳回 <literal os="sles">SUSE_SLES-SP3-migration</literal>。根據安裝的範圍，可能會列出更多產品。
     </para>
    </step>
    <step performance="required">
     <para>
      使用指令 <command>zypper in -t product <replaceable>產品清單</replaceable></command>安裝上一步中取回的移轉產品，例如：
     </para>
<screen os="sles">zypper in -t product SUSE_SLES-SP3-migration</screen>

    </step>
    <step performance="required">
     <para>
      註冊上一步中安裝的產品，以便取得相應的更新通道：
     </para>
<screen>suse_register -d 2 -L /root/.suse_register.log</screen>
    </step>
    <step performance="required">
     <para>
      重新整理儲存庫和服務：
     </para>
<screen>zypper ref -s</screen>
    </step>
    <step performance="required">
     <para>
      使用 <command>zypper lr</command> 檢查您可以取回的儲存庫清單。
     </para>
     <para>
      如果這些儲存庫中的任一個未啟用 (遵循此工作流程時，預設不會啟用 <literal>SP3</literal> 儲存庫)，請使用 <command>zypper modifyrepo --enable <replaceable>儲存庫別名</replaceable></command>進行啟用，例如：
     </para>
<screen os="sles">zypper modifyrepo --enable SLES11-SP3-Core SLES11-SP3-Updates</screen>

     <para>
      如果安裝程式包含無法與 SP3 相容的協力廠商儲存庫，請使用 <command>zypper modifyrepo --disable <replaceable>儲存庫別名</replaceable></command>停用這些儲存庫。
     </para>
    </step>
    <step performance="required">
     <para>
      現在一切準備就緒，您可以使用 <command>zypper dup --from <replaceable>儲存庫 1</replaceable> --from <replaceable>儲存庫 2</replaceable> <replaceable>...</replaceable></command> 執行套裝作業系統升級了。請務必使用 <option>--from</option> 列出所有需要的儲存庫，例如：
     </para>
<screen os="sles">zypper dup --from SLES11-SP3-Pool --from SLES11-SP3-Updates</screen>

     <para>
      按<guimenu>y</guimenu>進行確認，以開始升級。
     </para>
    </step>
    <step performance="required">
     <para>
      完成上一步中的套裝作業系統升級後，請執行下列指令：
     </para>
<screen>zypper update -t patch</screen>
    </step>
    <step performance="required">
     <para>
      SP3 的升級現已完成，您需要重新註冊產品：
     </para>
<screen>suse_register -d 2 -L /root/.suse_register.log</screen>
    </step>
    <step performance="required">
     <para>
      最後，將系統重新開機。
     </para>
    </step>
    <step performance="required">
     <para>
      您的系統已成功更新到 Service Pack 3。
     </para>
    </step>
   </procedure>
  </sect2>
 </sect1>
  
 <sect1 id="sec.update.sle11sp3">
   <title>將 SLE 11 SP3 升級到 SLE 11 SP4</title>
   <para>可以透過多種不同的方法從 SUSE Linux Enterprise Server 11 SP3 系統更新到 Service Pack 4。您可以使用線上更新工具安裝相應的修補程式 (線上移轉) 進行更新，也可以透過 Service Pack 安裝媒體來更新。另外，更新可透過代管訂閱管理工具 (SMT) 或 SUSE Manager 的伺服器執行。</para>
   <para>下列工具支援線上移轉：
     </para>
       <itemizedlist mark="bullet" spacing="normal">
         <listitem>
           <para>YaST wagon (圖形使用者介面) </para>
         </listitem>
         <listitem>
           <para><command>zypper</command> (指令行)</para>
         </listitem>
       </itemizedlist>
     <para>或者，您也可以下載完整的 Service Pack 媒體 (DVD ISO 影像)。透過從實體 Service Pack 媒體或網路安裝來源開機來開始更新程序。 </para>
   
   <sect2 id="sec.update.sle11sp3.onlinemigration">
     <title>線上移轉</title>
     <para>透過線上移轉更新系統的操作是從正在執行的系統中完成的。更新完成後，您只需要重新開機一次。</para>
     <sect3>
       <title>要求</title>
       <para>若要執行線上更新，必須滿足下列要求。另請務必閱讀<xref linkend="sec.update.prep"/>。
       </para>
       
       <variablelist>
         <varlistentry>
           <term>產品註冊</term>
           <listitem>
             <para>為了能夠連接至更新通道，您必須註冊產品。如果未註冊，請在 YaST 中執行 Novell Customer Center 組態模組或使用 <command>suse_register</command> 指令行工具開始註冊。 </para>
           </listitem>
         </varlistentry>
         <varlistentry>
           <term>執行線上更新</term>
           <listitem>
             <para>確定目前安裝的版本已裝有最新的修補程式。請在執行線上移轉之前先執行線上更新。使用圖形介面時，請啟動 YaST 線上更新或更新程式 applet。在指令行上，請執行下列指令 (最後一個指令需要執行兩次)： </para>
             <screen>zypper ref -s
zypper update -t patch
zypper update -t patch</screen>
             <para>視需要將系統重新開機。</para>
             <para>請參閱第 1.0 節「YaST 線上更新」(↑管理指南) 或第 6.1.3 節「使用 Zypper 更新軟體」(↑管理指南)。以取得線上更新工具的詳細資訊。</para>
           </listitem>
         </varlistentry>
         <varlistentry>
           <term>協力廠商軟體</term>
           <listitem>
             <para>如果您的安裝程式中有協力廠商軟體或附加軟體，請在其他機器上測試此程序，以確定相依項並未遭到更新程序的破壞。 </para>
           </listitem>
         </varlistentry>
       </variablelist>
       
       <important>
         <title>始終執行完整線上移轉</title>
         <para>必須始終從頭到尾完成整個線上移轉。如果線上移轉中途發生中斷，系統將會損毀且無法復原。</para>
       </important>
     </sect3>
   
   <sect3 id="sec.update.sle11sp3.online.wagon">
     <title>使用 YaST <guimenu>Wagon</guimenu> 進行線上移轉</title>
     <para>如果您擁有 SLES 11 SP1 系統，請在 <ulink url="https://www.suse.com/support/kb/doc.php?id=7011872"/> 中尋找所需的步驟。下面的程序適用於從 SP3 到 SP4 的線上移轉。</para>
     <procedure>
       <step performance="required">
         <para>
           滿足所有要求 (請參閱<xref linkend="sec.update.sle11spx.online.requirements"/>) 後，系統匣中的更新 applet 將會顯示一則訊息，指出有套裝作業系統升級可用。按一下它以啟動 YaST <guimenu>Wagon</guimenu>。或者以 <systemitem class="username">root</systemitem> 身分從指令行執行 <command>/usr/sbin/wagon</command>。
         </para>
       </step>
       <step performance="required">
         <para>
           按<guimenu>下一步</guimenu>確認<guimenu>歡迎使用</guimenu>對話方塊。
         </para>
       </step>
       <step performance="required">
         <para>
           如果 <guimenu>Wagon</guimenu> 發現要求未得到滿足 (有必要的維護更新可用但尚未安裝)，它將會執行自動自我更新，而這可能需要重新開機。依照螢幕上的指示進行。
         </para>
       </step>
       <step performance="required">
         <para>
           在下面的對話方塊中選擇更新方式。選擇<guimenu>Customer Center</guimenu>以使用預設設定 (建議)。
         </para>
         <para>
           按一下<guimenu>自定 URL</guimenu>以手動選擇用於線上移轉的軟體通道。此時會顯示通道清單，供您選擇手動啟用、停用、新增或刪除通道。新增 SP4 更新來源，可以是 SP4 安裝媒體或 <literal>SP4-Pool</literal> 和 <literal>SP4-Updates</literal> 通道。按一下<guimenu>確定</guimenu>以回到<guimenu>更新方式</guimenu>對話方塊。
         </para>
         <para>
           如果您要檢閱因更新程序而對通道設定引起的變更，請選取<guimenu>檢查儲存庫的自動變更</guimenu>。
         </para>
         <para>
           按<guimenu>下一步</guimenu>繼續。
         </para>
       </step>
       <step performance="required">
         <para>
           系統將會重新註冊。在此過程中，<literal>SP4-Pool</literal> 和 <literal>SP4-Updates</literal> 通道將會新增到系統中 (如需詳細資訊，請參閱<xref linkend="sec.update.nmm.channels"/>)。確認新增通道。
         </para>
       </step>
       <step performance="required">
         <para>
           如果您在<guimenu>更新方式</guimenu>對話方塊中選取了<guimenu>檢查儲存庫的自動變更</guimenu>，將會顯示儲存庫清單，供您選擇手動啟用、停用、新增或刪除通道。完成後，按一下<guimenu>確定</guimenu>以繼續。
         </para>
       </step>
       <step performance="required">
         <para>選擇移轉類型：</para>
         <variablelist>
           <varlistentry>
             <term>完全移轉</term>
             <listitem>
               <para>將所有套件都更新至最新的 SP4 層級。</para>
             </listitem>
           </varlistentry>
           <varlistentry>
             <term>精簡移轉</term>
             <listitem>
               <para>將最小一組套件更新至最新的 SP4 層級。</para>
             </listitem>
           </varlistentry>
         </variablelist>
         <para>按一下<guimenu>進階</guimenu>以手動選取用於升級的儲存庫。確認您的選擇。
         </para>
       </step>
       
       <step performance="required">
         <para>
           <guimenu>套裝作業系統升級設定</guimenu>螢幕將會開啟，並顯示更新組態的摘要。可用區段如下：
         </para>
         <variablelist>
           <varlistentry>
             <term>附加產品
             </term>
             <listitem>
               <para>
                 您可以在這裡新增 SUSE Linux Enterprise Server 附加產品或協力廠商產品。
               </para>
             </listitem>
           </varlistentry>
           <varlistentry>
             <term>更新選項
             </term>
             <listitem>
               <para>
                 列出更新期間將會執行的動作。您可以選擇是先下載所有套件再進行安裝 (建議的預設設定)，還是逐個下載和安裝。
               </para>
             </listitem>
           </varlistentry>
           <varlistentry>
             <term>套件
             </term>
             <listitem>
               <para>
                 更新的統計綜覽。
               </para>
             </listitem>
           </varlistentry>
           <varlistentry>
             <term>備份</term>
             <listitem>
               <para>
                 設定備份選項。
               </para>
             </listitem>
           </varlistentry>
         </variablelist>
         <para>
           按<guimenu>下一步</guimenu>和<guimenu>開始更新</guimenu>以繼續。
         </para>
         <important>
           <title>中止線上移轉</title>
           <para>
             在按一下<guimenu>開始更新</guimenu><emphasis>之前</emphasis>，您都可以在此螢幕及所有之前螢幕上安全地中止線上移轉。按一下<guimenu>中止</guimenu>離開更新程序，並將系統還原到啟動 YaST Wagon 之前它所處的狀態。遵循螢幕上的指示，並在離開 Wagon 之前先執行重新註冊，以從您的系統中移除 SP4 通道。
           </para>
         </important>
       </step>
       <step performance="required">
         <para>
           在更新過程中，將會執行下列步驟：
         </para>
         <orderedlist spacing="normal">
           <listitem>
             <para>
               將會更新套件。
             </para>
           </listitem>
           <listitem>
             <para>
               將會執行 <command>SuSEconfig</command>。
             </para>
           </listitem>
           <listitem>
             <para>
               將會重新啟動系統 (按<guimenu>確定</guimenu>)。
             </para>
           </listitem>
           <listitem>
             <para>
               將會重新註冊剛更新的系統。
             </para>
           </listitem>
         </orderedlist>
       </step>
       <step performance="required">
         <para>
           您的系統已成功更新到 Service Pack 4。
         </para>
       </step>
     </procedure>
   </sect3>
   
   <sect3 id="sec.update.sle11sp3.online.zypper">
     <title>使用 <command>zypper</command> 進行線上移轉</title>
     <procedure>
       <step performance="required">
         <para>
           滿足所有要求 (請參閱<xref linkend="sec.update.sle11spx.online.requirements"/>) 後，線上移轉所需的<quote>產品</quote>便會新增至 <filename>/etc/products.d</filename>。執行下列指令取得這些產品的清單：
         </para>
         
         <screen>zypper se -t product | grep -h -- "-migration" | cut -d'|' -f2</screen>
         <para>
           此指令至少應傳回 <literal os="sles">SUSE_SLES-SP4-migration</literal>。根據安裝的範圍，可能會列出更多產品。
         </para>
       </step>
       <step performance="required">
         <para>
           使用指令 <command>zypper in -t product <replaceable>產品清單</replaceable></command>安裝上一步中取回的移轉產品，例如：
         </para>
         <screen os="sles">zypper in -t product SUSE_SLES-SP4-migration</screen>
         
       </step>
       <step performance="required">
         <para>
           註冊上一步中安裝的產品，以便取得相應的更新通道：
         </para>
         <screen>suse_register -d 2 -L /root/.suse_register.log</screen>
       </step>
       <step performance="required">
         <para>
           重新整理儲存庫和服務：
         </para>
         <screen>zypper ref -s</screen>
       </step>
       <step performance="required">
         <para>
           使用 <command>zypper lr</command> 檢查您可以取回的儲存庫清單。至少下列儲存庫需要處於已啟用狀態︰ 
         </para>
         
         <itemizedlist mark="bullet" spacing="normal">
           <listitem>
             <para>SLES11-SP4-Pool</para>
           </listitem>
           <listitem>
             <para>SLES11-SP4-Updates</para>
           </listitem>
         </itemizedlist>
         
         <para>根據安裝的範圍，需要啟用附加產品或延伸的其他儲存庫。 </para>
         
         <para>
           如果這些儲存庫中的任一個未啟用 (遵循此工作流程時，預設不會啟用 <literal>SP4</literal> 儲存庫)，請使用 <command>zypper modifyrepo --enable <replaceable>儲存庫別名</replaceable></command>進行啟用，例如：
         </para>
         <screen os="sles">zypper modifyrepo --enable SLES11-SP4-Pool --enable SLES11-SP4-Updates</screen>
         
         <para>
           如果安裝程式包含無法與 SP4 相容的協力廠商儲存庫，請使用 <command>zypper modifyrepo --disable <replaceable>儲存庫別名</replaceable></command>停用這些儲存庫。
         </para>
       </step>
       <step performance="required">
         <para>
           現在一切準備就緒，您可以使用 <command>zypper dup --from <replaceable>儲存庫 1</replaceable> --from <replaceable>儲存庫 2</replaceable> <replaceable>...</replaceable></command> 執行套裝作業系統升級了。請務必使用 <option>--from</option> 列出所有需要的儲存庫，例如：
         </para>
         <screen os="sles">zypper dup --from SLES11-SP4-Pool --from SLES11-SP4-Updates</screen>
         
         <para>
           按<guimenu>y</guimenu>進行確認，以開始升級。
         </para>
       </step>
       <step performance="required">
         <para>
           完成上一步中的套裝作業系統升級後，便已執行精簡移轉 (已將最低限度的一組套件更新至最新的 SP4 層級)。如果您不想執行完整移轉，請跳過此步驟。
         </para>
         <para>若要執行完全移轉 (將所有套件都更新到最新的 SP4 層級)，請執行下列指令： </para>
         <screen>zypper update -t patch</screen>
       </step>
       <step performance="required">
         <para>
           SP4 的升級現已完成，您需要重新註冊產品：
         </para>
         <screen>suse_register -d 2 -L /root/.suse_register.log</screen>
       </step>
       <step performance="required">
         <para>
           最後，將系統重新開機。
         </para>
       </step>
     </procedure>
     <para>
       您的系統已成功更新到 Service Pack 4。
     </para>
   </sect3>
    
    <sect3>
      <title>透過從安裝來源開機進行更新</title>
      <para>做為線上移轉的替代方法，您還可以從安裝來源 (DVD 或網路安裝來源) 開機來更新系統。更新將與一般安裝一樣開始。 </para>
      <para>Service Pack 4 ISO 影像可從 <ulink url="http://download.suse.com/"/> 取得。將它燒錄到 DVD，或如<xref linkend="sec.deployment.remoteinst.instserver"/> 中所示準備網路安裝來源。
      </para>
    </sect3>
   </sect2>
   
 </sect1>
 
 <sect1 id="sec.update.backports">
  <title>將源代碼回移</title>

  <para>
   SUSE 廣泛地使用了回移。本節中的資訊將幫助您瞭解為何透過比較版本號碼來判斷軟體功能和問題的做法不可靠。

  </para>

  <sect2 id="sec.update.backports.why">
   <title>為何要回移？</title>
   <para>
    上游開發人員主要關注所開發軟體的進度。在大多情況下，他們會在修正錯誤的同時，引入未經廣泛測試且可能引發新錯誤的新功能。
   </para>
   <para>
    對於套裝作業系統開發人員，務必要區分清楚：
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      對功能可能造成有限中斷的錯誤修正；以及
     </para>
    </listitem>
    <listitem>
     <para>
      可能會中斷現有功能的變更。
     </para>
    </listitem>
   </itemizedlist>
   <para>
    在大部分情況下，當某套件成為已發行套裝作業系統的一部分時，套裝作業系統開發人員便不會遵循所有上游變更。通常，他們會繼續使用最初發行的上游版本，並根據上游變更建立修補程式來修正錯誤。此做法稱為<emphasis>回移</emphasis>。
   </para>
   <para>
    只有在下列兩種情況下，套裝作業系統開發人員一般才會引入較新版本的軟體：
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      套件與上游版本之間的變更過多，以致於回移操作不再可行，或者
     </para>
    </listitem>
    <listitem>
     <para>
      軟體本身已嚴重老化，例如防惡意程式軟體。
     </para>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 id="sec.update.backports.reasons-for">
   <title>回移的原因</title>
   <para>
    為了能在考量各種企業軟體的顧慮之間取得良好平衡，SUSE 廣泛使用了回移。其中，最重要的顧慮因素有：
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      提供穩定的介面 (API)，軟體廠商在建立 SUSE 的企業產品上使用的產品時可以依賴於這些介面。
     </para>
    </listitem>
    <listitem>
     <para>
      確保 SUSE 企業產品版本中使用的套件 (不論是套件本身還是做為整個企業產品的一部分) 都擁有最高品質且已經過全面測試。
     </para>
    </listitem>
    <listitem>
     <para>
      維護其他廠商提供之 SUSE 企業產品的各種證書，例如 Oracle 或 SAP 產品的證書。
     </para>
    </listitem>
    <listitem>
     <para>
      允許 SUSE 的開發人員竭盡所能提高下一版本產品的品質，而不是狹隘地把精力分散於推出各種版本。
     </para>
    </listitem>
    <listitem>
     <para>
      讓特定企業版本所含內容清楚可見，使得我們的支援人員可以提供有關該版本的準確及時的資訊。
     </para>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2 id="sec.update.backports.reasons-against">
   <title>反對回移的原因</title>
   <para>
    企業產品中不引入套件的任何新上游版本是一項基本政策規則。但這並不是絕對的規則。對於有限的一類套件，尤其是防毒軟體，我們顧慮更多的是安全因素，而不是品質保證方面優先顧慮的保守方法。對於該類別的套件，偶爾會將較新的版本引入到企業產品線的已發行版本中。
   </para>
   <para>
    對於其他類型的套件，有時還會選擇引入新版本，而不是執行回移。當產生回移在經濟上不可行時，或者存在極其相關的技術原因而需要引入較新版本時，便會這麼做。
   </para>
  </sect2>

  <sect2 id="sec.update.backports.">
   <title>解譯版本號碼時產生的回移問題</title>
   <para>
    由於採取了回移的做法，使用者無法僅透過比較版本號碼來判斷 SUSE 套件是否包含特定問題的修正程式或新增了特定功能。使用回移時，SUSE 套件版本號碼的上游部分僅表示 SUSE 套件所基於的上游版本。它可能包含相應上游版本中沒有但已回移至 SUSE 套件中的錯誤修正程式和功能。
   </para>
   <para>
    有很多位置用於儲存此類錯誤修正程式和功能的相關資訊︰
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      套件的變更記錄：
     </para>
<screen>rpm -q --changelog name-of-installed-package
rpm -qp --changelog packagefile.rpm</screen>
     <para>
      輸出簡要記錄套件的變更歷程。
     </para>
    </listitem>
    <listitem>
     <para>
      套件變更記錄可能包含 <literal>bnc#1234</literal> 等項目，它們指代的是 Novell Bugzilla 追蹤系統中的錯誤或連至其他錯誤追蹤系統的連結。(由於機密性規則，您可能無法存取所有此類資訊)。
     </para>
    </listitem>
    <listitem>
     <para>
      套件可能包含 <filename>/usr/share/doc/packagename/README.SUSE</filename> 或 <filename>README.SuSE</filename> 檔案，其含有 SUSE 套件特定的一般高階資訊。
     </para>
    </listitem>
    <listitem>
     <para>
      RPM 來源套件包含的修補程式可在將一般二進位 RPM 建立為獨立檔案期間加以套用；如果您熟悉如何讀取源代碼，可以解譯這些獨立檔案。如需詳細資訊，請參閱<ulink url="http://www.rpm.org/max-rpm/">《Maximum RPM》</ulink> 一書。
     </para>
    </listitem>
    <listitem>
     <para>
      如需瞭解安全性錯誤修正程式，請參閱 <ulink url="https://www.suse.com/support/security/#1">SUSE 安全性通告</ulink>。這些修正程式通常適用於由<ulink url="http://cve.mitre.org">通用弱點披露</ulink> 專案維護之以 <literal>CAN-2005-2495</literal> 等標準名稱顯示的錯誤。
     </para>
    </listitem>
   </itemizedlist>
   <para>
    在涉及回移時，版本號碼的這種限制值可能會導致問題的一個特定方面就是使用安全性掃描工具時。某些安全性弱點掃描工具 (或在此類工具中進行的特定測試) 僅針對版本資訊操作。在涉及回移時，這些工具/測試容易產生<quote>誤判</quote> (宣稱發現軟體存在弱點，而實際上並沒有弱點)。評估安全性掃描工具產生的報告時，使用者始終應該調查項目是僅基於版本號碼，還是實際弱點是否存在的實際測試。
   </para>
  </sect2>
 </sect1>
 <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="update_split_brain.xml" parse="xml"/>
 <sect1 id="sec.update.wagonhooks">
  <title>YaST Wagon 的移轉插入程式</title>



  <para>
   移轉插入程式可讓您在移轉過程中的某個時間點執行自定外部程序檔。使用這些程序檔，您可以處理透過一般 RPM 程序檔無法處理的特定問題，或者執行移轉期間可能需要的任何額外動作 (一般套件更新期間不需要執行這些動作)。
  </para>

  <para>
   移轉插入程式會以 root 權限執行，因此，可以在程序檔中執行任何維護任務 (啟動/停止服務、資料備份、資料移轉等)。程序檔不能是互動式的；STDIN 和 STDOUT 在 YaST 中執行時會被重新導向至管線。不應使用 X 工作階段，因為它可能並不適用於所有情況 (例如，在文字模式下執行時)。不要忘記設定插入程式程序檔的可執行權限。
  </para>

  <para>
   <systemitem class="resource">yast2-wagon</systemitem> 套件 2.17.32.1 版 (做為 SLES11-SP2 的更新提供) 或 2.17.3 版 (包含在 SLES11-SP3 中) 或更高版本中支援移轉插入程式。
  </para>

  <sect2>
   <title>插入程式程序檔位置和命名慣例</title>
   <para>
    可在 <filename>/var/lib/YaST2/wagon/hooks/</filename> 目錄中搜尋這些程序檔。預期的程序檔名稱採用<replaceable>步驟_順序_字首_名稱</replaceable>格式，其中：
   </para>
   <variablelist>
    <varlistentry>
     <term><replaceable>步驟</replaceable>
     </term>
     <listitem>
      <para>
       是預先定義的移轉步驟名稱，說明目前的移轉步驟。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>順序</replaceable>
     </term>
     <listitem>
      <para>
       是 00...99 範圍內的順序編號，您可以設定執行程序檔的順序。(務必保留前導零以便正確排序！)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>字首</replaceable>
     </term>
     <listitem>
      <para>
       應保持唯一，以避免衝突 (例如名稱空間)。使用套件名稱 (如果它是套件的一部分) 或廠商名稱、網際網路網域名稱等，基本而言，使用可視為足夠唯一的任何內容
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><replaceable>名稱</replaceable>
     </term>
     <listitem>
      <para>
       可以是任意字串 (僅用於區分程序檔)。建議使用一些描述性名稱。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <example>
    <title>包含完整路徑的插入程式程序檔</title>
<screen>/var/lib/YaST2/wagon/hooks/before_package_migration_00_postgresql_backup</screen>
   </example>
  </sect2>

  <sect2>
   <title>插入程式程序檔結束值</title>
   <para>
    程序檔應傳回結束值 0。如果失敗 (任何非零結束值)，Wagon 中將會顯示一則錯誤訊息，此時您可以重新啟動程序檔、忽略失敗 (並繼續執行其他程序檔) 或完全取消目前步驟和階段的插入程式。
   </para>
  </sect2>

  <sect2>
   <title>等冪程序檔</title>
   <para>
    插入程式程序檔<emphasis>可能會執行多次</emphasis> (不斷切換 Wagon 對話方塊時，Wagon 可能會重新啟動本身，或者移轉工作流程中的某些步驟可能會執行多次)，因此程序檔必須應付這種情況 (它們可以在開始時檢查是否需要執行該動作，或該動作已執行；或者可以建立簡單的暫存戳記檔案或以其他方式正確解決多次執行問題)。
   </para>
  </sect2>

  <sect2>
   <title>受支援的插入程式清單</title>
   <para>
    有些插入程式是選擇性的 (因為它們相依於先前的結果或使用者選取的值)。請注意，某些插入程式會被呼叫多次 (例如，移轉前後都會呼叫註冊)。下面按執行順序列出了受支援的插入程式 (步驟名稱)：
   </para>
   <variablelist>
    <varlistentry>
     <term><command>before_init</command>
     </term>
     <listitem>
      <para>
       在最初啟動 (請注意︰Wagon 重新啟動後會再次呼叫它)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_welcome</command>
     </term>
     <term><command>after_welcome</command>
     </term>
     <listitem>
      <para>
       在顯示歡迎使用對話方塊之前/之後啟動
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_registration_check</command>
     </term>
     <term><command>after_registration_check</command>
     </term>
     <listitem>
      <para>
       Wagon 會檢查註冊狀態 (如果某些產品的註冊已過期，移轉可能會失敗)。如果一切正常，則不會顯示任何對話方塊，且 Wagon 會自動繼續執行下一步。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_custom_url</command>
     </term>
     <term><command>after_custom_url</command>
     </term>
     <listitem>
      <para>
       啟動儲存庫管理員 (選擇性，僅限修補程式 CD 模式)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_self_update</command>
     </term>
     <term><command>after_self_update</command>
     </term>
     <listitem>
      <para>
       在 Wagon 更新本身之前/之後呼叫 (以確保使用最新版本進行移轉)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_installing_migration_products</command>
     </term>
     <term><command>after_installing_migration_products</command>
     </term>
     <listitem>
      <para>
       在安裝移轉產品之前/之後呼叫
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_selecting_migration_source</command>
     </term>
     <term><command>after_selecting_migration_source</command>
     </term>
     <listitem>
      <para>
       Wagon 會詢問使用者是透過 Novell Customer Center 儲存庫還是使用自定儲存庫進行移轉；下一步視使用者的選擇而定
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_registration</command>
     </term>
     <term><command>after_registration</command>
     </term>
     <listitem>
      <para>
       執行 SUSE 註冊 (以新增移轉儲存庫)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_repo_selection</command>
     </term>
     <term><command>after_repo_selection</command>
     </term>
     <listitem>
      <para>
       手動儲存庫管理
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_set_migration_repo</command>
     </term>
     <term><command>after_set_migration_repo</command>
     </term>
     <listitem>
      <para>
       選取移轉儲存庫 (使用 Novell Customer Center 時選取完全/精簡移轉) 或更新儲存庫選擇 (自定儲存庫移轉)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_package_migration</command>
     </term>
     <listitem>
      <para>
       在套件更新開始之前，此步驟之後，實際移轉將會開始，此時無法自動返回到先前的狀態 (在此階段中止將會導致系統出現不一致 (半升級)，因此需要手動復原)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_registration</command>
     </term>
     <term><command>after_registration</command>
     </term>
     <listitem>
      <para>
       執行 SUSE 註冊 (以註冊更新的產品)
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_congratulate</command>
     </term>
     <term><command>after_congratulate</command>
     </term>
     <listitem>
      <para>
       在 Wagon 因移轉成功而顯示恭喜對話方塊之前/之後
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_exit</command>
     </term>
     <listitem>
      <para>
       在 Wagon 即將結束之前呼叫 (始終如此，不管移轉結果如何；亦會在中止之後和重新啟動之時呼叫)
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2>
   <title>中止插入程式</title>
   <para>
    這些是特殊的中止插入程式，當使用者中止移轉時會呼叫它們。這些插入程式可在移轉工作流程的任何步驟中呼叫，因此無法保證執行順序。如果程序檔依賴於其他插入程式的結果，則需要檢查目前狀態。
   </para>
   <variablelist>
    <varlistentry>
     <term><command>before_abort</command>
     </term>
     <listitem>
      <para>
       使用者確認中止移轉
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>before_abort_rollback</command>
     </term>
     <term><command>after_abort_rollback</command>
     </term>
     <listitem>
      <para>
       使用者確認在中止之後復原 (回復到開始移轉之前所安裝的舊產品)。這些插入程式會在 before_abort 之後呼叫；使用者不確認復原時，則跳過。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2>
   <title>重新啟動插入程式</title>
   <para>
    每次 Wagon 重新啟動本身時，都會呼叫這些插入程式。
   </para>
   <variablelist>
    <varlistentry>
     <term><command>before_restart</command>
     </term>
     <listitem>
      <para>
       Wagon 正在完成，並將再次啟動
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>after_restart</command>
     </term>
     <listitem>
      <para>
       Wagon 已重新啟動，並將執行移轉工作流程中的下一步
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </sect2>

  <sect2>
   <title>常用插入程式</title>
   <para>
    插入程式清單相當長，但是其中許多插入程式僅適用於特定情況。在通常情況下，應該為這些插入程式指定優先設定︰
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      若要在系統移轉之前執行某動作 (仍執行先前版本)，請使用 <command>before_package_migration</command> 插入程式。
     </para>
     <para>
      此時，使用者清楚地知道移轉已就緒且即將開始，而此前的所有步驟都可能中止移轉。

     </para>
    </listitem>
    <listitem>
     <para>
      若要在系統移轉之後執行某動作 (系統執行的是新的已移轉版本，但是有些設定可能尚未處於使用中，例如更新的核心需要重新開機、更新的服務可能需要重新啟動等)，請使用 <command>before_congratulate</command> 或 <command>after_congratulate</command> 插入程式。
     </para>
     <para>
      此插入程式還可用於清理 <command>before_package_migration</command> 插入程式的暫存結果。此時，移轉已成功完成。
     </para>
    </listitem>
    <listitem>
     <para>
      若要在移轉中止時回復變更，請視情況使用下列其中一個中止插入程式。請記住，您可以隨時呼叫中止插入程式，因此可能並不需要回復 (可能尚未呼叫執行變更的插入程式)。中止插入程式需要檢查目前狀態。
     </para>
    </listitem>
   </itemizedlist>
  </sect2>

  <sect2>
   <title>過時的插入程式</title>
   <para>
    舊版 Wagon 僅支援兩個插入程式程序檔：<filename>/usr/lib/YaST2/bin/wagon_hook_init</filename> 與 <filename>/usr/lib/YaST2/bin/wagon_hook_finish</filename>。問題在於只能將一個程序檔做為插入程式執行，並且無法直接將這些插入程式置於 RPM 套件中。
   </para>
   <para>
    較新版本的 Wagon 中仍支援這些舊插入程式程序檔以取得反向相容性，但是應使用新的插入程式 <command>before_init</command> 與 <command>before_exit</command>，而不是過時的插入程式。
   </para>
  </sect2>
 </sect1>
</chapter>
