<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sect1 PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN"
"novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<sect1 xml:base="net_config_files.xml" id="sec.basicnet.manconf">
 <title>手動設定網路連接</title><indexterm id="idx.networks_configuring" class="startofrange"> <primary>網路</primary> <secondary>設定</secondary> </indexterm> <indexterm id="idx.configuring_networks_manually" class="startofrange"> <primary>設定</primary> <secondary>網路</secondary> <tertiary>手動</tertiary> </indexterm>

 <para>
  網路軟體的手動組態應該永遠是最後的替代方案。建議使用 YaST。不過，這個有關網路組態的背景資訊也可協助您使用 YaST。
 </para>



 <para>
  當核心偵測到網路卡並建立對應的網路介面時，它會根據探查到裝置或載入核心模組的順序，為該裝置指定名稱。只有在非常簡單或嚴密控制的硬體環境中，預設核心裝置的名稱才可預測。如果系統允許在執行時期新增或移除硬體，或是支援自動設定裝置組態，則無法準確預測核心在重新開機時指定的網路裝置名稱。
 </para>

 <para>
  但是，所有系統組態工具均依賴於永久的介面名稱。udev 解決了此問題。udev 永久網路產生器 (<filename>/lib/udev/rules.d/75-persistent-net-generator.rules</filename>) 會產生與硬體相符的規則 (預設使用其硬體位址)，並為硬體指定一個永遠唯一的介面。網路介面的 udev 資料庫儲存在檔案 <filename>/etc/udev/rules.d/70-persistent-net.rules</filename> 中。該檔案中的每一行描述一個網路介面並指定其永久名稱。系統管理員可以透過編輯 <literal>NAME=""</literal> 項目來變更指定的名稱。您也可以使用 YaST 修改永久規則。
 </para>

 <para>
  <xref linkend="tab.net.script.conf"/> 總結了與網路組態相關的最重要的程序檔。
 </para>

 <table id="tab.net.script.conf">
  <title>手動網路組態程序檔</title>
  <tgroup cols="2">
   <thead>
    <row>
     <entry>
      <para>
       指令
      </para>
     </entry>
     <entry>
      <para>
       函數
      </para>
     </entry>
    </row>
   </thead>
   <tbody>
    <row>
     <entry>
      <para>
       <command>ifup, ifdown, ifstatus</command>
      </para>
     </entry>
     <entry>
      <para>
       <literal>if</literal> 程序檔會啟動或停止網路介面，或傳回指定介面的狀態。如需詳細資訊，請參閱 <systemitem>ifup</systemitem> 手冊頁。
      </para>
     </entry>
    </row>
    <row>
     <entry>
      <para>
       <command>rcnetwork</command>
      </para>
     </entry>
     <entry>
      <para>
       <literal>rcnetwork</literal> 程序檔可用於啟動、停止或重新啟動所有網路介面 (或指定的網路介面)。停止、啟動或重新啟動網路介面時分別使用 <command>rcnetwork stop</command>、<command>rcnetwork start</command> 和 <command>rcnetwork restart</command>。若只需停止、啟動或重新啟動一個介面，請使用該命令，並在後面指定介面名稱，例如 <command>rcnetwork restart eth0</command>。<command>rcnetwork status</command> 指令顯示介面的狀態、IP 位址以及 DHCP 用戶端是否正在執行。使用 <command>rcnetwork stop-all-dhcp-clients</command> 和 <command>rcnetwork restart-all-dhcp-clients</command> 可以停止或重新啟動在網路介面上執行的 DHCP 用戶端。
      </para>
     </entry>
    </row>
   </tbody>
  </tgroup>
 </table>

 <para>
  如需 udev 和永久裝置名稱的詳細資訊，請參閱<xref linkend="cha.udev"/>。
 </para>

 <sect2 id="sec.basicnet.manconf.files">
  <title>組態檔案</title><indexterm> <primary>組態檔</primary> </indexterm> <indexterm id="idx.networks_configuration_files" class="startofrange"> <primary>網路</primary> <secondary>組態檔</secondary> </indexterm>
  <para>
   本節提供網路組態檔的綜覽，並說明其用途和使用的格式。
  </para>
  <sect3 id="sec.basicnet.manconf.files.ifcfg">
   <title><filename>/etc/sysconfig/network/ifcfg-*</filename></title>
   <para>
    這些檔案包含網路介面的組態。其中包含啟動模式和 IP 位址等資訊。可以使用的參數請參閱 <systemitem>ifup</systemitem> 的手冊頁。此外，如果一個一般設定只能用於一個介面，則檔案 <filename>dhcp</filename> 中的大多數變數在 <filename>ifcfg-*</filename> 檔案中都可以使用。但是，大多數 <filename>/etc/sysconfig/network/config</filename> 變數都是全域變數，在 ifcfg 檔案中不能將它們覆寫。例如，<systemitem>NETWORKMANAGER</systemitem> 或 <systemitem>NETCONFIG_*</systemitem> 變數就是全域變數。
   </para>
   <para>
    如需 <filename>ifcfg.template</filename> 的相關資訊，請參閱<xref linkend="sec.basicnet.manconf.files.config-etc"/>。
   </para><indexterm> <primary>組態檔</primary> <secondary>ifcfg-*</secondary> </indexterm>
   <para os="sles" arch="zseries">
    IBM System z 不支援 USB。介面檔案名稱和網路別名包含 System z 專屬元素，如 <literal>qeth</literal>。
   </para>


  </sect3>
  <sect3 id="sec.basicnet.manconf.files.config-etc">
   <title><filename>/etc/sysconfig/network/config</filename> 和 <filename>/etc/sysconfig/network/dhcp</filename></title><indexterm> <primary>組態檔案</primary> <secondary>網路</secondary></indexterm><indexterm> <primary>組態檔案</primary> <secondary>dhcp</secondary></indexterm>
   <para>
    <filename>config</filename> 檔案包含 <command>ifup</command>、<command>ifdown</command> 和 <command>ifstatus</command> 行為的一般設定。<filename>dhcp</filename> 包含 DHCP 的設定。這兩個組態檔案中的變數都已被註解。<filename>/etc/sysconfig/network/config</filename> 中的某些變數也可以在 <filename>ifcfg-*</filename> 檔案中使用，而且在這些檔案中它們的優先程度更高。<filename>/etc/sysconfig/network/ifcfg.template</filename> 檔案列出了可在永久介面中指定的變數。但是，大多數 <filename>/etc/sysconfig/network/config</filename> 變數都是全域變數，在 ifcfg 檔案中不能將它們覆寫。例如，<systemitem>NETWORKMANAGER</systemitem> 或 <systemitem>NETCONFIG_*</systemitem> 變數就是全域變數。
   </para>
  </sect3>
  <sect3>
   <title><filename>/etc/sysconfig/network/routes</filename> 和 <filename>/etc/sysconfig/network/ifroute-*</filename></title><indexterm id="idx.routing" class="startofrange"> <primary>路由</primary> </indexterm> <indexterm> <primary>路由</primary> <secondary>路由</secondary> </indexterm> <indexterm> <primary>組態檔</primary> <secondary>路由</secondary> </indexterm> <indexterm> <primary>設定</primary> <secondary>路由</secondary> </indexterm>
   <para>
    TCP/IP 封包的靜態路由在此決定。您可以將各種系統任務所需的所有靜態路由都輸入 <filename>/etc/sysconfig/network/routes</filename> 檔案，包括主機的路由、透過閘道前往主機的路由，以及網路的路由。對於需要個別路由的介面，請定義額外的組態檔案：<filename>/etc/sysconfig/network/ifroute-*</filename>。以介面的名稱取代 <literal>*</literal>。在路由組態檔中的項目看起來就像這樣：<indexterm> <primary>路由</primary> <secondary>靜態</secondary> </indexterm>
   </para>
<screen># Destination     Dummy/Gateway     Netmask            Device
#
127.0.0.0         0.0.0.0           255.255.255.0      lo
204.127.235.0     0.0.0.0           255.255.255.0      eth0
default           204.127.235.41    0.0.0.0            eth0
207.68.156.51     207.68.145.45     255.255.255.255    eth1
192.168.0.0       207.68.156.51     255.255.0.0        eth1</screen>
   <para>
    路由的目的地是在第一個資料欄。這個資料欄可能包含網路或主機的 IP 位址，這是指<emphasis>「可到達的」</emphasis>名稱伺服器、完整合格的網路或主機名稱。
   </para>
   <para>
    第二個資料欄包含預設的閘道或是可以存取主機或網路的閘道。第三個資料欄包含在閘道後面的網路或主機的網路遮罩。例如，遮罩為 <systemitem class="netmask">255.255.255.255</systemitem>，供在閘道後面的主機使用。
   </para>
   <para>
    第四欄只與連接至本地主機的網路相關，例如迴路、乙太網路、ISDN、PPP 以及虛擬裝置。必須在這裏輸入裝置名稱。
   </para>
   <para>
    第五欄 (可選) 可指定路由的類型。不需要的欄位必須包含 <literal>-</literal> 減號，以確保解析程式可正確解譯指令。如需詳細資訊，請參閱 <systemitem>routes(5)</systemitem> man 頁面。
   </para>
   <para>
    現在，IPv4 和 IPv6 的統一格式如下所示：
   </para>
<screen><replaceable>prefix</replaceable>/<replaceable>length</replaceable><replaceable>gateway</replaceable> -            [<replaceable>interface</replaceable>]
</screen>
   <para>
    相應地，所謂的相容性格式則為：
   </para>
<screen><replaceable>prefix</replaceable><replaceable>gateway</replaceable><replaceable>length</replaceable>       [<replaceable>interface</replaceable>]
</screen>
   <para>
    對於 IPv4，您仍然可以使用含網路遮罩的舊格式：
   </para>
<screen><replaceable>ipv4-network</replaceable><replaceable>gateway</replaceable><replaceable>ipv4-netmask</replaceable> [<replaceable>interface</replaceable>]
</screen>
   <para>
    下列範例作用相同：
   </para>
<screen>2001:db8:abba:cafe::/64 2001:db8:abba:cafe::dead  -            eth0
208.77.188.0/24         208.77.188.166            -            eth0

2001:db8:abba:cafe::    2001:db8:abba:cafe::dead 64            eth0
208.77.188.0            208.77.188.166           24            eth0

208.77.188.0            208.77.188.166           255.255.255.0 eth0
</screen>
<indexterm class="endofrange" startref="idx.routing"/>
  </sect3>
  <sect3>
   <title><filename>/etc/resolv.conf</filename></title><indexterm> <primary>組態檔案</primary> <secondary>resolv.conf</secondary> </indexterm>
   <para>
    主機所屬的網域指定於此檔案 (關鍵字 <systemitem>search</systemitem>)；另外也會列出要存取的名稱伺服器位址的狀態 (關鍵字 <systemitem>nameserver</systemitem>)。可以在檔案中指定多個網域名稱。解析不完整的名稱時，會嘗試附加個別 <systemitem>search</systemitem> 項目產生一個名稱。可以在多行中指定多個伺服器名稱，每個名稱均以 <systemitem>nameserver</systemitem> 開頭。備註前面標有 <literal>#</literal> 符號。<xref linkend="dat.netz.etc.resolv.conf"/> 顯示了 <filename>/etc/resolv.conf</filename> 的格式。<indexterm> <primary>DNS</primary> <secondary>網域</secondary> </indexterm> <indexterm> <primary>DNS</primary> <secondary>名稱伺服器</secondary> </indexterm>
   </para>
   <para>
    不過，您不可手動編輯 <filename>/etc/resolv.conf</filename>。它是由 <command>netconfig</command> 程序檔產生的。若要定義靜態 DNS 組態而不使用 YaST，請在 <filename>/etc/sysconfig/network/config</filename> 檔案中手動編輯適當的變數：
   </para>
   <variablelist>
    <varlistentry>
     <term><systemitem>NETCONFIG_DNS_STATIC_SEARCHLIST</systemitem>
     </term>
     <listitem>
      <para>
       用於主機名稱查詢的 DNS 網域名稱清單
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>NETCONFIG_DNS_STATIC_SERVERS</systemitem>
     </term>
     <listitem>
      <para>
       用於主機名稱查詢的名稱伺服器 IP 位址清單
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>NETCONFIG_DNS_FORWARDER</systemitem>
     </term>
     <listitem>
      <para>
       定義必須設定的 DNS 轉遞者的名稱
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    若要使用 netconfig 停用 DNS 組態，請設定 <literal>NETCONFIG_DNS_POLICY=''</literal>。如需 <command>netconfig</command> 的詳細資訊，請參閱 <command>man 8 netconfig</command>。
   </para>
   <example id="dat.netz.etc.resolv.conf">
    <title><filename>/etc/resolv.conf</filename></title>
<screen># Our domain
search example.com
#
# We use dns.example.com (192.168.1.116) as name server
nameserver 192.168.1.116</screen>
   </example>
  </sect3>

  <sect3 id="sec.basicnet.manconf.netconfig">
   <title><filename>/sbin/netconfig</filename></title>
   <para>
    <command>netconfig</command> 是一個模組化工具，用於管理其他網路組態設定。它根據預先定義的規則，將靜態定義的設定與自動組態機制 (如 DHCP 或 PPP) 提供的設定進行合併。透過呼叫負責修改組態檔案和重新啟動服務或類似動作的 netconfig 模組，將必要的變更套用至系統。
   </para>
   <para>
    <command>netconfig</command> 可以辨識三個主要動作。DHCP 或 PPP 等精靈使用 <command>netconfig modify</command> 與 <command>netconfig remove</command> 指令提供或移除 netconfig 的設定。使用者僅可使用 <command>netconfig update</command> 指令：
   </para>
   <variablelist>
    <varlistentry>
     <term><command>modify</command>
     </term>
     <listitem>
      <para>
       <command>netconfig modify</command> 指令會修改目前的介面和服務特定的動態設定，並更新網路組態。Netconfig 會從標準輸入或從 <option>--lease-file <replaceable>檔案名稱</replaceable></option>選項指定的檔案讀取設定，並將它們儲存於內部，直到系統重新開機 (或執行下一個修改或移除動作) 為止。系統會覆寫同一個介面與服務組合的現有設定。介面由 <option>-i <replaceable>介面名稱</replaceable></option>參數來指定。服務由 <option>-s <replaceable>服務名稱</replaceable></option>參數來指定。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>remove</command>
     </term>
     <listitem>
      <para>
       <command>netconfig remove</command> 指令會移除修改動作為指定介面和服務組合提供的動態設定，並更新網路組態。介面由 <option>-i <replaceable>介面名稱</replaceable></option>參數來指定。服務由 <option>-s <replaceable>服務名稱</replaceable></option>參數來指定。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><command>update</command>
     </term>
     <listitem>
      <para>

       <command>netconfig update</command> 指令會使用目前的設定更新網路組態。當規則或靜態組態變更時可以使用此指令。如果只想更新指定的服務 (<systemitem>dns</systemitem>、<systemitem>nis</systemitem> 或 <systemitem>ntp</systemitem>)，請使用 <option>-m <replaceable>模組類型</replaceable></option>參數。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>

   <para>
    netconfig 規則和靜態組態設定可透過手動方式定義，或使用 YaST 在 <filename>/etc/sysconfig/network/config</filename> 檔案中定義。自動組態工具 (如 DHCP 或 PPP) 提供的動態組態設定經由這些工具透過 <command>netconfig modify</command> 和 <command>netconfig remove</command> 動作直接傳送。NetworkManager 也可以使用 <command>netconfig modify</command> 與 <command>netconfig remove</command> 動作。NetworkManager 啟用時，netconfig (在 <literal>auto</literal> 規則模式中) 只會使用 NetworkManager 設定，而忽略使用傳統 ifup 方法設定的任何其他介面的設定。如果 NetworkManager 未提供任何設定，則使用靜態設定做為備用設定。系統不支援同時使用 NetworkManager 與傳統 ifup 方法。
   </para>
   <para>
    如需 <command>netconfig</command> 的詳細資訊，請參閱 <command>man 8 netconfig</command>。
   </para>
  </sect3>
  <sect3 id="sec.basicnet.manconf.hosts">
   <title><filename>/etc/hosts</filename></title><indexterm> <primary>組態檔案</primary> <secondary>主機</secondary> </indexterm>
   <para>
    在此檔中 (請參閱 <xref linkend="dat.netz.etc.hosts"/>)，IP 位址是指定給主機名稱。如果沒有執行任何名稱伺服器，將使用此 IP 連接設定的所有主機將列示於此。對於每個主機，分別在檔案中輸入一行包含 IP 位址、完全合法的主機名稱及主機名稱的項目。IP 位址必須在行的開頭，然後以空格和定位點分隔這些項目。註解的前面永遠是 <literal>#</literal> 符號。
   </para>
   <example id="dat.netz.etc.hosts">
    <title><filename>/etc/hosts</filename></title>
<screen>127.0.0.1 localhost
192.168.2.100 jupiter.example.com jupiter
192.168.2.101 venus.example.com venus</screen>
   </example>
  </sect3>
  <sect3>
   <title><filename>/etc/networks</filename></title><indexterm> <primary>組態檔案</primary> <secondary>網路</secondary> </indexterm>
   <para>
    在此檔中，網路名稱會轉換為網路位址。格式與 <filename>hosts</filename> 檔案格式相似，但是網路名稱在位址前。請參閱<xref linkend="dat.netz.networks"/>。
   </para>
   <example id="dat.netz.networks">
    <title><filename>/etc/networks</filename></title>
<screen>loopback     127.0.0.0
localnet     192.168.0.0</screen>
   </example>
  </sect3>
  <sect3>
   <title><filename>/etc/host.conf</filename></title><indexterm> <primary>組態檔案</primary> <secondary>host.conf</secondary> </indexterm>
   <para>
    名稱解析--透過<emphasis>解析器</emphasis>庫分析主機和網路的名稱--由此檔案收集。該檔案僅用於與 libc4 或 libc5 連結的程式。對於目前的 glibc 程式，請參閱 <filename>/etc/nsswitch.conf</filename> 中的設定。每個參數必須永遠是獨立一行。註解的前面是 <literal>#</literal> 符號。<xref linkend="tab.netz.param.hostconf"/> 顯示出可用的參數。<filename>/etc/host.conf</filename> 範例是顯示在 <xref linkend="dat.netz.etc.hostconf"/>。
   </para>
   <table id="tab.netz.param.hostconf">
    <title>/etc/host.conf 的參數</title>
    <tgroup cols="2" align="left">
     <tbody>
      <row>
       <entry>
        <para>
         order <emphasis>hosts</emphasis>, <emphasis>bind</emphasis>
        </para>
       </entry>
       <entry>
        <para>
         指定針對名稱解析存取服務的順序。可用的引數有 (以空格或逗號分隔)：
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para/>
       </entry>
       <entry>
        <para>
         <emphasis>hosts</emphasis>：搜尋 <filename>/etc/hosts</filename> 檔案
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para/>
       </entry>
       <entry>
        <para>
         <emphasis>bind</emphasis>：存取名稱伺服器
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para/>
       </entry>
       <entry>
        <para>
         <emphasis>nis</emphasis>：使用 NIS
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         multi <emphasis>on</emphasis>/<emphasis>off</emphasis>
        </para>
       </entry>
       <entry>
        <para>
         定義在 <filename>/etc/hosts</filename> 中所輸入的主機是否可以有多個 IP 位址。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         nospoof <emphasis>on</emphasis> spoofalert <emphasis>on</emphasis>/<emphasis>off</emphasis>
        </para>
       </entry>
       <entry>
        <para>
         這些參數會影響名稱伺服器 <emphasis>spoofing</emphasis>，但並不會對網路組態產生任何影響。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         trim <emphasis>domainname</emphasis>
        </para>
       </entry>
       <entry>
        <para>
         指定的網域名稱在主機名稱解析後會與主機名稱分隔 (只要主機名稱包括網域名稱)。只有在本地網域分隔出來的名稱位於 <filename>/etc/hosts</filename> 檔案，但仍然使用附加的網域名稱進行辨識時，這個選項才有用。
        </para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </table>
   <example id="dat.netz.etc.hostconf">
    <title><filename>/etc/host.conf</filename></title>
<screen># We have named running
order hosts bind
# Allow multiple address
multi on</screen>
   </example>
  </sect3>
  <sect3>
   <title><filename>/etc/nsswitch.conf</filename></title><indexterm> <primary>組態檔案</primary> <secondary>nsswitch.conf</secondary> </indexterm>
   <para>
    GNU C Library 2.0 的介紹隨附於<emphasis>名稱服務切換</emphasis> (NSS，Name Service Switch) 的介紹。詳細資訊請參閱 <systemitem>nsswitch.conf(5)</systemitem> man 頁面和 <emphasis>GNU C Library 參考手冊</emphasis>。<indexterm> <primary>NSS</primary> </indexterm>
   </para>
   <para>
    查詢的順序定義於檔案 <filename>/etc/nsswitch.conf</filename>。<filename>nsswitch.conf</filename> 範例是顯示在 <xref linkend="dat.netz.nsswitchconf"/>。備註前面標有 <literal>#</literal> 符號。在此範例中，<filename>hosts</filename> 資料庫下的項目表示要求是透過 DNS 傳送到 <filename>/etc/hosts</filename> (<option>files</option>)<phrase os="sles"> (請參閱<xref linkend="cha.dns"/>)</phrase>。
   </para>
   <example id="dat.netz.nsswitchconf">
    <title><filename>/etc/nsswitch.conf</filename></title>
<screen>passwd:     compat
group:      compat

hosts:      files dns
networks:   files dns

services:   db files
protocols:  db files
rpc:        files
ethers:     files
netmasks:   files
netgroup:   files nis
publickey:  files

bootparams: files
automount:  files nis
aliases:    files nis
shadow:     compat
</screen>
   </example>
   <para>
    NSS 上可用的<quote>資料庫</quote>列示於 <xref linkend="tab.netz.nnswitch.db"/>。<indexterm><primary>NSS</primary> <secondary>資料庫</secondary></indexterm> NSS 資料庫的組態選項將列於<xref linkend="tab.netz.nnswitch.conf"/>。
   </para>
   <table id="tab.netz.nnswitch.db">
    <title>透過 /etc/nsswitch.conf 的可用資料庫</title>
    <tgroup cols="2" align="left">
     <tbody>
      <row>
       <entry>
        <para>
         <option>aliases</option>
        </para>
       </entry>
       <entry>
        <para>
         <filename>sendmail</filename> 所執行的郵件別名；請參閱 <command>man</command> <option>5 aliases</option>。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>ethers</option>
        </para>
       </entry>
       <entry>
        <para>
         乙太網路位址。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>netmasks</option>
        </para>
       </entry>
       <entry>
        <para>
         網路及其子網路遮罩的清單。當您使用子網路時才需要。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>group</option>
        </para>
       </entry>
       <entry>
        <para>
         適用於 <filename>getgrent</filename> 所使用的使用者群組。請參閱 <command>group</command> 的 man 頁面。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>hosts</option>
        </para>
       </entry>
       <entry>
        <para>
         <filename>gethostbyname</filename> 及類似功能所使用的主機名稱與 IP 位址。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>netgroup</option>
        </para>
       </entry>
       <entry>
        <para>
         在網路中有效的主機與使用者清單，以利控制存取權限，請參閱 <systemitem>netgroup(5)</systemitem> man 頁面。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>networks</option>
        </para>
       </entry>
       <entry>
        <para>
         <filename>getnetent</filename> 所使用的網路名稱與位址。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>publickey</option>
        </para>
       </entry>
       <entry>
        <para>
         NFS 及 NIS+ 使用之 Secure_RPC 的公開金鑰和私密金鑰。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>passwd</option>
        </para>
       </entry>
       <entry>
        <para>
         <filename>getpwent</filename> 所使用的使用者密碼；請參閱 <systemitem>passwd(5)</systemitem> man 頁面。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>protocols</option>
        </para>
       </entry>
       <entry>
        <para>
         <filename>getprotoen</filename> 所使用的網路通訊協定；請參閱 <systemitem>protocols(5)</systemitem> man 頁面。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>rpc</option>
        </para>
       </entry>
       <entry>
        <para>
         <filename>getrpcbyname</filename> 及類似功能所使用的遠端程序呼叫名稱與位址。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>services</option>
        </para>
       </entry>
       <entry>
        <para>
         <filename>getservent</filename> 使用的網路服務。
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>shadow</option>
        </para>
       </entry>
       <entry>
        <para>
         <filename>getspnam</filename> 所使用的使用者遮蔽密碼；請參閱 <option>shadow(5)</option> man 頁面。
        </para>
       </entry>
      </row>

     </tbody>
    </tgroup>
   </table>
   <table id="tab.netz.nnswitch.conf">
    <title>NSS<quote>資料庫</quote>的組態選項</title>
    <tgroup cols="2" align="left">
     <tbody>
      <row>
       <entry>
        <para>
         <option>files</option>
        </para>
       </entry>
       <entry>
        <para>
         直接存取檔案，例如 <filename>/etc/aliases</filename>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>db</option>
        </para>
       </entry>
       <entry>
        <para>
         透過資料庫存取
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>nis</option>、<option>nisplus</option>
        </para>
       </entry>
       <entry>
        <para>
         NIS，請參閱<xref linkend="cha.nis"/>
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>dns</option>
        </para>
       </entry>
       <entry>
        <para>
         只能做為 <option>hosts</option> 與 <option>networks</option> 的延伸
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <option>compat</option>
        </para>
       </entry>
       <entry>
        <para>
         只能做為 <option>passwd</option>、<option>shadow</option> 與 <option>group</option> 的延伸
        </para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </table>
  </sect3>
  <sect3>
   <title><filename>/etc/nscd.conf</filename></title><indexterm> <primary>組態檔案</primary> <secondary>nscd.conf</secondary> </indexterm>
   <para>
    此檔案用來設定 nscd (名稱服務快取精靈)。請參閱 <systemitem>nscd(8)</systemitem> 與 <systemitem>nscd.conf(5)</systemitem> man 頁面。依預設，<option>passwd</option> 與 <option>groups</option> 的系統項目是由 nscd 快取。這對於目錄服務 (如 NIS 和 LDAP) 的效能而言是很重要的，否則每次存取名稱或群組時都需要使用網路連接。預設是不會快取 <option>hosts</option>，因為 nscd 快取主機的機制會造成本地系統無法信任轉寄以及反向查詢檢查。不要要求 nscd 快取名稱，而是設定快取 DNS 伺服器。
   </para>
   <para>
    如果啟用 <option>passwd</option> 的快取，通常需要 15 秒，才能辨識新增的本地使用者。使用指令 <command>rcnscd</command> <option>restart</option> 重新啟動 nscd，縮短這段等待時間。
   </para>
  </sect3>
  <sect3>
   <title><filename>/etc/HOSTNAME </filename></title><indexterm> <primary>組態檔案</primary> <secondary>HOSTNAME</secondary> </indexterm>
   <para>
    此檔案包含附加了網域名稱的完全合格的主機名稱。機器開機時數個程序檔會讀取該檔案。它只能包含一行，其中設定了主機名稱。
   </para><indexterm class="endofrange" startref="idx.networks_configuration_files"/>
  </sect3>
 </sect2>

 <sect2 id="sec.basicnet.manconf.testing">
  <title>測試與組態</title>
  <para>
   將組態寫入您的組態檔案之前，可先進行測試。若要設定測試組態，請使用 <command>ip</command> 指令。若要測試連接，請使用 <command>ping</command> 指令。同時也可使用較舊的組態工具，如 <command>ifconfig</command> 和 <command>route</command>。
  </para>
  <para>
   <command>ip</command>、<command>ifconfig</command> 和 <command>route</command> 指令會直接變更網路組態，不會將其儲存到組態檔案中。除非您將組態輸入正確的組態檔案，否則重新開機之後網路組態的變更就會遺失。
  </para>
  <sect3 id="sec.basicnet.manconf.ip">
   <title>使用 <command>ip</command> 設定網路介面</title><indexterm> <primary>指令</primary> <secondary>ip</secondary> </indexterm>
   
   <para>
    <command>ip</command> 是一項可顯示及設定網路裝置、路由、規則路由和通道的工具。
   </para>
   <para>
    <command>ip</command> 是非常複雜的工具。其一般語法是 <command>ip</command> <option><replaceable>options</replaceable> <replaceable>object</replaceable> <replaceable>command</replaceable></option>。您可使用下列物件：
   </para>
   <variablelist>
    <varlistentry>
     <term>link</term>
     <listitem>
      <para>
       此物件代表網路裝置。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>address</term>
     <listitem>
      <para>
       此物件代表裝置的 IP 位址。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>鄰接</term>
     <listitem>
      <para>
       此物件代表 ARP 或 NDISC 快取項目。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>route</term>
     <listitem>
      <para>
       此物件代表路由表格項目。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>rule</term>
     <listitem>
      <para>
       此物件代表路由原則資料庫中的規則。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>maddress</term>
     <listitem>
      <para>
       此物件代表多重廣播位址。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>mroute</term>
     <listitem>
      <para>
       此物件代表多重廣播路由快取項目。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>tunnel</term>
     <listitem>
      <para>
       此物件表示 IP 上的通道。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    若未提供指令，會使用預設指令 (通常是 <command>list</command>)。
   </para>
   <para>
    您可使用 <command>ip link set</command> <option><replaceable>device_name</replaceable></option> <command><replaceable>command</replaceable></command> 指令變更裝置狀態。例如，若要停用裝置 eth0，請輸入 <command>ip link set</command> <option>eth0 down</option>。若要重新啟用，請使用 <command>ip link set</command> <option>eth0 up</option>。
   </para>
   <para>
    啟用裝置之後，就可加以設定。若要設定 IP 位址，請使用 <command>ip addr add</command> <option><replaceable>ip_address</replaceable> + dev <replaceable>device_name</replaceable></option>。例如，若要將介面 eth0 的 IP 位址以標準廣播 (選項 <option>brd</option>) 設定為 192.168.12.154/30，請輸入 <command>ip addr</command> <option>add 192.168.12.154/30 brd + dev eth0</option>。
   </para>
   <para>
    若要具備作用中連接，必須設定預設閘道。若要為您的系統設定閘道，請輸入 <command>ip route add</command> <option>閘道 IP 位址</option>。若要轉換某個 IP 位址，請使用 <command>nat</command>: <command>ip route add nat</command> <option>ip_address</option> <command>via</command> <option>other_ip_address</option>。
   </para>
   <para>
    若要顯示所有裝置，請使用 <command>ip link ls</command>。若只希望顯示運作中介面，請使用 <command>ip link ls up</command>。若要列印裝置的介面統計值，請輸入 <command>ip -s link ls</command> <option>device_name</option>。若要檢是您裝置的位址，請輸入 <command>ip addr</command>。在 <command>ip addr</command> 的輸出中同時也可找到您裝置的 MAC 位址相關資訊。若要顯示所有路由，請使用 <command>ip route show</command>。
   </para>
   <para>
    如需有關使用 <command>ip</command> 的詳細資訊，請輸入 <command>ip</command> <option>help</option> 或參閱 <systemitem>ip(8)</systemitem> man 頁面。<option>help</option> 選項也適用於所有 <command>ip</command> 子指令。例如，如果您需要 <command>ip</command> <option>addr</option> 的說明，請輸入 <command>ip</command> <option>addr help</option>。<filename>/usr/share/doc/packages/iproute2/ip-cref.pdf</filename> 中提供了有關 <command>ip</command> 的說明。
   </para>
  </sect3>
  <sect3 id="sec.basicnet.manconf.testingping">
   <title>以 ping 測試連接</title><indexterm> <primary>指令</primary> <secondary>ping</secondary> </indexterm> <indexterm> <primary>ping</primary> </indexterm>
   <para>
    <command>ping</command> 指令是測試 TCP/IP 連接運作的標準工具。其使用 ICMP 通訊協定，將小型資料封包 ECHO_REQUEST 傳送至目的地主機，要求立即回應。如果有作用，<command>ping</command> 會顯示訊息，指示網路連結基本上是正常的。
   </para>
   <para>
    <command>ping</command> 不僅會測試兩台電腦之間能否連接，還會提供一些關於連接品質的基本資訊。您可在 <xref linkend="ex.basicnet.manconf.ping"/> 中看到 <command>ping</command> 輸出的一些範例。倒數第二行包含送出的封包數、封包遺失率以及執行 <command>ping</command> 總共花費的時間等資訊。
   </para>
   <para>
    對於目的地，可使用主機名稱或 IP 位址，例如 <command>ping</command> <option>example.com</option> 或 <command>ping</command> <option>192.168.3.100</option>。程式會持續傳送封包，直到您按下 <keycombo><keycap>Ctrl</keycap> <keycap>C</keycap></keycombo> 為止。
   </para>
   <para>
    若您只需要檢查連接功能性，您可以 <option>-c</option> 選項限定封包數量。例如，若要將 ping 限制於三個封包，請輸入 <command>ping</command> <option>-c 3 example.com</option>。
   </para>
   <example id="ex.basicnet.manconf.ping">
    <title>指令 ping 的輸出</title>
<screen>ping -c 3 example.com
PING example.com (192.168.3.100) 56(84) bytes of data.
64 bytes from example.com (192.168.3.100): icmp_seq=1 ttl=49 time=188 ms
64 bytes from example.com (192.168.3.100): icmp_seq=2 ttl=49 time=184 ms
64 bytes from example.com (192.168.3.100): icmp_seq=3 ttl=49 time=183 ms
--- example.com ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2007ms
rtt min/avg/max/mdev = 183.417/185.447/188.259/2.052 ms</screen>
   </example>
   <para>
    兩個封包之間的預設間隔為一秒。若要變更間隔，可以使用 ping 提供的選項 <option>-i</option>。例如，若要將 ping 間隔增加到十秒，請輸入 <command>ping</command> <option>-i 10 example.com</option>。
   </para>
   <para>
    在具備多網路裝置的系統中，透過特定介面位址傳送 ping 非常實用。若要執行此動作，請使用 <option>-I</option> 選項以及所選裝置的名稱，例如 <command>ping</command> <option>-I wlan1 example.com</option>。
   </para>
   <para>
    如需使用 ping 的選項與詳細資訊，請輸入 <command>ping</command> <option>-h</option> 或參閱 <systemitem>ping (8)</systemitem> man 頁面。
   </para>
   <tip>
    <title>Ping IPv6 位址</title>
    <para>
     對於 IPv6 位址，請使用 <command>ping6</command> 指令。請注意，若要 ping 連結-本機位址，必須使用 <option>-I</option> 指定介面。如果該位址可透過 <literal>eth1</literal> 存取，則可以使用以下指令實現目的：
    </para>
<screen>ping6 -I eth1 fe80::117:21ff:feda:a425</screen>
   </tip>
  </sect3>
  <sect3 id="sec.basicnet.manconf.testingifconfig">
   <title>以 ifconfig 設定網路</title><indexterm> <primary>指令</primary> <secondary>ifconfig</secondary> </indexterm>
   <para>
    <command>ifconfig</command> 是一項網路組態工具。
   </para>
   <note>
    <title><command/>ifconfig 和 ip<command/></title>
    <para>
     <command>ifconfig</command> 工具已過時。請改用 <command>ip</command>。與 <command>ip</command> 相反，<command>ifconfig</command> 只能用於介面組態。它將介面名稱限制為 9 個字元。
    </para>
   </note>
   <para>
    無疑，<command>ifconfig</command> 顯示的是目前作用中介面的狀態。如您在<xref linkend="ex.basicnet.manconf.ifconfig"/> 中所見，<command>ifconfig</command> 的輸出排列整齊並且內容詳盡。輸出的第一行亦包含您裝置的 MAC 位址 (<option>HWaddr</option> 的值) 等相關資訊。
   </para>
   <example id="ex.basicnet.manconf.ifconfig">
    <title><command>ifconfig</command> 指令的輸出</title>
<screen>eth0      Link encap:Ethernet  HWaddr 00:08:74:98:ED:51
          inet6 addr: fe80::208:74ff:fe98:ed51/64 Scope:Link
          UP BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:634735 errors:0 dropped:0 overruns:4 frame:0
          TX packets:154779 errors:0 dropped:0 overruns:0 carrier:1
          collisions:0 txqueuelen:1000
          RX bytes:162531992 (155.0 Mb)  TX bytes:49575995 (47.2 Mb)
          Interrupt:11 Base address:0xec80

lo        Link encap:Local Loopback
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:16436  Metric:1
          RX packets:8559 errors:0 dropped:0 overruns:0 frame:0
          TX packets:8559 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0
          RX bytes:533234 (520.7 Kb)  TX bytes:533234 (520.7 Kb)    

wlan1     Link encap:Ethernet  HWaddr 00:0E:2E:52:3B:1D
          inet addr:192.168.2.4  Bcast:192.168.2.255  Mask:255.255.255.0
          inet6 addr: fe80::20e:2eff:fe52:3b1d/64 Scope:Link
          UP BROADCAST NOTRAILERS RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:50828 errors:0 dropped:0 overruns:0 frame:0
          TX packets:43770 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:45978185 (43.8 Mb)  TX bytes:7526693 (7.1 MB)</screen>
   </example>
   <para>
    如需有關使用 <command>ifconfig</command> 的選項與詳細資訊，請輸入 <command>ifconfig</command> <option>-h</option> 或參閱 <systemitem>ifconfig (8)</systemitem> man 頁面。
   </para>
  </sect3>
  <sect3>
   <title>使用 <command>route</command> 設定路由</title><indexterm> <primary>指令</primary> <secondary>route</secondary> </indexterm>
   <para>
    <command>route</command> 是操作 IP 路由表格的程式。您可使用此指令檢視您的路由組態，以及新增或移除路由。
   </para>
   <note>
    <title><command/>route 與 ip<command/></title>
    <para>
     <command>route</command> 這個程式已過時。請改用 <command>ip</command>。
    </para>
   </note>
   <para>
    <command>若您需要快速又易於理解的路由組態資訊以判別路由問題，route 是特別實用的工具。</command>若要檢視您目前的路由組態，請以 <systemitem class="username">root</systemitem> 使用者身分輸入 <command>route</command> <option>-n</option>。
   </para>
   <example id="ex.basicnet.manconf.route">
    <title><command>route <option>-n</option></command> 指令的輸出</title>
<screen><?dbsuse-fo font-size="7pt"?>

route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags   MSS Window  irtt Iface
10.20.0.0       *               255.255.248.0   U         0 0          0 eth0
link-local      *               255.255.0.0     U         0 0          0 eth0
loopback        *               255.0.0.0       U         0 0          0 lo
default         styx.exam.com   0.0.0.0         UG        0 0          0 eth0</screen>
   </example>
   <para>
    如需使用 route 的選項與詳細資訊，請輸入 <command>route</command> <option>-h</option> 或參閱 <systemitem>route (8)</systemitem> man 頁面。
   </para>
  </sect3>
 </sect2>

 <sect2 id="sec.basicnet.manconf.scripts">
  <title>啟動程序檔</title><indexterm> <primary>程序檔</primary> <secondary>init.d</secondary> </indexterm>
  <para>
   除了上述的組態檔之外，還有在機器開機時載入網路程式的各種程序檔。只要系統切換到其中一個 <emphasis>multiuser runlevels</emphasis>，就會啟動這些程序檔。在 <xref linkend="tab.netz.start.skripte"/> 中提供了一些程序檔的說明。
  </para>
  <table id="tab.netz.start.skripte">
<?dbsuse-latex tablehead="p{.4\linewidth}p{.55\linewidth}"?>


   <title>網路程式的一些啟動程序檔</title>
   <tgroup cols="2" align="left">
    <tbody>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/network</filename><indexterm><primary>程序檔</primary><secondary>init.d</secondary> <tertiary>網路</tertiary></indexterm>
       </para>
      </entry>
      <entry>
       <para>
        此程序檔會處理網路介面的組態。如果未啟動<command>網路</command>服務，則不會實作任何網路介面。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/xinetd</filename> <indexterm> <primary>程序檔</primary> <secondary>init.d</secondary> <tertiary>xinetd</tertiary> </indexterm>
       </para>
      </entry>
      <entry>
       <para>
        啟動 xinetd。xinetd 可以用來讓伺服器服務能夠在系統上使用。例如，只要開啟 FTP 連接，它即可啟動 vsftpd。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/rpcbind</filename> <indexterm> <primary>程序檔</primary> <secondary>init.d</secondary> <tertiary>rpcbind</tertiary> </indexterm>
       </para>
      </entry>
      <entry>
       <para>
        啟動可將 RPC 程式號碼轉換為通用位址的 rpcbind 公用程式。NFS 伺服器等 RPC 服務需要用到。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/nfsserver</filename><indexterm><primary>scripts</primary><secondary>init.d</secondary><tertiary>nfsserver </tertiary></indexterm>
       </para>
      </entry>
      <entry>
       <para>
        啟動 NFS 伺服器。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/postfix</filename> <indexterm> <primary>程序檔</primary> <secondary>init.d</secondary> <tertiary>postfix</tertiary> </indexterm>
       </para>
      </entry>
      <entry>
       <para>
        控制後置程序。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/ypserv</filename><indexterm><primary>scripts</primary><secondary>init.d</secondary><tertiary>ypserv </tertiary></indexterm>
       </para>
      </entry>
      <entry>
       <para>
        啟動 NIS 伺服器。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/etc/init.d/ypbind</filename><indexterm><primary>scripts</primary><secondary>init.d</secondary> <tertiary>ypbind</tertiary></indexterm>
       </para>
      </entry>
      <entry>
       <para>
        啟動 NIS 用戶端。
       </para>
      </entry>
     </row>
    </tbody>
   </tgroup>
  </table><indexterm startref="idx.networks_configuring" class="endofrange"/><indexterm startref="idx.configuring_networks_manually" class="endofrange"/>
 </sect2>
</sect1>
