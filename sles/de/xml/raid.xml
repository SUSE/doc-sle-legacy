<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sect1 PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN"
"novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<sect1 xml:base="raid.xml" id="sec-yast2-system-raid">
 <title>Soft-RAID-Konfiguration</title><indexterm> <primary>YaST</primary> <secondary>RAID</secondary></indexterm><indexterm> <primary>RAID</primary> <secondary>YaST</secondary></indexterm><indexterm> <primary>soft RAID</primary> <see>RAID</see></indexterm>



 <para>
  Der Sinn eines RAID (Redundant Array of Independent Disks) ist es, mehrere Festplattenpartitionen in einer großen <emphasis>virtuellen</emphasis> Festplatte zusammenzufassen, um die Leistung und/oder die Datensicherheit zu optimieren. Die meisten RAID-Controller verwenden das SCSI-Protokoll, da es eine größere Anzahl von Festplatten effektiver als das IDE-Protokoll ansprechen kann. Er eignet sich auch besser zur parallelen Kommandoverarbeitung. Es gibt einige RAID-Controller, die IDE- oder SATA-Festplatten unterstützen. Soft RAID bietet die Vorteile von RAID-Systemen ohne die zusätzlichen Kosten für hardwareseitige RAID-Controller. Dies geht allerdings zu Lasten von Prozessorzeit und Arbeitsspeicher, weshalb Soft RAID für Hochleistungssysteme nicht wirklich geeignet ist.
 </para>

 <para>
  Bei <phrase role="productname"><phrase os="sles">SUSE® Linux Enterprise Server</phrase></phrase> können Sie mehrere Festplatten zu einem einzigen Soft RAID-System kombinieren. RAID bietet verschiedene Strategien für das Kombinieren mehrerer Festplatten in einem RAID-System, von der jede andere Ziele, Vorteile und Merkmale aufweist. Diese Variationen werden im Allgemeinen als <emphasis>RAID-Level</emphasis> bezeichnet.
 </para>

 <para>
  Es gibt folgende gängige RAID-Level:
 </para>

 <variablelist>
  <varlistentry>
   <term>RAID 0</term>
   <listitem>
    <para>
     Dieser Level verbessert die Leistung des Datenzugriffs, indem er die einzelnen Dateiblöcke über mehrere Festplattenlaufwerke verteilt. Im Grunde ist dies gar kein RAID, da es keine Datensicherung gibt, doch die Bezeichnung <emphasis>RAID 0 </emphasis> hat sich für diese Art von System eingebürgert. Bei RAID 0 werden mindestens zwei Festplatten zusammengefasst. Die Leistung wurde zwar verbessert, aber wenn auch nur eine der Festplatten ausfällt, ist das RAID-System zerstört und Ihre Daten sind verloren.
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term>RAID 1</term>
   <listitem>
    <para>
     Dieser Level bietet eine ausreichende Sicherheit für Ihre Daten, weil sie 1:1 auf eine andere Festplatte kopiert werden. Dies wird als <emphasis>Festplattenspiegelung</emphasis> bezeichnet. Ist eine Festplatte zerstört, steht eine Kopie des Inhalts auf einer anderen zur Verfügung. Solange noch eine Festplatte intakt ist, können alle anderen fehlerhaft sein, ohne dass Daten verloren gehen. Wenn der Schaden jedoch nicht erkannt wird, können die beschädigten Daten auf die unbeschädigte Festplatte gespiegelt werden. Dadurch können die Daten ebenfalls verloren gehen. Verglichen mit dem Zugriff auf einzelne Festplatten (10 bis 20% langsamer) wird die Schreibgeschwindigkeit beim Kopiervorgang beeinträchtigt, doch der Lesezugriff ist erheblich schneller im Vergleich zu normalen physischen Festplatten. Der Grund besteht darin, dass die doppelten Daten parallel abgesucht werden können. Im Allgemeinen kann gesagt werden, dass Level 1 fast eine doppelt so schnelle Leseübertragungsrate und nahezu dieselbe Schreibübertragungsrate wie einzelne Festplatten bietet.
    </para>
   </listitem>
  </varlistentry>

  <varlistentry>
   <term>RAID 5</term>
   <listitem>
    <para>
     RAID 5 ist ein optimierter Kompromiss aus Level 0 und Level 1, was Leistung und Redundanz betrifft. Der nutzbare Festplattenplatz entspricht der Anzahl der eingesetzten Festplatten minus einer. Die Daten werden genau wie bei RAID 0 auf der Festplatte verteilt. <emphasis>Paritätsblocks</emphasis>, die auf einer Partition erstellt wurden, sind aus Sicherheitsgründen vorhanden. Diese werden mit XOR miteinander verknüpft, sodass sich beim Ausfall einer Partition durch den dazugehörigen Paritätsblock der Inhalt rekonstruieren lässt. Bei RAID 5 ist zu beachten, dass nicht mehrere Festplatten gleichzeitig ausfallen dürfen. Wenn eine Festplatte ausfällt, muss sie schnellstmöglich ausgetauscht werden, da sonst Datenverlust droht.
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term>RAID 6</term>
   <listitem>
    <para>
     RAID 6 stellt hinsichtlich Zuverlässigkeit eine weitere Steigerung des RAID-Systems dar. Auf diesem Level kann das Array selbst nach einem Ausfall von zwei Festplatten noch rekonstruiert werden. Für ein RAID 6-Array werden mindestens vier Festplatten benötigt. Allerdings benötigt diese Konfiguration als Software-RAID sehr viel CPU-Zeit und Arbeitsspeicher.
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term>RAID 10 (RAID 1+0)</term>
   <listitem>
    <para>
     Diese RAID-Implementierung kombiniert Funktionen von RAID 0 und RAID 1: Die Daten werden zuerst in separaten Festplatten-Arrays gespiegelt, die in ein neues Array vom Typ RAID 0 eingefügt werden. In jedem RAID 1-Subarray kann eine Festplatte ohne Datenverlust ausfallen. Für RAID 10 sind mindestens vier Festplatten und eine gerade Anzahl an Festplatten erforderlich. Dieser RAID-Typ wird für Datenbankanwendungen verwendet, bei denen eine hohe Last zu erwarten ist.
    </para>
   </listitem>
  </varlistentry>
  <varlistentry>
   <term>Weitere RAID-Level</term>
   <listitem>
    <para>
     Es wurden noch weitere RAID-Level entwickelt (RAID 2, RAID 3, RAID 4, RAIDn, RAID 10, RAID 0+1, RAID 30, RAID 50 usw.), wobei einige von diesen proprietäre Implementierungen verschiedener Hardwarehersteller sind. Diese Level sind nicht sehr weit verbreitet und werden aus diesem Grund hier nicht näher erläutert. 
    </para>
   </listitem>
  </varlistentry>
 </variablelist>

 <sect2 id="sec-yast2-system-raid-conf">
  <title>Soft-RAID-Konfiguration mit YaST</title>
  <para>
   Zur YaST-<guimenu>RAID</guimenu>-Konfiguration gelangen Sie über den YaST-Expertenmodus des Partitionierungsmoduls, der in <xref linkend="sec-yast2-i-y2-part-expert"/> beschrieben ist. Mit diesem Partitionierungswerkzeug können Sie vorhandene Partitionen bearbeiten und löschen sowie neue Partitionen erstellen, die mit Soft-RAID verwendet werden sollen:
  </para>
  <procedure>
   <step performance="required">
    <para>
     Wählen Sie unter <guimenu>Festplatten</guimenu> eine Festplatte aus.
    </para>
   </step>
   <step performance="required">
    <para>
     Wechseln Sie in den Karteireiter <guimenu>Partitionen</guimenu>.
    </para>
   </step>
   <step performance="required">
    <para>
     Klicken Sie auf <guimenu>Hinzufügen</guimenu> und geben Sie die gewünschte Größe der RAID-Partition auf dieser Platte ein.
    </para>
   </step>
   <step performance="required">
    <para>
     Verwenden Sie <guimenu>Partition nicht formatieren</guimenu> und ändern Sie die <guimenu>Dateisystem-ID</guimenu> in <guimenu>0xFD Linux RAID</guimenu>. Hängen Sie diese Partition nicht ein.
    </para>
   </step>
   <step performance="required">
    <para>
     Wiederholen Sie diesen Vorgang, bis alle gewünschten physischen Volumes auf den verfügbaren Platten definiert sind.
    </para>
   </step>
  </procedure>
  <para>
   Für RAID 0 und RAID 1 sind mindestens zwei Partitionen erforderlich, für RAID 1 in der Regel exakt zwei. Bei RAID 5 sind mindestens drei Partitionen erforderlich, bei RAID 6 und RAID 10 dagegen mindestens vier Partitionen. Es empfiehlt sich, nur Partitionen derselben Größe zu verwenden. Die RAID-Partitionen sollten sich auf verschiedenen Festplatten befinden, um das Risiko eines Datenverlusts gering zu halten, falls eine (RAID 1 und 5) defekt ist, und die Leistung von RAID 0 zu optimieren. Nachdem alle gewünschten Partitionen für RAID erstellt sind, klicken Sie auf <menuchoice><guimenu>RAID</guimenu><guimenu>RAID hinzufügen</guimenu></menuchoice>, um mit der RAID-Konfiguration zu beginnen.
  </para>
  <para>
   Wählen Sie im nächsten Dialogfeld zwischen RAID-Level 0, 1, 5, 6 oder 10. Wählen Sie dann alle Partitionen mit dem Typ <quote>Linux RAID</quote> oder <quote>Linux native</quote> aus, die das RAID-System benutzen soll. Swap- oder DOS-Partitionen werden nicht angezeigt.
  </para>
  <tip>
   <para>
    Bei RAID-Typen, für die die Reihenfolge beim Hinzufügen der Festplatten wichtig ist, können Sie die einzelnen Festplatten mit den Buchstaben A bis E versehen. Klicken Sie auf die Schaltfläche <guimenu>Einstufen</guimenu>, wählen Sie die Festplatte aus und klicken Sie auf eine der Schaltflächen <guimenu>Class X (Klasse X)</guimenu> (X bezeichnet den zuzuweisenden Buchstaben für die Festplatte). Weisen Sie alle verfügbaren RAID-Festplatten auf diese Weise zu und bestätigen Sie mit <guimenu>OK</guimenu>. Sie können die klassifizierten Festplatten komfortabel mit den Schaltflächen <guimenu>Sortiert</guimenu> und <guimenu>Interleaved</guimenu> sortieren oder auch ein Sortierschema aus einer Textdatei mit der Schaltfläche <guimenu>Schemadatei</guimenu> hinzufügen.
   </para>
  </tip>
  <figure id="fig-yast2-system-raid-conf">
   <title>RAID-Partitionen</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="yast2_raid4.png" width="75%" format="PNG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="yast2_raid4.png" width="75%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
  <para>
   Um dem ausgewählten RAID-Volume eine zuvor nicht zugewiesene Partition zuzuweisen, klicken Sie zuerst auf die Partition und anschließend auf <guimenu>Hinzufügen</guimenu>. Weisen Sie alle für RAID reservierten Partitionen zu. Anderenfalls bleibt der Speicherplatz in den Partitionen unbenutzt. Klicken Sie nach dem Zuweisen aller Partitionen auf <guimenu>Weiter</guimenu>, um die verfügbaren <guimenu>RAID-Optionen</guimenu> auszuwählen.
  </para>
  <para>
   Legen Sie in diesem letzten Schritt das zu verwendende Dateisystem sowie die Verschlüsselung und den Einhängepunkt für das RAID-Volume fest. Wenn Sie die Konfiguration mit <guimenu>Verlassen</guimenu> abgeschlossen haben, sind im Expertenmodus des Partitionierungsmoduls das Gerät <filename>/dev/md0</filename> und andere Geräte mit <emphasis>RAID</emphasis> gekennzeichnet.
  </para>
 </sect2>

 <sect2>
  <title>Fehlersuche</title>
  <para>
   Prüfen Sie die Datei <filename>/proc/mdstat</filename>, um festzustellen, ob eine RAID-Partition beschädigt ist. Grundsätzliche Vorgehensweise bei einem Systemfehler ist es, Ihr Linux-System herunterzufahren und die defekte Festplatte durch eine neue, gleichartig partitionierte Platte zu ersetzen. Starten Sie das System anschließend neu und geben Sie den Befehl <command>mdadm /dev/mdX --add /dev/sdX</command> ein. Ersetzen Sie „X“ durch die entsprechende Geräte-ID. Damit wird die neue Festplatte automatisch in das RAID-System integriert und vollautomatisch rekonstruiert.
  </para>
  <para>
   Beachten Sie, dass Sie zwar bei einem Neuaufbau auf alle Daten zugreifen können, jedoch bis zum vollständigen RAID-Neuaufbau einige Probleme in der Leistung auftreten können.
  </para>
 </sect2>

<?dbfo-need height="10em"?>



 <sect2>
  <title>Weiterführende Informationen</title>
  <para>
   Weitere Informationen sowie eine Anleitung zur Konfiguration von Soft-RAID finden Sie in den angegebenen HOWTO-Dokumenten unter:
  </para>
  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     <filename>/usr/share/doc/packages/mdadm/Software-RAID.HOWTO.html</filename>
    </para>
   </listitem>
   <listitem>
    <para>
     <ulink url="http://raid.wiki.kernel.org"/>
    </para>
   </listitem>
  </itemizedlist>
  <para>
   Linux-RAID-Mailinglisten sind beispielsweise unter folgender URL verfügbar: <ulink url="http://marc.info/?l=linux-raid"/>.
  </para>
 </sect2>
</sect1>
