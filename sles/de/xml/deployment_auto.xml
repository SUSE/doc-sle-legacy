<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE chapter PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN"
"novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<chapter xml:base="deployment_auto.xml" id="cha-deployment-autoinst" os="sled;sles">
 <title>Automatisierte Installation</title>
 <para>
  AutoYaST ermöglicht es Ihnen, SUSE® Linux Enterprise auf einer großen Anzahl von Computern gleichzeitig zu installieren. Die AutoYaST-Technologie bietet große Flexibilität zur Anpassung von Implementierungen für heterogene Hardware. In diesem Kapitel erfahren Sie, wie eine einfache automatisierte Installation vorbereitet wird und ein komplexeres Szenario mit unterschiedlichen Hardwaretypen und Installationszwecken gehandhabt wird.
 </para>
 <sect1 id="sec-deployment-autoinst-simple">
  <title>Einfache Masseninstallation</title>

  <important>
   <title>Identische Hardware</title>
   <para>
    Dieses Szenario setzt voraus, dass Sie SUSE Linux Enterprise auf einer Reihe von Computern mit genau derselben Hardwarekonfiguration installieren.
   </para>
  </important>

  <para>
   Zur Vorbereitung einer AutoYaST-Masseninstallation gehen Sie wie folgt vor:
  </para>

  <procedure>
   <step performance="required">
    <para>
     Erstellen Sie ein AutoYaST-Profil mit den erforderlichen Installationsdetails für Ihr Szenario, wie unter <xref linkend="sec-deployment-autoinst-simple-profile"/> beschrieben.
    </para>
   </step>
   <step performance="required">
    <para>
     Bestimmen Sie die Quelle für das AutoYaST-Profil und den Parameter, der an die Installationsroutinen übergeben werden soll (siehe<xref linkend="sec-deployment-autoinst-simple-dist"/>).
    </para>
   </step>
   <step performance="required">
    <para>
     Bestimmen Sie die Quelle für die SUSE Linux Enterprise-Installationsdaten, wie unter <xref linkend="sec-deployment-autoinst-simple-source"/> beschrieben.
    </para>
   </step>
   <step performance="required">
    <para>
     Richten Sie das Boot-Szenario für die automatische Installation, wie unter <xref linkend="sec-deployment-autoinst-simple-boot"/> beschrieben ein.
    </para>
   </step>
   <step performance="required">
    <para>
     Übergeben Sie die Kommandozeile an die Installationsroutinen, indem Sie die Parameter manuell hinzufügen oder eine <filename>info</filename>-Datei erstellen (siehe <xref linkend="sec-deployment-autoinst-simple-info"/>).
    </para>
   </step>
   <step performance="required">
    <para>
     Starten Sie die automatische Installation, wie unter <xref linkend="sec-deployment-autoinst-simple-install"/> beschrieben.
    </para>
   </step>
  </procedure>

  <sect2 id="sec-deployment-autoinst-simple-profile">
   <title>Erstellen eines AutoYaST-Profils</title>
   <para>
    Ein AutoYaST-Profil weist AutoYaST an, was installiert und wie das installierte System konfiguriert werden soll, um am Ende ein voll funktionsbereites System zu ergeben. Ein solches Profil kann auf verschiedene Weisen erstellt werden:
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      Klonen einer frischen Installation von einem Referenzcomputer auf einer Reihe von identischen Computern
     </para>
    </listitem>
    <listitem>
     <para>
      Erstellung und Änderung eines Profils mithilfe der AutoYaST GUI nach Ihren Anforderungen
     </para>
    </listitem>
    <listitem>
     <para>
      Verwendung eines XML-Editors zur Erstellung eines ganz neuen Profils
     </para>
    </listitem>
   </itemizedlist>
   <para>
    Gehen Sie wie folgt vor, um eine frische Referenzinstallation zu klonen:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Führen Sie eine normale Installation aus.
     </para>
    </step>
    <step performance="required">
     <para>
      Nachdem Sie die Hardware-Konfiguration abgeschlossen und die Versionshinweise gelesen haben, aktivieren Sie die Option <guimenu>Dieses System für AutoYaST klonen</guimenu>, wenn sie noch nicht standardmäßig aktiviert ist. Dadurch wird ein einsatzbereites Profil namens <filename>/root/autoyast.xml</filename> erstellt, das zur Erstellung mehrerer Klone dieser speziellen Installation eingesetzt werden kann.
     </para>
    </step>
   </procedure>
   <para>
    Gehen Sie wie folgt vor, um über die AutoYaST GUI aus einer bestehenden Systemkonfiguration ein Profil zu erstellen und dieses nach Bedarf zu verändern:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Starten Sie YaST als <systemitem class="username">root</systemitem>.
     </para>
    </step>
    <step performance="required">
     <para>
      Wählen Sie <menuchoice><guimenu>Miscellaneous</guimenu><guimenu> (Andere) </guimenu></menuchoice>Autoinstallation, um die AutoYaST-Bedienoberfläche zu starten.
     </para>
    </step>
    <step performance="required">
     <para>
      Wählen Sie <menuchoice><guimenu>Werkzeuge</guimenu><guimenu>Create Reference Control File</guimenu> </menuchoice>(Referenzkontrolldatei erstellen), um AutoYaST für die Spiegelung der aktuellen Systemkonfiguration in ein AutoYaST-Profil vorzubereiten.
     </para>
    </step>
    <step performance="required">
     <para>
      Zusätzlich zu den Standardressourcen (wie Bootloader, Partitionierung und Software-Auswahl) können Sie dem Profil zahlreiche andere Aspekte Ihres Systems hinzufügen, indem Sie die Elemente in der Liste <guimenu>Referenzkontrolldatei erstellen</guimenu> aktivieren.
     </para>
    </step>
    <step performance="required">
     <para>
      Klicken Sie auf <guimenu>Erstellen</guimenu>, damit YaST alle Systeminformationen sammelt und in ein neues Profil schreibt.
     </para>
    </step>
    <step performance="required">
     <para>
      Wählen Sie eine der folgenden Möglichkeiten, um fortzufahren:
     </para>
     <itemizedlist mark="bullet" spacing="normal">
      <listitem>
       <para>
        Wenn das Profil abgeschlossen ist und Ihren Anforderungen entspricht, wählen Sie <menuchoice><guimenu>Datei</guimenu><guimenu>Speichern unter</guimenu></menuchoice> und geben Sie einen Dateinamen für das Profil ein, beispielsweise <filename>autoyast.xml</filename>.
       </para>
      </listitem>
      <listitem>
       <para>
        Ändern Sie das Referenzprofil durch Auswahl der entsprechenden Konfigurationsaspekte (wie <quote>Hardware/Drucker</quote>) in der Baumansicht auf der linken Seite und klicken Sie dann auf <guimenu>Konfigurieren</guimenu>. Das entsprechende YaST-Modul wird gestartet, aber die Einstellungen werden nicht auf Ihr System angewendet, sondern in das AutoYaST-Profil geschrieben. Wählen Sie nach Abschluss dieses Vorgangs <menuchoice><guimenu>Datei</guimenu><guimenu>Speichern unter</guimenu></menuchoice> und geben Sie einen passenden Namen für das Profil ein.
       </para>
      </listitem>
     </itemizedlist>
    </step>
    <step performance="required">
     <para>
      Schließen Sie das AutoYaST-Modul mit <menuchoice><guimenu>Datei</guimenu><guimenu>Beenden</guimenu> </menuchoice>.
     </para>
    </step>
   </procedure>
   <figure>
    <title>Bearbeiten eines AutoYaST-Profils in der AutoYaST-Bedienoberfläche</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="autoyast_gui.png" width="75%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="autoyast_gui.png" width="75%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </sect2>

  <sect2 id="sec-deployment-autoinst-simple-dist">
   <title>Verteilen des Profils und Festlegen der autoyast-Parameter</title>
   <para>
    Das AutoYaST-Profil kann auf verschiedene Weisen verteilt werden. Je nachdem, welches Protokoll zur Verteilung der Profildaten eingesetzt wird, werden verschiedene AutoYaST-Parameter verwendet, um den Installationsroutinen auf dem Client den Profilspeicherort bekannt zu geben. Der Speicherort des Profils wird an die Installationsroutinen durch die Boot-Eingabeaufforderung oder eine <filename>info</filename>-Datei übergeben, die beim Booten geladen wird. Mit den zur Verfügung stehenden Optionen können Sie
   </para>
   <informaltable>
    <tgroup cols="3">
     <thead>
      <row>
       <entry>
        <para>
         Profilspeicherort
        </para>
       </entry>
       <entry>
        <para>
         Parameter
        </para>
       </entry>
       <entry>
        <para>
         Beschreibung
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para>
         Datei
        </para>
       </entry>
       <entry>
        <para>
         <filename>autoyast=file://<replaceable>pfad</replaceable></filename>
        </para>
       </entry>
       <entry>
        <para>
         Die Installationsroutinen suchen im angegebenen Pfad nach der Kontrolldatei (relativ zum Quell-Root-Verzeichnis – <filename>file:///autoyast.xml</filename>, wenn es sich im Root-Verzeichnis einer CD-ROM befindet).
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         Gerät
        </para>
       </entry>
       <entry>
        <para>
         <filename>autoyast=device://<replaceable>pfad</replaceable></filename>
        </para>
       </entry>
       <entry>
        <para>
         Bewirkt, dass die Installationsroutinen auf einem Speichergerät nach der Kontrolldatei suchen. Es wird nur der Gerätename benötigt – <filename>/dev/sda1</filename> ist falsch, verwenden Sie stattdessen <filename>sda1</filename>.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         Diskette
        </para>
       </entry>
       <entry>
        <para>
         <filename>autoyast=floppy://<replaceable>pfad</replaceable></filename>
        </para>
       </entry>
       <entry>
        <para>
         Bewirkt, dass die Installationsroutinen auf einer Diskette im Diskettenlaufwerk nach der Kontrolldatei suchen. Diese Option ist besonders hilfreich, wenn Sie von einer CD-ROM booten möchten.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         NFS
        </para>
       </entry>
       <entry>
        <para>

         <filename>autoyast=nfs://<replaceable>server</replaceable>/<replaceable>pfad</replaceable></filename>
        </para>
       </entry>
       <entry>
        <para>
         Lässt die Installationsroutinen die Kontrolldatei von einem NFS-Server abrufen.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         HTTP
        </para>
       </entry>
       <entry>
        <para>

         <filename>autoyast=http://<replaceable>server</replaceable>/<replaceable>pfad</replaceable></filename>
        </para>
       </entry>
       <entry>
        <para>
         Lässt die Installationsroutinen die Kontrolldatei von einem HTTP-Server abrufen.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         HTTPS
        </para>
       </entry>
       <entry>
        <para>

         <filename>autoyast=https://<replaceable>server</replaceable>/<replaceable>pfad</replaceable></filename>
        </para>
       </entry>
       <entry>
        <para>
         Lässt die Installationsroutinen die Kontrolldatei von einem HTTPS-Server abrufen.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         TFTP
        </para>
       </entry>
       <entry>
        <para>

         <filename>autoyast=tftp://<replaceable>server</replaceable>/<replaceable>pfad</replaceable></filename>
        </para>
       </entry>
       <entry>
        <para>
         Lässt die Installationsroutinen die Kontrolldatei von einem TFTP-Server abrufen.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         FTP
        </para>
       </entry>
       <entry>
        <para>

         <filename>autoyast=ftp://<replaceable>server</replaceable>/<replaceable>pfad</replaceable></filename>
        </para>
       </entry>
       <entry>
        <para>
         Lässt die Installationsroutinen die Kontrolldatei von einem FTP-Server abrufen.
        </para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </informaltable>
   <para>
    Ersetzen Sie die Platzhalter <replaceable>server</replaceable> und <replaceable>pfad</replaceable> durch die entsprechenden Werte für Ihre Konfiguration.
   </para>
   <para>
    AutoYaST enthält eine Funktion, die eine Bindung bestimmter Profile an die MAC-Adresse des Clients ermöglicht. Dadurch können Sie verschiedene Instanzen derselben Konfiguration mit unterschiedlichen Profilen installieren, ohne den Parameter <option>autoyast=</option> zu ändern.
   </para>
   <para>
    Gehen Sie hierfür wie folgt vor:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Erstellen Sie separate Profile mit der MAC-Adresse des Client als Dateiname und speichern Sie diese auf dem HTTP-Server mit Ihren AutoYaST-Profilen.
     </para>
    </step>
    <step performance="required">
     <para>
      Lassen Sie den exakten Pfad leer und geben Sie bei Erstellung des Parameters <option>autoyast=</option> den Dateinamen an. Zum Beispiel:
     </para>
<screen>autoyast=tftp://192.168.1.115/</screen>
    </step>
    <step performance="required">
     <para>
      Starten Sie die automatische Installation.
     </para>
    </step>
   </procedure>
   <para>
    YaST versucht, den Speicherort des Profils auf folgende Weise zu ermitteln:
   </para>
   <orderedlist spacing="normal">
    <listitem>
     <para>
      YaST sucht nach dem Profil unter Verwendung seiner eigenen IP-Adresse in Hexadezimalzahlen mit Großbuchstaben, z. B. <literal>192.0.2.91</literal> ist <literal>C000025B</literal>.
     </para>
    </listitem>
    <listitem>
     <para>
      Wird diese Datei nicht gefunden, entfernt YaST eine Hexadezimalstelle und versucht es dann erneut. Diese Aktion wird achtmal wiederholt, bis die Datei mit dem korrekten Namen gefunden wird.
     </para>
    </listitem>
    <listitem>
     <para>
      Wenn dies weiterhin fehlschlägt, wird versucht, eine Datei mit der MAC-Adresse des Clients als Dateinamen zu finden. Die MAC-Adresse des Beispiel-Client ist <literal>0080C8F6484C</literal>.
     </para>
    </listitem>
    <listitem>
     <para>
      Wenn die mit der MAC-Adresse benannte Datei nicht gefunden wird, sucht YaST nach einer Datei namens <filename>default</filename> (in Kleinbuchstaben). Ein Beispiel für eine Reihe von Adressen, in denen YaST nach dem AutoYaST-Profil sucht, sieht wie folgt aus:
     </para>
<screen>
C000025B 
C000025 
C00002 
C0000 
C000 
C00 
C0 
C 
0080C8F6484C 
default
     </screen>
    </listitem>
   </orderedlist>
  </sect2>

  <sect2 id="sec-deployment-autoinst-simple-source">
   <title>Bereitstellung der Installationsdaten</title>
   <para>
    Die Installationsdaten können in Form von Produkt-CDs oder -DVDs oder über eine Netzwerkinstallationsquelle bereitgestellt werden. Wenn die Produkt-CDs als Installationsquelle verwendet werden, ist zur Installation ein physischer Zugriff auf den Client erforderlich, da der Boot-Vorgang manuell gestartet werden muss und die CDs gewechselt werden müssen.
   </para>
   <para>
    Zur Bereitstellung der Installationsquellen über das Netzwerk müssen Sie einen Netzwerkinstallationsserver (HTTP, NFS, FTP) einrichten, wie unter <xref linkend="sec-deployment-remoteinst-instserver-sles9"/> beschrieben. Verwenden Sie eine <filename>info</filename>-Datei, um den Installationsroutinen den Standort des Servers bekannt zu geben.
   </para>
  </sect2>

  <sect2 id="sec-deployment-autoinst-simple-boot">
   <title>Einrichten des Boot-Szenarios</title>
   <para>
    Der Client kann auf verschiedene Weisen gebootet werden:
   </para>
   <variablelist>
    <varlistentry>
     <term>Network-Boot</term>
     <listitem>
      <para>
       Wie bei einer normalen entfernten Installation ist es möglich, die automatische Installation mit Wake-on-LAN und PXE zu initialisieren, das Boot-Image und die Kontrolldatei über TFTP abzurufen und die Installationsquellen von einem Netzwerkinstallationsserver zu laden.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Bootfähige CD-ROM</term>
     <listitem>
      <para>
       Mit dem SUSE Linux Enterprise-Originaldatenträger können Sie das System für die automatische Installation booten und die Kontrolldatei von einem Netzlaufwerk oder einer Diskette laden. Alternativ dazu können Sie auch eine eigene CD-ROM mit den Installationsquellen und dem AutoYaST-Profil erstellen.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    In den folgenden Abschnitten werden die Verfahren für das Booten über das Netzwerk oder von der CD-ROM kurz umrissen.
   </para>
   <sect3 id="sec-deployment-autoinst-simple-boot-pxe">
    <title>Vorbereitung auf einen Netzwerk-Boot</title>
    <para>
     Das Netzwerk-Booting mit Wake-on-LAN, PXE und TFTP wird in <xref linkend="sec-deployment-remoteinst-scenario-vncpxe"/> beschrieben. Damit die dort vorgestellte Konfiguration für die automatische Installation eingesetzt werden kann, müssen Sie die angegebene PXE-Linux-Konfigurationsdatei (<filename>/srv/tftp/pxelinux.cfg/default</filename>) so ändern, dass der Parameter <literal>autoyast</literal> auf den Speicherort des AutoYaST-Profils verweist. Ein Beispiel für eine Standardinstallation sieht wie folgt aus:
    </para>
<screen>
default linux 

# default label linux 
    kernel linux
    append initrd=initrd install=http://192.168.1.115/install/suse-enterprise/ 
	  
	</screen>
    <para>
     Dasselbe Beispiel für die automatische Installation sieht wie folgt aus:
    </para>
<screen>
default linux 

# default label linux 
    kernel linux
    append initrd=initrd install=http://192.168.1.115/install/suse-enterprise/ \
           autoyast=nfs://192.168.1.110/profiles/autoyast.xml
	</screen>
    <para>
     Ersetzen Sie die Beispiel-IP-Adressen und -pfade durch die Daten aus Ihrer Konfiguration.
    </para>
   </sect3>
   <sect3 id="sec-deployment-autoinst-simple-boot-cd">
    <title>Vorbereitung auf das Booten von CD-ROM</title>
    <para>
     Das Booten von CD-ROM kann bei AutoYaST-Installationen auf verschiedene Weisen eingesetzt werden. Folgende Szenarien stehen zur Auswahl:
    </para>
    <variablelist>
     <varlistentry>
      <term>Booten von SUSE Linux Enterprise-Medien, Abrufen des Profils über das Netzwerk</term>
      <listitem>
       <para>
        Verwenden Sie diesen Ansatz, wenn ein vollständig netzwerkbasiertes Szenario nicht möglich ist (beispielsweise, wenn Ihre Hardware PXE nicht unterstützt) und Sie ausreichenden physischen Zugriff auf das zu installierende System haben.
       </para>
       <para>
        Sie benötigen:
       </para>
       <itemizedlist mark="bullet" spacing="normal">
        <listitem>
         <para>
          Die SUSE Linux Enterprise-Medien
         </para>
        </listitem>
        <listitem>
         <para>
          Ein Netzwerkserver, der die Profildaten bereitstellt (Einzelheiten siehe <xref linkend="sec-deployment-autoinst-simple-dist"/>)
         </para>
        </listitem>
        <listitem>
         <para>
          Eine Diskette mit der <filename>info</filename>-Datei, die den Installationsroutinen den Speicherort des Profils angibt
         </para>
         <para>
          <emphasis>oder</emphasis>
         </para>
         <para>
          Zugriff auf die Boot-Eingabeaufforderung des zu installierenden Systems zur manuellen Eingabe des Parameters <literal>autoyast=</literal>
         </para>
        </listitem>
       </itemizedlist>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term> Booten und Installieren von SUSE Linux Enterprise-Medien, Abrufen des Profils von einer Diskette </term>
      <listitem>
       <para>
        Verwenden Sie diesen Ansatz, wenn ein vollständig netzwerkbasiertes Installationsszenario nicht möglich ist. Er erfordert den physischen Zugriff auf das zu installierende System zum Einschalten des Zielcomputers oder, wie im zweiten Fall, zur Eingabe des Speicherorts des Profils an der Boot-Eingabeaufforderung. In beiden Fällen müssen Sie je nach Umfang der Installation möglicherweise auch die Datenträger wechseln.
       </para>
       <para>
        Sie benötigen:
       </para>
       <itemizedlist mark="bullet" spacing="normal">
        <listitem>
         <para>
          Die SUSE Linux Enterprise-Medien
         </para>
        </listitem>
        <listitem>
         <para>
          Eine Diskette mit dem Profil und der <filename>info</filename>-Datei
         </para>
         <para>
          <emphasis>oder</emphasis>
         </para>
         <para>
          Zugriff auf die Boot-Eingabeaufforderung des Ziels zur Eingabe des Parameters <option>autoyast=</option>
         </para>
        </listitem>
       </itemizedlist>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Booten und Installation von benutzerdefinierten Datenträgern, Abrufen des Profils von den Datenträgern</term>
      <listitem>
       <para>
        Wenn Sie nur eine beschränkte Anzahl von Softwarepaketen installieren müssen und die Anzahl der Ziele relativ gering ist, empfiehlt es sich möglicherweise, eine eigene benutzerdefinierte CD mit den Installationsdaten und dem Profil zu erstellen. Dies empfiehlt sich vor allem, wenn in Ihrer Konfiguration kein Netzwerk verfügbar ist.
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </sect3>
  </sect2>

  <sect2 id="sec-deployment-autoinst-simple-info">
   <title>Erstellen der <filename>info</filename>-Datei</title>
   <para>
    Die Installationsroutinen auf dem Zielcomputer müssen auf die vielen verschiedenen Komponenten des AutoYaST-Framework aufmerksam gemacht werden. Dies geschieht durch Erstellung einer Kommandozeile mit allen Parametern, die zum Auffinden der AutoYaST-Komponenten, Installationsquellen und Parameter erforderlich sind, die zur Steuerung des Installationsvorgangs benötigt werden.
   </para>
   <para>
    Sie können dies bewerkstelligen, indem Sie diese Parameter an der Boot-Eingabeaufforderung der Installation manuell eingeben oder indem Sie eine Datei namens <filename>info</filename> bereitstellen, die von den Installationsroutinen (linuxrc) gelesen wird. Ersteres erfordert den physischen Zugriff auf jeden zu installierenden Client, was diesen Ansatz für umfangreiche Implementierungen ungeeignet macht. Letzteres ermöglicht Ihnen die Bereitstellung der <filename>info</filename>-Datei auf einem Datenträger, der vorbereitet und vor der automatischen Installation in das entsprechende Laufwerk des Client eingelegt wird. Alternativ dazu können Sie auch einen PXE-Boot durchführen und die linuxrc-Parameter in die Datei <filename>pxelinux.cfg/default</filename> einfügen (siehe <xref linkend="sec-deployment-autoinst-simple-boot-pxe"/>).
   </para>
   <para>
    Die folgenden Parameter werden häufig für linuxrc verwendet. Weitere Informationen finden Sie in der Dokumentation zu AutoYaST unter <filename>/usr/share/doc/packages/autoyast</filename>.
   </para>
   <important>
    <title>Trennung von Parametern und Werten</title>
    <para>
     Verwenden Sie bei der Übergabe von Parametern an linuxrc an der Boot-Eingabeaufforderung ein Gleichheitszeichen (<literal>=</literal>), um Parameter und Wert voneinander zu trennen. Bei Verwendung einer <filename>info</filename>-Datei müssen Parameter und Wert durch einen Doppelpunkt (<literal>:</literal>) getrennt sein.
    </para>
   </important>
   <informaltable>
    <tgroup cols="2">
     <thead>
      <row>
       <entry>
        <para>
         Schlüsselwort
        </para>
       </entry>
       <entry>
        <para>
         Wert
        </para>
       </entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>
        <para>
         <literal>netdevice</literal>
        </para>
       </entry>
       <entry>
        <para>
         Das Netzwerkgerät, das für die Netzwerkeinrichtung verwendet werden soll (für BOOTP/DHCP-Anforderungen). Nur erforderlich, wenn mehrere Netzwerkgeräte verfügbar sind.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>hostip</literal>
        </para>
       </entry>
       <entry>
        <para>
         Beim Fehlen einer Angabe sendet der Client eine BOOTP-Anforderung. Anderenfalls wird der Client mithilfe der angegebenen Daten konfiguriert.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>netmask</literal>
        </para>
       </entry>
       <entry>
        <para>
         Netzmaske für das ausgewählte Netzwerk.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>Gateway</literal>
        </para>
       </entry>
       <entry>
        <para>
         Standard-Gateway.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>nameserver</literal>
        </para>
       </entry>
       <entry>
        <para>
         Namenserver.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>autoyast</literal>
        </para>
       </entry>
       <entry>
        <para>
         Speicherort der Kontrolldatei, die für die automatische Installation verwendet wird, beispielsweise <literal>autoyast=nfs//192.168.1.110/profiles/</literal>.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>install</literal>
        </para>
       </entry>
       <entry>
        <para>
         Speicherort der Installationsquelle, beispielsweise <literal>install=nfs://192.168.1.110/CDs/</literal>.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>vnc</literal>
        </para>
       </entry>
       <entry>
        <para>
         Der Wert <literal>1</literal> aktiviert die ferngesteuerte VNC-Installation.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>vncpassword</literal>
        </para>
       </entry>
       <entry>
        <para>
         Das Passwort für VNC.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>usessh</literal>
        </para>
       </entry>
       <entry>
        <para>
         Der Wert <literal>1</literal> aktiviert die ferngesteuerte SSH-Installation.
        </para>
       </entry>
      </row>
      <row>
       <entry>
        <para>
         <literal>netsetup</literal>
        </para>
       </entry>
       <entry>
        <para>
         Beim Wert <literal>1</literal> wird das Netzwerk eingerichtet. In der Regel erfolgt dies automatisch. Falls das Installations-Repository lokal bereitgestellt wird (z. B. als DVD oder als lokales ISO-Image) und die Datei <filename>info</filename> aus dem Netzwerk geladen wird, müssen Sie allerdings <literal>netsetup=1</literal> festlegen.
        </para>
       </entry>
      </row>
     </tbody>
    </tgroup>
   </informaltable>
   <para>
    Wenn Ihr Szenario für die automatische Installation eine Client-Konfiguration über DHCP und eine Netzwerkinstallationsquelle aufweist und Sie den Installationsvorgang mit VNC überwachen möchten, würde Ihre <filename>info</filename>-Datei wie folgt aussehen:
   </para>
<screen>autoyast:<replaceable>profile_source</replaceable> install:<replaceable>install_source</replaceable> vnc:1 vncpassword:<replaceable>some_password</replaceable></screen>
   <para>
    Wenn Sie eine statische Netzwerkkonfiguration bevorzugen, würde Ihre <filename>info</filename>-Datei wie folgt aussehen:
   </para>
<screen>
autoyast:<replaceable>profile_source</replaceable> \
install:<replaceable>install_source</replaceable> \ 
hostip:<replaceable>some_ip</replaceable> \ 
netmask:<replaceable>some_netmask</replaceable> \ 
gateway:<replaceable>some_gateway</replaceable></screen>
   <para>
    Umgekehrte Schrägstriche (<literal>\</literal>) geben an, dass die Zeilenumbrüche nur zur Verbesserung der Lesbarkeit hinzugefügt wurden. Alle Optionen müssen als eine fortlaufende Zeichenkette eingegeben werden.
   </para>
   <para>
    Die <filename>info</filename>-Daten können linuxrc auf verschiedene Weisen bereitgestellt werden:
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      Als Datei auf einer Diskette oder CD-ROM, die zum Installationszeitpunkt im Laufwerk des Clients eingelegt ist. Fügen Sie den info-Parameter ähnlich wie <systemitem>info=floppy:/info</systemitem> oder <systemitem>info=cd:/info</systemitem> hinzu.
     </para>
    </listitem>
    <listitem>
     <para>
      Als Datei im root-Verzeichnis der Initial RAM-Disk, die zum Booten des Systems verwendet wird und entweder von einem benutzerdefinierten Installationsdatenträger oder von PXE-Boot stammt.
     </para>
    </listitem>
    <listitem>
     <para>
      Als Teil des AutoYaST-Profils. In diesem Fall muss die AutoYaST-Datei <filename>info</filename> genannt werden, damit linuxrc sie analysieren kann. Ein Beispiel für diesen Ansatz sehen Sie unten.
     </para>
    </listitem>
    <listitem>
     <para>
      Mithilfe einer URL, die zum Speicherort der Info-Datei weist. Die Syntax dazu sieht wie folgt aus: <systemitem>info=http://www.example.com/info</systemitem>.
     </para>
    </listitem>
   </itemizedlist>
   <para>
    linuxrc sucht im Profil nach einer Zeichenkette (<option>start_linuxrc_conf</option>), die den Anfang der Datei angibt. Wird diese gefunden, wird der Inhalt der Datei zwischen dieser Zeichenkette und der Zeichenkette <option>end_linuxrc_conf</option> analysiert. Die Optionen werden im Profil wie folgt gespeichert:
   </para>
<screen>....
  &lt;install&gt;
....
    &lt;init&gt;
      &lt;info_file&gt;
&lt;![CDATA[
#
# Don't remove the following line:
# start_linuxrc_conf
#
install: nfs:<replaceable>server</replaceable>/<replaceable>path</replaceable>
vnc: 1
vncpassword: test
autoyast: file:///info

# end_linuxrc_conf
# Do not remove the above comment
#
]]&gt;

      &lt;/info_file&gt;
    &lt;/init&gt;
......
  &lt;/install&gt;
....
</screen>
   <para>
    linuxrc lädt das Profil mit den Boot-Parametern anstelle der herkömmlichen <filename>info</filename>-Datei. Der Parameter <option>install:</option> verweist auf den Speicherort der Installationsquellen. <option>vnc</option> und <option>vncpassword</option> geben die Verwendung von VNC für die Überwachung der Installation an. Der Parameter <option>autoyast</option> weist linuxrc an, die <filename>info</filename>-Datei als AutoYaST-Profil zu behandeln.
   </para>
  </sect2>

  <sect2 id="sec-deployment-autoinst-simple-install">
   <title>Initialisierung und Überwachung der automatischen Installation</title>
   <para>
    Nachdem Sie die gesamte oben genannte Infrastruktur bereitgestellt haben (Profil, Installationsquelle und <filename>info</filename>-Datei), können Sie die automatische Installation starten. Je nach gewähltem Szenario für das Booten und Überwachen des Vorgangs kann eine physische Interaktion mit dem Client erforderlich sein:
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      Wenn das Client-System von physischen Datenträgern bootet (entweder von Produktdatenträgern oder benutzerdefinierten CDs), müssen Sie diese in das entsprechende Laufwerk des Client einlegen.
     </para>
    </listitem>
    <listitem>
     <para>
      Wenn der Client nicht mittels Wake-on-LAN eingeschaltet wird, müssen Sie zumindest den Client-Computer einschalten.
     </para>
    </listitem>
    <listitem>
     <para>
      Wenn Sie sich nicht für eine ferngesteuerte automatische Installation entschieden haben, werden die visuellen Rückmeldungen von AutoYaST an den angeschlossenen Bildschirm bzw. an eine serielle Konsole gesendet, falls der Client über keinen Bildschirm verfügt.
     </para>
    </listitem>
   </itemizedlist>
   <para>
    Zur Aktivierung einer ferngesteuerten automatischen Installation verwenden Sie die unter beschriebenen <xref linkend="sec-deployment-autoinst-simple-info"/> VNC- oder SSH-Parameter und stellen Sie von einem anderen Computer aus eine Verbindung zum Client her (siehe <xref linkend="sec-deployment-remoteinst-monitor"/>).
   </para>
  </sect2>
 </sect1>
 <sect1 id="sec-deployment-autoinst-advanced">
  <title>Regelbasierte automatische Installation</title>

  <para>
   In den folgenden Abschnitten werden die grundlegenden Konzepte der regelbasierten automatischen Installation mit AutoYaST vorgestellt und anhand der Beispielszenarien können Sie eigene benutzerdefinierte Konfigurationen für die automatische Installation erstellen.
  </para>

  <sect2 id="sec-deployment-autoinst-advanced-expl">
   <title>Informationen zur regelbasierten automatischen Installation</title>
   <para>
    Die regelbasierte AutoYaST-Installation ermöglicht Ihnen den Einsatz heterogener Hardwareumgebungen:
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      Gibt es an Ihrem Standort Hardware verschiedener Hersteller?
     </para>
    </listitem>
    <listitem>
     <para>
      Weisen die Computer an Ihrem Standort eine unterschiedliche Hardwarekonfiguration auf (beispielsweise verschiedene Geräte oder Arbeitsspeicher- und Festplattengrößen)?
     </para>
    </listitem>
    <listitem>
     <para>
      Beabsichtigen Sie eine Installation über verschiedene Domänen hinweg und müssen Sie zwischen diesen unterscheiden?
     </para>
    </listitem>
   </itemizedlist>
   <para>
    Das Ziel der regelbasierten automatischen Installation besteht im Grunde darin, ein benutzerdefiniertes Profil für ein heterogenes Szenario durch Zusammenführung verschiedener Profile zu erstellen. Jede Regel beschreibt hierbei ein bestimmtes Merkmal Ihrer Konfiguration (z. B. die Festplattengröße) und weist AutoYaST an, welches Profil verwendet werden soll, wenn die Regel übereinstimmt. Mehrere Regeln, die die verschiedenen Merkmale Ihrer Konfiguration beschreiben, werden in einer AutoYaST-Datei namens <filename>rules.xml</filename> zusammengefasst. Der Regelstapel wird dann verarbeitet und AutoYaST generiert das endgültige Profil durch Zusammenführung der verschiedenen Profile, die mit den AutoYaST-Regeln übereinstimmen. Eine Illustration dieses Vorgangs finden Sie unter <xref linkend="sec-deployment-autoinst-advanced-example"/>.
   </para>
   <para>
    Die regelbasierte AutoYaST-Installation bietet Ihnen große Flexibilität bei der Planung und Durchführung der SUSE Linux Enterprise-Implementierung. Sie haben folgende Möglichkeiten:
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      Regeln für die Übereinstimmung mit den vordefinierten Systemattributen in AutoYaST erstellen
     </para>
    </listitem>
    <listitem>
     <para>
      Mehrere Systemattribute (wie die Festplattengröße und die Kernel-Architektur) mithilfe logischer Operatoren zu einer Regel zusammenfassen
     </para>
    </listitem>
    <listitem>
     <para>
      Durch Ausführung von Shell-Skripts und die Übergabe des Ergebnisses an das AutoYaST-Framework benutzerdefinierte Regeln erstellen. Die Anzahl der benutzerdefinierten Regeln ist auf fünf beschränkt.
     </para>
    </listitem>
   </itemizedlist>
   <note>
    <para>
     Weitere Informationen zur Erstellung und Verwendung von Regeln mit AutoYaST finden Sie in der Dokumentation zum Paket unter <filename>/usr/share/doc/packages/autoyast2/html/index.html</filename> im Kapitel <guimenu>Regeln und Klassen</guimenu>.
    </para>
   </note>
   <para>
    Zur Vorbereitung einer regelbasierten AutoYaST-Masseninstallation gehen Sie wie folgt vor:
   </para>
   <procedure>
    <step performance="required">
     <para>
      Erstellen Sie mehrere AutoYaST-Profile mit den erforderlichen Installationsdetails für Ihre heterogene Konfiguration, wie unter <xref linkend="sec-deployment-autoinst-simple-profile"/> beschrieben.
     </para>
    </step>
    <step performance="required">
     <para>
      Definieren Sie Regeln für die Übereinstimmung der Systemattribute Ihrer Hardwarekonfiguration (siehe <xref linkend="sec-deployment-autoinst-advanced-example"/>).
     </para>
    </step>
    <step performance="required">
     <para>
      Bestimmen Sie die Quelle für das AutoYaST-Profil und den Parameter, der an die Installationsroutinen übergeben werden soll (siehe<xref linkend="sec-deployment-autoinst-simple-dist"/>).
     </para>
    </step>
    <step performance="required">
     <para>
      Bestimmen Sie die Quelle für die SUSE Linux Enterprise-Installationsdaten, wie unter <xref linkend="sec-deployment-autoinst-simple-source"/> beschrieben.
     </para>
    </step>
    <step performance="required">
     <para>
      Übergeben Sie die Kommandozeile an die Installationsroutinen, indem Sie die Parameter manuell hinzufügen oder eine <filename>info</filename>-Datei erstellen (siehe <xref linkend="sec-deployment-autoinst-simple-info"/>).
     </para>
    </step>
    <step performance="required">
     <para>
      Richten Sie das Boot-Szenario für die automatische Installation, wie unter <xref linkend="sec-deployment-autoinst-simple-boot"/> beschrieben ein.
     </para>
    </step>
    <step performance="required">
     <para>
      Starten Sie die automatische Installation, wie unter <xref linkend="sec-deployment-autoinst-simple-install"/> beschrieben.
     </para>
    </step>
   </procedure>
  </sect2>

  <sect2 id="sec-deployment-autoinst-advanced-example">
   <title>Beispielszenario für die regelbasierte automatische Installation</title>
   <para>
    Zur Erlangung eines Grundverständnisses der Vorgehensweise für die Erstellung von Regeln sollten Sie das folgende Beispiel beachten, das unter <xref linkend="fig-autoyast-rules"/> dargestellt ist. In einem AutoYaST-Durchlauf wird die folgende Konfiguration installiert:
   </para>
   <variablelist>
    <varlistentry>
     <term>Ein Druckserver</term>
     <listitem>
      <para>
       Dieser Computer erfordert nur eine minimale Installation ohne Desktop-Umgebung sowie einen eingeschränkten Satz von Softwarepaketen.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Arbeitsplatzrechner in der technischen Abteilung</term>
     <listitem>
      <para>
       Diese Computer benötigen eine Desktop-Umgebung und eine breite Palette von Entwicklungssoftware.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>Laptops in der Verkaufsabteilung</term>
     <listitem>
      <para>
       Diese Computer benötigen eine Desktop-Umgebung und eine eingeschränkte Palette spezialisierter Anwendungen, wie Büro- und Terminverwaltungsprogramme.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <figure id="fig-autoyast-rules">
    <title>AutoYaST-Regeln</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="autoyast_rules.svg" width="90%" format="SVG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="autoyast_rules.png" width="80%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    Verwenden Sie in einem ersten Schritt eine der unter <xref linkend="sec-deployment-autoinst-simple-profile"/> beschriebenen Methoden, um Profile für jeden Anwendungsfall zu erstellen. In diesem Beispiel würden Sie die Profile <filename>print.xml</filename>, <filename>engineering.xml</filename> und <filename>sales.xml</filename> erstellen.
   </para>
   <para>
    Erstellen Sie in einem zweiten Schritt Regeln zur Unterscheidung zwischen den drei Hardwaretypen sowie zur Anweisung von AutoYaST, welches Profil verwendet werden soll. Verwenden Sie zur Erstellung der Regeln einen Algorithmus, der dem folgenden ähnelt:
   </para>
   <orderedlist spacing="normal">
    <listitem>
     <para>
      Hat der Computer die IP-Adresse <guimenu>192.168.2.253</guimenu>? Dann mache ihn zum Druckserver.
     </para>
    </listitem>
    <listitem>
     <para>
      Verfügt der Computer über PCMCIA-Hardware und einen Intel-Chipsatz? Dann betrachte ihn als Intel-Laptop und installiere darauf die Software-Auswahl für die Verkaufsabteilung.
     </para>
    </listitem>
    <listitem>
     <para>
      Wenn keine dieser Bedingungen wahr ist, betrachte den Computer als Entwickler-Arbeitsplatzrechner und installiere ihn entsprechend.
     </para>
    </listitem>
   </orderedlist>
   <para>
    Dies kann, grob umrissen, in eine Datei namens <filename>rules.xml</filename> mit folgendem Inhalt übersetzt werden:
   </para>
<screen>
&lt;?xml version="1.0"?&gt;
&lt;!DOCTYPE autoinstall SYSTEM "/usr/share/autoinstall/dtd/rules.dtd"&gt; 
&lt;autoinstall xmlns="http://www.suse.com/1.0/yast2ns" xmlns:config="http://www.suse.com/1.0/configns"&gt;
  &lt;rules config:type="list"&gt;
    &lt;rule&gt;
       &lt;hostaddress&gt;
	    &lt;match&gt;192.168.2.253&lt;/match&gt;
            &lt;match_type&gt;exact&lt;/match_type&gt;
       &lt;/hostaddress&gt;
       &lt;result&gt;
            &lt;profile&gt;print.xml&lt;/profile&gt;
            &lt;continue config:type="boolean"&gt;false&lt;/continue&gt;
        &lt;/result&gt;
    &lt;/rule&gt;
    &lt;rule&gt;
       &lt;haspcmcia&gt;
            &lt;match&gt;1&lt;/match&gt;
            &lt;match_type&gt;exact&lt;/match_type&gt;
       &lt;/haspcmcia&gt;
       &lt;custom1&gt;
           &lt;script&gt;
if grep -i intel /proc/cpuinfo &gt; /dev/null; then
echo -n "intel"
else
echo -n "non_intel"
fi;
           &lt;/script&gt;
           &lt;match&gt;*&lt;/match&gt;
           &lt;match_type&gt;exact&lt;/match_type&gt;
       &lt;/custom1&gt;
       &lt;result&gt;
            &lt;profile&gt;sales.xml&lt;/profile&gt;
            &lt;continue config:type="boolean"&gt;false&lt;/continue&gt;
        &lt;/result&gt;
        &lt;operator&gt;and&lt;/operator&gt;
    &lt;/rule&gt;
    &lt;rule&gt;
        &lt;haspcmcia&gt;
            &lt;match&gt;0&lt;/match&gt;
            &lt;match_type&gt;exact&lt;/match_type&gt;
        &lt;/haspcmcia&gt;
 	&lt;result&gt;
            &lt;profile&gt;engineering.xml&lt;/profile&gt;
            &lt;continue config:type="boolean"&gt;false&lt;/continue&gt;
        &lt;/result&gt;
    &lt;/rule&gt;
  &lt;/rules&gt;
&lt;/autoinstall&gt;
</screen>
   <para>
    Stellen Sie bei der Verteilung der Regeldatei sicher, dass sich das Verzeichnis <filename>rules</filename> unterhalb des Verzeichnisses <filename>profiles</filename> befindet, das in der URL <filename>autoyast=<replaceable>protocol</replaceable>:<replaceable>serverip</replaceable>/profiles/</filename> angegeben ist. AutoYaST sucht nach einem Unterverzeichnis namens <filename>rules</filename>, das eine Datei namens <filename>rules.xml</filename> enthält, lädt dann die in der Regeldatei angegebenen Profile und führt sie zusammen.
   </para>
   <para>
    Der Rest des Verfahrens zur automatischen Installation wird wie üblich ausgeführt.
   </para>
  </sect2>
 </sect1>
 <sect1 id="sec-deployment-autoinst-moreinfo">
  <title>Weiterführende Informationen</title>

  <para>

   Detaillierte Informationen zur AutoYaST-Technologie finden Sie unter <phrase os="sles"><xref linkend="book-autoyast"/> oder </phrase> in der Dokumentation, die zusammen mit der Software installiert wurde (<filename>/usr/share/doc/packages/autoyast2</filename>).
  </para>
 </sect1>
</chapter>
