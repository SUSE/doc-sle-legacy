<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE sect1 PUBLIC "-//Novell//DTD NovDoc XML V1.0//EN"
"novdocx.dtd">
<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<sect1 xml:base="lvm.xml" id="sec.yast2.system.lvm">
 <title>Configuración de LVM</title><indexterm> <primary>YaST</primary> <secondary>LVM</secondary></indexterm><indexterm> <primary>LVM</primary> <secondary>YaST</secondary></indexterm><indexterm> <primary>Gestor de volúmenes lógicos</primary> <see>LVM</see></indexterm>

 <para>
  En esta sección se describen brevemente los conceptos básicos del Gestor de volúmenes lógicos (LVM) y sus funciones polivalentes. En la <xref linkend="sec.yast2.system.lvm.yast"/>, aprenderá a configurar LVM con YaST.
 </para>

 <warning>
  <para>
   El uso de LVM se asocia a veces con un aumento del riesgo, por ejemplo, de pérdida de datos. Otros riesgos posibles incluirían la detención de las aplicaciones por fallo, fallos de alimentación y comandos erróneos. Haga una copia de seguridad de los datos antes de implementar LVM o volver a configurar los volúmenes. Nunca haga nada sin haber hecho antes una copia de seguridad.
  </para>
 </warning>

 <sect2 id="sec.yast2.system.lvm.explained">
  <title>Administrador de volúmenes lógicos</title>
  <para>
   LVM permite distribuir de forma flexible el espacio del disco duro entre varios sistemas de archivo distintos. Se desarrolló porque, en ocasiones, surge la necesidad de cambiar la segmentación del disco duro después de hacer la partición inicial. Puesto que es difícil modificar las particiones en un sistema que se está ejecutando, LVM ofrece un repositorio virtual (grupo de volúmenes, GV en adelante por sus siglas en inglés) de espacio en memoria desde el que se pueden crear los volúmenes lógicos (VL) según sea necesario. El sistema operativo accede a estos VL en lugar de a particiones físicas. Los grupos de volúmenes pueden ocupar más de un disco, de manera que varios discos o partes de ellos puedan formar un único grupo de volúmenes. De esta forma, LVM ofrece un tipo de abstracción a partir del espacio de disco físico que permite cambiar la segmentación de una manera más sencilla y segura que con una partición física. Encontrará información básica relativa a la particiones físicas en la <xref linkend="sec.IB.part.typen"/> y en la <xref linkend="sec.yast2.i_y2_part_expert"/>.
  </para>
  <figure id="fig.lvm.explained.schematic">
   <title>Particiones físicas y LVM</title>
   <mediaobject>
    <imageobject role="fo">
     <imagedata fileref="lvm.svg" width="75%" format="SVG"/>
    </imageobject>
    <imageobject role="html">
     <imagedata fileref="lvm.png" width="75%" format="PNG"/>
    </imageobject>
   </mediaobject>
  </figure>
  <para>
   En la <xref linkend="fig.lvm.explained.schematic"/> se compara una partición física (a la izquierda) con una segmentación de LVM (a la derecha). En la parte izquierda, se ha dividido un disco en tres particiones físicas (PARTE), cada uno con un punto de montaje (MP) asignado de manera que el sistema operativo pueda acceder a ellos. En la parte derecha, hay dos discos divididos en dos o tres particiones físicas cada uno. Se han definido dos grupos de volúmenes de LVM (GV 1 y GV 2). GV 1 incluye dos particiones del disco 1 y una del disco 2. GV 2 contiene las otras dos particiones del disco 2. En LVM, las particiones de disco físicas que se incorporan en un grupo de volúmenes se denominan volúmenes físicos (VF). En los grupos de volúmenes se han identificado cuatro volúmenes lógicos (del VL 1 al VL 4) El sistema operativo los puede utilizar mediante los puntos de montaje asociados. No es necesario que el borde entre los distintos VL esté alineado con ningún borde de partición. Observe en este ejemplo el borde entre VL 1 y VL 2.
  </para>
  <para>
   Funciones de LVM:
  </para>
  <itemizedlist mark="bullet" spacing="normal">
   <listitem>
    <para>
     Es posible combinar varios discos duros o particiones en un volumen lógico de gran tamaño.
    </para>
   </listitem>
   <listitem>
    <para>
     Siempre que la configuración sea adecuada, se puede aumentar de tamaño un volumen lógico (como <filename>/usr</filename>) si ya no queda espacio libre.
    </para>
   </listitem>
   <listitem>
    <para>
     Mediante LVM es posible añadir discos duros o volúmenes lógicos a un sistema en funcionamiento. Pero para hacerlo se requiere hardware que admita el intercambio en caliente.
    </para>
   </listitem>
   <listitem>
    <para>
     Es posible activar un modo de repartición con el que se distribuye el flujo de datos de un VL en varios VF. Si estos volúmenes físicos se encuentran en discos distintos, mejora el rendimiento de lectura y escritura, como en el caso de RAID 0.
    </para>
   </listitem>
   <listitem>
    <para>
     La función de instantánea permite realizar copias de seguridad coherentes (especialmente para servidores) del sistema en funcionamiento.
    </para>
   </listitem>
  </itemizedlist>
  <para>
   Con estas funciones, LVM ya está preparado para un equipo doméstico de uso intensivo o servidores pequeños. LVM es adecuado para usuarios que tengan cada vez más datos (como en bases de datos, archivos de música o directorios de usuario). ya que permite sistemas de archivos que ocupan más que el disco duro. Otra ventaja de LVM es que se pueden añadir hasta 256 VL. Sin embargo, trabajar con LVM es distinto a trabajar con particiones convencionales. Hay más información disponible e instrucciones acerca de cómo configurar LVM en la página oficial de LVM HOWTO en <ulink url="http://tldp.org/HOWTO/LVM-HOWTO/"/>.
  </para>
  <para>
   A partir de la versión 2.6 del núcleo, está disponible la versión 2 de LVM, que a su vez, es compatible con las versiones anteriores de LVM y permite la gestión continua de los grupos de volúmenes antiguos. Al crear nuevos grupos de volúmenes, decida si desea usar el formato nuevo o la versión compatible con versiones anteriores. LVM 2 no requiere ningún parche del núcleo, ya que utiliza el mapeador de dispositivos integrado en la versión 2.6 del núcleo. Esta versión del núcleo solo admite la versión 2 de LVM. Por tanto, siempre que se menciona LVM en esta sección, se hace referencia a la versión 2.
  </para>
  <sect3>
   <title>Aprovisionamiento flexible</title>
   <para>
    A partir de la versión 3.4 del núcleo, LVM es compatible con el aprovisionamiento flexible. Un volumen con aprovisionamiento flexible tiene una capacidad virtual y una real. La capacidad <emphasis>virtual</emphasis> es la capacidad de volumen de almacenamiento disponible para un host. La capacidad <emphasis>real</emphasis> es la capacidad de almacenamiento asignada a una copia de volumen desde un repositorio de almacenamiento. En un volumen totalmente asignado, la capacidad virtual coincide con la real. Sin embargo, en un volumen con aprovisionamiento flexible, la capacidad virtual puede ser muy superior a la real. Si un volumen con aprovisionamiento flexible no tiene suficiente capacidad real para una operación de escritura, el volumen se desconecta y se registra un error.
   </para>
   <para>
    Para obtener información más general, consulte <ulink url="http://wikibon.org/wiki/v/Thin_provisioning"/>.
   </para>
  </sect3>
 </sect2>

 <sect2 id="sec.yast2.system.lvm.yast">
  <title>Configuración de LVM con YaST</title>
  <para>
   Puede acceder a la configuración de YaST LVM desde el Particionamiento en modo experto de YaST (consulte la <xref linkend="sec.yast2.i_y2_part_expert"/>) dentro del elemento <guimenu>Gestión de volúmenes</guimenu> del panel <guimenu>Vista del sistema.</guimenu> Esta herramienta permite editar y suprimir particiones existentes, así como crear otras nuevas que se deban usar con LVM. La primera tarea consiste en crear volúmenes físicos (VF) para proporcionar espacio a un grupo de volúmenes:
  </para>
  <procedure>
   <step performance="required">
    <para>
     Seleccione un disco duro en <guimenu>Discos duros.</guimenu>
    </para>
   </step>
   <step performance="required">
    <para>
     Acceda a la pestaña <guimenu>Particiones.</guimenu>
    </para>
   </step>
   <step performance="required">
    <para>
     Haga clic en <guimenu>Añadir</guimenu> y escriba el tamaño que desee asignar al VF en el disco seleccionado.
    </para>
   </step>
   <step performance="required">
    <para>
     Utilice <guimenu>No dar formato a la partición</guimenu> y cambie el valor de <guimenu>ID del sistema de archivos</guimenu> a <guimenu>0x8E Linux LVM</guimenu>. No monte la partición.
    </para>
   </step>
   <step performance="required">
    <para>
     Repita este procedimiento hasta que haya definido todos los volúmenes físicos que desee en los discos disponibles.
    </para>
   </step>
  </procedure>
  <sect3>
   <title>Creación de grupos de volúmenes</title>
   <para>
    Si no existe ningún grupo de volúmenes en el sistema, debe añadir uno (consulte la <xref linkend="fig.lvm.yast.volgrp"/>). Es posible crear grupos adicionales haciendo clic en <guimenu>Gestión de volúmenes</guimenu> en el panel <guimenu>Vista del sistema</guimenu> y, a continuación, en <guimenu>Añadir grupo de volúmenes.</guimenu> Suele bastar con un único grupo de volúmenes.
   </para>
   <procedure>
    <step performance="required">
     <para>
      Escriba un nombre para el GV, por ejemplo, <literal>sistema</literal>.
     </para>
    </step>
    <step performance="required">
     <para>
      Seleccione el tamaño físico extendido que desee.<guimenu/> Este valor define el tamaño de un bloque físico en el grupo de volúmenes. Todo el espacio en disco de un grupo de volúmenes se gestiona en bloques de este tamaño.
     </para>
    </step>
    <step performance="required">
     <para>
      Añada los VF preparados al GV seleccionando el dispositivo y haciendo clic en <guimenu>Añadir.</guimenu> Es posible seleccionar varios dispositivos manteniendo pulsada la tecla <keycap>Ctrl</keycap> a la vez que se seleccionan los dispositivos.
     </para>
    </step>
    <step performance="required">
     <para>
      Elija <guimenu>Finalizar</guimenu> para continuar con el proceso de configuración del GV.
     </para>
    </step>
   </procedure>
   <figure id="fig.lvm.yast.volgrp">
    <title>Creación de un grupo de volúmenes</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="yast2_lvm4.png" width="75%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_lvm4.png" width="75%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    Si dispone de varios grupos de volúmenes definidos y desea añadir o eliminar volúmenes físicos, seleccione el grupo de volúmenes en la lista <guimenu>Gestión de volúmenes</guimenu> y haga clic en <guimenu>Cambiar tamaño.</guimenu> En la ventana siguiente, puede añadir o eliminar volúmenes físicos del grupo de volúmenes seleccionado.
   </para>
  </sect3>
  <sect3>
   <title>Configuración de los volúmenes lógicos</title>
   <para>
    Después de incorporar volúmenes físicos al grupo de volúmenes, debe definir los volúmenes lógicos que debe utilizar el sistema operativo en el siguiente recuadro de diálogo. Elija el grupo de volúmenes adecuado y acceda a la pestaña <guimenu>Volúmenes lógicos.</guimenu> Utilice las opciones <guimenu>Añadir,</guimenu> <guimenu>Editar,</guimenu> <guimenu>Cambiar tamaño</guimenu> y <guimenu>Suprimir</guimenu> con los volúmenes lógicos como sea necesario hasta ocupar todo el espacio del grupo de volúmenes. Debe asignar al menos un VL a cada grupo de volúmenes.
   </para>
   <figure id="fig.lvm.yast.mgmt">
    <title>Gestión de volúmenes lógicos</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="yast2_lvm6.png" width="75%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_lvm6.png" width="75%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
   <para>
    Haga clic en <guimenu>Añadir</guimenu> y recorra las pantallas del asistente que se abrirá:
   </para>
   <orderedlist spacing="normal">
    <listitem>
     <para>
      Escriba el nombre del VL. Si se trata de una partición que se deba montar en el directorio <filename>/home</filename>, se puede emplear un nombre descriptivo, como <literal>HOME.</literal>
     </para>
    </listitem>
    <listitem>
     <para>
      Seleccione el tipo de VL. Puede ser <guimenu>Volumen normal,</guimenu> <guimenu>Depósito flexible</guimenu> o <guimenu>Volumen flexible.</guimenu> Tenga en cuenta que primero es necesario crear un depósito flexible que pueda almacenar volúmenes flexibles.
     </para>
    </listitem>
    <listitem>
     <para>
      Seleccione el tamaño y el número de bandas del volumen lógico (VL). Si solo tiene un volumen físico, no resulta útil seleccionar varias bandas.
     </para>
     <tip>
      <para>
       La gran ventaja del aprovisionamiento flexible es que la suma total de todos los volúmenes flexibles almacenados en un depósito flexible, puede superar el tamaño del propio depósito.
      </para>
     </tip>
    </listitem>
    <listitem>
     <para>
      Elija el sistema de archivos que se debe utilizar en el VL y el punto de montaje.
     </para>
    </listitem>
   </orderedlist>
   <para>
    El uso de bandas permite distribuir el flujo de datos del VL entre varios VF (repartición). Sin embargo, solo es posible repartir los datos de un volumen sobre diferentes volúmenes físicos. Y cada uno de ellos debe ofrecer al menos la misma cantidad de espacio que el volumen. El número máximo de reparticiones equivale al número de volúmenes físicos, donde la repartición "1" significa "sin repartición de datos". La repartición de datos solo tiene sentido si los volúmenes físicos están en diferentes discos duros, de lo contrario se reducirá el rendimiento.
   </para>
   <warning>
    <title>repartición de datos</title>
    <para>
     YaST no puede comprobar en este momento si son correctas las entradas que tienen que ver con la repartición. Cualquier error que se haya cometido aquí solo será obvio más tarde, cuando LVM se implemente en el disco.
    </para>
   </warning>
   <para>
    Si ya ha configurado LVM en el sistema, se pueden utilizar también los volúmenes lógicos existentes. Antes de continuar, asigne los puntos de montaje adecuados a esos volúmenes lógicos. Haga clic en <guimenu>Finalizar</guimenu> para volver al Particionamiento en modo experto de YaST y finalizar el procedimiento.
   </para>
  </sect3>
 </sect2>


</sect1>
