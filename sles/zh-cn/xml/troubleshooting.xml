<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet href="urn:x-suse:xslt:profiling:docbook51-profile.xsl"
    type="text/xml"
    title="Profiling step"
?>
<!DOCTYPE chapter
[
   <!ENTITY % entities SYSTEM "entity-decl.ent">
   %entities;
]>


<!--
*********************************
Please see LICENSE.txt for this document's license.
*********************************
-->
<chapter xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" version="5.1" xml:base="troubleshooting.xml" xml:id="cha-trouble"><title>常见问题及其解决方案</title><info/>
 
 <para>
  本章将描述一系列可能发生的问题及其解决方法。即使您的情况并未精确地列在这里，也可能有足够相似的情况可提供解决您的问题的方法提示。
 </para>
 <section xml:id="sec-trouble-info">
  <title>查找和收集信息</title>

  <para>
   Linux 报告情况时是很详细的。在您的系统遇到问题时，有几个地方可以查看，大多数是 Linux 系统的标准问题，有一些是与 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 系统相关的问题。多数日志文件可以用 YaST（<menuchoice><guimenu>杂项</guimenu> <guimenu>启动日志</guimenu></menuchoice>）查看。
  </para>

  <para>
   <indexterm> <primary>YaST</primary> <secondary>支持查询</secondary> </indexterm><indexterm> <primary>支持查询</primary> </indexterm>YaST 可提供支持团队所需的所有系统信息。使用<menuchoice> <guimenu>其他</guimenu> <guimenu>支持</guimenu> </menuchoice>，然后选择问题类别。当所有信息都被集合后，将其附加在您的支持请求。
  </para>

  <para>
   将出现最常检查的日志文件的列表，并附有其典型用途说明。包含 <filename>~</filename> 的路径是指当前用户的用户主目录。
  </para>

  <table xml:id="tab-trouble-info">
   <title>日志文件</title>
   <tgroup cols="2">
    <thead>
     <row>
      <entry>
       <para>
        日志文件
       </para>
      </entry>
      <entry>
       <para>
        描述
       </para>
      </entry>
     </row>
    </thead>
    <tbody>
     <row>
      <entry>
       <para>
        <filename>~/.xsession-errors</filename>
       </para>
      </entry>
      <entry>
       <para>
        来自当前运行的桌面应用程序的消息。 
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/var/log/apparmor/</filename>
       </para>
      </entry>
      <entry>
       <para>
        来自 AppArmor 的日志文件，详细信息请参见<xref linkend="part-aaa"/>。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/var/log/audit/audit.log</filename>
       </para>
      </entry>
      <entry>
       <para>
        来自审计的日志文件，用来跟踪对系统的文件、目录或资源的任何访问，并跟踪系统调用。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/var/log/boot.msg</filename>
       </para>
      </entry>
      <entry>
       <para>
        引导期间报告的来自内核的消息。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/var/log/mail.*</filename>
       </para>
      </entry>
      <entry>
       <para>
        来自邮件系统的消息。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/var/log/messages</filename>
       </para>
      </entry>
      <entry>
       <para>
        （运行时）来自内核和系统日志守护程序的消息。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/var/log/NetworkManager</filename>
       </para>
      </entry>
      <entry>
       <para>
        来自 NetworkManager 的日志文件通过网络连接收集问题
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/var/log/samba/</filename>
       </para>
      </entry>
      <entry>
       <para>
        包含 Samba 服务器及客户端日志消息的目录。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/var/log/SaX.log</filename>
       </para>
      </entry>
      <entry>
       <para>
        来自 SaX 屏幕和 KVM 系统的硬件消息。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/var/log/warn</filename>
       </para>
      </entry>
      <entry>
       <para>
        所有来自内核与系统日志守护程序的消息为<quote>警告</quote>或更高级别。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/var/log/wtmp</filename>
       </para>
      </entry>
      <entry>
       <para>
        包含当前计算机会话的用户登录记录的二进制文件。可使用 <command>last</command> 查看它。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/var/log/Xorg.*.log</filename>
       </para>
      </entry>
      <entry>
       <para>
        来自 X Window 系统的各种启动和运行时日志。在调试失败的 X 启动时，该日志很有用。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/var/log/YaST2/</filename>
       </para>
      </entry>
      <entry>
       <para>
        包含 YaST 操作及其结果的目录。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/var/log/zypper.log</filename>
       </para>
      </entry>
      <entry>
       <para>
        zypper 的日志文件。
       </para>
      </entry>
     </row>
    </tbody>
   </tgroup>
  </table>

  <para>
   除了日志文件外，您的计算机还可提供关于运行中的系统的信息。请参见 <xref linkend="tab-trouble-system" xrefstyle="select:label title nopage"/>
  </para>

  <table xml:id="tab-trouble-system">
   <title><filename>/proc</filename> 文件系统的系统信息</title>
   <tgroup cols="2">
    <thead>
     <row>
      <entry>
       <para>
        文件
       </para>
      </entry>
      <entry>
       <para>
        描述
       </para>
      </entry>
     </row>
    </thead>
    <tbody>
     <row>
      <entry>
       <para>
        <filename>/proc/cpuinfo</filename>
       </para>
      </entry>
      <entry>
       <para>
        包含处理器信息，包括处理器类型、制造商、型号和性能。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/proc/dma</filename>
       </para>
      </entry>
      <entry>
       <para>
        显示当前使用的 DMA 通道。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/proc/interrupts</filename>
       </para>
      </entry>
      <entry>
       <para>
        显示正在使用的中断和已使用的中断数量。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/proc/iomem</filename>
       </para>
      </entry>
      <entry>
       <para>
        显示 I/O（输入/输出）内存的状态。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/proc/ioports</filename>
       </para>
      </entry>
      <entry>
       <para>
        显示当时正在使用的 I/O 端口。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/proc/meminfo</filename>
       </para>
      </entry>
      <entry>
       <para>
        显示内存状态。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/proc/modules</filename>
       </para>
      </entry>
      <entry>
       <para>
        显示各个模块。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/proc/mounts</filename>
       </para>
      </entry>
      <entry>
       <para>
        显示当前装入的设备。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/proc/partitions</filename>
       </para>
      </entry>
      <entry>
       <para>
        显示所有硬盘的分区。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/proc/version</filename>
       </para>
      </entry>
      <entry>
       <para>
        显示当前的 Linux 版本。
       </para>
      </entry>
     </row>
    </tbody>
   </tgroup>
  </table>

  <para>
   除了 <filename>/proc</filename> 文件系统外，Linux 内核还可通过 <literal>sysfs</literal> 模块（一个内存内的文件系统）导出信息。该模块表示了内核对象及其属性以及关系。有关 <literal>sysfs</literal> 的更多信息，请参见<xref linkend="cha-udev"/> 中 udev 的环境。<xref linkend="tab-trouble-sysfs" xrefstyle="select:label nopage"/> 包含 <filename>/sys</filename> 下最常见目录的概述。
  </para>

  <table xml:id="tab-trouble-sysfs">
   <title><filename>/sys</filename> 文件系统的系统信息</title>
   <tgroup cols="2">
    <thead>
     <row>
      <entry>
       <para>
        文件
       </para>
      </entry>
      <entry>
       <para>
        描述
       </para>
      </entry>
     </row>
    </thead>
    <tbody>
     <row>
      <entry>
       <para>
        <filename>/sys/block</filename>
       </para>
      </entry>
      <entry>
       <para>
        包含系统中发现的每个块设备的子目录。通常多数是磁盘类设备。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/sys/bus</filename>
       </para>
      </entry>
      <entry>
       <para>
        包含每个物理总线类型的子目录。
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/sys/class</filename>
       </para>
      </entry>
      <entry>
       <para>
        包含按设备功能类型分组的子目录（如图形、网络、打印机等）
       </para>
      </entry>
     </row>
     <row>
      <entry>
       <para>
        <filename>/sys/device</filename>
       </para>
      </entry>
      <entry>
       <para>
        包含全局设备层次结构。
       </para>
      </entry>
     </row>
    </tbody>
   </tgroup>
  </table>

  <para>
   Linux 带有一些用于系统分析和监视的工具。请参见<xref linkend="cha-util"/>以选择在系统诊断中使用的最重要的工具。
  </para>

  <para>
   以下包含的每个情景都以一个描述问题的标题开头，后跟一两段内容，提供建议的解决方案、解决方案详细信息的参考，以及对其他可能相关的情景的交叉引用。
  </para>
 </section>
 <section xml:id="sec-trouble-install">
  <title>安装问题</title>

  <para>
   安装问题是指计算机无法进行安装的情况。一种可能是完全无法进行安装，另一种是无法启动图形安装程序。本节将着重介绍几个您可能会遇到的典型问题，并提供可行的解决方案或针对此类情况的变通方案。
  </para>

  <section xml:id="sec-trouble-checkingMedia">
   <title>检查媒体</title><indexterm> <primary>Yast</primary><secondary>媒体检查</secondary></indexterm><indexterm><primary>DVD</primary><secondary>检查</secondary></indexterm>
   <para>
    如果您使用 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 安装媒体时遇到任何问题，请使用<menuchoice><guimenu>软件</guimenu> <guimenu>媒体检查</guimenu></menuchoice>检查安装媒体的完整性。您自己刻录的媒体更有可能出问题。要检查 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 媒体，将它插入驱动器中，在 YaST 的<guimenu>媒体检查</guimenu>屏幕中单击<guimenu>启动检查</guimenu>。这可能要花几分钟时间。如果检测到有任何错误，则不应使用此媒体进行安装。
   </para>
   <figure xml:id="fig-yast2-mediacheck">
    <title>检查媒体</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="yast2_medaicheck1.png" width="75%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_medaicheck1.png" width="75%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </section>

  <section xml:id="sec-trouble-hardinfo">
   <title>硬件信息</title><indexterm> <primary>硬件</primary><secondary>信息</secondary></indexterm><indexterm><primary>YaST</primary><secondary>硬件</secondary><tertiary>信息</tertiary></indexterm>
   <para>
    使用<menuchoice><guimenu>硬件</guimenu><guimenu>硬件信息</guimenu></menuchoice>显示检测到的硬件和技术数据。单击树的任意节点以获取有关设备的更多信息。在提交需要硬件信息的支持请求时，此模块特别有用。
   </para>
   <para>
    单击<guimenu>保存到文件</guimenu>将显示的硬件信息保存到文件。选择需要的目录和文件名，然后单击<guimenu>保存</guimenu>以创建文件。
   </para>
   <figure xml:id="fig-yast2-hardinfo">
    <title>显示硬件信息</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="yast2_hwinfo_1.png" width="75%" format="PNG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="yast2_hwinfo_1.png" width="75%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </section>

  <section xml:id="sec-trouble-install-cdrom">
   <title>没有可用于引导的 DVD 驱动器</title>
   <para>
    如果您的计算机没有可引导的 DVD-ROM 驱动器，或者 Linux 不支持您的驱动器，则有几种无需内置 DVD 驱动器便可安装计算机的方法：
   </para>



   <variablelist>
    <varlistentry>
     <term>从软盘引导</term>
     <listitem>
      <para>
       创建一张引导软盘，然后从软盘而非 DVD 引导。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>使用外置的引导设备</term>
     <listitem>
      <para>
       如果您的 BIOS 和安装内核支持，从外部 DVD 驱动器引导。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>通过 PXE 进行网络引导</term>
     <listitem>
      <para>
       如果计算机没有 DVD 驱动器，但是提供了有效的以太网连接，则可以执行完全基于网络的安装。详情请参见<xref linkend="sec-deployment-remoteinst-scenario-vncpxe"/>和<xref linkend="sec-deployment-remoteinst-scenario-sshpxe"/>。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <section xml:id="sec-trouble-install-cdrom-bdisk">
    <title>从软盘引导 (SYSLINUX)</title><indexterm> <primary>引导</primary><secondary>软盘, 从</secondary> </indexterm>
    <para>
     在某些较旧的计算机上，没有可用于引导的 DVD 驱动器，但有软盘驱动器。要在此类系统上安装，需要创建引导磁盘，然后使用引导磁盘引导系统。
    </para>
    <para>
     引导磁盘包括加载程序 SYSLINUX 和程序 linuxrc。SYSLINUX 支持在引导过程中选择内核以及指定所使用的硬件所需的任何参数。程序 linuxrc 支持为您的硬件装载内核模块并随后启动安装。
    </para>
    <para>
     在从引导磁盘引导时，引导过程由引导加载程序 SYSLINUX（<systemitem>syslinux</systemitem> 包）启动。当引导系统时，SYSLINUX 运行最小硬件检测，主要由以下步骤组成：
    </para>
    <orderedlist spacing="normal">
     <listitem>
      <para>
       该程序检查 BIOS 是否提供符合 VESA 2.0 的帧缓冲支持并相应地引导内核。
      </para>
     </listitem>
     <listitem>
      <para>
       读取监视数据（DDC 信息）。
      </para>
     </listitem>
     <listitem>
      <para>
       读取第一个硬盘的第一个块 (MBR) 以在引导加载程序配置过程中将 BIOS ID 映射到 Linux 设备名。程序将尝试通过 BIOS 的 lba32 功能读取块以确定 BIOS 是否支持这些功能。
      </para>
     </listitem>
    </orderedlist>
    <para>
     如果在 SYSLINUX 启动时按住 <keycap>Shift</keycap> 键，则将跳过所有这些步骤。出于查错的目的，请将行
    </para>
<screen>verbose 1</screen>
    <para>
     插入 <filename>syslinux.cfg</filename> 中，以便引导加载程序显示当前正在执行哪个操作。
    </para>
    <para>
     如果不能从软盘引导计算机，则可能需要将 BIOS 中的引导顺序更改为 <literal>A,C,CDROM</literal>。
    </para>
   </section>
   <section xml:id="sec-trouble-install-cdrom-ext">
    <title>外置引导设备</title>
    <para>
     Linux 支持多数的现有 DVD 驱动器。如果系统上既没有 DVD 驱动器也没有软盘驱动器，仍可能用通过 USB、FireWire 或 SCSI 连接的外部 DVD 驱动器引导系统。这主要取决于 BIOS 与所使用硬件的交互。如果遇到问题，有时执行 BIOS 更新可能会有用。
    </para>
   </section>
  </section>

  <section xml:id="sec-trouble-install-BIOS">
   <title>从安装媒体引导失败</title><indexterm> <primary>DVD</primary> <secondary>引导自</secondary></indexterm><indexterm> <primary>引导</primary> <secondary>DVD，来自</secondary></indexterm>
   <para>
    计算机不从安装媒体引导的一个原因可能是 BIOS 中的引导顺序的设置不正确。BIOS 引导顺序必须将 DVD 驱动器设置为第一引导项。否则计算机将尝试从其他媒体引导，通常为硬盘。 关于更改 BIOS 引导顺序的指南可在随主板提供的文档中找到，也可以参见以下段落。
   </para>
   <para>
    BIOS 是实现计算机最基本功能的软件。主板厂商提供专门为他们的硬件设计的 BIOS。通常，只能在特定时间（例如引导计算机时）访问 BIOS 设置。在此初始化阶段，计算机执行若干诊断硬件测试。其中一项测试就是内存检查，由内存计数器指示。当显示计数器时，请查找一行（通常在计数器下面，有时也在底部），该行提到要访问 BIOS 设置需要按的键。通常，要按的键是 <keycap>Del</keycap> 键、<keycap>F1</keycap> 键或 <keycap>Esc</keycap> 键之一。按此键，直到出现 BIOS 设置屏幕。
   </para>
   <procedure xml:id="proc-trouble-install-bios">
    <title>更改 BIOS 引导顺序</title>
    <step>
     <para>
      使用由引导例程声明的适当键输入 BIOS，然后等待 BIOS 屏幕出现。
     </para>
    </step>
    <step>
     <para>
      若要更改 AWARD BIOS 中的引导顺序，请查找 <guimenu>BIOS FEATURES SETUP</guimenu> 项。其他制造商可能对该项使用不同的名称，例如 <guimenu>ADVANCED CMOS SETUP</guimenu>。当您找到该项后，将其选中并按 <keycap>Enter</keycap> 键确认。
     </para>
    </step>
    <step>
     <para>
      在所打开的屏幕中，查找名为 <guimenu>BOOT SEQUENCE</guimenu> 或 <guimenu>BOOT ORDER</guimenu> 的子项。引导顺序形如 <literal>C,A</literal> 或 <literal>A,C</literal>。在前一种情况中，计算机首先搜索硬盘 (C)，然后搜索软盘驱动器 (A) 以查找可引导媒体。通过按 <keycap>PgUp</keycap> 键或 <keycap>PgDown</keycap> 键更改设置，直到顺序为 <literal>A、CDROM 和 C</literal>。
     </para>
    </step>
    <step>
     <para>
      通过按 <keycap>Esc</keycap> 键离开 BIOS 设置屏幕。若要保存更改，请选择 <guimenu>SAVE &amp; EXIT SETUP</guimenu> 或按 <keycap>F10</keycap> 键。若要确认应保存设置，按 <keycap>Y</keycap> 键。
     </para>
    </step>
   </procedure>
   <procedure>
    <title>更改 SCSI BIOS（Adaptec 主机适配器）中的引导顺序</title>
    <step>
     <para>
      按 <keycombo><keycap>Ctrl</keycap><keycap>A</keycap> </keycombo>打开设置。
     </para>
    </step>
    <step>
     <para>
      选择<guimenu>磁盘实用程序</guimenu>。现在将显示所连接的硬件组件。
     </para>
     <para>
      记下您 DVD 驱动器的 SCSI ID。
     </para>
    </step>
    <step>
     <para>
      按 <keycap>ESC</keycap> 退出菜单。
     </para>
    </step>
    <step>
     <para>
      打开<guimenu>配置适配器设置</guimenu>。在<guimenu>其他选项</guimenu>下，选择<guimenu>引导设备选项</guimenu>，然后按 <keycap>Enter</keycap> 键。
     </para>
    </step>
    <step>
     <para>
      输入 DVD 驱动器的 ID，然后再次按 <keycap>Enter</keycap> 键。
     </para>
    </step>
    <step>
     <para>
      按 <keycap>Esc</keycap> 键两次以返回到 SCSI BIOS 的开始屏幕。
     </para>
    </step>
    <step>
     <para>
      退出此屏幕，并确认<guimenu>是</guimenu>以引导计算机。
     </para>
    </step>
   </procedure>
   <para>
    无论最终安装将使用何种语言及键盘布局，大多数 BIOS 配置使用下图所示的美式键盘布局：<indexterm><primary>美式键盘布局</primary></indexterm>
   </para>
   <figure xml:id="fig-trouble-install-keyboard-us">
    <title>美式键盘布局</title>
    <mediaobject>
     <imageobject role="fo">
      <imagedata fileref="keyboard_us.svg" width="75%" format="SVG"/>
     </imageobject>
     <imageobject role="html">
      <imagedata fileref="keyboard_us.png" width="75%" format="PNG"/>
     </imageobject>
    </mediaobject>
   </figure>
  </section>

  <section xml:id="sec-trouble-install-noboot">
   <title>无法引导</title>
   <para>
    某些硬件类型（主要是过旧或非常新的硬件）可能无法安装。在许多情况下，可能由于安装内核中缺少此类硬件的支持或该内核中包含的某些功能（如 ACPI，它仍会在某些硬件上引起问题）而引起的。
   </para>
   <para>
    如果系统无法使用第一个安装引导屏幕上的标准<guimenu>安装</guimenu>方式进行安装，请尝试使用以下方法：
   </para>
   <procedure>
    <step>
     <para>
      将第一张 DVD 留在驱动器中，然后使用 <keycombo action="press"><keycap function="control">Ctrl</keycap><keycap function="alt">Alt</keycap> <keycap function="delete">Del</keycap></keycombo> 或硬件重设置按钮来重引导计算机。
     </para>
    </step>
    <step>
     <para>
      在出现引导屏幕时，按 <keycap>F5</keycap> 键，使用键盘上的箭头键浏览至<guimenu>无 ACPI</guimenu>，然后按 <keycap function="enter">Enter</keycap> 键起动引导和安装过程。此选项将禁用对 ACPI 电源管理技术的支持。
     </para>
    </step>
    <step>
     <para>
      按<xref linkend="cha-inst"/>中所述的步骤进行安装。
     </para>
    </step>
   </procedure>
   <para>
    如果此操作失败，请按照以上步骤继续，但应选择<guimenu>安全设置</guimenu>。此选项将禁用 ACPI 和 DMA 支持。 大多数硬件应使用此选项引导。
   </para>
   <para>
    如果以上两个选项都失败，请使用引导选项提示向安装内核传递支持此硬件类型所需的任何其他参数。关于可用作引导选项的参数的更多信息，请参见 <filename>/usr/src/linux/Documentation/kernel-parameters.txt</filename> 中的内核文档。
   </para>
   <tip>
    <title>获取内核文档</title>
    <para>
     安装 <systemitem class="systemname">kernel-source</systemitem> 包以查看内核文档。
    </para>
   </tip>
   <para>
    在引导安装之前，还有各种其他与 ACPI 相关的内核参数可在引导提示处输入：
   </para>
   <variablelist>
    <varlistentry>
     <term><systemitem>acpi=off</systemitem>
     </term>
     <listitem>
      <para>
       此参数禁用计算机上的整个 ACPI 子系统。如果您的计算机根本不能处理 ACPI 或如果您认为是计算机中的 ACPI 导致问题的产生，则可以使用此参数。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>acpi=force</systemitem>
     </term>
     <listitem>
      <para>
       始终启用 ACPI，即使计算机使用的是 2000 年以前的 BIOS。如果除了 <systemitem>acpi=off</systemitem> 之外还设置了此参数，则此参数将启用 ACPI。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>acpi=noirq</systemitem>
     </term>
     <listitem>
      <para>
       不要将 ACPI 用于 IRQ 路由。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>acpi=ht</systemitem>
     </term>
     <listitem>
      <para>
       只运行足够的 ACPI 来启用超线程。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>acpi=strict</systemitem>
     </term>
     <listitem>
      <para>
       降低对不严格遵循 ACPI 规格的平台的容许度。
      </para>
     </listitem>
    </varlistentry>



    <varlistentry>
     <term><systemitem>pci=noacpi</systemitem>
     </term>
     <listitem>
      <para>
       禁用新 ACPI 系统的 PCI IRQ 路由。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>pnpacpi=off</systemitem>
     </term>
     <listitem>
      <para>
       在您的 BIOS 设置包含错误的中断或端口时，此选项用于串行或并行问题。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>notsc</systemitem>
     </term>
     <listitem>
      <para>
       禁用时戳计数器。此选项可用于解决系统上的计时问题。这是一项新功能，如果看到计算机上有衰退，尤其是时间相关的或甚至完全挂起，此选项值得一试。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><systemitem>nohz=off</systemitem>
     </term>
     <listitem>
      <para>
       禁用 nohz 功能。如果您的计算机挂起，则此选项可能有帮助。否则就没有用处。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
   <para>
    一旦确定了正确的参数组合，YaST 会自动将其写入引导加载程序配置中以确保系统下一次能够正确引导。
   </para>
   <para>
    如果在装载内核或安装过程中出现无法解释的错误，则在引导菜单中选择<guimenu>内存测试</guimenu>以检查内存。如果<guimenu>内存测试</guimenu>返回一个错误，则通常这是硬件错误。
   </para>
  </section>

  <section xml:id="sec-trouble-install-graph">
   <title>无法启动图形安装程序</title>
   <para>
    在将媒体插入驱动器并重引导计算机之后，出现安装屏幕，但是在选择<guimenu>安装</guimenu>之后，图形安装程序没有启动。
   </para>
   <para>
    有多种方法可解决此情况：
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      尝试为安装对话框另选一种屏幕分辨率。
     </para>
    </listitem>
    <listitem>
     <para>
      选择<guimenu>文本方式</guimenu>进行安装。
     </para>
    </listitem>
    <listitem>
     <para>
      使用图形安装程序进行远程安装（通过 VNC）。
     </para>
    </listitem>
   </itemizedlist>
   <procedure xml:id="proc-trouble-install-graph">
    <title>安装时更改屏幕分辨率</title>
    <step>
     <para>
      引导以安装。
     </para>
    </step>
    <step>
     <para>
      按 <keycap>F3</keycap> 键打开一个菜单，从中选择一个较低的安装分辨率。
     </para>
    </step>
    <step>
     <para>
      选择<guimenu>安装</guimenu>，然后按<xref linkend="cha-inst"/>中所述的步骤进行安装。
     </para>
    </step>
   </procedure>
   <procedure xml:id="proc-trouble-install-text">
    <title>用文本方式进行安装</title>
    <step>
     <para>
      引导以安装。
     </para>
    </step>
    <step>
     <para>
      按 <keycap>F3</keycap>，然后选择<guimenu>文本方式</guimenu>。
     </para>
    </step>
    <step>
     <para>
      选择<guimenu>安装</guimenu>，然后按<xref linkend="cha-inst"/>中所述的步骤进行安装。
     </para>
    </step>
   </procedure>
   <procedure xml:id="proc-trouble-install-vnc">
    <title>VNC 安装</title>
    <step>
     <para>
      引导以安装。
     </para>
    </step>
    <step>
     <para>
      在引导选项提示下输入以下文本：
     </para>
<screen>vnc=1 vncpassword=<replaceable>some_password</replaceable></screen>
     <para>
      将 <replaceable>some_password</replaceable> 替换为用于 VNC 安装的口令。
     </para>
    </step>
    <step>
     <para>
      选择<guimenu>安装</guimenu>，然后按 <keycap function="enter">Enter</keycap> 键启动安装。
     </para>
     <para>
      系统未正确启动图形安装例程，而是仍以文本方式继续运行，接着暂停，显示一条消息，其中包含了可通过浏览器界面或 VNC 查看器应用程序访问安装程序的 IP 地址和端口号。
     </para>
    </step>
    <step>
     <para>
      如果使用浏览器来访问安装程序，请启动浏览器并输入由未来 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 计算机上的安装例程提供的地址信息，然后按 <keycap function="enter">Enter</keycap> 键：
     </para>
<screen>http://<replaceable>ip_address_of_machine</replaceable>:5801</screen>
     <para>
      随后浏览器窗口中将打开一个对话框，提示您输入 VNC 口令。输入口令，然后按<xref linkend="cha-inst"/>中所述的步骤进行安装。
     </para>
     <important>
      <para>
       通过 VNC 安装这一方法可在任意操作系统下的任意浏览器上进行，只要启用了 Java 支持即可。
      </para>
     </important>
     <para>
      看到提示时，提供您的 VNC 查看器的 IP 地址和口令。然后，将打开一个窗口，其中显示了多个安装对话框。照常进行安装。
     </para>
    </step>
   </procedure>
  </section>

  <section xml:id="sec-trouble-install-mini">
   <title>只能启动简陋的引导屏幕</title>
   <para>
    将媒体插入了驱动器，BIOS 例程结束，但是系统未启动图形引导屏幕。而是启动了一个非常简陋的基于文本的界面。 如果计算机的图形内存不足而无法生成图形引导屏幕，则可能发生这种情况。
   </para>
   <para>
    虽然文本引导屏幕看起来比较简陋，但是它所提供的功能与图形引导屏幕几乎是相同的。
   </para>
   <variablelist>
    <varlistentry>
     <term>引导选项</term>
     <listitem>
      <para>
       与图形界面不同的是，不能使用键盘的鼠标键来选择其他引导选项。文本引导屏幕上的引导菜单提供了一些可在引导提示下输入的关键字。这些关键字与图形版本中提供的选项相对应。输入您的选择，然后按 <keycap function="enter">Enter</keycap> 键以启动引导过程。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>自定义引导选项</term>
     <listitem>
      <para>
       在选择引导选项之后，请在引导提示下输入相应的关键字，或者根据<xref linkend="sec-trouble-install-noboot"/> 中所述输入自定义引导选项。要启动安装过程，请按 <keycap function="enter">Enter</keycap> 键。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>屏幕分辨率</term>
     <listitem>
      <para>
       使用 F 键来确定安装屏幕的分辨率。如果需要以文本方式引导，请选择 <keycap>F3</keycap>。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </section>
 </section>
 <section xml:id="sec-trouble-boot">
  <title>引导问题</title>

  <para>
   引导问题是指系统不能正确引导时出现的情况（不能引导到期望的运行级别和登录屏幕）。
  </para>

  <section xml:id="sec-trouble-boot-nogrub">
   <title>无法装载 GRUB 引导加载程序</title>
   <para>
    如果硬件运行正常，则可能是由于引导加载程序已损坏而使 Linux 无法在计算机上启动。在这种情况下，需要重安装引导加载程序。要重安装引导加载程序，请执行如下操作：
   </para>
   <procedure>
    <step>
     <para>
      将安装介质插入驱动器中。
     </para>
    </step>
    <step>
     <para>
      重引导计算机。
     </para>
    </step>
    <step>
     <para>
      从引导菜单中选择<guimenu>安装</guimenu>。
     </para>
    </step>
    <step>
     <para>
      选择一种语言。
     </para>
    </step>
    <step>
     <para>
      接受许可证协议。
     </para>
    </step>
    <step>
     <para>
      在<guimenu>安装模式</guimenu>屏幕中，选择<guimenu>修复已安装系统</guimenu>。
     </para>
    </step>
    <step>
     <para>
      然后在“YaST 系统修复”模块中，选择<guimenu>专家工具</guimenu>，再选择<guimenu>安装新引导加载程序</guimenu>。
     </para>
    </step>
    <step>
     <para>
      恢复原始设置并重安装引导加载程序。
     </para>
    </step>
    <step>
     <para>
      退出“YAST 系统修复”模块并重新引导系统。
     </para>
    </step>
   </procedure>
   <para>
    其他导致计算机无法引导的原因可能与 BIOS 相关：
   </para>
   <variablelist>
    <varlistentry>
     <term>BIOS 设置</term>
     <listitem>
      <para>
       请检查 BIOS 中对硬盘驱动器的引用。如果在当前的 BIOS 设置中找不到硬盘驱动器本身，则 GRUB 可能就不能启动。
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term>BIOS 引导顺序</term>
     <listitem>
      <para>
       请检查您的系统引导顺序中是否包含硬盘。如果未启用硬盘选项，即使系统正确安装，在访问所需的硬盘时仍可能无法引导。
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </section>

  

  <section xml:id="sec-trouble-boot-prompt">
   <title>无图形登录</title>
   <para>
    如果计算机能够启动，但是无法引导到图形登录管理器中，则问题可能出在默认的运行级别选项或 X Window 系统的配置上。要检查运行级别配置，请作为 <systemitem class="username">root</systemitem> 用户登录，然后检查计算机是否配置为引导到运行级别 5（图形桌面）。有一个快捷的检查方法就是检验 <filename>/etc/inittab</filename> 中的如下内容：
   </para>
<screen>tux@mercury:~&gt; grep "id:" /etc/inittab 
id:5:initdefault:</screen>
   <para>
    如果返回的行表明计算机的默认运行级别（<literal>initdefault</literal>）设置为 <literal>5</literal>，则它将引导到图形桌面。如果运行级别设置为其他任何数字，请使用“YaST 运行级别编辑器”模块将其设置为 <literal>5</literal>。
   </para>
   <important>
    <para>
     请不要手动编辑运行级别配置。否则 SUSEconfig（由 YaST 运行）将在其下次运行时覆盖这些更改。如果需要在此处进行手动更改，请将 <filename>/etc/sysconfig/suseconfig</filename> 中的 <replaceable>CHECK_INITTAB</replaceable> 设置为 <option>no</option> 以禁用未来的 SUSEconfig 更改。
    </para>
   </important>
   <para>
    如果运行级别设置为 <literal>5</literal>，您的桌面或 X Windows 软件可能配置错误或已损坏。请检验 <filename>/var/log/Xorg.*.log</filename> 中的日志文件，查找它尝试启动的 X 服务器发出的详细消息。 如果桌面在启动时发生故障，它可能将错误消息记录到 <filename>/var/log/messages</filename> 中。如果这些错误消息指出问题出在 X 服务器中的配置上，请尝试修正这些问题。如果图形系统仍无法启动，请考虑重安装图形桌面。
   </para>
   <tip>
    <title>手动启动 X Window 系统</title>
    <para>
     一项快速测试：如果用户当前登录到了控制台，<command>startx</command> 命令会强制 X Window 系统使用已配置的默认值启动。 如果这不起作用，它将把错误记录到控制台中。 
    </para>
   </tip>
  </section>
 </section>
 <section xml:id="sec-trouble-login">
  <title>登录问题</title>

  <para>
   登录问题是指计算机实际上已引导到期望的欢迎屏幕或登录提示下，但是拒绝接受用户名和口令，或者虽然接受了用户名和口令，但是未能正确地运行（无法启动图形桌面、发生错误或转到了命令行等）。
  </para>

  <section xml:id="sec-trouble-login-no">
   <title>有效的用户名和口令组合失败</title>
   <para>
    如果系统配置为使用网络身份验证或目录服务，但由于某些原因无法从其已配置的服务器上检索到结果，则通常会发生此问题。只有作为唯一本地用户的 <systemitem class="username">root</systemitem> 用户仍能登录到这些计算机。以下是计算机似乎能够运行但是无法正确处理登录的常见原因：
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      网络出现故障。有关此问题的进一步说明，请转到<xref linkend="sec-trouble-netconfig"/>。
     </para>
    </listitem>
    <listitem>
     <para>
      DNS 在当时不起作用（这使得 GNOME 或 KDE 不起作用，并使系统无法向安全服务器发出经验证的请求）。如果是这种情况，则表现为计算机对任何操作的响应都需要极其长的时间。有关该主题的详细信息，请参见 <xref linkend="sec-trouble-netconfig"/>。
     </para>
    </listitem>
    <listitem>
     <para>
      如果将系统配置为使用 Kerberos，则系统的本地时间与 Kerberos 服务器时间之间的差异可能超过了可接受的值（通常为 300 秒）。如果 NTP（网络时间协议）未正确地起作用，或者本地 NTP 服务器不起作用，则 Kerberos 身份验证将不再工作，因为该身份验证依赖于整个网络的通用时钟同步。
     </para>
    </listitem>
    <listitem>
     <para>
      系统的身份验证配置不正确。请对相关的 PAM 配置文件进行检查以确定是否存在指令输入错误或排序错误。有关 PAM 的其他背景信息及相关配置文件的语法，请参见<xref linkend="cha-pam"/>。
     </para>
    </listitem>
    <listitem>
     <para>
      主分区是加密的。有关该主题的详细信息，请参见 <xref linkend="sec-trouble-login-encrypted"/>。
     </para>
    </listitem>
   </itemizedlist>
   <para>
    在不涉及外部网络问题的所有情况下，解决方法是将系统重引导到单用户方式并修复配置，然后再次引导到操作方式并重试登录。要引导到单用户方式，请执行以下操作：
   </para>
   <procedure xml:id="proc-trouble-login-no">
    <step>
     <para>
      重引导系统。此时将出现引导屏幕，其中显示一个提示。
     </para>
    </step>
    <step>
     <para>
      在引导提示下输入 <command>1</command>，使系统引导到单用户方式。
     </para>
    </step>
    <step>
     <para>
      输入<systemitem class="username"> root </systemitem>用户的用户名和口令。
     </para>
    </step>
    <step>
     <para>
      进行必要的一切更改。
     </para>
    </step>
    <step>
     <para>
      在命令行中输入 <command>telinit 5</command> 以引导到完全的多用户和网络方式。
     </para>
    </step>
   </procedure>
  </section>

  <section xml:id="sec-trouble-login-pw">
   <title>不接受有效的用户名和口令</title>
   <para>
    这是到目前为止用户最常遇到的问题，因为有许多原因可能引起该问题。登录失败可由多种原因造成，取决于您是使用本地用户管理和身份验证，还是使用网络身份验证。
   </para>
   <para>
    本地用户管理失败可由以下原因造成：
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      用户可能输入了错误的口令。
     </para>
    </listitem>
    <listitem>
     <para>
      用户包含桌面配置文件的主目录已损坏或被写保护。
     </para>
    </listitem>
    <listitem>
     <para>
      验证该特定用户的 X Window 系统可能存在问题，尤其是在安装当前版本之前，该用户的主目录已被其他 Linux 分发版使用时。
     </para>
    </listitem>
   </itemizedlist>
   <para>
    要找到本地登录失败的原因，请执行如下操作：
   </para>
   <procedure>
    <step>
     <para>
      在尝试调试整个身份验证机制之前，请检查用户所记的口令是否正确。如果用户可能记错了口令，请使用“YaST 用户管理”模块更改用户的口令。注意 <keycap>Caps Lock</keycap> 键，如果需要请解锁。
     </para>
    </step>
    <step>
     <para>
      以 <systemitem class="username">root</systemitem> 用户身份登录并检查 <filename>/var/log/messages</filename> 以找到登录过程和 PAM 的错误消息。
     </para>
    </step>
    <step>
     <para>
      尝试从控制台登录（使用 <keycombo><keycap function="control">CTRL</keycap><keycap function="alt">Alt</keycap><keycap>F1</keycap></keycombo>）。如果成功了，则问题不在 PAM 上，因为可以在该计算机上身份验证此用户。尝试找出任何与 X Window 系统或桌面（GNOME 或 KDE）有关的错误。有关更多信息，请参见<xref linkend="sec-trouble-login-dk"/> 和<xref linkend="sec-trouble-login-kde"/>。
     </para>
    </step>
    <step>
     <para>
      如果用户的主目录被其他 Linux 产品所使用，请将该用户主目录中的 <filename>Xauthority</filename> 文件删除。使用控制台登录（通过 <keycombo><keycap function="control">Ctrl</keycap><keycap function="alt">Alt</keycap><keycap>F1</keycap></keycombo>），然后以该用户的身份运行<command/> rm .Xauthority。这样应该可以消除该用户的 X 身份验证问题。然后再次尝试图形登录。
     </para>
    </step>
    <step>
     <para>
      如果图形登录依然失败，请使用 <keycombo><keycap function="control">Ctrl</keycap><keycap function="alt">Alt</keycap><keycap>F1</keycap></keycombo> 进行控制台登录。尝试在另一个屏幕上启动 X 会话，第一个（<literal>:0</literal>）已在使用：
     </para>
<screen>startx -- :1</screen>
     <para>
      这样应该可以显示图形屏幕和桌面。如果无效，请查看 X Window 系统的日志文件（<filename>/var/log/Xorg.<replaceable>displaynumber</replaceable>.log</filename>）或您桌面应用程序的日志文件（用户主目录中的 <filename>.xsession-errors</filename>），以确定是否有任何违反规则的地方。
     </para>
    </step>
    <step>
     <para>
      如果桌面由于配置文件损坏而无法启动，请参见<xref linkend="sec-trouble-login-dk"/> 或<xref linkend="sec-trouble-login-kde"/>。
     </para>
    </step>
   </procedure>
   <para>
    以下是在特定的计算机上对特定用户的网络身份验证可能失败的常见原因：
   </para>
   <itemizedlist mark="bullet" spacing="normal">
    <listitem>
     <para>
      用户可能输入了错误的口令。
     </para>
    </listitem>
    <listitem>
     <para>
      用户名存在于计算机的本地身份验证文件中，但同时网络身份验证系统也提供了该用户名，从而引起冲突。
     </para>
    </listitem>
    <listitem>
     <para>
      主目录存在，但已损坏或不可用。该目录可能处于写保护状态或位于此刻无法访问的服务器上。
     </para>
    </listitem>
    <listitem>
     <para>
      用户无权登录到身份验证系统中的该特定主机。
     </para>
    </listitem>
    <listitem>
     <para>
      计算机出于某种原因更改了主机名，而用户无权登录到该主机。
     </para>
    </listitem>
    <listitem>
     <para>
      计算机无法访问包含该用户信息的身份验证服务器或目录服务器。
     </para>
    </listitem>
    <listitem>
     <para>
      验证该特定用户的 X Window 系统可能存在问题，尤其是在安装当前办法之前，该用户的主目录已被其他 Linux 分发版使用时。
     </para>
    </listitem>
   </itemizedlist>
   <para>
    要通过网络身份验证找到登录问题的原因，请执行以下步骤：
   </para>
   <procedure xml:id="proc-trouble-login-pw">
    <step>
     <para>
      在尝试调试整个身份验证机制之前，请检查用户所记的口令是否正确。
     </para>
    </step>
    <step>
     <para>
      确定计算机在身份验证时要依赖的目录服务器，并确保计算机在正常运行且与其他计算机正常通讯。
     </para>
    </step>
    <step>
     <para>
      确定该用户的用户名和口令在其他计算机上是否有效，以确保存在该用户的身份验证数据且已正确分发。
     </para>
    </step>
    <step>
     <para>
      确定其他用户是否可以登录到该故障计算机。如果其他用户可以毫无困难地登录或者 <systemitem class="username">root</systemitem> 用户可以登录，请登录并检验 <filename>/var/log/messages</filename> 文件。找到与登录尝试相对应的时间戳记，然后确定 PAM 是否生成了任何错误消息。
     </para>
    </step>
    <step>
     <para>
      尝试从控制台登录（使用 <keycombo><keycap function="control">Ctrl</keycap><keycap function="alt">Alt</keycap><keycap>F1</keycap></keycombo>）。如果成功，则问题不在用户主目录中的 PAM 或目录服务器上，因为可以在该计算机上验证此用户。尝试找出任何与 X Window 系统或桌面（GNOME 或 KDE）有关的错误。有关更多信息，请参见<xref linkend="sec-trouble-login-dk"/> 和<xref linkend="sec-trouble-login-kde"/>。
     </para>
    </step>
    <step>
     <para>
      如果用户的主目录被其他 Linux 产品所使用，请将该用户主目录中的 <filename>Xauthority</filename> 文件删除。使用控制台登录（通过 <keycombo><keycap function="control">Ctrl</keycap><keycap function="alt">Alt</keycap><keycap>F1</keycap></keycombo>），然后以该用户的身份运行<command/> rm .Xauthority。这样应该可以消除该用户的 X 身份验证问题。然后再次尝试图形登录。
     </para>
    </step>
    <step>
     <para>
      如果图形登录依然失败，请使用 <keycombo><keycap function="control">Ctrl</keycap><keycap function="alt">Alt</keycap><keycap>F1</keycap></keycombo> 进行控制台登录。尝试在另一个屏幕上启动 X 会话，第一个（<literal>:0</literal>）已在使用：
     </para>
<screen>startx -- :1</screen>
     <para>
      这样应该可以显示图形屏幕和桌面。如果无效，请查看 X Window 系统的日志文件（<filename>/var/log/Xorg.<replaceable>displaynumber</replaceable>.log</filename>）或您桌面应用程序的日志文件（用户主目录中的 <filename>.xsession-errors</filename>），以确定是否有任何违反规则的地方。
     </para>
    </step>
    <step>
     <para>
      如果桌面由于配置文件损坏而无法启动，请参见<xref linkend="sec-trouble-login-dk"/> 或<xref linkend="sec-trouble-login-kde"/>。
     </para>
    </step>
   </procedure>
  </section>

  <section xml:id="sec-trouble-login-encrypted">
   <title>登录至加密的主分区失败</title><indexterm> <primary>加密</primary> <secondary>主分区问题</secondary></indexterm>
   <para>
    对于便携式计算机建议使用加密的主分区。如果无法登录到您的便携式计算机，原因通常很简单：您的分区无法解锁。
   </para>
   <para>
    在引导时，必须输入通行口令来解锁加密的分区。如果不输入它，引导进程继续，但保持分区锁定。
   </para>
   <para>
    要解锁您的加密分区，请如下操作：
   </para>
   <procedure>
    <step>
     <para>
      按 <keycombo> <keycap function="control"/> <keycap function="alt"/> <keycap>F1</keycap> </keycombo> 切换到文本控制台。
     </para>
    </step>
    <step>
     <para>
      成为 <systemitem class="username">root </systemitem>用户。
     </para>
    </step>
    <step>
     <para>
      用以下步骤重启动解锁进程：
     </para>
<screen>/etc/init.d/boot.crypto restart</screen>
    </step>
    <step>
     <para>
      输入您的通行口令以解锁加密的分区。
     </para>
    </step>
    <step>
     <para>
      用 <keycombo><keycap function="alt"/> <keycap>F7</keycap> </keycombo> 退出文本控制台并切换回登录屏幕。
     </para>
    </step>
    <step>
     <para>
      如常登录。
     </para>
    </step>
   </procedure>
  </section>

  <section xml:id="sec-trouble-login-dk">
   <title>登录成功但 GNOME 桌面发生故障</title>
   <para>
    如果是这种情况，可能您的 GNOME 配置文件已损坏。可能出现的症状包括键盘不起作用、屏幕几何图形变形，甚至整个屏幕变成灰色。而最重要的差别在于其他用户登录时，该计算机能正常运行。 那么可能只需将用户的 GNOME 配置目录移到某个新位置，以便使 GNOME 初始化一个新的桌面，这样就能很快地解决此问题。虽然用户不得不重配置 GNOME，但不会丢失任何数据。
   </para>
   <procedure xml:id="proc-trouble-login-dk">
    <step>
     <para>
      按 <keycombo> <keycap function="control"/> <keycap function="alt"/> <keycap>F1</keycap> </keycombo> 切换到文本控制台。
     </para>
    </step>
    <step>
     <para>
      用您的用户名登录。
     </para>
    </step>
    <step>
     <para>
      将用户的 GNOME 配置目录移到某个临时位置：
     </para>
<screen>mv .gconf  .gconf-ORIG-RECOVER
mv .gnome2 .gnome2-ORIG-RECOVER</screen>
    </step>
    <step>
     <para>
      注销。
     </para>
    </step>
    <step>
     <para>
      再次登录，但别运行任何应用程序。
     </para>
    </step>
    <step>
     <para>
      通过以下命令将 <filename>~/.gconf-ORIG-RECOVER/apps/</filename> 目录复制回新的 <filename>~/.gconf</filename> 目录，这样就能恢复您的个人应用程序配置数据（包括 Evolution 电子邮件客户端数据）：
     </para>
<screen>cp -a .gconf-ORIG-RECOVER/apps .gconf/</screen>
     <para>
      如果这引起登录问题，则尝试只恢复重要的应用程序数据并重配置其他的应用程序。
     </para>
    </step>
   </procedure>
  </section>

  <section xml:id="sec-trouble-login-kde">
   <title>登录成功但 KDE 桌面发生故障</title>
   <para>
    KDE 桌面不允许用户登录有多种原因。高速缓存数据以及 KDE 桌面配置文件的损坏都可能引起登录问题。
   </para>
   <para>
    桌面在启动时会用到缓存数据，这将提高性能。如果数据损坏，则启动将变慢或完全失败。将缓存数据删除会强制桌面启动例程从头开始。这样会花费比正常启动更多的时间，但是在这之后数据将完好无缺，用户也可以登录。
   </para>
   <para>
    要删除 KDE 桌面的高速缓存文件，请以 <systemitem class="username">root</systemitem> 用户身份发出以下命令：
   </para>
<screen>rm -rf /tmp/kde-<replaceable>user</replaceable> /tmp/ksocket-<replaceable>user</replaceable></screen>
   <para>
    使用您的用户名来替换 <replaceable>user</replaceable>。将这两个目录删除只是删除损坏的高速缓存文件，使用该过程并不会破坏实际数据。
   </para>
   <para>
    损坏的桌面配置文件始终可以用初始配置文件替换。如果想要恢复用户所作的调整，请在使用默认配置值恢复配置之后，将这些调整从其临时位置小心地复制回原来的位置。
   </para>
   <para>
    要将损坏的桌面配置替换为初始配置值，请执行如下操作：
   </para>
   <procedure xml:id="proc-trouble-login-kde">
    <step>
     <para>
      按<keycombo> <keycap function="control"/> <keycap function="alt"/> <keycap>F1</keycap> </keycombo>切换到文本控制台。
     </para>
    </step>
    <step>
     <para>
      用您的用户名登录。
     </para>
    </step>
    <step xml:id="st-trouble-login-kde-mv">
     <para>
      将 KDE 配置目录和 <filename>.skel</filename> 文件移到临时位置：
     </para>
     <itemizedlist mark="bullet" spacing="normal">
      <listitem>
       <para>
        对于 KDE3 使用以下命令：
       </para>
<screen>mv .kde  .kde-ORIG-RECOVER 
mv .skel .skel-ORIG-RECOVER<replaceable/></screen>
      </listitem>
      <listitem>
       <para>
        对于 KDE4 使用以下命令：
       </para>
<screen>mv .kde4  .kde4-ORIG-RECOVER 
mv .skel .skel-ORIG-RECOVER<replaceable/></screen>
      </listitem>
     </itemizedlist>
    </step>
    <step>
     <para>
      注销。
     </para>
    </step>
    <step>
     <para>
      再次登录。
     </para>
    </step>
    <step>
     <para>
      在成功启动桌面之后，将用户自己的配置复制回原来的位置：
     </para>
<screen>cp -a <replaceable>KDEDIR</replaceable>/share .kde/share</screen>
     <para>
      将 <replaceable>KDEDIR</replaceable> 替换为<xref linkend="st-trouble-login-kde-mv"/> 中的目录。
     </para>
     <important>
      <para>
       如果用户自己的调整先前引起了登录失败并仍然如此，请重复上述步骤，但是不要复制 <filename>.kde/share</filename> 目录。
      </para>
     </important>
    </step>
   </procedure>
  </section>
 </section>
 <section xml:id="sec-trouble-netconfig">
  <title>网络问题</title>

  <para>
   系统的许多问题可能都与网络相关，即使初看起来不是这样。例如，系统不允许用户登录可能是某种网络问题造成的。本节介绍一个简单的核对表，您可以使用它来确定任何所遇到的网络问题的原因。
  </para>

  <procedure xml:id="proc-trouble-config-net">
   <title>如何识别网络故障</title>
   <para>
    在检查计算机的网络连接时，请执行如下操作：
   </para>
   <step>
    <para>
     如果使用的是以太网连接，请首先检查硬件。确保您的网络电缆已正确插入计算机和路由器（或集线器等）。以太网连接器旁边的控制灯通常应全部激活。
    </para>
    <para>
     如果连接失败，请检查网线在别的计算机上是否正常。如果正常，则可能是网卡引起了该问题。如果您的网络设置中有集线器或交换机，它们也可能有故障。
    </para>
   </step>
   <step>
    <para>
     如果使用的是无线连接，请检查是否可与其他计算机建立此无线链接。 如果没有，请联系无线网络的管理员。
    </para>
   </step>
   <step>
    <para>
     一旦完成了对基本网络连通性的检查，请尝试找出没有响应的服务。收集设置中所需的所有网络服务器的地址信息。在相应的 YaST 模块中查找这些信息，或者询问您的系统管理员。以下列表给出了设置中涉及的一些典型网络服务器问题以及服务中断的症状。
    </para>
    <variablelist>
     <varlistentry>
      <term>DNS（名称服务）</term>
      <listitem>
       <para>
        名称服务中断或发生故障会在许多方面影响网络运行。如果本地计算机依赖于任何网络服务器进行身份验证，但由于名称解析问题而无法找到这些服务器，则用户甚至可能无法登录。网络中由中断的名称服务管理的计算机将无法<quote>看到</quote>彼此且不能通信。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>NTP（时间服务）</term>
      <listitem>
       <para>
        NTP 服务发生故障或完全中断可能会影响 Kerberos 身份验证和 X 服务器功能。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>NFS（文件服务）</term>
      <listitem>
       <para>
        如果任何应用程序所需的数据储存在 NFS 装入目录中，则一旦此服务停止或配置错误，应用程序将无法启动或正常运行。最坏的情况是，如果由于 NFS 服务器发生故障而无法找到包含 <filename>.gconf</filename> 或 <filename>.kde</filename> 子目录的用户主目录，则该用户主目录所属的用户的个人桌面配置将无法启动。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Samba（文件服务）</term>
      <listitem>
       <para>
        如果任何应用程序需要储存在有故障的 Samba 服务器目录中的数据，它将不能启动或正常运行。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>NIS（用户管理）</term>
      <listitem>
       <para>
        如果您的 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 系统依赖有故障的 NIS 服务器提供用户数据，用户将无法登录此计算机。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>LDAP（用户管理）</term>
      <listitem>
       <para>
        如果您的 <phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 系统依赖有故障的 LDAP 服务器提供用户数据，用户将无法登录此计算机。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>Kerberos（身份验证）</term>
      <listitem>
       <para>
        身份验证无法进行，登录至任何计算机都会失败。
       </para>
      </listitem>
     </varlistentry>
     <varlistentry>
      <term>CUPS（网络打印）</term>
      <listitem>
       <para>
        用户无法打印。
       </para>
      </listitem>
     </varlistentry>
    </variablelist>
   </step>
   <step>
    <para>
     请检查网络服务器是否正在运行并且您的网络设置是否允许您建立连接：
    </para>
    <important>
     <para>
      下面介绍的调试步骤只适用于简单的网络服务器/客户端设置，不涉及任何内部路由。假设服务器和客户端都是同一子网的成员，不需要额外的路由。
     </para>
    </important>
    <substeps performance="required">
     <step>
      <para>
       可使用 <command>ping</command> <replaceable>IP 地址</replaceable>或<replaceable>主机名</replaceable>（将<replaceable>主机名</replaceable>替换为服务器的主机名）来检查各台服务器是否正在运行且能够对网络作出响应。如果此命令成功，表示您所查找的主机在正常运行，并且网络的名称服务配置正确。
      </para>
      <para>
       如果 ping 命令失败，同时显示消息<literal>目标主机不可访问</literal>，则表明您的系统或期望的服务器未正确配置或已宕机。可从其他计算机运行 <command>ping</command> <replaceable>IP 地址</replaceable>或<replaceable>您的主机名</replaceable>命令来检查您的系统是否可达。如果可以从其他计算机访问您的计算机，则服务器不会运行或正确配置。
      </para>
      <para>
       如果 ping 命令失败，同时显示<literal>未知主机</literal>，则表示名称服务未正确配置或使用的主机名不正确。要对该问题进行进一步的检查，请参见<xref linkend="st-trouble-config-net-host" xrefstyle="StepOnPage"/>。 如果 ping 命令仍然失败，则可能网卡未正确配置或网络硬件存在故障。 
      </para>
     </step>
     <step xml:id="st-trouble-config-net-host">
      <para>
       请使用 <command>host</command> <replaceable>hostname</replaceable> 来检查您尝试连接的服务器的主机名是否能够正确地转换为 IP 地址，反之亦然。如果此命令返回了该主机的 IP 地址，则名称服务已在正常运行。如果 <command>host</command> 命令失败，请检查您主机上所有与名称和地址解析相关的网络配置文件：
      </para>



      <variablelist>
       <varlistentry>
        <term><filename>/etc/resolv.conf</filename>
        </term>
        <listitem>
         <para>
          此文件用于对当前使用的名称服务器和域进行跟踪。您可手工修改该文件，或者由 YaST 或 DHCP 自动调整。建议采用自动调整。但是，请确保此文件具有以下结构并且所有的网络地址和域名都正确无误：
         </para>
<screen>search <replaceable>fully_qualified_domain_name</replaceable>
nameserver <replaceable>ipaddress_of_nameserver</replaceable></screen>
         <para>
          此文件中可以包含多个名称服务器地址，但是其中必须至少有一个能够对您的主机提供正确的名称解析。如果需要，请使用 YaST“网络设置”模块（“主机名/DNS”选项卡）调整此文件。
         </para>
         <para>
          如果网络连接是通过 DHCP 处理的，请在“YaST DNS 和主机名”模块中选择<guimenu>通过 DHCP 更改主机名</guimenu>和<guimenu>通过 DHCP 更新名称服务器和搜索列表</guimenu>，以启用 DHCP 来更改主机名和名称服务信息。
         </para>
        </listitem>
       </varlistentry>
       <varlistentry>
        <term><filename>/etc/nsswitch.conf</filename>
        </term>
        <listitem>
         <para>
          此文件告诉 Linux 到何处查找名称服务信息。它应显示为：
         </para>
<screen> ...
hosts: files dns
networks: files dns
...</screen>
         <para>
          <option>dns </option>条目是必需的。它告诉 Linux 要使用外部名称服务器。通常这些项是 YaST 自动管理的，但最好谨慎地检查。
         </para>
         <para>
          如果主机上的所有相关条目均正确，请让系统管理员检查 DNS 服务器配置，以确定时区信息是否正确。 <phrase os="sles;osuse">有关 DNS 的详细信息，请参见<xref linkend="cha-dns"/>。</phrase>如果确信主机和 DNS 服务器的 DNS 配置正确，请检查网络和网络设备的配置。
         </para>
        </listitem>
       </varlistentry>
      </variablelist>
     </step>
     <step>
      <para>
       如果系统无法与网络服务器建立连接，并且已排除了名称服务出现问题的可能，则请检查网卡的配置。
      </para>
      <para>
       请使用 <command>ifconfig</command> <replaceable>network_device</replaceable> 命令（以 <systemitem class="username">root</systemitem> 用户的身份执行）来检查此设备是否已正确配置。确保 <option>inet address </option> 和 <option>Mask</option> 已正确配置。如果 IP 地址中出现错误或网络掩码中缺少一位，将使您的网络配置无法使用。如有必要，也在服务器上执行该检查。
      </para>
     </step>
     <step>
      <para>
       如果名称服务和网络硬件已正确配置并正在运行，但是某些外部网络连接仍然长时间超时或完全失败，请使用 <command>traceroute</command> <replaceable>fully_qualified_domain_name</replaceable> 命令（以 <systemitem class="username">root</systemitem> 用户的身份执行）来跟踪这些请求所经过的网络路由。此命令将列出某一请求从您的计算机传递到其目标所经过的所有网关（跳跃）。它列出了每个中继的响应时间以及该中继是否可访问。请将 traceroute 和 ping 结合使用以确定故障原因并通知管理员。
      </para>
     </step>
    </substeps>
   </step>
  </procedure>

  <para>
   一旦确定了网络故障的原因，就可以自行解决（如果问题出在您自己的计算机上），或告诉网络系统管理员您的发现，以便其重配置服务或修复必要的系统。
  </para>

  <section xml:id="sec-trouble-networkmanager">
   <title>NetworkManager 问题</title>
   
   <para>
    如果网络连接有问题，请按<xref linkend="proc-trouble-config-net"/> 中所述缩小范围。如果 NetworkManager 看上去有问题，请执行以下步骤，以获取相关的日志来找出 NetworkManager 失败原因的线索：
   </para>
   <procedure>
    <step>
     <para>
      以 <systemitem class="username">root</systemitem> 用户身份打开外壳并登录。
     </para>
    </step>
    <step>
     <para>
      重启动 NetworkManager：
     </para>
<screen>rcnetwork restart -o nm</screen>
    </step>
    <step>
     <para>
      以普通用户身份打开一个网页，例如 <link xlink:href="http://www.opensuse.org"/>，看看是否可以连接。
     </para>
    </step>
    <step>
     <para>
      收集 <filename>/var/log/NetworkManager</filename> 中有关 NetworkManager 状态的任何信息。
     </para>
    </step>
   </procedure>
   <para>
    有关 NetworkManager 的更多信息，请参考<xref linkend="cha-nm"/>。
   </para>
  </section>
 </section>
 <section xml:id="sec-trouble-data">
  <title>数据问题</title>

  <para>
   数据问题是指无论计算机是否能够正确引导，有一点是明确的，即系统上的数据损坏并且系统需要恢复。这些情况下需要对关键数据进行备份，以便您能够在系统出现故障时恢复故障前的状态。<phrase role="productname"><phrase os="sles">SUSE Linux Enterprise Server</phrase></phrase> 提供了专用的 YaST 模块用于系统备份和恢复，此外还提供了一个救援系统，用于从外部恢复受损的系统。
  </para>

  <section xml:id="sec-trouble-data-partitions">
   <title>管理分区映像</title>
   <para>
    有时您需要从整个分区甚至硬盘来执行备份。Linux 附带了 <command>dd</command> 工具，后者可以用来创建磁盘的精确副本。与 <command>gzip</command> 一起使用可节约一些空间。
   </para>
   <procedure>
    <title>备份和恢复硬盘</title>
    <step>
     <para>
      以 <systemitem class="username">root</systemitem> 用户身份启动外壳。
     </para>
    </step>
    <step>
     <para>
      选择源设备。通常形如 <filename>/dev/sda</filename>（标记为 <replaceable>SOURCE</replaceable>）。
     </para>
    </step>
    <step>
     <para>
      确定要把您的映像储存在何处（标记为 <replaceable>BACKUP_PATH</replaceable>）。它不能与您的源设备相同。换句话说：如果从 <filename>/dev/sda</filename> 备份，则映像文件不得储存在 <filename>/dev/sda</filename> 下。
     </para>
    </step>
    <step>
     <para>
      运行以下命令创建压缩映像文件：
     </para>
<screen>dd if=/dev/<replaceable>SOURCE</replaceable> | gzip &gt; /<replaceable>BACKUP_PATH</replaceable>/image.gz </screen>
    </step>
    <step>
     <para>
      用以下命令恢复硬盘：
     </para>
<screen>gzip -dc /<replaceable>BACKUP_PATH</replaceable>/image.gz | dd of=/dev/<replaceable>SOURCE</replaceable></screen>
    </step>
   </procedure>
   <para>
    如果您只需要备份某分区，将 <replaceable>SOURCE</replaceable> 占位符替换为您各自的分区。在这种情况下，映像文件可以位于同一硬盘上不同的分区中。
   </para>
  </section>



  <section xml:id="sec-trouble-data-backup">
   <title>备份关键数据</title>
   <procedure xml:id="proc-trouble-data-backup">
    <para>
     可使用“YaST 系统备份”模块轻松管理系统备份：
    </para>
    <step>
     <para>
      以 <systemitem class="username">root</systemitem> 身份启动 YaST，然后选择<menuchoice><guimenu>系统</guimenu> <guimenu>系统备份</guimenu></menuchoice>。
     </para>
    </step>
    <step>
     <para>
      创建一个存放备份所需的所有详细信息、存档文件的文件名以及备份范围和类型的备份配置文件：
     </para>
     <substeps performance="required">
      <step>
       <para>
        选择<menuchoice><guimenu>配置文件管理</guimenu><guimenu>添加</guimenu></menuchoice>。
       </para>
      </step>
      <step>
       <para>
        输入存档文件的名称。
       </para>
      </step>
      <step>
       <para>
        如果想要保留本地备份，请输入备份位置的路径。如果要将备份存档在网络服务器上（通过 NFS），请输入 IP 地址或服务器名称以及存放存档文件的目录。
       </para>
      </step>
      <step>
       <para>
        确定存档类型，然后单击<guimenu>下一步</guimenu>。
       </para>
      </step>
      <step>
       <para>
        确定要使用的备份选项，例如是否要对不属于任何包的文件进行备份以及在创建存档文件之前是否显示文件列表。此外，确定是否使用耗费时间的 MD5 机制来确定更改过的文件。
       </para>
       <para>
        使用<guimenu>专家</guimenu>进入备份整个硬盘区域的对话框。目前该选项仅适用于 Ext2 文件系统。
       </para>
      </step>
      <step>
       <para>
        最后，设置搜索约束条件，以将某些不需要备份的系统区域排除在备份区域之外，如锁文件或高速缓存文件。添加、编辑或删除项目，直到符合要求为止，然后单击<guimenu>确定</guimenu>退出。
       </para>
      </step>
     </substeps>
    </step>
    <step>
     <para>
      一旦完成了配置文件设置，就可以单击<guimenu>创建备份</guimenu>立即开始备份，或者配置自动备份。此外，还可以创建用于其他各种用途的配置文件。
     </para>
    </step>
   </procedure>
   <procedure xml:id="proc-trouble-data-profile">
    <para>
     要为指定的配置文件配置自动备份，请执行如下操作：
    </para>
    <step>
     <para>
      在<guimenu>配置文件管理</guimenu>菜单中选择<guimenu>自动备份</guimenu>。
     </para>
    </step>
    <step>
     <para>
      选择<guimenu>自动启动备份</guimenu>。
     </para>
    </step>
    <step>
     <para>
      确定备份频率。选择<guimenu>每天</guimenu>、<guimenu>每周</guimenu>或<guimenu>每月</guimenu>。
     </para>
    </step>
    <step>
     <para>
      确定备份开始时间。这些设置取决于所选择的备份频率。
     </para>
    </step>
    <step>
     <para>
      确定是否保留旧的备份以及保留的个数。要自动接收备份过程自动生成的状态消息，请选中<guimenu>向 root 用户发送摘要邮件</guimenu>。
     </para>
    </step>
    <step>
     <para>
      单击<guimenu>确定</guimenu>以应用您的设置，首次备份将在指定的时间开始。
     </para>
    </step>
   </procedure>
  </section>

  <section xml:id="sec-trouble-data-replay">
   <title>恢复系统备份</title>
   <para>
    请使用“YaST 系统恢复”模块从备份恢复系统配置。可恢复整个备份，或选择已损坏并需要重置为先前状态的特定部分。
   </para>



   <procedure xml:id="proc-trouble-data-replay">
    <step>
     <para>
      启动 <menuchoice><guimenu>YaST</guimenu> <guimenu>系统</guimenu> <guimenu>系统恢复</guimenu></menuchoice>。
     </para>
    </step>
    <step>
     <para>
      输入备份文件的位置。这可以是本地文件、网络装入文件或可卸设备（如软盘或 DVD）上的文件。然后单击<guimenu>下一步</guimenu>。
     </para>
     <para>
      以下对话框显示了存档文件属性（如文件名、创建日期、备份类型和可选的注释）的摘要。
     </para>
    </step>
    <step>
     <para>
      可单击<guimenu>存档文件内容</guimenu>来查看已存档的内容。单击<guimenu>确定</guimenu>可返回到<guimenu>存档文件属性</guimenu>对话框。
     </para>
    </step>
    <step>
     <para>
      <guimenu>单击</guimenu>专家选项将打开一个对话框，在其中可对恢复过程进行微调。单击<guimenu>确定</guimenu>可返回到<guimenu>存档文件属性</guimenu>对话框。
     </para>
    </step>
    <step>
     <para>
      单击<guimenu>下一步</guimenu>可打开要恢复的包的视图。按<guimenu>接受</guimenu>可恢复该存档文件中的所有文件，或者使用各个<guimenu>全选</guimenu>、<guimenu>取消选择全部</guimenu>和<guimenu>选择文件</guimenu>按钮对所选存档文件进行微调。如果 RPM 数据库损坏或被删除，且该文件包含在备份中，则只需使用<guimenu>恢复 RPM 数据库</guimenu>选项。
     </para>
    </step>
    <step>
     <para>
      在单击<guimenu>接受</guimenu>之后，将恢复备份。在恢复过程完成后，单击<guimenu>完成</guimenu>将退出此模块。
     </para>
    </step>
   </procedure>
  </section>

  <xi:include href="system_repair.xml" parse="xml"/>
 </section>
 <xi:include os="sles" arch="zseries" href="zseries_rescue_initrd.xml" parse="xml"/>
</chapter>
